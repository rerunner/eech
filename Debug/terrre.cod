; Listing generated by Microsoft (R) Optimizing Compiler Version 19.16.27045.0 

	TITLE	C:\Users\nhv90\Projects\eech\modules\3d\terrain\terrre.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRTD
INCLUDELIB OLDNAMES

PUBLIC	?asm_convert_float_to_int@@YGXMPAH@Z		; asm_convert_float_to_int
PUBLIC	?render_3d_terrain_word_fan@@YGXH@Z		; render_3d_terrain_word_fan
PUBLIC	?render_3d_terrain_byte_fan@@YGXH@Z		; render_3d_terrain_byte_fan
PUBLIC	?render_3d_terrain_word_strip@@YGXH@Z		; render_3d_terrain_word_strip
PUBLIC	?render_3d_terrain_byte_strip@@YGXH@Z		; render_3d_terrain_byte_strip
PUBLIC	?render_3d_terrain_texture_xy_word_strip@@YGXH@Z ; render_3d_terrain_texture_xy_word_strip
PUBLIC	?render_3d_terrain_texture_xy_byte_strip@@YGXH@Z ; render_3d_terrain_texture_xy_byte_strip
PUBLIC	?render_3d_terrain_texture_zy_word_strip@@YGXH@Z ; render_3d_terrain_texture_zy_word_strip
PUBLIC	?render_3d_terrain_texture_zy_byte_strip@@YGXH@Z ; render_3d_terrain_texture_zy_byte_strip
PUBLIC	?render_3d_terrain_texture_xy_word_fan@@YGXH@Z	; render_3d_terrain_texture_xy_word_fan
PUBLIC	?render_3d_terrain_texture_xy_byte_fan@@YGXH@Z	; render_3d_terrain_texture_xy_byte_fan
PUBLIC	?render_3d_terrain_texture_zy_word_fan@@YGXH@Z	; render_3d_terrain_texture_zy_word_fan
PUBLIC	?render_3d_terrain_texture_zy_byte_fan@@YGXH@Z	; render_3d_terrain_texture_zy_byte_fan
PUBLIC	?render_3d_terrain_word_colour_fan@@YGXH@Z	; render_3d_terrain_word_colour_fan
PUBLIC	?render_3d_terrain_byte_colour_fan@@YGXH@Z	; render_3d_terrain_byte_colour_fan
PUBLIC	?render_3d_terrain_word_colour_strip@@YGXH@Z	; render_3d_terrain_word_colour_strip
PUBLIC	?render_3d_terrain_byte_colour_strip@@YGXH@Z	; render_3d_terrain_byte_colour_strip
PUBLIC	?render_3d_terrain_texture_xy_word_colour_fan@@YGXH@Z ; render_3d_terrain_texture_xy_word_colour_fan
PUBLIC	?render_3d_terrain_texture_xy_byte_colour_fan@@YGXH@Z ; render_3d_terrain_texture_xy_byte_colour_fan
PUBLIC	?render_3d_terrain_texture_zy_word_colour_fan@@YGXH@Z ; render_3d_terrain_texture_zy_word_colour_fan
PUBLIC	?render_3d_terrain_texture_zy_byte_colour_fan@@YGXH@Z ; render_3d_terrain_texture_zy_byte_colour_fan
PUBLIC	?render_3d_terrain_texture_xy_word_colour_strip@@YGXH@Z ; render_3d_terrain_texture_xy_word_colour_strip
PUBLIC	?render_3d_terrain_texture_xy_byte_colour_strip@@YGXH@Z ; render_3d_terrain_texture_xy_byte_colour_strip
PUBLIC	?render_3d_terrain_texture_zy_word_colour_strip@@YGXH@Z ; render_3d_terrain_texture_zy_word_colour_strip
PUBLIC	?render_3d_terrain_texture_zy_byte_colour_strip@@YGXH@Z ; render_3d_terrain_texture_zy_byte_colour_strip
PUBLIC	?render_3d_terrain_secondary_word_fan@@YGXH@Z	; render_3d_terrain_secondary_word_fan
PUBLIC	?render_3d_terrain_secondary_byte_fan@@YGXH@Z	; render_3d_terrain_secondary_byte_fan
PUBLIC	?render_3d_terrain_secondary_word_strip@@YGXH@Z	; render_3d_terrain_secondary_word_strip
PUBLIC	?render_3d_terrain_secondary_byte_strip@@YGXH@Z	; render_3d_terrain_secondary_byte_strip
PUBLIC	?render_3d_terrain_secondary_texture_xy_word_fan@@YGXH@Z ; render_3d_terrain_secondary_texture_xy_word_fan
PUBLIC	?render_3d_terrain_secondary_texture_xy_byte_fan@@YGXH@Z ; render_3d_terrain_secondary_texture_xy_byte_fan
PUBLIC	?render_3d_terrain_secondary_texture_zy_word_fan@@YGXH@Z ; render_3d_terrain_secondary_texture_zy_word_fan
PUBLIC	?render_3d_terrain_secondary_texture_zy_byte_fan@@YGXH@Z ; render_3d_terrain_secondary_texture_zy_byte_fan
PUBLIC	?render_3d_terrain_secondary_texture_xy_word_strip@@YGXH@Z ; render_3d_terrain_secondary_texture_xy_word_strip
PUBLIC	?render_3d_terrain_secondary_texture_xy_byte_strip@@YGXH@Z ; render_3d_terrain_secondary_texture_xy_byte_strip
PUBLIC	?render_3d_terrain_secondary_texture_zy_word_strip@@YGXH@Z ; render_3d_terrain_secondary_texture_zy_word_strip
PUBLIC	?render_3d_terrain_secondary_texture_zy_byte_strip@@YGXH@Z ; render_3d_terrain_secondary_texture_zy_byte_strip
PUBLIC	?render_3d_terrain_secondary_vertex_polygon@@YGXPAUVERTEX@@@Z ; render_3d_terrain_secondary_vertex_polygon
PUBLIC	?render_3d_terrain_stripe_word_fan@@YGXH@Z	; render_3d_terrain_stripe_word_fan
PUBLIC	?render_3d_terrain_stripe_byte_fan@@YGXH@Z	; render_3d_terrain_stripe_byte_fan
PUBLIC	?terrain_3d_copy_and_recolour_polygon@@YGPAUVERTEX@@PAU1@@Z ; terrain_3d_copy_and_recolour_polygon
PUBLIC	?render_3d_terrain_clipped_fan@@YGXHPAUVERTEX@@@Z ; render_3d_terrain_clipped_fan
PUBLIC	?render_3d_terrain_clipped_fan_new@@YGXXZ	; render_3d_terrain_clipped_fan_new
EXTRN	?draw_fan_primitive@@YGXHPAU_D3DTLVERTEX@@@Z:PROC ; draw_fan_primitive
EXTRN	?draw_strip_primitive@@YGXHPAU_D3DTLVERTEX@@@Z:PROC ; draw_strip_primitive
EXTRN	?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z:PROC ; get_d3d_vertices_points_address
EXTRN	?get_terrain_3d_buffered_vertices@@YGPAU_D3DTLVERTEX@@H@Z:PROC ; get_terrain_3d_buffered_vertices
EXTRN	?add_terrain_3d_buffered_triangle_fan@@YGXHPAUSCREEN@@@Z:PROC ; add_terrain_3d_buffered_triangle_fan
EXTRN	?add_terrain_3d_buffered_triangle_strip@@YGXHPAUSCREEN@@@Z:PROC ; add_terrain_3d_buffered_triangle_strip
EXTRN	?zbuffer_factor@@3NA:QWORD			; zbuffer_factor
EXTRN	?zbuffer_constant@@3NA:QWORD			; zbuffer_constant
EXTRN	?clipping_vertices@@3PAUVERTEX@@A:BYTE		; clipping_vertices
EXTRN	?number_of_clipping_primitives@@3HA:DWORD	; number_of_clipping_primitives
EXTRN	?clipping_primitives_results@@3PAHA:BYTE	; clipping_primitives_results
EXTRN	?clipping_primitives_vertex_indices@@3PAHA:BYTE	; clipping_primitives_vertex_indices
EXTRN	?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A:BYTE ; transformed_3d_2d_points
EXTRN	?terrain_3d_map_minimum_height@@3MA:DWORD	; terrain_3d_map_minimum_height
EXTRN	?terrain_3d_map_scaled_height_difference@@3MA:DWORD ; terrain_3d_map_scaled_height_difference
EXTRN	?terrain_3d_sector_point_byte_references@@3PAUTERRAIN_3D_POINT_BYTE_REFERENCE@@A:DWORD ; terrain_3d_sector_point_byte_references
EXTRN	?terrain_3d_sector_point_word_references@@3PAUTERRAIN_3D_POINT_WORD_REFERENCE@@A:DWORD ; terrain_3d_sector_point_word_references
EXTRN	?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A:DWORD ; current_terrain_type_class
EXTRN	?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A:DWORD ; current_terrain_points_xz
EXTRN	?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A:DWORD ; current_terrain_points_y
EXTRN	?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A:BYTE ; transformed_3d_point_colours
EXTRN	?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A:BYTE ; terrain_3d_transformed_point_normals
EXTRN	?terrain_3d_faces_constructed@@3HA:DWORD	; terrain_3d_faces_constructed
EXTRN	?terrain_3d_copied_points@@3PAUVERTEX@@A:BYTE	; terrain_3d_copied_points
EXTRN	__fltused:DWORD
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_clipped_fan_new@@YGXXZ
_TEXT	SEGMENT
_vertex_index$1 = -24					; size = 4
_destination_vertices$ = -20				; size = 4
_count$ = -16						; size = 4
_vertex_indices$ = -12					; size = 4
_primitive_count$ = -8					; size = 4
_number_of_points$ = -4					; size = 4
?render_3d_terrain_clipped_fan_new@@YGXXZ PROC		; render_3d_terrain_clipped_fan_new, COMDAT

; 2328 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 58	 sub	 esp, 88			; 00000058H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 2329 : 
; 2330 : 	int
; 2331 : 		number_of_points,
; 2332 : 		primitive_count,
; 2333 : 		*vertex_indices,
; 2334 : 		count;
; 2335 : 
; 2336 : 	LPD3DTLVERTEX
; 2337 : 		destination_vertices;
; 2338 : 
; 2339 : 	vertex_indices = clipping_primitives_vertex_indices;

  00009	c7 45 f4 00 00
	00 00		 mov	 DWORD PTR _vertex_indices$[ebp], OFFSET ?clipping_primitives_vertex_indices@@3PAHA ; clipping_primitives_vertex_indices

; 2340 : 
; 2341 : 	for ( primitive_count = 0; primitive_count < number_of_clipping_primitives; primitive_count++ )

  00010	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _primitive_count$[ebp], 0
  00017	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  00019	8b 45 f8	 mov	 eax, DWORD PTR _primitive_count$[ebp]
  0001c	83 c0 01	 add	 eax, 1
  0001f	89 45 f8	 mov	 DWORD PTR _primitive_count$[ebp], eax
$LN4@render_3d_:
  00022	8b 45 f8	 mov	 eax, DWORD PTR _primitive_count$[ebp]
  00025	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?number_of_clipping_primitives@@3HA ; number_of_clipping_primitives
  0002b	0f 8d 5c 01 00
	00		 jge	 $LN3@render_3d_

; 2342 : 	{
; 2343 : 
; 2344 : 		number_of_points = clipping_primitives_results[primitive_count];

  00031	8b 45 f8	 mov	 eax, DWORD PTR _primitive_count$[ebp]
  00034	8b 0c 85 00 00
	00 00		 mov	 ecx, DWORD PTR ?clipping_primitives_results@@3PAHA[eax*4]
  0003b	89 4d fc	 mov	 DWORD PTR _number_of_points$[ebp], ecx

; 2345 : 
; 2346 : 		destination_vertices = get_d3d_vertices_points_address ( number_of_points );

  0003e	8b 45 fc	 mov	 eax, DWORD PTR _number_of_points$[ebp]
  00041	50		 push	 eax
  00042	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00047	89 45 ec	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 2347 : 
; 2348 : 		terrain_3d_faces_constructed += ( number_of_points - 2 );

  0004a	8b 45 fc	 mov	 eax, DWORD PTR _number_of_points$[ebp]
  0004d	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  00053	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00057	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 2349 : 	
; 2350 : 		for ( count = 0; count < number_of_points; count++ )

  0005d	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  00064	eb 09		 jmp	 SHORT $LN7@render_3d_
$LN5@render_3d_:
  00066	8b 45 f0	 mov	 eax, DWORD PTR _count$[ebp]
  00069	83 c0 01	 add	 eax, 1
  0006c	89 45 f0	 mov	 DWORD PTR _count$[ebp], eax
$LN7@render_3d_:
  0006f	8b 45 f0	 mov	 eax, DWORD PTR _count$[ebp]
  00072	3b 45 fc	 cmp	 eax, DWORD PTR _number_of_points$[ebp]
  00075	0f 8d f9 00 00
	00		 jge	 $LN6@render_3d_

; 2351 : 		{
; 2352 : 
; 2353 : 			int
; 2354 : 				vertex_index;
; 2355 : 
; 2356 : 			vertex_index = *vertex_indices++;

  0007b	8b 45 f4	 mov	 eax, DWORD PTR _vertex_indices$[ebp]
  0007e	8b 08		 mov	 ecx, DWORD PTR [eax]
  00080	89 4d e8	 mov	 DWORD PTR _vertex_index$1[ebp], ecx
  00083	8b 55 f4	 mov	 edx, DWORD PTR _vertex_indices$[ebp]
  00086	83 c2 04	 add	 edx, 4
  00089	89 55 f4	 mov	 DWORD PTR _vertex_indices$[ebp], edx

; 2357 : 
; 2358 : 			destination_vertices[count].tu = clipping_vertices[vertex_index].u;

  0008c	8b 45 e8	 mov	 eax, DWORD PTR _vertex_index$1[ebp]
  0008f	c1 e0 06	 shl	 eax, 6
  00092	8b 4d f0	 mov	 ecx, DWORD PTR _count$[ebp]
  00095	c1 e1 05	 shl	 ecx, 5
  00098	8b 55 ec	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0009b	8b 80 18 00 00
	00		 mov	 eax, DWORD PTR ?clipping_vertices@@3PAUVERTEX@@A[eax+24]
  000a1	89 44 0a 18	 mov	 DWORD PTR [edx+ecx+24], eax

; 2359 : 			destination_vertices[count].tv = clipping_vertices[vertex_index].v;

  000a5	8b 45 e8	 mov	 eax, DWORD PTR _vertex_index$1[ebp]
  000a8	c1 e0 06	 shl	 eax, 6
  000ab	8b 4d f0	 mov	 ecx, DWORD PTR _count$[ebp]
  000ae	c1 e1 05	 shl	 ecx, 5
  000b1	8b 55 ec	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000b4	8b 80 1c 00 00
	00		 mov	 eax, DWORD PTR ?clipping_vertices@@3PAUVERTEX@@A[eax+28]
  000ba	89 44 0a 1c	 mov	 DWORD PTR [edx+ecx+28], eax

; 2360 : 			destination_vertices[count].sx = clipping_vertices[vertex_index].i;

  000be	8b 45 e8	 mov	 eax, DWORD PTR _vertex_index$1[ebp]
  000c1	c1 e0 06	 shl	 eax, 6
  000c4	8b 4d f0	 mov	 ecx, DWORD PTR _count$[ebp]
  000c7	c1 e1 05	 shl	 ecx, 5
  000ca	8b 55 ec	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000cd	8b 80 10 00 00
	00		 mov	 eax, DWORD PTR ?clipping_vertices@@3PAUVERTEX@@A[eax+16]
  000d3	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 2361 : 			destination_vertices[count].sy = clipping_vertices[vertex_index].j;

  000d6	8b 45 e8	 mov	 eax, DWORD PTR _vertex_index$1[ebp]
  000d9	c1 e0 06	 shl	 eax, 6
  000dc	8b 4d f0	 mov	 ecx, DWORD PTR _count$[ebp]
  000df	c1 e1 05	 shl	 ecx, 5
  000e2	8b 55 ec	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000e5	8b 80 14 00 00
	00		 mov	 eax, DWORD PTR ?clipping_vertices@@3PAUVERTEX@@A[eax+20]
  000eb	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 2362 : 			destination_vertices[count].sz = ( clipping_vertices[vertex_index].q * zbuffer_factor ) + zbuffer_constant;

  000ef	8b 45 e8	 mov	 eax, DWORD PTR _vertex_index$1[ebp]
  000f2	c1 e0 06	 shl	 eax, 6
  000f5	f3 0f 5a 80 0c
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?clipping_vertices@@3PAUVERTEX@@A[eax+12]
  000fd	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00105	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0010d	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00111	8b 4d f0	 mov	 ecx, DWORD PTR _count$[ebp]
  00114	c1 e1 05	 shl	 ecx, 5
  00117	8b 55 ec	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0011a	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 2363 : 			destination_vertices[count].rhw = clipping_vertices[vertex_index].q;

  00120	8b 45 e8	 mov	 eax, DWORD PTR _vertex_index$1[ebp]
  00123	c1 e0 06	 shl	 eax, 6
  00126	8b 4d f0	 mov	 ecx, DWORD PTR _count$[ebp]
  00129	c1 e1 05	 shl	 ecx, 5
  0012c	8b 55 ec	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0012f	8b 80 0c 00 00
	00		 mov	 eax, DWORD PTR ?clipping_vertices@@3PAUVERTEX@@A[eax+12]
  00135	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 2364 : 			destination_vertices[count].color = clipping_vertices[vertex_index].colour;

  00139	8b 45 e8	 mov	 eax, DWORD PTR _vertex_index$1[ebp]
  0013c	c1 e0 06	 shl	 eax, 6
  0013f	8b 4d f0	 mov	 ecx, DWORD PTR _count$[ebp]
  00142	c1 e1 05	 shl	 ecx, 5
  00145	8b 55 ec	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00148	8b 80 30 00 00
	00		 mov	 eax, DWORD PTR ?clipping_vertices@@3PAUVERTEX@@A[eax+48]
  0014e	89 44 0a 10	 mov	 DWORD PTR [edx+ecx+16], eax

; 2365 : 			destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, clipping_vertices[vertex_index].fog );

  00152	8b 45 e8	 mov	 eax, DWORD PTR _vertex_index$1[ebp]
  00155	c1 e0 06	 shl	 eax, 6
  00158	0f b6 88 2e 00
	00 00		 movzx	 ecx, BYTE PTR ?clipping_vertices@@3PAUVERTEX@@A[eax+46]
  0015f	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00162	8b 55 f0	 mov	 edx, DWORD PTR _count$[ebp]
  00165	c1 e2 05	 shl	 edx, 5
  00168	8b 45 ec	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  0016b	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 2366 : 		}

  0016f	e9 f2 fe ff ff	 jmp	 $LN5@render_3d_
$LN6@render_3d_:

; 2367 : 
; 2368 : 		draw_fan_primitive ( clipping_primitives_results[primitive_count], destination_vertices );

  00174	8b 45 ec	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00177	50		 push	 eax
  00178	8b 4d f8	 mov	 ecx, DWORD PTR _primitive_count$[ebp]
  0017b	8b 14 8d 00 00
	00 00		 mov	 edx, DWORD PTR ?clipping_primitives_results@@3PAHA[ecx*4]
  00182	52		 push	 edx
  00183	e8 00 00 00 00	 call	 ?draw_fan_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_fan_primitive

; 2369 : 	}

  00188	e9 8c fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 2370 : }

  0018d	5f		 pop	 edi
  0018e	5e		 pop	 esi
  0018f	5b		 pop	 ebx
  00190	8b e5		 mov	 esp, ebp
  00192	5d		 pop	 ebp
  00193	c3		 ret	 0
?render_3d_terrain_clipped_fan_new@@YGXXZ ENDP		; render_3d_terrain_clipped_fan_new
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_clipped_fan@@YGXHPAUVERTEX@@@Z
_TEXT	SEGMENT
_destination_vertices$ = -8				; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
_points$ = 12						; size = 4
?render_3d_terrain_clipped_fan@@YGXHPAUVERTEX@@@Z PROC	; render_3d_terrain_clipped_fan, COMDAT

; 2295 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 48	 sub	 esp, 72			; 00000048H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 2296 : 
; 2297 : 	int
; 2298 : 		count;
; 2299 : 
; 2300 : 	LPD3DTLVERTEX
; 2301 : 		destination_vertices;
; 2302 : 
; 2303 : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00009	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0000c	50		 push	 eax
  0000d	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00012	89 45 f8	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 2304 : 
; 2305 : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00015	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00018	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0001e	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00022	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 2306 : 
; 2307 : 	for ( count = 0; count < num_points; count++ )

  00028	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0002f	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  00031	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00034	83 c0 01	 add	 eax, 1
  00037	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  0003a	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0003d	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  00040	0f 8d f0 00 00
	00		 jge	 $LN3@render_3d_

; 2308 : 	{
; 2309 : 	
; 2310 : 		destination_vertices[count].tu = points[count].u;

  00046	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00049	c1 e0 06	 shl	 eax, 6
  0004c	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0004f	c1 e1 05	 shl	 ecx, 5
  00052	8b 55 f8	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00055	8b 75 0c	 mov	 esi, DWORD PTR _points$[ebp]
  00058	8b 44 06 18	 mov	 eax, DWORD PTR [esi+eax+24]
  0005c	89 44 0a 18	 mov	 DWORD PTR [edx+ecx+24], eax

; 2311 : 		destination_vertices[count].tv = points[count].v;

  00060	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00063	c1 e0 06	 shl	 eax, 6
  00066	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00069	c1 e1 05	 shl	 ecx, 5
  0006c	8b 55 f8	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0006f	8b 75 0c	 mov	 esi, DWORD PTR _points$[ebp]
  00072	8b 44 06 1c	 mov	 eax, DWORD PTR [esi+eax+28]
  00076	89 44 0a 1c	 mov	 DWORD PTR [edx+ecx+28], eax

; 2312 : 		destination_vertices[count].sx = points[count].i;

  0007a	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0007d	c1 e0 06	 shl	 eax, 6
  00080	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00083	c1 e1 05	 shl	 ecx, 5
  00086	8b 55 f8	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00089	8b 75 0c	 mov	 esi, DWORD PTR _points$[ebp]
  0008c	8b 44 06 10	 mov	 eax, DWORD PTR [esi+eax+16]
  00090	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 2313 : 		destination_vertices[count].sy = points[count].j;

  00093	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00096	c1 e0 06	 shl	 eax, 6
  00099	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0009c	c1 e1 05	 shl	 ecx, 5
  0009f	8b 55 f8	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000a2	8b 75 0c	 mov	 esi, DWORD PTR _points$[ebp]
  000a5	8b 44 06 14	 mov	 eax, DWORD PTR [esi+eax+20]
  000a9	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 2314 : 		destination_vertices[count].sz = ( points[count].q * zbuffer_factor ) + zbuffer_constant;

  000ad	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000b0	c1 e0 06	 shl	 eax, 6
  000b3	8b 4d 0c	 mov	 ecx, DWORD PTR _points$[ebp]
  000b6	f3 0f 5a 44 01
	0c		 cvtss2sd xmm0, DWORD PTR [ecx+eax+12]
  000bc	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  000c4	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  000cc	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  000d0	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  000d3	c1 e2 05	 shl	 edx, 5
  000d6	8b 45 f8	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  000d9	f3 0f 11 44 10
	08		 movss	 DWORD PTR [eax+edx+8], xmm0

; 2315 : 		destination_vertices[count].rhw = points[count].q;

  000df	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000e2	c1 e0 06	 shl	 eax, 6
  000e5	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000e8	c1 e1 05	 shl	 ecx, 5
  000eb	8b 55 f8	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000ee	8b 75 0c	 mov	 esi, DWORD PTR _points$[ebp]
  000f1	8b 44 06 0c	 mov	 eax, DWORD PTR [esi+eax+12]
  000f5	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 2316 : 		destination_vertices[count].color = points[count].colour;

  000f9	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000fc	c1 e0 06	 shl	 eax, 6
  000ff	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00102	c1 e1 05	 shl	 ecx, 5
  00105	8b 55 f8	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00108	8b 75 0c	 mov	 esi, DWORD PTR _points$[ebp]
  0010b	8b 44 06 30	 mov	 eax, DWORD PTR [esi+eax+48]
  0010f	89 44 0a 10	 mov	 DWORD PTR [edx+ecx+16], eax

; 2317 : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, points[count].fog );

  00113	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00116	c1 e0 06	 shl	 eax, 6
  00119	8b 4d 0c	 mov	 ecx, DWORD PTR _points$[ebp]
  0011c	0f b6 54 01 2e	 movzx	 edx, BYTE PTR [ecx+eax+46]
  00121	c1 e2 18	 shl	 edx, 24			; 00000018H
  00124	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00127	c1 e0 05	 shl	 eax, 5
  0012a	8b 4d f8	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  0012d	89 54 01 14	 mov	 DWORD PTR [ecx+eax+20], edx

; 2318 : 	}

  00131	e9 fb fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 2319 : 
; 2320 : 	draw_fan_primitive ( num_points, destination_vertices );

  00136	8b 45 f8	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00139	50		 push	 eax
  0013a	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  0013d	51		 push	 ecx
  0013e	e8 00 00 00 00	 call	 ?draw_fan_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_fan_primitive

; 2321 : }

  00143	5f		 pop	 edi
  00144	5e		 pop	 esi
  00145	5b		 pop	 ebx
  00146	8b e5		 mov	 esp, ebp
  00148	5d		 pop	 ebp
  00149	c2 08 00	 ret	 8
?render_3d_terrain_clipped_fan@@YGXHPAUVERTEX@@@Z ENDP	; render_3d_terrain_clipped_fan
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?terrain_3d_copy_and_recolour_polygon@@YGPAUVERTEX@@PAU1@@Z
_TEXT	SEGMENT
_normal_index$1 = -20					; size = 4
_blue$2 = -16						; size = 4
_green$3 = -12						; size = 4
_red$4 = -8						; size = 4
_vertex_count$ = -4					; size = 4
_polygon$ = 8						; size = 4
?terrain_3d_copy_and_recolour_polygon@@YGPAUVERTEX@@PAU1@@Z PROC ; terrain_3d_copy_and_recolour_polygon, COMDAT

; 2237 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 54	 sub	 esp, 84			; 00000054H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 2238 : 
; 2239 : 	int
; 2240 : 		vertex_count;
; 2241 : 
; 2242 : 	vertex_count = 0;

  00009	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _vertex_count$[ebp], 0
$LN2@terrain_3d:

; 2243 : 
; 2244 : 	while ( polygon )

  00010	83 7d 08 00	 cmp	 DWORD PTR _polygon$[ebp], 0
  00014	0f 84 d2 01 00
	00		 je	 $LN3@terrain_3d

; 2245 : 	{
; 2246 : 
; 2247 : 		int
; 2248 : 			red,
; 2249 : 			green,
; 2250 : 			blue,
; 2251 : 			normal_index;
; 2252 : 
; 2253 : 		terrain_3d_copied_points[vertex_count].x = polygon->x;

  0001a	8b 45 fc	 mov	 eax, DWORD PTR _vertex_count$[ebp]
  0001d	c1 e0 06	 shl	 eax, 6
  00020	8b 4d 08	 mov	 ecx, DWORD PTR _polygon$[ebp]
  00023	8b 11		 mov	 edx, DWORD PTR [ecx]
  00025	89 90 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_copied_points@@3PAUVERTEX@@A[eax], edx

; 2254 : 		terrain_3d_copied_points[vertex_count].y = polygon->y;

  0002b	8b 45 fc	 mov	 eax, DWORD PTR _vertex_count$[ebp]
  0002e	c1 e0 06	 shl	 eax, 6
  00031	8b 4d 08	 mov	 ecx, DWORD PTR _polygon$[ebp]
  00034	8b 51 04	 mov	 edx, DWORD PTR [ecx+4]
  00037	89 90 04 00 00
	00		 mov	 DWORD PTR ?terrain_3d_copied_points@@3PAUVERTEX@@A[eax+4], edx

; 2255 : 		terrain_3d_copied_points[vertex_count].z = polygon->z;

  0003d	8b 45 fc	 mov	 eax, DWORD PTR _vertex_count$[ebp]
  00040	c1 e0 06	 shl	 eax, 6
  00043	8b 4d 08	 mov	 ecx, DWORD PTR _polygon$[ebp]
  00046	8b 51 08	 mov	 edx, DWORD PTR [ecx+8]
  00049	89 90 08 00 00
	00		 mov	 DWORD PTR ?terrain_3d_copied_points@@3PAUVERTEX@@A[eax+8], edx

; 2256 : 		terrain_3d_copied_points[vertex_count].q = polygon->q;

  0004f	8b 45 fc	 mov	 eax, DWORD PTR _vertex_count$[ebp]
  00052	c1 e0 06	 shl	 eax, 6
  00055	8b 4d 08	 mov	 ecx, DWORD PTR _polygon$[ebp]
  00058	8b 51 0c	 mov	 edx, DWORD PTR [ecx+12]
  0005b	89 90 0c 00 00
	00		 mov	 DWORD PTR ?terrain_3d_copied_points@@3PAUVERTEX@@A[eax+12], edx

; 2257 : 		terrain_3d_copied_points[vertex_count].i = polygon->i;

  00061	8b 45 fc	 mov	 eax, DWORD PTR _vertex_count$[ebp]
  00064	c1 e0 06	 shl	 eax, 6
  00067	8b 4d 08	 mov	 ecx, DWORD PTR _polygon$[ebp]
  0006a	8b 51 10	 mov	 edx, DWORD PTR [ecx+16]
  0006d	89 90 10 00 00
	00		 mov	 DWORD PTR ?terrain_3d_copied_points@@3PAUVERTEX@@A[eax+16], edx

; 2258 : 		terrain_3d_copied_points[vertex_count].j = polygon->j;

  00073	8b 45 fc	 mov	 eax, DWORD PTR _vertex_count$[ebp]
  00076	c1 e0 06	 shl	 eax, 6
  00079	8b 4d 08	 mov	 ecx, DWORD PTR _polygon$[ebp]
  0007c	8b 51 14	 mov	 edx, DWORD PTR [ecx+20]
  0007f	89 90 14 00 00
	00		 mov	 DWORD PTR ?terrain_3d_copied_points@@3PAUVERTEX@@A[eax+20], edx

; 2259 : 		terrain_3d_copied_points[vertex_count].u = polygon->u;

  00085	8b 45 fc	 mov	 eax, DWORD PTR _vertex_count$[ebp]
  00088	c1 e0 06	 shl	 eax, 6
  0008b	8b 4d 08	 mov	 ecx, DWORD PTR _polygon$[ebp]
  0008e	8b 51 18	 mov	 edx, DWORD PTR [ecx+24]
  00091	89 90 18 00 00
	00		 mov	 DWORD PTR ?terrain_3d_copied_points@@3PAUVERTEX@@A[eax+24], edx

; 2260 : 		terrain_3d_copied_points[vertex_count].v = polygon->v;

  00097	8b 45 fc	 mov	 eax, DWORD PTR _vertex_count$[ebp]
  0009a	c1 e0 06	 shl	 eax, 6
  0009d	8b 4d 08	 mov	 ecx, DWORD PTR _polygon$[ebp]
  000a0	8b 51 1c	 mov	 edx, DWORD PTR [ecx+28]
  000a3	89 90 1c 00 00
	00		 mov	 DWORD PTR ?terrain_3d_copied_points@@3PAUVERTEX@@A[eax+28], edx

; 2261 : 		terrain_3d_copied_points[vertex_count].u2 = polygon->u2;

  000a9	8b 45 fc	 mov	 eax, DWORD PTR _vertex_count$[ebp]
  000ac	c1 e0 06	 shl	 eax, 6
  000af	8b 4d 08	 mov	 ecx, DWORD PTR _polygon$[ebp]
  000b2	8b 51 20	 mov	 edx, DWORD PTR [ecx+32]
  000b5	89 90 20 00 00
	00		 mov	 DWORD PTR ?terrain_3d_copied_points@@3PAUVERTEX@@A[eax+32], edx

; 2262 : 		terrain_3d_copied_points[vertex_count].v2 = polygon->v2;

  000bb	8b 45 fc	 mov	 eax, DWORD PTR _vertex_count$[ebp]
  000be	c1 e0 06	 shl	 eax, 6
  000c1	8b 4d 08	 mov	 ecx, DWORD PTR _polygon$[ebp]
  000c4	8b 51 24	 mov	 edx, DWORD PTR [ecx+36]
  000c7	89 90 24 00 00
	00		 mov	 DWORD PTR ?terrain_3d_copied_points@@3PAUVERTEX@@A[eax+36], edx

; 2263 : 		terrain_3d_copied_points[vertex_count].colour2 = polygon->colour2;

  000cd	8b 45 fc	 mov	 eax, DWORD PTR _vertex_count$[ebp]
  000d0	c1 e0 06	 shl	 eax, 6
  000d3	8b 4d 08	 mov	 ecx, DWORD PTR _polygon$[ebp]
  000d6	8b 51 34	 mov	 edx, DWORD PTR [ecx+52]
  000d9	89 90 34 00 00
	00		 mov	 DWORD PTR ?terrain_3d_copied_points@@3PAUVERTEX@@A[eax+52], edx

; 2264 : 		terrain_3d_copied_points[vertex_count].outcode = polygon->outcode;

  000df	8b 45 fc	 mov	 eax, DWORD PTR _vertex_count$[ebp]
  000e2	c1 e0 06	 shl	 eax, 6
  000e5	8b 4d 08	 mov	 ecx, DWORD PTR _polygon$[ebp]
  000e8	8a 51 2c	 mov	 dl, BYTE PTR [ecx+44]
  000eb	88 90 2c 00 00
	00		 mov	 BYTE PTR ?terrain_3d_copied_points@@3PAUVERTEX@@A[eax+44], dl

; 2265 : 		terrain_3d_copied_points[vertex_count].fog = polygon->fog;

  000f1	8b 45 fc	 mov	 eax, DWORD PTR _vertex_count$[ebp]
  000f4	c1 e0 06	 shl	 eax, 6
  000f7	8b 4d 08	 mov	 ecx, DWORD PTR _polygon$[ebp]
  000fa	8a 51 2e	 mov	 dl, BYTE PTR [ecx+46]
  000fd	88 90 2e 00 00
	00		 mov	 BYTE PTR ?terrain_3d_copied_points@@3PAUVERTEX@@A[eax+46], dl

; 2266 : 
; 2267 : 		normal_index = polygon->normal_index;

  00103	8b 45 08	 mov	 eax, DWORD PTR _polygon$[ebp]
  00106	0f b6 48 2f	 movzx	 ecx, BYTE PTR [eax+47]
  0010a	89 4d ec	 mov	 DWORD PTR _normal_index$1[ebp], ecx

; 2268 : 
; 2269 : 		asm_convert_float_to_int ( ( current_terrain_type_class->red * terrain_3d_transformed_point_normals[normal_index].r ), &red );

  0010d	8d 45 f8	 lea	 eax, DWORD PTR _red$4[ebp]
  00110	50		 push	 eax
  00111	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  00117	0f b6 51 0c	 movzx	 edx, BYTE PTR [ecx+12]
  0011b	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  0011f	8b 45 ec	 mov	 eax, DWORD PTR _normal_index$1[ebp]
  00122	c1 e0 04	 shl	 eax, 4
  00125	f3 0f 59 80 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax]
  0012d	51		 push	 ecx
  0012e	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00133	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 2270 : 		asm_convert_float_to_int ( ( current_terrain_type_class->green * terrain_3d_transformed_point_normals[normal_index].g ), &green );

  00138	8d 45 f4	 lea	 eax, DWORD PTR _green$3[ebp]
  0013b	50		 push	 eax
  0013c	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  00142	0f b6 51 0d	 movzx	 edx, BYTE PTR [ecx+13]
  00146	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  0014a	8b 45 ec	 mov	 eax, DWORD PTR _normal_index$1[ebp]
  0014d	c1 e0 04	 shl	 eax, 4
  00150	f3 0f 59 80 04
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+4]
  00158	51		 push	 ecx
  00159	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0015e	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 2271 : 		asm_convert_float_to_int ( ( current_terrain_type_class->blue * terrain_3d_transformed_point_normals[normal_index].b ), &blue );

  00163	8d 45 f0	 lea	 eax, DWORD PTR _blue$2[ebp]
  00166	50		 push	 eax
  00167	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0016d	0f b6 51 0e	 movzx	 edx, BYTE PTR [ecx+14]
  00171	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00175	8b 45 ec	 mov	 eax, DWORD PTR _normal_index$1[ebp]
  00178	c1 e0 04	 shl	 eax, 4
  0017b	f3 0f 59 80 08
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+8]
  00183	51		 push	 ecx
  00184	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00189	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 2272 : 
; 2273 : 		terrain_3d_copied_points[vertex_count].red = red;

  0018e	8b 45 fc	 mov	 eax, DWORD PTR _vertex_count$[ebp]
  00191	c1 e0 06	 shl	 eax, 6
  00194	8a 4d f8	 mov	 cl, BYTE PTR _red$4[ebp]
  00197	88 88 32 00 00
	00		 mov	 BYTE PTR ?terrain_3d_copied_points@@3PAUVERTEX@@A[eax+50], cl

; 2274 : 		terrain_3d_copied_points[vertex_count].green = green;

  0019d	8b 45 fc	 mov	 eax, DWORD PTR _vertex_count$[ebp]
  001a0	c1 e0 06	 shl	 eax, 6
  001a3	8a 4d f4	 mov	 cl, BYTE PTR _green$3[ebp]
  001a6	88 88 31 00 00
	00		 mov	 BYTE PTR ?terrain_3d_copied_points@@3PAUVERTEX@@A[eax+49], cl

; 2275 : 		terrain_3d_copied_points[vertex_count].blue = blue;

  001ac	8b 45 fc	 mov	 eax, DWORD PTR _vertex_count$[ebp]
  001af	c1 e0 06	 shl	 eax, 6
  001b2	8a 4d f0	 mov	 cl, BYTE PTR _blue$2[ebp]
  001b5	88 88 30 00 00
	00		 mov	 BYTE PTR ?terrain_3d_copied_points@@3PAUVERTEX@@A[eax+48], cl

; 2276 : //		terrain_3d_copied_points[vertex_count].alpha2 = 0;
; 2277 : 
; 2278 : 		terrain_3d_copied_points[vertex_count].next_vertex = &terrain_3d_copied_points[vertex_count+1];

  001bb	8b 45 fc	 mov	 eax, DWORD PTR _vertex_count$[ebp]
  001be	83 c0 01	 add	 eax, 1
  001c1	c1 e0 06	 shl	 eax, 6
  001c4	05 00 00 00 00	 add	 eax, OFFSET ?terrain_3d_copied_points@@3PAUVERTEX@@A ; terrain_3d_copied_points
  001c9	8b 4d fc	 mov	 ecx, DWORD PTR _vertex_count$[ebp]
  001cc	c1 e1 06	 shl	 ecx, 6
  001cf	89 81 28 00 00
	00		 mov	 DWORD PTR ?terrain_3d_copied_points@@3PAUVERTEX@@A[ecx+40], eax

; 2279 : 
; 2280 : 		vertex_count++;

  001d5	8b 45 fc	 mov	 eax, DWORD PTR _vertex_count$[ebp]
  001d8	83 c0 01	 add	 eax, 1
  001db	89 45 fc	 mov	 DWORD PTR _vertex_count$[ebp], eax

; 2281 : 
; 2282 : 		polygon = polygon->next_vertex;

  001de	8b 45 08	 mov	 eax, DWORD PTR _polygon$[ebp]
  001e1	8b 48 28	 mov	 ecx, DWORD PTR [eax+40]
  001e4	89 4d 08	 mov	 DWORD PTR _polygon$[ebp], ecx

; 2283 : 	}

  001e7	e9 24 fe ff ff	 jmp	 $LN2@terrain_3d
$LN3@terrain_3d:

; 2284 : 
; 2285 : 	terrain_3d_copied_points[vertex_count-1].next_vertex = NULL;

  001ec	8b 45 fc	 mov	 eax, DWORD PTR _vertex_count$[ebp]
  001ef	83 e8 01	 sub	 eax, 1
  001f2	c1 e0 06	 shl	 eax, 6
  001f5	c7 80 28 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?terrain_3d_copied_points@@3PAUVERTEX@@A[eax+40], 0

; 2286 : 
; 2287 : 	return ( terrain_3d_copied_points );

  001ff	b8 00 00 00 00	 mov	 eax, OFFSET ?terrain_3d_copied_points@@3PAUVERTEX@@A ; terrain_3d_copied_points

; 2288 : }

  00204	5f		 pop	 edi
  00205	5e		 pop	 esi
  00206	5b		 pop	 ebx
  00207	8b e5		 mov	 esp, ebp
  00209	5d		 pop	 ebp
  0020a	c2 04 00	 ret	 4
?terrain_3d_copy_and_recolour_polygon@@YGPAUVERTEX@@PAU1@@Z ENDP ; terrain_3d_copy_and_recolour_polygon
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_stripe_byte_fan@@YGXH@Z
_TEXT	SEGMENT
_this_colour$1 = -32					; size = 4
_y$2 = -28						; size = 4
_y_texture_scale$ = -24					; size = 4
_xz_texture_scale$ = -20				; size = 4
_destination_vertices$ = -16				; size = 4
_normal_index$ = -12					; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_stripe_byte_fan@@YGXH@Z PROC		; render_3d_terrain_stripe_byte_fan, COMDAT

; 2175 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 60	 sub	 esp, 96			; 00000060H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 2176 : 
; 2177 : 	int
; 2178 : 		count,
; 2179 : 		this_point,
; 2180 : 		normal_index;
; 2181 : 
; 2182 : 	LPD3DTLVERTEX
; 2183 : 		destination_vertices;
; 2184 : 
; 2185 : 	float
; 2186 : 		xz_texture_scale,
; 2187 : 		y_texture_scale;
; 2188 : 
; 2189 : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 ec	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 2190 : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 e8	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 2191 : 
; 2192 : 	destination_vertices = get_terrain_3d_buffered_vertices ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_terrain_3d_buffered_vertices@@YGPAU_D3DTLVERTEX@@H@Z ; get_terrain_3d_buffered_vertices
  00030	89 45 f0	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 2193 : 
; 2194 : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 2195 : 
; 2196 : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d 50 01 00
	00		 jge	 $LN3@render_3d_

; 2197 : 	{
; 2198 : 
; 2199 : 		float
; 2200 : 			y;
; 2201 : 
; 2202 : 		real_colour
; 2203 : 			this_colour;
; 2204 : 	
; 2205 : 		this_point = terrain_3d_sector_point_byte_references[count].point;

  00064	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_point_byte_references@@3PAUTERRAIN_3D_POINT_BYTE_REFERENCE@@A ; terrain_3d_sector_point_byte_references
  00069	03 45 fc	 add	 eax, DWORD PTR _count$[ebp]
  0006c	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  0006f	89 4d f8	 mov	 DWORD PTR _this_point$[ebp], ecx

; 2206 : 	
; 2207 : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  00072	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00075	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  0007d	89 4d f4	 mov	 DWORD PTR _normal_index$[ebp], ecx

; 2208 : 
; 2209 : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00080	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00085	8b 4d f8	 mov	 ecx, DWORD PTR _this_point$[ebp]
  00088	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  0008e	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00092	0f b7 c0	 movzx	 eax, ax
  00095	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  00099	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  000a1	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  000a9	f3 0f 11 45 e4	 movss	 DWORD PTR _y$2[ebp], xmm0

; 2210 : 
; 2211 : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].x ) * xz_texture_scale;

  000ae	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000b1	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000b7	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  000bb	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000bf	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000c4	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000c7	c1 e0 05	 shl	 eax, 5
  000ca	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000cd	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 2212 : 		destination_vertices[count].tv = y * y_texture_scale;

  000d3	f3 0f 10 45 e4	 movss	 xmm0, DWORD PTR _y$2[ebp]
  000d8	f3 0f 59 45 e8	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000dd	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000e0	c1 e0 05	 shl	 eax, 5
  000e3	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000e6	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 2213 : 
; 2214 : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000ec	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000ef	c1 e0 04	 shl	 eax, 4
  000f2	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000f5	c1 e1 05	 shl	 ecx, 5
  000f8	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000fb	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  00101	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 2215 : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  00104	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00107	c1 e0 04	 shl	 eax, 4
  0010a	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0010d	c1 e1 05	 shl	 ecx, 5
  00110	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00113	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  00119	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 2216 : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  0011d	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00120	c1 e0 04	 shl	 eax, 4
  00123	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0012b	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00133	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0013b	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  0013f	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00142	c1 e1 05	 shl	 ecx, 5
  00145	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00148	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 2217 : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  0014e	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00151	c1 e0 04	 shl	 eax, 4
  00154	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00157	c1 e1 05	 shl	 ecx, 5
  0015a	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0015d	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00163	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 2218 : 
; 2219 : 		this_colour.colour = transformed_3d_point_colours[this_point].colour;

  00167	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0016a	8b 0c c5 00 00
	00 00		 mov	 ecx, DWORD PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8]
  00171	89 4d e0	 mov	 DWORD PTR _this_colour$1[ebp], ecx

; 2220 : 		this_colour.red = 255;

  00174	c6 45 e2 ff	 mov	 BYTE PTR _this_colour$1[ebp+2], 255 ; 000000ffH

; 2221 : 		this_colour.green = 0;

  00178	c6 45 e1 00	 mov	 BYTE PTR _this_colour$1[ebp+1], 0

; 2222 : 		this_colour.blue = 0;

  0017c	c6 45 e0 00	 mov	 BYTE PTR _this_colour$1[ebp], 0

; 2223 : 		this_colour.alpha = 64;

  00180	c6 45 e3 40	 mov	 BYTE PTR _this_colour$1[ebp+3], 64 ; 00000040H

; 2224 : 
; 2225 : 		destination_vertices[count].color = this_colour.colour;

  00184	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00187	c1 e0 05	 shl	 eax, 5
  0018a	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  0018d	8b 55 e0	 mov	 edx, DWORD PTR _this_colour$1[ebp]
  00190	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 2226 : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00194	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00197	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  0019f	c1 e1 18	 shl	 ecx, 24			; 00000018H
  001a2	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  001a5	c1 e2 05	 shl	 edx, 5
  001a8	8b 45 f0	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  001ab	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 2227 : 	}

  001af	e9 9b fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 2228 : 
; 2229 : 	add_terrain_3d_buffered_triangle_fan ( num_points, current_terrain_type_class->texture );

  001b4	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001b9	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  001bc	51		 push	 ecx
  001bd	8b 55 08	 mov	 edx, DWORD PTR _num_points$[ebp]
  001c0	52		 push	 edx
  001c1	e8 00 00 00 00	 call	 ?add_terrain_3d_buffered_triangle_fan@@YGXHPAUSCREEN@@@Z ; add_terrain_3d_buffered_triangle_fan

; 2230 : }

  001c6	5f		 pop	 edi
  001c7	5e		 pop	 esi
  001c8	5b		 pop	 ebx
  001c9	8b e5		 mov	 esp, ebp
  001cb	5d		 pop	 ebp
  001cc	c2 04 00	 ret	 4
?render_3d_terrain_stripe_byte_fan@@YGXH@Z ENDP		; render_3d_terrain_stripe_byte_fan
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_stripe_word_fan@@YGXH@Z
_TEXT	SEGMENT
_this_colour$1 = -32					; size = 4
_y$2 = -28						; size = 4
_y_texture_scale$ = -24					; size = 4
_xz_texture_scale$ = -20				; size = 4
_destination_vertices$ = -16				; size = 4
_normal_index$ = -12					; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_stripe_word_fan@@YGXH@Z PROC		; render_3d_terrain_stripe_word_fan, COMDAT

; 2114 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 60	 sub	 esp, 96			; 00000060H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 2115 : 
; 2116 : 	int
; 2117 : 		count,
; 2118 : 		this_point,
; 2119 : 		normal_index;
; 2120 : 
; 2121 : 	LPD3DTLVERTEX
; 2122 : 		destination_vertices;
; 2123 : 
; 2124 : 	float
; 2125 : 		xz_texture_scale,
; 2126 : 		y_texture_scale;
; 2127 : 
; 2128 : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 ec	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 2129 : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 e8	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 2130 : 
; 2131 : 	destination_vertices = get_terrain_3d_buffered_vertices ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_terrain_3d_buffered_vertices@@YGPAU_D3DTLVERTEX@@H@Z ; get_terrain_3d_buffered_vertices
  00030	89 45 f0	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 2132 : 
; 2133 : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 2134 : 
; 2135 : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d 52 01 00
	00		 jge	 $LN3@render_3d_

; 2136 : 	{
; 2137 : 
; 2138 : 		float
; 2139 : 			y;
; 2140 : 
; 2141 : 		real_colour
; 2142 : 			this_colour;
; 2143 : 
; 2144 : 		this_point = terrain_3d_sector_point_word_references[count].point;

  00064	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00067	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_sector_point_word_references@@3PAUTERRAIN_3D_POINT_WORD_REFERENCE@@A ; terrain_3d_sector_point_word_references
  0006d	0f b7 14 41	 movzx	 edx, WORD PTR [ecx+eax*2]
  00071	89 55 f8	 mov	 DWORD PTR _this_point$[ebp], edx

; 2145 : 
; 2146 : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  00074	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00077	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  0007f	89 4d f4	 mov	 DWORD PTR _normal_index$[ebp], ecx

; 2147 : 	
; 2148 : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00082	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00087	8b 4d f8	 mov	 ecx, DWORD PTR _this_point$[ebp]
  0008a	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  00090	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00094	0f b7 c0	 movzx	 eax, ax
  00097	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0009b	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  000a3	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  000ab	f3 0f 11 45 e4	 movss	 DWORD PTR _y$2[ebp], xmm0

; 2149 : 
; 2150 : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].x ) * xz_texture_scale;

  000b0	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000b3	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000b9	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  000bd	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000c1	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000c6	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000c9	c1 e0 05	 shl	 eax, 5
  000cc	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000cf	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 2151 : 		destination_vertices[count].tv = y * y_texture_scale;

  000d5	f3 0f 10 45 e4	 movss	 xmm0, DWORD PTR _y$2[ebp]
  000da	f3 0f 59 45 e8	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000df	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000e2	c1 e0 05	 shl	 eax, 5
  000e5	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000e8	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 2152 : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000ee	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000f1	c1 e0 04	 shl	 eax, 4
  000f4	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000f7	c1 e1 05	 shl	 ecx, 5
  000fa	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000fd	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  00103	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 2153 : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  00106	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00109	c1 e0 04	 shl	 eax, 4
  0010c	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0010f	c1 e1 05	 shl	 ecx, 5
  00112	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00115	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0011b	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 2154 : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  0011f	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00122	c1 e0 04	 shl	 eax, 4
  00125	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0012d	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00135	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0013d	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00141	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00144	c1 e1 05	 shl	 ecx, 5
  00147	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0014a	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 2155 : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00150	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00153	c1 e0 04	 shl	 eax, 4
  00156	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00159	c1 e1 05	 shl	 ecx, 5
  0015c	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0015f	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00165	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 2156 : 
; 2157 : 		this_colour.colour = transformed_3d_point_colours[this_point].colour;

  00169	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0016c	8b 0c c5 00 00
	00 00		 mov	 ecx, DWORD PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8]
  00173	89 4d e0	 mov	 DWORD PTR _this_colour$1[ebp], ecx

; 2158 : 		this_colour.red = 255;

  00176	c6 45 e2 ff	 mov	 BYTE PTR _this_colour$1[ebp+2], 255 ; 000000ffH

; 2159 : 		this_colour.green = 0;

  0017a	c6 45 e1 00	 mov	 BYTE PTR _this_colour$1[ebp+1], 0

; 2160 : 		this_colour.blue = 0;

  0017e	c6 45 e0 00	 mov	 BYTE PTR _this_colour$1[ebp], 0

; 2161 : 		this_colour.alpha = 64;

  00182	c6 45 e3 40	 mov	 BYTE PTR _this_colour$1[ebp+3], 64 ; 00000040H

; 2162 : 
; 2163 : 		destination_vertices[count].color = this_colour.colour;

  00186	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00189	c1 e0 05	 shl	 eax, 5
  0018c	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  0018f	8b 55 e0	 mov	 edx, DWORD PTR _this_colour$1[ebp]
  00192	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 2164 : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00196	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00199	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  001a1	c1 e1 18	 shl	 ecx, 24			; 00000018H
  001a4	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  001a7	c1 e2 05	 shl	 edx, 5
  001aa	8b 45 f0	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  001ad	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 2165 : 	}

  001b1	e9 99 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 2166 : 
; 2167 : 	add_terrain_3d_buffered_triangle_fan ( num_points, current_terrain_type_class->texture );

  001b6	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001bb	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  001be	51		 push	 ecx
  001bf	8b 55 08	 mov	 edx, DWORD PTR _num_points$[ebp]
  001c2	52		 push	 edx
  001c3	e8 00 00 00 00	 call	 ?add_terrain_3d_buffered_triangle_fan@@YGXHPAUSCREEN@@@Z ; add_terrain_3d_buffered_triangle_fan

; 2168 : }

  001c8	5f		 pop	 edi
  001c9	5e		 pop	 esi
  001ca	5b		 pop	 ebx
  001cb	8b e5		 mov	 esp, ebp
  001cd	5d		 pop	 ebp
  001ce	c2 04 00	 ret	 4
?render_3d_terrain_stripe_word_fan@@YGXH@Z ENDP		; render_3d_terrain_stripe_word_fan
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_secondary_vertex_polygon@@YGXPAUVERTEX@@@Z
_TEXT	SEGMENT
_destination_vertices$ = -12				; size = 4
_alpha$ = -5						; size = 1
_count$ = -4						; size = 4
_polygon$ = 8						; size = 4
?render_3d_terrain_secondary_vertex_polygon@@YGXPAUVERTEX@@@Z PROC ; render_3d_terrain_secondary_vertex_polygon, COMDAT

; 2066 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 4c	 sub	 esp, 76			; 0000004cH
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 2067 : 
; 2068 : 	int
; 2069 : 		count;
; 2070 : 
; 2071 : 	unsigned char
; 2072 : 		alpha;
; 2073 : 
; 2074 : 	LPD3DTLVERTEX
; 2075 : 		destination_vertices;
; 2076 : 
; 2077 : 	destination_vertices = get_terrain_3d_buffered_vertices ( 64 );

  00009	6a 40		 push	 64			; 00000040H
  0000b	e8 00 00 00 00	 call	 ?get_terrain_3d_buffered_vertices@@YGPAU_D3DTLVERTEX@@H@Z ; get_terrain_3d_buffered_vertices
  00010	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 2078 : 
; 2079 : 	count = 0;

  00013	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0

; 2080 : 
; 2081 : 	alpha = 0;

  0001a	c6 45 fb 00	 mov	 BYTE PTR _alpha$[ebp], 0
$LN2@render_3d_:

; 2082 : 
; 2083 : 	while ( polygon )

  0001e	83 7d 08 00	 cmp	 DWORD PTR _polygon$[ebp], 0
  00022	0f 84 d4 00 00
	00		 je	 $LN3@render_3d_

; 2084 : 	{
; 2085 : 
; 2086 : 		destination_vertices[count].tu = polygon->u2;

  00028	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0002b	c1 e0 05	 shl	 eax, 5
  0002e	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00031	8b 55 08	 mov	 edx, DWORD PTR _polygon$[ebp]
  00034	8b 52 20	 mov	 edx, DWORD PTR [edx+32]
  00037	89 54 01 18	 mov	 DWORD PTR [ecx+eax+24], edx

; 2087 : 		destination_vertices[count].tv = polygon->v2;

  0003b	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0003e	c1 e0 05	 shl	 eax, 5
  00041	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00044	8b 55 08	 mov	 edx, DWORD PTR _polygon$[ebp]
  00047	8b 52 24	 mov	 edx, DWORD PTR [edx+36]
  0004a	89 54 01 1c	 mov	 DWORD PTR [ecx+eax+28], edx

; 2088 : 		destination_vertices[count].sx = polygon->i;

  0004e	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00051	c1 e0 05	 shl	 eax, 5
  00054	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00057	8b 55 08	 mov	 edx, DWORD PTR _polygon$[ebp]
  0005a	8b 52 10	 mov	 edx, DWORD PTR [edx+16]
  0005d	89 14 01	 mov	 DWORD PTR [ecx+eax], edx

; 2089 : 		destination_vertices[count].sy = polygon->j;

  00060	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00063	c1 e0 05	 shl	 eax, 5
  00066	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00069	8b 55 08	 mov	 edx, DWORD PTR _polygon$[ebp]
  0006c	8b 52 14	 mov	 edx, DWORD PTR [edx+20]
  0006f	89 54 01 04	 mov	 DWORD PTR [ecx+eax+4], edx

; 2090 : 		destination_vertices[count].sz = ( polygon->q * zbuffer_factor ) + zbuffer_constant;

  00073	8b 45 08	 mov	 eax, DWORD PTR _polygon$[ebp]
  00076	f3 0f 5a 40 0c	 cvtss2sd xmm0, DWORD PTR [eax+12]
  0007b	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00083	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0008b	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  0008f	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00092	c1 e1 05	 shl	 ecx, 5
  00095	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00098	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 2091 : 		destination_vertices[count].rhw = polygon->q;

  0009e	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000a1	c1 e0 05	 shl	 eax, 5
  000a4	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000a7	8b 55 08	 mov	 edx, DWORD PTR _polygon$[ebp]
  000aa	8b 52 0c	 mov	 edx, DWORD PTR [edx+12]
  000ad	89 54 01 0c	 mov	 DWORD PTR [ecx+eax+12], edx

; 2092 : 		destination_vertices[count].color = polygon->colour2;

  000b1	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000b4	c1 e0 05	 shl	 eax, 5
  000b7	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000ba	8b 55 08	 mov	 edx, DWORD PTR _polygon$[ebp]
  000bd	8b 52 34	 mov	 edx, DWORD PTR [edx+52]
  000c0	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 2093 : 		destination_vertices[count].specular = 0;

  000c4	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000c7	c1 e0 05	 shl	 eax, 5
  000ca	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000cd	c7 44 01 14 00
	00 00 00	 mov	 DWORD PTR [ecx+eax+20], 0

; 2094 : 
; 2095 : 		alpha |= polygon->alpha2;

  000d5	8b 45 08	 mov	 eax, DWORD PTR _polygon$[ebp]
  000d8	0f b6 48 37	 movzx	 ecx, BYTE PTR [eax+55]
  000dc	0f b6 55 fb	 movzx	 edx, BYTE PTR _alpha$[ebp]
  000e0	0b d1		 or	 edx, ecx
  000e2	88 55 fb	 mov	 BYTE PTR _alpha$[ebp], dl

; 2096 : 
; 2097 : 		polygon = polygon->next_vertex;

  000e5	8b 45 08	 mov	 eax, DWORD PTR _polygon$[ebp]
  000e8	8b 48 28	 mov	 ecx, DWORD PTR [eax+40]
  000eb	89 4d 08	 mov	 DWORD PTR _polygon$[ebp], ecx

; 2098 : 
; 2099 : 		count++;

  000ee	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000f1	83 c0 01	 add	 eax, 1
  000f4	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax

; 2100 : 	}

  000f7	e9 22 ff ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 2101 : 
; 2102 : 	if ( alpha )

  000fc	0f b6 45 fb	 movzx	 eax, BYTE PTR _alpha$[ebp]
  00100	85 c0		 test	 eax, eax
  00102	74 12		 je	 SHORT $LN4@render_3d_

; 2103 : 	{
; 2104 : 	
; 2105 : 		add_terrain_3d_buffered_triangle_fan ( count, current_terrain_type_class->texture2 );

  00104	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  00109	8b 48 08	 mov	 ecx, DWORD PTR [eax+8]
  0010c	51		 push	 ecx
  0010d	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  00110	52		 push	 edx
  00111	e8 00 00 00 00	 call	 ?add_terrain_3d_buffered_triangle_fan@@YGXHPAUSCREEN@@@Z ; add_terrain_3d_buffered_triangle_fan
$LN4@render_3d_:

; 2106 : 	}
; 2107 : }

  00116	5f		 pop	 edi
  00117	5e		 pop	 esi
  00118	5b		 pop	 ebx
  00119	8b e5		 mov	 esp, ebp
  0011b	5d		 pop	 ebp
  0011c	c2 04 00	 ret	 4
?render_3d_terrain_secondary_vertex_polygon@@YGXPAUVERTEX@@@Z ENDP ; render_3d_terrain_secondary_vertex_polygon
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_secondary_texture_zy_byte_strip@@YGXH@Z
_TEXT	SEGMENT
_this_colour$1 = -32					; size = 4
_y$2 = -28						; size = 4
_y_texture_scale$ = -24					; size = 4
_xz_texture_scale$ = -20				; size = 4
_destination_vertices$ = -16				; size = 4
_this_point$ = -12					; size = 4
_normal_index$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_secondary_texture_zy_byte_strip@@YGXH@Z PROC ; render_3d_terrain_secondary_texture_zy_byte_strip, COMDAT

; 2006 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 60	 sub	 esp, 96			; 00000060H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 2007 : 
; 2008 : 	int
; 2009 : 		count,
; 2010 : 		normal_index,
; 2011 : 		this_point;
; 2012 : 
; 2013 : 	LPD3DTLVERTEX
; 2014 : 		destination_vertices;
; 2015 : 
; 2016 : 	float
; 2017 : 		xz_texture_scale,
; 2018 : 		y_texture_scale;
; 2019 : 
; 2020 : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 ec	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 2021 : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 e8	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 2022 : 
; 2023 : 	destination_vertices = get_terrain_3d_buffered_vertices ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_terrain_3d_buffered_vertices@@YGPAU_D3DTLVERTEX@@H@Z ; get_terrain_3d_buffered_vertices
  00030	89 45 f0	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 2024 : 
; 2025 : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 2026 : 
; 2027 : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d 64 01 00
	00		 jge	 $LN3@render_3d_

; 2028 : 	{
; 2029 : 
; 2030 : 		float
; 2031 : 			y;
; 2032 : 	
; 2033 : 		real_colour
; 2034 : 			this_colour;
; 2035 : 	
; 2036 : 		this_point = terrain_3d_sector_point_byte_references[count].point;

  00064	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_point_byte_references@@3PAUTERRAIN_3D_POINT_BYTE_REFERENCE@@A ; terrain_3d_sector_point_byte_references
  00069	03 45 fc	 add	 eax, DWORD PTR _count$[ebp]
  0006c	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  0006f	89 4d f4	 mov	 DWORD PTR _this_point$[ebp], ecx

; 2037 : 	
; 2038 : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  00072	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00075	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  0007d	89 4d f8	 mov	 DWORD PTR _normal_index$[ebp], ecx

; 2039 : 	
; 2040 : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00080	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00085	8b 4d f4	 mov	 ecx, DWORD PTR _this_point$[ebp]
  00088	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  0008e	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00092	0f b7 c0	 movzx	 eax, ax
  00095	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  00099	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  000a1	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  000a9	f3 0f 11 45 e4	 movss	 DWORD PTR _y$2[ebp], xmm0

; 2041 : 
; 2042 : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].z ) * xz_texture_scale;

  000ae	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  000b1	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000b7	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  000bc	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000c0	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000c5	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000c8	c1 e0 05	 shl	 eax, 5
  000cb	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000ce	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 2043 : 		destination_vertices[count].tv = y * y_texture_scale;

  000d4	f3 0f 10 45 e4	 movss	 xmm0, DWORD PTR _y$2[ebp]
  000d9	f3 0f 59 45 e8	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000de	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000e1	c1 e0 05	 shl	 eax, 5
  000e4	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000e7	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 2044 : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000ed	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  000f0	c1 e0 04	 shl	 eax, 4
  000f3	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000f6	c1 e1 05	 shl	 ecx, 5
  000f9	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000fc	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  00102	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 2045 : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  00105	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00108	c1 e0 04	 shl	 eax, 4
  0010b	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0010e	c1 e1 05	 shl	 ecx, 5
  00111	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00114	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0011a	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 2046 : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  0011e	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00121	c1 e0 04	 shl	 eax, 4
  00124	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0012c	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00134	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0013c	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00140	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00143	c1 e1 05	 shl	 ecx, 5
  00146	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00149	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 2047 : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  0014f	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00152	c1 e0 04	 shl	 eax, 4
  00155	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00158	c1 e1 05	 shl	 ecx, 5
  0015b	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0015e	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00164	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 2048 : 
; 2049 : 		this_colour.red = terrain_3d_transformed_point_normals[normal_index].colour.red;

  00168	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0016b	c1 e0 04	 shl	 eax, 4
  0016e	8a 88 0e 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+14]
  00174	88 4d e2	 mov	 BYTE PTR _this_colour$1[ebp+2], cl

; 2050 : 		this_colour.green = terrain_3d_transformed_point_normals[normal_index].colour.green;

  00177	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0017a	c1 e0 04	 shl	 eax, 4
  0017d	8a 88 0d 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+13]
  00183	88 4d e1	 mov	 BYTE PTR _this_colour$1[ebp+1], cl

; 2051 : 		this_colour.blue = terrain_3d_transformed_point_normals[normal_index].colour.blue;

  00186	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  00189	c1 e0 04	 shl	 eax, 4
  0018c	8a 88 0c 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+12]
  00192	88 4d e0	 mov	 BYTE PTR _this_colour$1[ebp], cl

; 2052 : 		this_colour.alpha = transformed_3d_point_colours[this_point].alpha;

  00195	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00198	8a 0c c5 03 00
	00 00		 mov	 cl, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+3]
  0019f	88 4d e3	 mov	 BYTE PTR _this_colour$1[ebp+3], cl

; 2053 : 
; 2054 : 		destination_vertices[count].color = this_colour.colour;

  001a2	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  001a5	c1 e0 05	 shl	 eax, 5
  001a8	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  001ab	8b 55 e0	 mov	 edx, DWORD PTR _this_colour$1[ebp]
  001ae	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 2055 : 		destination_vertices[count].specular = 0;

  001b2	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  001b5	c1 e0 05	 shl	 eax, 5
  001b8	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  001bb	c7 44 01 14 00
	00 00 00	 mov	 DWORD PTR [ecx+eax+20], 0

; 2056 : 	}

  001c3	e9 87 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 2057 : 
; 2058 : 	add_terrain_3d_buffered_triangle_strip ( num_points, current_terrain_type_class->texture2 );

  001c8	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001cd	8b 48 08	 mov	 ecx, DWORD PTR [eax+8]
  001d0	51		 push	 ecx
  001d1	8b 55 08	 mov	 edx, DWORD PTR _num_points$[ebp]
  001d4	52		 push	 edx
  001d5	e8 00 00 00 00	 call	 ?add_terrain_3d_buffered_triangle_strip@@YGXHPAUSCREEN@@@Z ; add_terrain_3d_buffered_triangle_strip

; 2059 : }

  001da	5f		 pop	 edi
  001db	5e		 pop	 esi
  001dc	5b		 pop	 ebx
  001dd	8b e5		 mov	 esp, ebp
  001df	5d		 pop	 ebp
  001e0	c2 04 00	 ret	 4
?render_3d_terrain_secondary_texture_zy_byte_strip@@YGXH@Z ENDP ; render_3d_terrain_secondary_texture_zy_byte_strip
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_secondary_texture_zy_word_strip@@YGXH@Z
_TEXT	SEGMENT
_this_colour$1 = -32					; size = 4
_y$2 = -28						; size = 4
_y_texture_scale$ = -24					; size = 4
_xz_texture_scale$ = -20				; size = 4
_destination_vertices$ = -16				; size = 4
_this_point$ = -12					; size = 4
_normal_index$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_secondary_texture_zy_word_strip@@YGXH@Z PROC ; render_3d_terrain_secondary_texture_zy_word_strip, COMDAT

; 1946 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 60	 sub	 esp, 96			; 00000060H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 1947 : 
; 1948 : 	int
; 1949 : 		count,
; 1950 : 		normal_index,
; 1951 : 		this_point;
; 1952 : 
; 1953 : 	LPD3DTLVERTEX
; 1954 : 		destination_vertices;
; 1955 : 
; 1956 : 	float
; 1957 : 		xz_texture_scale,
; 1958 : 		y_texture_scale;
; 1959 : 
; 1960 : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 ec	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 1961 : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 e8	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 1962 : 
; 1963 : 	destination_vertices = get_terrain_3d_buffered_vertices ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_terrain_3d_buffered_vertices@@YGPAU_D3DTLVERTEX@@H@Z ; get_terrain_3d_buffered_vertices
  00030	89 45 f0	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 1964 : 
; 1965 : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 1966 : 
; 1967 : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d 66 01 00
	00		 jge	 $LN3@render_3d_

; 1968 : 	{
; 1969 : 
; 1970 : 		float
; 1971 : 			y;
; 1972 : 	
; 1973 : 		real_colour
; 1974 : 			this_colour;
; 1975 : 	
; 1976 : 		this_point = terrain_3d_sector_point_word_references[count].point;

  00064	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00067	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_sector_point_word_references@@3PAUTERRAIN_3D_POINT_WORD_REFERENCE@@A ; terrain_3d_sector_point_word_references
  0006d	0f b7 14 41	 movzx	 edx, WORD PTR [ecx+eax*2]
  00071	89 55 f4	 mov	 DWORD PTR _this_point$[ebp], edx

; 1977 : 	
; 1978 : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  00074	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00077	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  0007f	89 4d f8	 mov	 DWORD PTR _normal_index$[ebp], ecx

; 1979 : 	
; 1980 : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00082	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00087	8b 4d f4	 mov	 ecx, DWORD PTR _this_point$[ebp]
  0008a	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  00090	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00094	0f b7 c0	 movzx	 eax, ax
  00097	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0009b	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  000a3	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  000ab	f3 0f 11 45 e4	 movss	 DWORD PTR _y$2[ebp], xmm0

; 1981 : 
; 1982 : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].z ) * xz_texture_scale;

  000b0	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  000b3	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000b9	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  000be	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000c2	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000c7	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000ca	c1 e0 05	 shl	 eax, 5
  000cd	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000d0	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 1983 : 		destination_vertices[count].tv = y * y_texture_scale;

  000d6	f3 0f 10 45 e4	 movss	 xmm0, DWORD PTR _y$2[ebp]
  000db	f3 0f 59 45 e8	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000e0	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000e3	c1 e0 05	 shl	 eax, 5
  000e6	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000e9	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 1984 : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000ef	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  000f2	c1 e0 04	 shl	 eax, 4
  000f5	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000f8	c1 e1 05	 shl	 ecx, 5
  000fb	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000fe	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  00104	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 1985 : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  00107	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  0010a	c1 e0 04	 shl	 eax, 4
  0010d	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00110	c1 e1 05	 shl	 ecx, 5
  00113	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00116	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0011c	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 1986 : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  00120	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00123	c1 e0 04	 shl	 eax, 4
  00126	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0012e	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00136	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0013e	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00142	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00145	c1 e1 05	 shl	 ecx, 5
  00148	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0014b	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 1987 : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00151	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00154	c1 e0 04	 shl	 eax, 4
  00157	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0015a	c1 e1 05	 shl	 ecx, 5
  0015d	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00160	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00166	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 1988 : 
; 1989 : 		this_colour.red = terrain_3d_transformed_point_normals[normal_index].colour.red;

  0016a	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0016d	c1 e0 04	 shl	 eax, 4
  00170	8a 88 0e 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+14]
  00176	88 4d e2	 mov	 BYTE PTR _this_colour$1[ebp+2], cl

; 1990 : 		this_colour.green = terrain_3d_transformed_point_normals[normal_index].colour.green;

  00179	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0017c	c1 e0 04	 shl	 eax, 4
  0017f	8a 88 0d 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+13]
  00185	88 4d e1	 mov	 BYTE PTR _this_colour$1[ebp+1], cl

; 1991 : 		this_colour.blue = terrain_3d_transformed_point_normals[normal_index].colour.blue;

  00188	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0018b	c1 e0 04	 shl	 eax, 4
  0018e	8a 88 0c 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+12]
  00194	88 4d e0	 mov	 BYTE PTR _this_colour$1[ebp], cl

; 1992 : 		this_colour.alpha = transformed_3d_point_colours[this_point].alpha;

  00197	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  0019a	8a 0c c5 03 00
	00 00		 mov	 cl, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+3]
  001a1	88 4d e3	 mov	 BYTE PTR _this_colour$1[ebp+3], cl

; 1993 : 
; 1994 : 		destination_vertices[count].color = this_colour.colour;

  001a4	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  001a7	c1 e0 05	 shl	 eax, 5
  001aa	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  001ad	8b 55 e0	 mov	 edx, DWORD PTR _this_colour$1[ebp]
  001b0	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 1995 : 		destination_vertices[count].specular = 0;

  001b4	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  001b7	c1 e0 05	 shl	 eax, 5
  001ba	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  001bd	c7 44 01 14 00
	00 00 00	 mov	 DWORD PTR [ecx+eax+20], 0

; 1996 : 	}

  001c5	e9 85 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 1997 : 
; 1998 : 	add_terrain_3d_buffered_triangle_strip ( num_points, current_terrain_type_class->texture2 );

  001ca	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001cf	8b 48 08	 mov	 ecx, DWORD PTR [eax+8]
  001d2	51		 push	 ecx
  001d3	8b 55 08	 mov	 edx, DWORD PTR _num_points$[ebp]
  001d6	52		 push	 edx
  001d7	e8 00 00 00 00	 call	 ?add_terrain_3d_buffered_triangle_strip@@YGXHPAUSCREEN@@@Z ; add_terrain_3d_buffered_triangle_strip

; 1999 : }

  001dc	5f		 pop	 edi
  001dd	5e		 pop	 esi
  001de	5b		 pop	 ebx
  001df	8b e5		 mov	 esp, ebp
  001e1	5d		 pop	 ebp
  001e2	c2 04 00	 ret	 4
?render_3d_terrain_secondary_texture_zy_word_strip@@YGXH@Z ENDP ; render_3d_terrain_secondary_texture_zy_word_strip
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_secondary_texture_xy_byte_strip@@YGXH@Z
_TEXT	SEGMENT
_this_colour$1 = -32					; size = 4
_y$2 = -28						; size = 4
_y_texture_scale$ = -24					; size = 4
_xz_texture_scale$ = -20				; size = 4
_destination_vertices$ = -16				; size = 4
_this_point$ = -12					; size = 4
_normal_index$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_secondary_texture_xy_byte_strip@@YGXH@Z PROC ; render_3d_terrain_secondary_texture_xy_byte_strip, COMDAT

; 1886 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 60	 sub	 esp, 96			; 00000060H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 1887 : 
; 1888 : 	int
; 1889 : 		count,
; 1890 : 		normal_index,
; 1891 : 		this_point;
; 1892 : 
; 1893 : 	LPD3DTLVERTEX
; 1894 : 		destination_vertices;
; 1895 : 
; 1896 : 	float
; 1897 : 		xz_texture_scale,
; 1898 : 		y_texture_scale;
; 1899 : 
; 1900 : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 ec	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 1901 : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 e8	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 1902 : 
; 1903 : 	destination_vertices = get_terrain_3d_buffered_vertices ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_terrain_3d_buffered_vertices@@YGPAU_D3DTLVERTEX@@H@Z ; get_terrain_3d_buffered_vertices
  00030	89 45 f0	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 1904 : 
; 1905 : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 1906 : 
; 1907 : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d 63 01 00
	00		 jge	 $LN3@render_3d_

; 1908 : 	{
; 1909 : 
; 1910 : 		float
; 1911 : 			y;
; 1912 : 	
; 1913 : 		real_colour
; 1914 : 			this_colour;
; 1915 : 	
; 1916 : 		this_point = terrain_3d_sector_point_byte_references[count].point;

  00064	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_point_byte_references@@3PAUTERRAIN_3D_POINT_BYTE_REFERENCE@@A ; terrain_3d_sector_point_byte_references
  00069	03 45 fc	 add	 eax, DWORD PTR _count$[ebp]
  0006c	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  0006f	89 4d f4	 mov	 DWORD PTR _this_point$[ebp], ecx

; 1917 : 	
; 1918 : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  00072	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00075	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  0007d	89 4d f8	 mov	 DWORD PTR _normal_index$[ebp], ecx

; 1919 : 	
; 1920 : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00080	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00085	8b 4d f4	 mov	 ecx, DWORD PTR _this_point$[ebp]
  00088	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  0008e	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00092	0f b7 c0	 movzx	 eax, ax
  00095	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  00099	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  000a1	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  000a9	f3 0f 11 45 e4	 movss	 DWORD PTR _y$2[ebp], xmm0

; 1921 : 
; 1922 : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].x ) * xz_texture_scale;

  000ae	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  000b1	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000b7	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  000bb	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000bf	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000c4	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000c7	c1 e0 05	 shl	 eax, 5
  000ca	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000cd	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 1923 : 		destination_vertices[count].tv = y * y_texture_scale;

  000d3	f3 0f 10 45 e4	 movss	 xmm0, DWORD PTR _y$2[ebp]
  000d8	f3 0f 59 45 e8	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000dd	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000e0	c1 e0 05	 shl	 eax, 5
  000e3	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000e6	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 1924 : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000ec	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  000ef	c1 e0 04	 shl	 eax, 4
  000f2	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000f5	c1 e1 05	 shl	 ecx, 5
  000f8	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000fb	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  00101	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 1925 : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  00104	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00107	c1 e0 04	 shl	 eax, 4
  0010a	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0010d	c1 e1 05	 shl	 ecx, 5
  00110	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00113	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  00119	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 1926 : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  0011d	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00120	c1 e0 04	 shl	 eax, 4
  00123	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0012b	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00133	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0013b	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  0013f	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00142	c1 e1 05	 shl	 ecx, 5
  00145	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00148	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 1927 : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  0014e	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00151	c1 e0 04	 shl	 eax, 4
  00154	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00157	c1 e1 05	 shl	 ecx, 5
  0015a	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0015d	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00163	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 1928 : 
; 1929 : 		this_colour.red = terrain_3d_transformed_point_normals[normal_index].colour.red;

  00167	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0016a	c1 e0 04	 shl	 eax, 4
  0016d	8a 88 0e 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+14]
  00173	88 4d e2	 mov	 BYTE PTR _this_colour$1[ebp+2], cl

; 1930 : 		this_colour.green = terrain_3d_transformed_point_normals[normal_index].colour.green;

  00176	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  00179	c1 e0 04	 shl	 eax, 4
  0017c	8a 88 0d 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+13]
  00182	88 4d e1	 mov	 BYTE PTR _this_colour$1[ebp+1], cl

; 1931 : 		this_colour.blue = terrain_3d_transformed_point_normals[normal_index].colour.blue;

  00185	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  00188	c1 e0 04	 shl	 eax, 4
  0018b	8a 88 0c 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+12]
  00191	88 4d e0	 mov	 BYTE PTR _this_colour$1[ebp], cl

; 1932 : 		this_colour.alpha = transformed_3d_point_colours[this_point].alpha;

  00194	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00197	8a 0c c5 03 00
	00 00		 mov	 cl, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+3]
  0019e	88 4d e3	 mov	 BYTE PTR _this_colour$1[ebp+3], cl

; 1933 : 
; 1934 : 		destination_vertices[count].color = this_colour.colour;

  001a1	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  001a4	c1 e0 05	 shl	 eax, 5
  001a7	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  001aa	8b 55 e0	 mov	 edx, DWORD PTR _this_colour$1[ebp]
  001ad	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 1935 : 		destination_vertices[count].specular = 0;

  001b1	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  001b4	c1 e0 05	 shl	 eax, 5
  001b7	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  001ba	c7 44 01 14 00
	00 00 00	 mov	 DWORD PTR [ecx+eax+20], 0

; 1936 : 	}

  001c2	e9 88 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 1937 : 
; 1938 : 	add_terrain_3d_buffered_triangle_strip ( num_points, current_terrain_type_class->texture2 );

  001c7	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001cc	8b 48 08	 mov	 ecx, DWORD PTR [eax+8]
  001cf	51		 push	 ecx
  001d0	8b 55 08	 mov	 edx, DWORD PTR _num_points$[ebp]
  001d3	52		 push	 edx
  001d4	e8 00 00 00 00	 call	 ?add_terrain_3d_buffered_triangle_strip@@YGXHPAUSCREEN@@@Z ; add_terrain_3d_buffered_triangle_strip

; 1939 : }

  001d9	5f		 pop	 edi
  001da	5e		 pop	 esi
  001db	5b		 pop	 ebx
  001dc	8b e5		 mov	 esp, ebp
  001de	5d		 pop	 ebp
  001df	c2 04 00	 ret	 4
?render_3d_terrain_secondary_texture_xy_byte_strip@@YGXH@Z ENDP ; render_3d_terrain_secondary_texture_xy_byte_strip
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_secondary_texture_xy_word_strip@@YGXH@Z
_TEXT	SEGMENT
_this_colour$1 = -32					; size = 4
_y$2 = -28						; size = 4
_y_texture_scale$ = -24					; size = 4
_xz_texture_scale$ = -20				; size = 4
_destination_vertices$ = -16				; size = 4
_this_point$ = -12					; size = 4
_normal_index$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_secondary_texture_xy_word_strip@@YGXH@Z PROC ; render_3d_terrain_secondary_texture_xy_word_strip, COMDAT

; 1826 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 60	 sub	 esp, 96			; 00000060H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 1827 : 
; 1828 : 	int
; 1829 : 		count,
; 1830 : 		normal_index,
; 1831 : 		this_point;
; 1832 : 
; 1833 : 	LPD3DTLVERTEX
; 1834 : 		destination_vertices;
; 1835 : 
; 1836 : 	float
; 1837 : 		xz_texture_scale,
; 1838 : 		y_texture_scale;
; 1839 : 
; 1840 : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 ec	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 1841 : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 e8	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 1842 : 
; 1843 : 	destination_vertices = get_terrain_3d_buffered_vertices ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_terrain_3d_buffered_vertices@@YGPAU_D3DTLVERTEX@@H@Z ; get_terrain_3d_buffered_vertices
  00030	89 45 f0	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 1844 : 
; 1845 : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 1846 : 
; 1847 : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d 65 01 00
	00		 jge	 $LN3@render_3d_

; 1848 : 	{
; 1849 : 
; 1850 : 		float
; 1851 : 			y;
; 1852 : 	
; 1853 : 		real_colour
; 1854 : 			this_colour;
; 1855 : 	
; 1856 : 		this_point = terrain_3d_sector_point_word_references[count].point;

  00064	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00067	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_sector_point_word_references@@3PAUTERRAIN_3D_POINT_WORD_REFERENCE@@A ; terrain_3d_sector_point_word_references
  0006d	0f b7 14 41	 movzx	 edx, WORD PTR [ecx+eax*2]
  00071	89 55 f4	 mov	 DWORD PTR _this_point$[ebp], edx

; 1857 : 	
; 1858 : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  00074	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00077	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  0007f	89 4d f8	 mov	 DWORD PTR _normal_index$[ebp], ecx

; 1859 : 	
; 1860 : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00082	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00087	8b 4d f4	 mov	 ecx, DWORD PTR _this_point$[ebp]
  0008a	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  00090	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00094	0f b7 c0	 movzx	 eax, ax
  00097	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0009b	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  000a3	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  000ab	f3 0f 11 45 e4	 movss	 DWORD PTR _y$2[ebp], xmm0

; 1861 : 
; 1862 : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].x ) * xz_texture_scale;

  000b0	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  000b3	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000b9	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  000bd	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000c1	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000c6	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000c9	c1 e0 05	 shl	 eax, 5
  000cc	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000cf	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 1863 : 		destination_vertices[count].tv = y * y_texture_scale;

  000d5	f3 0f 10 45 e4	 movss	 xmm0, DWORD PTR _y$2[ebp]
  000da	f3 0f 59 45 e8	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000df	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000e2	c1 e0 05	 shl	 eax, 5
  000e5	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000e8	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 1864 : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000ee	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  000f1	c1 e0 04	 shl	 eax, 4
  000f4	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000f7	c1 e1 05	 shl	 ecx, 5
  000fa	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000fd	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  00103	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 1865 : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  00106	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00109	c1 e0 04	 shl	 eax, 4
  0010c	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0010f	c1 e1 05	 shl	 ecx, 5
  00112	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00115	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0011b	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 1866 : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  0011f	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00122	c1 e0 04	 shl	 eax, 4
  00125	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0012d	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00135	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0013d	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00141	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00144	c1 e1 05	 shl	 ecx, 5
  00147	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0014a	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 1867 : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00150	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00153	c1 e0 04	 shl	 eax, 4
  00156	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00159	c1 e1 05	 shl	 ecx, 5
  0015c	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0015f	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00165	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 1868 : 
; 1869 : 		this_colour.red = terrain_3d_transformed_point_normals[normal_index].colour.red;

  00169	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0016c	c1 e0 04	 shl	 eax, 4
  0016f	8a 88 0e 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+14]
  00175	88 4d e2	 mov	 BYTE PTR _this_colour$1[ebp+2], cl

; 1870 : 		this_colour.green = terrain_3d_transformed_point_normals[normal_index].colour.green;

  00178	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0017b	c1 e0 04	 shl	 eax, 4
  0017e	8a 88 0d 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+13]
  00184	88 4d e1	 mov	 BYTE PTR _this_colour$1[ebp+1], cl

; 1871 : 		this_colour.blue = terrain_3d_transformed_point_normals[normal_index].colour.blue;

  00187	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0018a	c1 e0 04	 shl	 eax, 4
  0018d	8a 88 0c 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+12]
  00193	88 4d e0	 mov	 BYTE PTR _this_colour$1[ebp], cl

; 1872 : 		this_colour.alpha = transformed_3d_point_colours[this_point].alpha;

  00196	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00199	8a 0c c5 03 00
	00 00		 mov	 cl, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+3]
  001a0	88 4d e3	 mov	 BYTE PTR _this_colour$1[ebp+3], cl

; 1873 : 
; 1874 : 		destination_vertices[count].color = this_colour.colour;

  001a3	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  001a6	c1 e0 05	 shl	 eax, 5
  001a9	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  001ac	8b 55 e0	 mov	 edx, DWORD PTR _this_colour$1[ebp]
  001af	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 1875 : 		destination_vertices[count].specular = 0;

  001b3	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  001b6	c1 e0 05	 shl	 eax, 5
  001b9	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  001bc	c7 44 01 14 00
	00 00 00	 mov	 DWORD PTR [ecx+eax+20], 0

; 1876 : 	}

  001c4	e9 86 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 1877 : 
; 1878 : 	add_terrain_3d_buffered_triangle_strip ( num_points, current_terrain_type_class->texture2 );

  001c9	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001ce	8b 48 08	 mov	 ecx, DWORD PTR [eax+8]
  001d1	51		 push	 ecx
  001d2	8b 55 08	 mov	 edx, DWORD PTR _num_points$[ebp]
  001d5	52		 push	 edx
  001d6	e8 00 00 00 00	 call	 ?add_terrain_3d_buffered_triangle_strip@@YGXHPAUSCREEN@@@Z ; add_terrain_3d_buffered_triangle_strip

; 1879 : }

  001db	5f		 pop	 edi
  001dc	5e		 pop	 esi
  001dd	5b		 pop	 ebx
  001de	8b e5		 mov	 esp, ebp
  001e0	5d		 pop	 ebp
  001e1	c2 04 00	 ret	 4
?render_3d_terrain_secondary_texture_xy_word_strip@@YGXH@Z ENDP ; render_3d_terrain_secondary_texture_xy_word_strip
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_secondary_texture_zy_byte_fan@@YGXH@Z
_TEXT	SEGMENT
_this_colour$1 = -32					; size = 4
_y$2 = -28						; size = 4
_y_texture_scale$ = -24					; size = 4
_xz_texture_scale$ = -20				; size = 4
_destination_vertices$ = -16				; size = 4
_this_point$ = -12					; size = 4
_normal_index$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_secondary_texture_zy_byte_fan@@YGXH@Z PROC ; render_3d_terrain_secondary_texture_zy_byte_fan, COMDAT

; 1766 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 60	 sub	 esp, 96			; 00000060H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 1767 : 
; 1768 : 	int
; 1769 : 		count,
; 1770 : 		normal_index,
; 1771 : 		this_point;
; 1772 : 
; 1773 : 	LPD3DTLVERTEX
; 1774 : 		destination_vertices;
; 1775 : 
; 1776 : 	float
; 1777 : 		xz_texture_scale,
; 1778 : 		y_texture_scale;
; 1779 : 
; 1780 : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 ec	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 1781 : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 e8	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 1782 : 
; 1783 : 	destination_vertices = get_terrain_3d_buffered_vertices ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_terrain_3d_buffered_vertices@@YGPAU_D3DTLVERTEX@@H@Z ; get_terrain_3d_buffered_vertices
  00030	89 45 f0	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 1784 : 
; 1785 : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 1786 : 
; 1787 : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d 64 01 00
	00		 jge	 $LN3@render_3d_

; 1788 : 	{
; 1789 : 
; 1790 : 		float
; 1791 : 			y;
; 1792 : 	
; 1793 : 		real_colour
; 1794 : 			this_colour;
; 1795 : 	
; 1796 : 		this_point = terrain_3d_sector_point_byte_references[count].point;

  00064	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_point_byte_references@@3PAUTERRAIN_3D_POINT_BYTE_REFERENCE@@A ; terrain_3d_sector_point_byte_references
  00069	03 45 fc	 add	 eax, DWORD PTR _count$[ebp]
  0006c	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  0006f	89 4d f4	 mov	 DWORD PTR _this_point$[ebp], ecx

; 1797 : 	
; 1798 : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  00072	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00075	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  0007d	89 4d f8	 mov	 DWORD PTR _normal_index$[ebp], ecx

; 1799 : 	
; 1800 : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00080	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00085	8b 4d f4	 mov	 ecx, DWORD PTR _this_point$[ebp]
  00088	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  0008e	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00092	0f b7 c0	 movzx	 eax, ax
  00095	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  00099	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  000a1	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  000a9	f3 0f 11 45 e4	 movss	 DWORD PTR _y$2[ebp], xmm0

; 1801 : 
; 1802 : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].z ) * xz_texture_scale;

  000ae	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  000b1	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000b7	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  000bc	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000c0	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000c5	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000c8	c1 e0 05	 shl	 eax, 5
  000cb	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000ce	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 1803 : 		destination_vertices[count].tv = y * y_texture_scale;

  000d4	f3 0f 10 45 e4	 movss	 xmm0, DWORD PTR _y$2[ebp]
  000d9	f3 0f 59 45 e8	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000de	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000e1	c1 e0 05	 shl	 eax, 5
  000e4	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000e7	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 1804 : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000ed	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  000f0	c1 e0 04	 shl	 eax, 4
  000f3	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000f6	c1 e1 05	 shl	 ecx, 5
  000f9	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000fc	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  00102	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 1805 : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  00105	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00108	c1 e0 04	 shl	 eax, 4
  0010b	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0010e	c1 e1 05	 shl	 ecx, 5
  00111	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00114	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0011a	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 1806 : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  0011e	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00121	c1 e0 04	 shl	 eax, 4
  00124	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0012c	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00134	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0013c	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00140	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00143	c1 e1 05	 shl	 ecx, 5
  00146	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00149	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 1807 : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  0014f	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00152	c1 e0 04	 shl	 eax, 4
  00155	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00158	c1 e1 05	 shl	 ecx, 5
  0015b	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0015e	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00164	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 1808 : 
; 1809 : 		this_colour.red = terrain_3d_transformed_point_normals[normal_index].colour.red;

  00168	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0016b	c1 e0 04	 shl	 eax, 4
  0016e	8a 88 0e 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+14]
  00174	88 4d e2	 mov	 BYTE PTR _this_colour$1[ebp+2], cl

; 1810 : 		this_colour.green = terrain_3d_transformed_point_normals[normal_index].colour.green;

  00177	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0017a	c1 e0 04	 shl	 eax, 4
  0017d	8a 88 0d 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+13]
  00183	88 4d e1	 mov	 BYTE PTR _this_colour$1[ebp+1], cl

; 1811 : 		this_colour.blue = terrain_3d_transformed_point_normals[normal_index].colour.blue;

  00186	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  00189	c1 e0 04	 shl	 eax, 4
  0018c	8a 88 0c 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+12]
  00192	88 4d e0	 mov	 BYTE PTR _this_colour$1[ebp], cl

; 1812 : 		this_colour.alpha = transformed_3d_point_colours[this_point].alpha;

  00195	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00198	8a 0c c5 03 00
	00 00		 mov	 cl, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+3]
  0019f	88 4d e3	 mov	 BYTE PTR _this_colour$1[ebp+3], cl

; 1813 : 
; 1814 : 		destination_vertices[count].color = this_colour.colour;

  001a2	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  001a5	c1 e0 05	 shl	 eax, 5
  001a8	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  001ab	8b 55 e0	 mov	 edx, DWORD PTR _this_colour$1[ebp]
  001ae	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 1815 : 		destination_vertices[count].specular = 0;

  001b2	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  001b5	c1 e0 05	 shl	 eax, 5
  001b8	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  001bb	c7 44 01 14 00
	00 00 00	 mov	 DWORD PTR [ecx+eax+20], 0

; 1816 : 	}

  001c3	e9 87 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 1817 : 
; 1818 : 	add_terrain_3d_buffered_triangle_fan ( num_points, current_terrain_type_class->texture2 );

  001c8	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001cd	8b 48 08	 mov	 ecx, DWORD PTR [eax+8]
  001d0	51		 push	 ecx
  001d1	8b 55 08	 mov	 edx, DWORD PTR _num_points$[ebp]
  001d4	52		 push	 edx
  001d5	e8 00 00 00 00	 call	 ?add_terrain_3d_buffered_triangle_fan@@YGXHPAUSCREEN@@@Z ; add_terrain_3d_buffered_triangle_fan

; 1819 : }

  001da	5f		 pop	 edi
  001db	5e		 pop	 esi
  001dc	5b		 pop	 ebx
  001dd	8b e5		 mov	 esp, ebp
  001df	5d		 pop	 ebp
  001e0	c2 04 00	 ret	 4
?render_3d_terrain_secondary_texture_zy_byte_fan@@YGXH@Z ENDP ; render_3d_terrain_secondary_texture_zy_byte_fan
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_secondary_texture_zy_word_fan@@YGXH@Z
_TEXT	SEGMENT
_this_colour$1 = -32					; size = 4
_y$2 = -28						; size = 4
_y_texture_scale$ = -24					; size = 4
_xz_texture_scale$ = -20				; size = 4
_destination_vertices$ = -16				; size = 4
_this_point$ = -12					; size = 4
_normal_index$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_secondary_texture_zy_word_fan@@YGXH@Z PROC ; render_3d_terrain_secondary_texture_zy_word_fan, COMDAT

; 1706 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 60	 sub	 esp, 96			; 00000060H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 1707 : 
; 1708 : 	int
; 1709 : 		count,
; 1710 : 		normal_index,
; 1711 : 		this_point;
; 1712 : 
; 1713 : 	LPD3DTLVERTEX
; 1714 : 		destination_vertices;
; 1715 : 
; 1716 : 	float
; 1717 : 		xz_texture_scale,
; 1718 : 		y_texture_scale;
; 1719 : 
; 1720 : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 ec	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 1721 : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 e8	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 1722 : 
; 1723 : 	destination_vertices = get_terrain_3d_buffered_vertices ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_terrain_3d_buffered_vertices@@YGPAU_D3DTLVERTEX@@H@Z ; get_terrain_3d_buffered_vertices
  00030	89 45 f0	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 1724 : 
; 1725 : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 1726 : 
; 1727 : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d 66 01 00
	00		 jge	 $LN3@render_3d_

; 1728 : 	{
; 1729 : 
; 1730 : 		float
; 1731 : 			y;
; 1732 : 	
; 1733 : 		real_colour
; 1734 : 			this_colour;
; 1735 : 	
; 1736 : 		this_point = terrain_3d_sector_point_word_references[count].point;

  00064	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00067	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_sector_point_word_references@@3PAUTERRAIN_3D_POINT_WORD_REFERENCE@@A ; terrain_3d_sector_point_word_references
  0006d	0f b7 14 41	 movzx	 edx, WORD PTR [ecx+eax*2]
  00071	89 55 f4	 mov	 DWORD PTR _this_point$[ebp], edx

; 1737 : 	
; 1738 : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  00074	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00077	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  0007f	89 4d f8	 mov	 DWORD PTR _normal_index$[ebp], ecx

; 1739 : 	
; 1740 : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00082	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00087	8b 4d f4	 mov	 ecx, DWORD PTR _this_point$[ebp]
  0008a	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  00090	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00094	0f b7 c0	 movzx	 eax, ax
  00097	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0009b	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  000a3	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  000ab	f3 0f 11 45 e4	 movss	 DWORD PTR _y$2[ebp], xmm0

; 1741 : 
; 1742 : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].z ) * xz_texture_scale;

  000b0	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  000b3	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000b9	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  000be	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000c2	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000c7	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000ca	c1 e0 05	 shl	 eax, 5
  000cd	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000d0	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 1743 : 		destination_vertices[count].tv = y * y_texture_scale;

  000d6	f3 0f 10 45 e4	 movss	 xmm0, DWORD PTR _y$2[ebp]
  000db	f3 0f 59 45 e8	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000e0	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000e3	c1 e0 05	 shl	 eax, 5
  000e6	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000e9	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 1744 : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000ef	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  000f2	c1 e0 04	 shl	 eax, 4
  000f5	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000f8	c1 e1 05	 shl	 ecx, 5
  000fb	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000fe	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  00104	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 1745 : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  00107	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  0010a	c1 e0 04	 shl	 eax, 4
  0010d	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00110	c1 e1 05	 shl	 ecx, 5
  00113	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00116	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0011c	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 1746 : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  00120	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00123	c1 e0 04	 shl	 eax, 4
  00126	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0012e	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00136	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0013e	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00142	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00145	c1 e1 05	 shl	 ecx, 5
  00148	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0014b	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 1747 : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00151	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00154	c1 e0 04	 shl	 eax, 4
  00157	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0015a	c1 e1 05	 shl	 ecx, 5
  0015d	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00160	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00166	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 1748 : 
; 1749 : 		this_colour.red = terrain_3d_transformed_point_normals[normal_index].colour.red;

  0016a	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0016d	c1 e0 04	 shl	 eax, 4
  00170	8a 88 0e 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+14]
  00176	88 4d e2	 mov	 BYTE PTR _this_colour$1[ebp+2], cl

; 1750 : 		this_colour.green = terrain_3d_transformed_point_normals[normal_index].colour.green;

  00179	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0017c	c1 e0 04	 shl	 eax, 4
  0017f	8a 88 0d 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+13]
  00185	88 4d e1	 mov	 BYTE PTR _this_colour$1[ebp+1], cl

; 1751 : 		this_colour.blue = terrain_3d_transformed_point_normals[normal_index].colour.blue;

  00188	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0018b	c1 e0 04	 shl	 eax, 4
  0018e	8a 88 0c 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+12]
  00194	88 4d e0	 mov	 BYTE PTR _this_colour$1[ebp], cl

; 1752 : 		this_colour.alpha = transformed_3d_point_colours[this_point].alpha;

  00197	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  0019a	8a 0c c5 03 00
	00 00		 mov	 cl, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+3]
  001a1	88 4d e3	 mov	 BYTE PTR _this_colour$1[ebp+3], cl

; 1753 : 
; 1754 : 		destination_vertices[count].color = this_colour.colour;

  001a4	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  001a7	c1 e0 05	 shl	 eax, 5
  001aa	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  001ad	8b 55 e0	 mov	 edx, DWORD PTR _this_colour$1[ebp]
  001b0	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 1755 : 		destination_vertices[count].specular = 0;

  001b4	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  001b7	c1 e0 05	 shl	 eax, 5
  001ba	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  001bd	c7 44 01 14 00
	00 00 00	 mov	 DWORD PTR [ecx+eax+20], 0

; 1756 : 	}

  001c5	e9 85 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 1757 : 
; 1758 : 	add_terrain_3d_buffered_triangle_fan ( num_points, current_terrain_type_class->texture2 );

  001ca	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001cf	8b 48 08	 mov	 ecx, DWORD PTR [eax+8]
  001d2	51		 push	 ecx
  001d3	8b 55 08	 mov	 edx, DWORD PTR _num_points$[ebp]
  001d6	52		 push	 edx
  001d7	e8 00 00 00 00	 call	 ?add_terrain_3d_buffered_triangle_fan@@YGXHPAUSCREEN@@@Z ; add_terrain_3d_buffered_triangle_fan

; 1759 : }

  001dc	5f		 pop	 edi
  001dd	5e		 pop	 esi
  001de	5b		 pop	 ebx
  001df	8b e5		 mov	 esp, ebp
  001e1	5d		 pop	 ebp
  001e2	c2 04 00	 ret	 4
?render_3d_terrain_secondary_texture_zy_word_fan@@YGXH@Z ENDP ; render_3d_terrain_secondary_texture_zy_word_fan
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_secondary_texture_xy_byte_fan@@YGXH@Z
_TEXT	SEGMENT
_this_colour$1 = -32					; size = 4
_y$2 = -28						; size = 4
_y_texture_scale$ = -24					; size = 4
_xz_texture_scale$ = -20				; size = 4
_destination_vertices$ = -16				; size = 4
_this_point$ = -12					; size = 4
_normal_index$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_secondary_texture_xy_byte_fan@@YGXH@Z PROC ; render_3d_terrain_secondary_texture_xy_byte_fan, COMDAT

; 1646 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 60	 sub	 esp, 96			; 00000060H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 1647 : 
; 1648 : 	int
; 1649 : 		count,
; 1650 : 		normal_index,
; 1651 : 		this_point;
; 1652 : 
; 1653 : 	LPD3DTLVERTEX
; 1654 : 		destination_vertices;
; 1655 : 
; 1656 : 	float
; 1657 : 		xz_texture_scale,
; 1658 : 		y_texture_scale;
; 1659 : 
; 1660 : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 ec	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 1661 : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 e8	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 1662 : 
; 1663 : 	destination_vertices = get_terrain_3d_buffered_vertices ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_terrain_3d_buffered_vertices@@YGPAU_D3DTLVERTEX@@H@Z ; get_terrain_3d_buffered_vertices
  00030	89 45 f0	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 1664 : 
; 1665 : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 1666 : 
; 1667 : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d 63 01 00
	00		 jge	 $LN3@render_3d_

; 1668 : 	{
; 1669 : 
; 1670 : 		float
; 1671 : 			y;
; 1672 : 	
; 1673 : 		real_colour
; 1674 : 			this_colour;
; 1675 : 	
; 1676 : 		this_point = terrain_3d_sector_point_byte_references[count].point;

  00064	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_point_byte_references@@3PAUTERRAIN_3D_POINT_BYTE_REFERENCE@@A ; terrain_3d_sector_point_byte_references
  00069	03 45 fc	 add	 eax, DWORD PTR _count$[ebp]
  0006c	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  0006f	89 4d f4	 mov	 DWORD PTR _this_point$[ebp], ecx

; 1677 : 	
; 1678 : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  00072	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00075	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  0007d	89 4d f8	 mov	 DWORD PTR _normal_index$[ebp], ecx

; 1679 : 	
; 1680 : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00080	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00085	8b 4d f4	 mov	 ecx, DWORD PTR _this_point$[ebp]
  00088	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  0008e	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00092	0f b7 c0	 movzx	 eax, ax
  00095	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  00099	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  000a1	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  000a9	f3 0f 11 45 e4	 movss	 DWORD PTR _y$2[ebp], xmm0

; 1681 : 
; 1682 : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].x ) * xz_texture_scale;

  000ae	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  000b1	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000b7	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  000bb	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000bf	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000c4	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000c7	c1 e0 05	 shl	 eax, 5
  000ca	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000cd	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 1683 : 		destination_vertices[count].tv = y * y_texture_scale;

  000d3	f3 0f 10 45 e4	 movss	 xmm0, DWORD PTR _y$2[ebp]
  000d8	f3 0f 59 45 e8	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000dd	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000e0	c1 e0 05	 shl	 eax, 5
  000e3	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000e6	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 1684 : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000ec	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  000ef	c1 e0 04	 shl	 eax, 4
  000f2	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000f5	c1 e1 05	 shl	 ecx, 5
  000f8	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000fb	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  00101	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 1685 : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  00104	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00107	c1 e0 04	 shl	 eax, 4
  0010a	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0010d	c1 e1 05	 shl	 ecx, 5
  00110	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00113	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  00119	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 1686 : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  0011d	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00120	c1 e0 04	 shl	 eax, 4
  00123	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0012b	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00133	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0013b	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  0013f	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00142	c1 e1 05	 shl	 ecx, 5
  00145	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00148	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 1687 : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  0014e	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00151	c1 e0 04	 shl	 eax, 4
  00154	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00157	c1 e1 05	 shl	 ecx, 5
  0015a	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0015d	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00163	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 1688 : 
; 1689 : 		this_colour.red = terrain_3d_transformed_point_normals[normal_index].colour.red;

  00167	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0016a	c1 e0 04	 shl	 eax, 4
  0016d	8a 88 0e 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+14]
  00173	88 4d e2	 mov	 BYTE PTR _this_colour$1[ebp+2], cl

; 1690 : 		this_colour.green = terrain_3d_transformed_point_normals[normal_index].colour.green;

  00176	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  00179	c1 e0 04	 shl	 eax, 4
  0017c	8a 88 0d 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+13]
  00182	88 4d e1	 mov	 BYTE PTR _this_colour$1[ebp+1], cl

; 1691 : 		this_colour.blue = terrain_3d_transformed_point_normals[normal_index].colour.blue;

  00185	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  00188	c1 e0 04	 shl	 eax, 4
  0018b	8a 88 0c 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+12]
  00191	88 4d e0	 mov	 BYTE PTR _this_colour$1[ebp], cl

; 1692 : 		this_colour.alpha = transformed_3d_point_colours[this_point].alpha;

  00194	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00197	8a 0c c5 03 00
	00 00		 mov	 cl, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+3]
  0019e	88 4d e3	 mov	 BYTE PTR _this_colour$1[ebp+3], cl

; 1693 : 
; 1694 : 		destination_vertices[count].color = this_colour.colour;

  001a1	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  001a4	c1 e0 05	 shl	 eax, 5
  001a7	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  001aa	8b 55 e0	 mov	 edx, DWORD PTR _this_colour$1[ebp]
  001ad	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 1695 : 		destination_vertices[count].specular = 0;

  001b1	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  001b4	c1 e0 05	 shl	 eax, 5
  001b7	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  001ba	c7 44 01 14 00
	00 00 00	 mov	 DWORD PTR [ecx+eax+20], 0

; 1696 : 	}

  001c2	e9 88 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 1697 : 
; 1698 : 	add_terrain_3d_buffered_triangle_fan ( num_points, current_terrain_type_class->texture2 );

  001c7	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001cc	8b 48 08	 mov	 ecx, DWORD PTR [eax+8]
  001cf	51		 push	 ecx
  001d0	8b 55 08	 mov	 edx, DWORD PTR _num_points$[ebp]
  001d3	52		 push	 edx
  001d4	e8 00 00 00 00	 call	 ?add_terrain_3d_buffered_triangle_fan@@YGXHPAUSCREEN@@@Z ; add_terrain_3d_buffered_triangle_fan

; 1699 : }

  001d9	5f		 pop	 edi
  001da	5e		 pop	 esi
  001db	5b		 pop	 ebx
  001dc	8b e5		 mov	 esp, ebp
  001de	5d		 pop	 ebp
  001df	c2 04 00	 ret	 4
?render_3d_terrain_secondary_texture_xy_byte_fan@@YGXH@Z ENDP ; render_3d_terrain_secondary_texture_xy_byte_fan
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_secondary_texture_xy_word_fan@@YGXH@Z
_TEXT	SEGMENT
_this_colour$1 = -32					; size = 4
_y$2 = -28						; size = 4
_y_texture_scale$ = -24					; size = 4
_xz_texture_scale$ = -20				; size = 4
_destination_vertices$ = -16				; size = 4
_this_point$ = -12					; size = 4
_normal_index$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_secondary_texture_xy_word_fan@@YGXH@Z PROC ; render_3d_terrain_secondary_texture_xy_word_fan, COMDAT

; 1586 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 60	 sub	 esp, 96			; 00000060H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 1587 : 
; 1588 : 	int
; 1589 : 		count,
; 1590 : 		normal_index,
; 1591 : 		this_point;
; 1592 : 
; 1593 : 	LPD3DTLVERTEX
; 1594 : 		destination_vertices;
; 1595 : 
; 1596 : 	float
; 1597 : 		xz_texture_scale,
; 1598 : 		y_texture_scale;
; 1599 : 
; 1600 : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 ec	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 1601 : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 e8	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 1602 : 
; 1603 : 	destination_vertices = get_terrain_3d_buffered_vertices ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_terrain_3d_buffered_vertices@@YGPAU_D3DTLVERTEX@@H@Z ; get_terrain_3d_buffered_vertices
  00030	89 45 f0	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 1604 : 
; 1605 : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 1606 : 
; 1607 : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d 65 01 00
	00		 jge	 $LN3@render_3d_

; 1608 : 	{
; 1609 : 
; 1610 : 		float
; 1611 : 			y;
; 1612 : 	
; 1613 : 		real_colour
; 1614 : 			this_colour;
; 1615 : 	
; 1616 : 		this_point = terrain_3d_sector_point_word_references[count].point;

  00064	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00067	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_sector_point_word_references@@3PAUTERRAIN_3D_POINT_WORD_REFERENCE@@A ; terrain_3d_sector_point_word_references
  0006d	0f b7 14 41	 movzx	 edx, WORD PTR [ecx+eax*2]
  00071	89 55 f4	 mov	 DWORD PTR _this_point$[ebp], edx

; 1617 : 	
; 1618 : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  00074	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00077	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  0007f	89 4d f8	 mov	 DWORD PTR _normal_index$[ebp], ecx

; 1619 : 	
; 1620 : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00082	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00087	8b 4d f4	 mov	 ecx, DWORD PTR _this_point$[ebp]
  0008a	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  00090	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00094	0f b7 c0	 movzx	 eax, ax
  00097	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0009b	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  000a3	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  000ab	f3 0f 11 45 e4	 movss	 DWORD PTR _y$2[ebp], xmm0

; 1621 : 
; 1622 : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].x ) * xz_texture_scale;

  000b0	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  000b3	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000b9	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  000bd	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000c1	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000c6	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000c9	c1 e0 05	 shl	 eax, 5
  000cc	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000cf	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 1623 : 		destination_vertices[count].tv = y * y_texture_scale;

  000d5	f3 0f 10 45 e4	 movss	 xmm0, DWORD PTR _y$2[ebp]
  000da	f3 0f 59 45 e8	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000df	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000e2	c1 e0 05	 shl	 eax, 5
  000e5	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000e8	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 1624 : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000ee	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  000f1	c1 e0 04	 shl	 eax, 4
  000f4	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000f7	c1 e1 05	 shl	 ecx, 5
  000fa	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000fd	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  00103	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 1625 : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  00106	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00109	c1 e0 04	 shl	 eax, 4
  0010c	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0010f	c1 e1 05	 shl	 ecx, 5
  00112	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00115	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0011b	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 1626 : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  0011f	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00122	c1 e0 04	 shl	 eax, 4
  00125	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0012d	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00135	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0013d	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00141	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00144	c1 e1 05	 shl	 ecx, 5
  00147	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0014a	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 1627 : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00150	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00153	c1 e0 04	 shl	 eax, 4
  00156	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00159	c1 e1 05	 shl	 ecx, 5
  0015c	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0015f	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00165	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 1628 : 
; 1629 : 		this_colour.red = terrain_3d_transformed_point_normals[normal_index].colour.red;

  00169	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0016c	c1 e0 04	 shl	 eax, 4
  0016f	8a 88 0e 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+14]
  00175	88 4d e2	 mov	 BYTE PTR _this_colour$1[ebp+2], cl

; 1630 : 		this_colour.green = terrain_3d_transformed_point_normals[normal_index].colour.green;

  00178	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0017b	c1 e0 04	 shl	 eax, 4
  0017e	8a 88 0d 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+13]
  00184	88 4d e1	 mov	 BYTE PTR _this_colour$1[ebp+1], cl

; 1631 : 		this_colour.blue = terrain_3d_transformed_point_normals[normal_index].colour.blue;

  00187	8b 45 f8	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0018a	c1 e0 04	 shl	 eax, 4
  0018d	8a 88 0c 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+12]
  00193	88 4d e0	 mov	 BYTE PTR _this_colour$1[ebp], cl

; 1632 : 		this_colour.alpha = transformed_3d_point_colours[this_point].alpha;

  00196	8b 45 f4	 mov	 eax, DWORD PTR _this_point$[ebp]
  00199	8a 0c c5 03 00
	00 00		 mov	 cl, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+3]
  001a0	88 4d e3	 mov	 BYTE PTR _this_colour$1[ebp+3], cl

; 1633 : 
; 1634 : 		destination_vertices[count].color = this_colour.colour;

  001a3	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  001a6	c1 e0 05	 shl	 eax, 5
  001a9	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  001ac	8b 55 e0	 mov	 edx, DWORD PTR _this_colour$1[ebp]
  001af	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 1635 : 		destination_vertices[count].specular = 0;

  001b3	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  001b6	c1 e0 05	 shl	 eax, 5
  001b9	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  001bc	c7 44 01 14 00
	00 00 00	 mov	 DWORD PTR [ecx+eax+20], 0

; 1636 : 	}

  001c4	e9 86 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 1637 : 
; 1638 : 	add_terrain_3d_buffered_triangle_fan ( num_points, current_terrain_type_class->texture2 );

  001c9	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001ce	8b 48 08	 mov	 ecx, DWORD PTR [eax+8]
  001d1	51		 push	 ecx
  001d2	8b 55 08	 mov	 edx, DWORD PTR _num_points$[ebp]
  001d5	52		 push	 edx
  001d6	e8 00 00 00 00	 call	 ?add_terrain_3d_buffered_triangle_fan@@YGXHPAUSCREEN@@@Z ; add_terrain_3d_buffered_triangle_fan

; 1639 : }

  001db	5f		 pop	 edi
  001dc	5e		 pop	 esi
  001dd	5b		 pop	 ebx
  001de	8b e5		 mov	 esp, ebp
  001e0	5d		 pop	 ebp
  001e1	c2 04 00	 ret	 4
?render_3d_terrain_secondary_texture_xy_word_fan@@YGXH@Z ENDP ; render_3d_terrain_secondary_texture_xy_word_fan
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_secondary_byte_strip@@YGXH@Z
_TEXT	SEGMENT
_this_colour$1 = -24					; size = 4
_texture_scale$ = -20					; size = 4
_destination_vertices$ = -16				; size = 4
_normal_index$ = -12					; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_secondary_byte_strip@@YGXH@Z PROC	; render_3d_terrain_secondary_byte_strip, COMDAT

; 1533 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 58	 sub	 esp, 88			; 00000058H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 1534 : 
; 1535 : 	int
; 1536 : 		count,
; 1537 : 		this_point,
; 1538 : 		normal_index;
; 1539 : 
; 1540 : 	LPD3DTLVERTEX
; 1541 : 		destination_vertices;
; 1542 : 
; 1543 : 	float
; 1544 : 		texture_scale;
; 1545 : 
; 1546 : 	texture_scale = current_terrain_type_class->xz_texture_scale2;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 18	 movss	 xmm0, DWORD PTR [eax+24]
  00013	f3 0f 11 45 ec	 movss	 DWORD PTR _texture_scale$[ebp], xmm0

; 1547 : 
; 1548 : 	destination_vertices = get_terrain_3d_buffered_vertices ( num_points );

  00018	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0001b	50		 push	 eax
  0001c	e8 00 00 00 00	 call	 ?get_terrain_3d_buffered_vertices@@YGPAU_D3DTLVERTEX@@H@Z ; get_terrain_3d_buffered_vertices
  00021	89 45 f0	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 1549 : 
; 1550 : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00024	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00027	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0002d	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00031	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 1551 : 
; 1552 : 	for ( count = 0; count < num_points; count++ )

  00037	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0003e	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  00040	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00043	83 c0 01	 add	 eax, 1
  00046	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00049	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0004c	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0004f	0f 8d 42 01 00
	00		 jge	 $LN3@render_3d_

; 1553 : 	{
; 1554 : 
; 1555 : 		real_colour
; 1556 : 			this_colour;
; 1557 : 	
; 1558 : 		this_point = terrain_3d_sector_point_byte_references[count].point;

  00055	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_point_byte_references@@3PAUTERRAIN_3D_POINT_BYTE_REFERENCE@@A ; terrain_3d_sector_point_byte_references
  0005a	03 45 fc	 add	 eax, DWORD PTR _count$[ebp]
  0005d	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  00060	89 4d f8	 mov	 DWORD PTR _this_point$[ebp], ecx

; 1559 : 	
; 1560 : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  00063	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00066	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  0006e	89 4d f4	 mov	 DWORD PTR _normal_index$[ebp], ecx

; 1561 : 	
; 1562 : 		destination_vertices[count].tu = ( current_terrain_points_xz[this_point].x ) * texture_scale;

  00071	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00074	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  0007a	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  0007e	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00082	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  00087	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0008a	c1 e0 05	 shl	 eax, 5
  0008d	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00090	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 1563 : 		destination_vertices[count].tv = ( current_terrain_points_xz[this_point].z ) * texture_scale;

  00096	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00099	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  0009f	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  000a4	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000a8	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  000ad	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000b0	c1 e0 05	 shl	 eax, 5
  000b3	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000b6	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 1564 : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000bc	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000bf	c1 e0 04	 shl	 eax, 4
  000c2	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000c5	c1 e1 05	 shl	 ecx, 5
  000c8	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000cb	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000d1	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 1565 : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000d4	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000d7	c1 e0 04	 shl	 eax, 4
  000da	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000dd	c1 e1 05	 shl	 ecx, 5
  000e0	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000e3	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  000e9	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 1566 : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  000ed	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000f0	c1 e0 04	 shl	 eax, 4
  000f3	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  000fb	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00103	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0010b	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  0010f	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00112	c1 e1 05	 shl	 ecx, 5
  00115	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00118	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 1567 : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  0011e	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00121	c1 e0 04	 shl	 eax, 4
  00124	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00127	c1 e1 05	 shl	 ecx, 5
  0012a	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0012d	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00133	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 1568 : 
; 1569 : 		this_colour.red = terrain_3d_transformed_point_normals[normal_index].colour.red;

  00137	8b 45 f4	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0013a	c1 e0 04	 shl	 eax, 4
  0013d	8a 88 0e 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+14]
  00143	88 4d ea	 mov	 BYTE PTR _this_colour$1[ebp+2], cl

; 1570 : 		this_colour.green = terrain_3d_transformed_point_normals[normal_index].colour.green;

  00146	8b 45 f4	 mov	 eax, DWORD PTR _normal_index$[ebp]
  00149	c1 e0 04	 shl	 eax, 4
  0014c	8a 88 0d 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+13]
  00152	88 4d e9	 mov	 BYTE PTR _this_colour$1[ebp+1], cl

; 1571 : 		this_colour.blue = terrain_3d_transformed_point_normals[normal_index].colour.blue;

  00155	8b 45 f4	 mov	 eax, DWORD PTR _normal_index$[ebp]
  00158	c1 e0 04	 shl	 eax, 4
  0015b	8a 88 0c 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+12]
  00161	88 4d e8	 mov	 BYTE PTR _this_colour$1[ebp], cl

; 1572 : 		this_colour.alpha = transformed_3d_point_colours[this_point].alpha;

  00164	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00167	8a 0c c5 03 00
	00 00		 mov	 cl, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+3]
  0016e	88 4d eb	 mov	 BYTE PTR _this_colour$1[ebp+3], cl

; 1573 : 
; 1574 : 		destination_vertices[count].color = this_colour.colour;

  00171	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00174	c1 e0 05	 shl	 eax, 5
  00177	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  0017a	8b 55 e8	 mov	 edx, DWORD PTR _this_colour$1[ebp]
  0017d	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 1575 : 		destination_vertices[count].specular = 0;

  00181	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00184	c1 e0 05	 shl	 eax, 5
  00187	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  0018a	c7 44 01 14 00
	00 00 00	 mov	 DWORD PTR [ecx+eax+20], 0

; 1576 : 	}

  00192	e9 a9 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 1577 : 
; 1578 : 	add_terrain_3d_buffered_triangle_strip ( num_points, current_terrain_type_class->texture2 );

  00197	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0019c	8b 48 08	 mov	 ecx, DWORD PTR [eax+8]
  0019f	51		 push	 ecx
  001a0	8b 55 08	 mov	 edx, DWORD PTR _num_points$[ebp]
  001a3	52		 push	 edx
  001a4	e8 00 00 00 00	 call	 ?add_terrain_3d_buffered_triangle_strip@@YGXHPAUSCREEN@@@Z ; add_terrain_3d_buffered_triangle_strip

; 1579 : }

  001a9	5f		 pop	 edi
  001aa	5e		 pop	 esi
  001ab	5b		 pop	 ebx
  001ac	8b e5		 mov	 esp, ebp
  001ae	5d		 pop	 ebp
  001af	c2 04 00	 ret	 4
?render_3d_terrain_secondary_byte_strip@@YGXH@Z ENDP	; render_3d_terrain_secondary_byte_strip
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_secondary_word_strip@@YGXH@Z
_TEXT	SEGMENT
_this_colour$1 = -24					; size = 4
_texture_scale$ = -20					; size = 4
_destination_vertices$ = -16				; size = 4
_normal_index$ = -12					; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_secondary_word_strip@@YGXH@Z PROC	; render_3d_terrain_secondary_word_strip, COMDAT

; 1480 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 58	 sub	 esp, 88			; 00000058H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 1481 : 
; 1482 : 	int
; 1483 : 		count,
; 1484 : 		this_point,
; 1485 : 		normal_index;
; 1486 : 
; 1487 : 	LPD3DTLVERTEX
; 1488 : 		destination_vertices;
; 1489 : 
; 1490 : 	float
; 1491 : 		texture_scale;
; 1492 : 
; 1493 : 	texture_scale = current_terrain_type_class->xz_texture_scale2;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 18	 movss	 xmm0, DWORD PTR [eax+24]
  00013	f3 0f 11 45 ec	 movss	 DWORD PTR _texture_scale$[ebp], xmm0

; 1494 : 
; 1495 : 	destination_vertices = get_terrain_3d_buffered_vertices ( num_points );

  00018	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0001b	50		 push	 eax
  0001c	e8 00 00 00 00	 call	 ?get_terrain_3d_buffered_vertices@@YGPAU_D3DTLVERTEX@@H@Z ; get_terrain_3d_buffered_vertices
  00021	89 45 f0	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 1496 : 
; 1497 : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00024	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00027	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0002d	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00031	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 1498 : 
; 1499 : 	for ( count = 0; count < num_points; count++ )

  00037	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0003e	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  00040	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00043	83 c0 01	 add	 eax, 1
  00046	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00049	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0004c	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0004f	0f 8d 44 01 00
	00		 jge	 $LN3@render_3d_

; 1500 : 	{
; 1501 : 
; 1502 : 		real_colour
; 1503 : 			this_colour;
; 1504 : 
; 1505 : 		this_point = terrain_3d_sector_point_word_references[count].point;

  00055	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00058	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_sector_point_word_references@@3PAUTERRAIN_3D_POINT_WORD_REFERENCE@@A ; terrain_3d_sector_point_word_references
  0005e	0f b7 14 41	 movzx	 edx, WORD PTR [ecx+eax*2]
  00062	89 55 f8	 mov	 DWORD PTR _this_point$[ebp], edx

; 1506 : 
; 1507 : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  00065	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00068	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  00070	89 4d f4	 mov	 DWORD PTR _normal_index$[ebp], ecx

; 1508 : 	
; 1509 : 		destination_vertices[count].tu = ( current_terrain_points_xz[this_point].x ) * texture_scale;

  00073	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00076	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  0007c	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  00080	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00084	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  00089	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0008c	c1 e0 05	 shl	 eax, 5
  0008f	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00092	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 1510 : 		destination_vertices[count].tv = ( current_terrain_points_xz[this_point].z ) * texture_scale;

  00098	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0009b	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000a1	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  000a6	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000aa	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  000af	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000b2	c1 e0 05	 shl	 eax, 5
  000b5	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000b8	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 1511 : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000be	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000c1	c1 e0 04	 shl	 eax, 4
  000c4	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000c7	c1 e1 05	 shl	 ecx, 5
  000ca	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000cd	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000d3	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 1512 : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000d6	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000d9	c1 e0 04	 shl	 eax, 4
  000dc	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000df	c1 e1 05	 shl	 ecx, 5
  000e2	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000e5	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  000eb	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 1513 : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  000ef	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000f2	c1 e0 04	 shl	 eax, 4
  000f5	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  000fd	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00105	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0010d	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00111	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00114	c1 e1 05	 shl	 ecx, 5
  00117	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0011a	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 1514 : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00120	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00123	c1 e0 04	 shl	 eax, 4
  00126	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00129	c1 e1 05	 shl	 ecx, 5
  0012c	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0012f	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00135	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 1515 : 
; 1516 : 		this_colour.red = terrain_3d_transformed_point_normals[normal_index].colour.red;

  00139	8b 45 f4	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0013c	c1 e0 04	 shl	 eax, 4
  0013f	8a 88 0e 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+14]
  00145	88 4d ea	 mov	 BYTE PTR _this_colour$1[ebp+2], cl

; 1517 : 		this_colour.green = terrain_3d_transformed_point_normals[normal_index].colour.green;

  00148	8b 45 f4	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0014b	c1 e0 04	 shl	 eax, 4
  0014e	8a 88 0d 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+13]
  00154	88 4d e9	 mov	 BYTE PTR _this_colour$1[ebp+1], cl

; 1518 : 		this_colour.blue = terrain_3d_transformed_point_normals[normal_index].colour.blue;

  00157	8b 45 f4	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0015a	c1 e0 04	 shl	 eax, 4
  0015d	8a 88 0c 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+12]
  00163	88 4d e8	 mov	 BYTE PTR _this_colour$1[ebp], cl

; 1519 : 		this_colour.alpha = transformed_3d_point_colours[this_point].alpha;

  00166	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00169	8a 0c c5 03 00
	00 00		 mov	 cl, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+3]
  00170	88 4d eb	 mov	 BYTE PTR _this_colour$1[ebp+3], cl

; 1520 : 
; 1521 : 		destination_vertices[count].color = this_colour.colour;

  00173	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00176	c1 e0 05	 shl	 eax, 5
  00179	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  0017c	8b 55 e8	 mov	 edx, DWORD PTR _this_colour$1[ebp]
  0017f	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 1522 : 		destination_vertices[count].specular = 0;

  00183	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00186	c1 e0 05	 shl	 eax, 5
  00189	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  0018c	c7 44 01 14 00
	00 00 00	 mov	 DWORD PTR [ecx+eax+20], 0

; 1523 : 	}

  00194	e9 a7 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 1524 : 
; 1525 : 	add_terrain_3d_buffered_triangle_strip ( num_points, current_terrain_type_class->texture2 );

  00199	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0019e	8b 48 08	 mov	 ecx, DWORD PTR [eax+8]
  001a1	51		 push	 ecx
  001a2	8b 55 08	 mov	 edx, DWORD PTR _num_points$[ebp]
  001a5	52		 push	 edx
  001a6	e8 00 00 00 00	 call	 ?add_terrain_3d_buffered_triangle_strip@@YGXHPAUSCREEN@@@Z ; add_terrain_3d_buffered_triangle_strip

; 1526 : }

  001ab	5f		 pop	 edi
  001ac	5e		 pop	 esi
  001ad	5b		 pop	 ebx
  001ae	8b e5		 mov	 esp, ebp
  001b0	5d		 pop	 ebp
  001b1	c2 04 00	 ret	 4
?render_3d_terrain_secondary_word_strip@@YGXH@Z ENDP	; render_3d_terrain_secondary_word_strip
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_secondary_byte_fan@@YGXH@Z
_TEXT	SEGMENT
_this_colour$1 = -24					; size = 4
_texture_scale$ = -20					; size = 4
_destination_vertices$ = -16				; size = 4
_normal_index$ = -12					; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_secondary_byte_fan@@YGXH@Z PROC	; render_3d_terrain_secondary_byte_fan, COMDAT

; 1426 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 58	 sub	 esp, 88			; 00000058H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 1427 : 
; 1428 : 	int
; 1429 : 		count,
; 1430 : 		this_point,
; 1431 : 		normal_index;
; 1432 : 
; 1433 : 	LPD3DTLVERTEX
; 1434 : 		destination_vertices;
; 1435 : 
; 1436 : 	float
; 1437 : 		texture_scale;
; 1438 : 
; 1439 : 	texture_scale = current_terrain_type_class->xz_texture_scale2;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 18	 movss	 xmm0, DWORD PTR [eax+24]
  00013	f3 0f 11 45 ec	 movss	 DWORD PTR _texture_scale$[ebp], xmm0

; 1440 : 
; 1441 : 	destination_vertices = get_terrain_3d_buffered_vertices ( num_points );

  00018	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0001b	50		 push	 eax
  0001c	e8 00 00 00 00	 call	 ?get_terrain_3d_buffered_vertices@@YGPAU_D3DTLVERTEX@@H@Z ; get_terrain_3d_buffered_vertices
  00021	89 45 f0	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 1442 : 
; 1443 : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00024	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00027	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0002d	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00031	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 1444 : 
; 1445 : 	for ( count = 0; count < num_points; count++ )

  00037	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0003e	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  00040	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00043	83 c0 01	 add	 eax, 1
  00046	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00049	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0004c	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0004f	0f 8d 42 01 00
	00		 jge	 $LN3@render_3d_

; 1446 : 	{
; 1447 : 
; 1448 : 		real_colour
; 1449 : 			this_colour;
; 1450 : 	
; 1451 : 		this_point = terrain_3d_sector_point_byte_references[count].point;

  00055	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_point_byte_references@@3PAUTERRAIN_3D_POINT_BYTE_REFERENCE@@A ; terrain_3d_sector_point_byte_references
  0005a	03 45 fc	 add	 eax, DWORD PTR _count$[ebp]
  0005d	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  00060	89 4d f8	 mov	 DWORD PTR _this_point$[ebp], ecx

; 1452 : 	
; 1453 : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  00063	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00066	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  0006e	89 4d f4	 mov	 DWORD PTR _normal_index$[ebp], ecx

; 1454 : 
; 1455 : 		this_colour.red = terrain_3d_transformed_point_normals[normal_index].colour.red;

  00071	8b 45 f4	 mov	 eax, DWORD PTR _normal_index$[ebp]
  00074	c1 e0 04	 shl	 eax, 4
  00077	8a 88 0e 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+14]
  0007d	88 4d ea	 mov	 BYTE PTR _this_colour$1[ebp+2], cl

; 1456 : 		this_colour.green = terrain_3d_transformed_point_normals[normal_index].colour.green;

  00080	8b 45 f4	 mov	 eax, DWORD PTR _normal_index$[ebp]
  00083	c1 e0 04	 shl	 eax, 4
  00086	8a 88 0d 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+13]
  0008c	88 4d e9	 mov	 BYTE PTR _this_colour$1[ebp+1], cl

; 1457 : 		this_colour.blue = terrain_3d_transformed_point_normals[normal_index].colour.blue;

  0008f	8b 45 f4	 mov	 eax, DWORD PTR _normal_index$[ebp]
  00092	c1 e0 04	 shl	 eax, 4
  00095	8a 88 0c 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+12]
  0009b	88 4d e8	 mov	 BYTE PTR _this_colour$1[ebp], cl

; 1458 : 		this_colour.alpha = transformed_3d_point_colours[this_point].alpha;

  0009e	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000a1	8a 0c c5 03 00
	00 00		 mov	 cl, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+3]
  000a8	88 4d eb	 mov	 BYTE PTR _this_colour$1[ebp+3], cl

; 1459 : 
; 1460 : 		destination_vertices[count].tu = ( current_terrain_points_xz[this_point].x ) * texture_scale;

  000ab	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000ae	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000b4	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  000b8	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000bc	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  000c1	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000c4	c1 e0 05	 shl	 eax, 5
  000c7	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000ca	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 1461 : 		destination_vertices[count].tv = ( current_terrain_points_xz[this_point].z ) * texture_scale;

  000d0	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000d3	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000d9	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  000de	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000e2	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  000e7	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000ea	c1 e0 05	 shl	 eax, 5
  000ed	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000f0	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 1462 : 
; 1463 : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000f6	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000f9	c1 e0 04	 shl	 eax, 4
  000fc	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000ff	c1 e1 05	 shl	 ecx, 5
  00102	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00105	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  0010b	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 1464 : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  0010e	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00111	c1 e0 04	 shl	 eax, 4
  00114	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00117	c1 e1 05	 shl	 ecx, 5
  0011a	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0011d	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  00123	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 1465 : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  00127	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0012a	c1 e0 04	 shl	 eax, 4
  0012d	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00135	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  0013d	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  00145	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00149	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0014c	c1 e1 05	 shl	 ecx, 5
  0014f	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00152	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 1466 : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00158	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0015b	c1 e0 04	 shl	 eax, 4
  0015e	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00161	c1 e1 05	 shl	 ecx, 5
  00164	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00167	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0016d	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 1467 : 
; 1468 : 		destination_vertices[count].color = this_colour.colour;

  00171	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00174	c1 e0 05	 shl	 eax, 5
  00177	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  0017a	8b 55 e8	 mov	 edx, DWORD PTR _this_colour$1[ebp]
  0017d	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 1469 : 		destination_vertices[count].specular = 0;

  00181	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00184	c1 e0 05	 shl	 eax, 5
  00187	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  0018a	c7 44 01 14 00
	00 00 00	 mov	 DWORD PTR [ecx+eax+20], 0

; 1470 : 	}

  00192	e9 a9 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 1471 : 
; 1472 : 	add_terrain_3d_buffered_triangle_fan ( num_points, current_terrain_type_class->texture2 );

  00197	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0019c	8b 48 08	 mov	 ecx, DWORD PTR [eax+8]
  0019f	51		 push	 ecx
  001a0	8b 55 08	 mov	 edx, DWORD PTR _num_points$[ebp]
  001a3	52		 push	 edx
  001a4	e8 00 00 00 00	 call	 ?add_terrain_3d_buffered_triangle_fan@@YGXHPAUSCREEN@@@Z ; add_terrain_3d_buffered_triangle_fan

; 1473 : }

  001a9	5f		 pop	 edi
  001aa	5e		 pop	 esi
  001ab	5b		 pop	 ebx
  001ac	8b e5		 mov	 esp, ebp
  001ae	5d		 pop	 ebp
  001af	c2 04 00	 ret	 4
?render_3d_terrain_secondary_byte_fan@@YGXH@Z ENDP	; render_3d_terrain_secondary_byte_fan
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_secondary_word_fan@@YGXH@Z
_TEXT	SEGMENT
_this_colour$1 = -24					; size = 4
_texture_scale$ = -20					; size = 4
_destination_vertices$ = -16				; size = 4
_normal_index$ = -12					; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_secondary_word_fan@@YGXH@Z PROC	; render_3d_terrain_secondary_word_fan, COMDAT

; 1373 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 58	 sub	 esp, 88			; 00000058H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 1374 : 
; 1375 : 	int
; 1376 : 		count,
; 1377 : 		this_point,
; 1378 : 		normal_index;
; 1379 : 
; 1380 : 	LPD3DTLVERTEX
; 1381 : 		destination_vertices;
; 1382 : 
; 1383 : 	float
; 1384 : 		texture_scale;
; 1385 : 
; 1386 : 	texture_scale = current_terrain_type_class->xz_texture_scale2;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 18	 movss	 xmm0, DWORD PTR [eax+24]
  00013	f3 0f 11 45 ec	 movss	 DWORD PTR _texture_scale$[ebp], xmm0

; 1387 : 
; 1388 : 	destination_vertices = get_terrain_3d_buffered_vertices ( num_points );

  00018	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0001b	50		 push	 eax
  0001c	e8 00 00 00 00	 call	 ?get_terrain_3d_buffered_vertices@@YGPAU_D3DTLVERTEX@@H@Z ; get_terrain_3d_buffered_vertices
  00021	89 45 f0	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 1389 : 
; 1390 : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00024	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00027	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0002d	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00031	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 1391 : 
; 1392 : 	for ( count = 0; count < num_points; count++ )

  00037	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0003e	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  00040	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00043	83 c0 01	 add	 eax, 1
  00046	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00049	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0004c	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0004f	0f 8d 44 01 00
	00		 jge	 $LN3@render_3d_

; 1393 : 	{
; 1394 : 
; 1395 : 		real_colour
; 1396 : 			this_colour;
; 1397 : 
; 1398 : 		this_point = terrain_3d_sector_point_word_references[count].point;

  00055	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00058	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_sector_point_word_references@@3PAUTERRAIN_3D_POINT_WORD_REFERENCE@@A ; terrain_3d_sector_point_word_references
  0005e	0f b7 14 41	 movzx	 edx, WORD PTR [ecx+eax*2]
  00062	89 55 f8	 mov	 DWORD PTR _this_point$[ebp], edx

; 1399 : 
; 1400 : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  00065	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00068	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  00070	89 4d f4	 mov	 DWORD PTR _normal_index$[ebp], ecx

; 1401 : 	
; 1402 : 		destination_vertices[count].tu = ( current_terrain_points_xz[this_point].x ) * texture_scale;

  00073	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00076	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  0007c	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  00080	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00084	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  00089	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0008c	c1 e0 05	 shl	 eax, 5
  0008f	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00092	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 1403 : 		destination_vertices[count].tv = ( current_terrain_points_xz[this_point].z ) * texture_scale;

  00098	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0009b	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000a1	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  000a6	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000aa	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  000af	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000b2	c1 e0 05	 shl	 eax, 5
  000b5	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000b8	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 1404 : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000be	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000c1	c1 e0 04	 shl	 eax, 4
  000c4	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000c7	c1 e1 05	 shl	 ecx, 5
  000ca	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000cd	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000d3	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 1405 : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000d6	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000d9	c1 e0 04	 shl	 eax, 4
  000dc	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000df	c1 e1 05	 shl	 ecx, 5
  000e2	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000e5	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  000eb	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 1406 : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  000ef	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000f2	c1 e0 04	 shl	 eax, 4
  000f5	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  000fd	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00105	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0010d	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00111	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00114	c1 e1 05	 shl	 ecx, 5
  00117	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0011a	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 1407 : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00120	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00123	c1 e0 04	 shl	 eax, 4
  00126	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00129	c1 e1 05	 shl	 ecx, 5
  0012c	8b 55 f0	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0012f	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00135	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 1408 : 
; 1409 : 		this_colour.red = terrain_3d_transformed_point_normals[normal_index].colour.red;

  00139	8b 45 f4	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0013c	c1 e0 04	 shl	 eax, 4
  0013f	8a 88 0e 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+14]
  00145	88 4d ea	 mov	 BYTE PTR _this_colour$1[ebp+2], cl

; 1410 : 		this_colour.green = terrain_3d_transformed_point_normals[normal_index].colour.green;

  00148	8b 45 f4	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0014b	c1 e0 04	 shl	 eax, 4
  0014e	8a 88 0d 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+13]
  00154	88 4d e9	 mov	 BYTE PTR _this_colour$1[ebp+1], cl

; 1411 : 		this_colour.blue = terrain_3d_transformed_point_normals[normal_index].colour.blue;

  00157	8b 45 f4	 mov	 eax, DWORD PTR _normal_index$[ebp]
  0015a	c1 e0 04	 shl	 eax, 4
  0015d	8a 88 0c 00 00
	00		 mov	 cl, BYTE PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+12]
  00163	88 4d e8	 mov	 BYTE PTR _this_colour$1[ebp], cl

; 1412 : 		this_colour.alpha = transformed_3d_point_colours[this_point].alpha;

  00166	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00169	8a 0c c5 03 00
	00 00		 mov	 cl, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+3]
  00170	88 4d eb	 mov	 BYTE PTR _this_colour$1[ebp+3], cl

; 1413 : 
; 1414 : 		destination_vertices[count].color = this_colour.colour;

  00173	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00176	c1 e0 05	 shl	 eax, 5
  00179	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  0017c	8b 55 e8	 mov	 edx, DWORD PTR _this_colour$1[ebp]
  0017f	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 1415 : 		destination_vertices[count].specular = 0;

  00183	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00186	c1 e0 05	 shl	 eax, 5
  00189	8b 4d f0	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  0018c	c7 44 01 14 00
	00 00 00	 mov	 DWORD PTR [ecx+eax+20], 0

; 1416 : 	}

  00194	e9 a7 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 1417 : 
; 1418 : 	add_terrain_3d_buffered_triangle_fan ( num_points, current_terrain_type_class->texture2 );

  00199	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0019e	8b 48 08	 mov	 ecx, DWORD PTR [eax+8]
  001a1	51		 push	 ecx
  001a2	8b 55 08	 mov	 edx, DWORD PTR _num_points$[ebp]
  001a5	52		 push	 edx
  001a6	e8 00 00 00 00	 call	 ?add_terrain_3d_buffered_triangle_fan@@YGXHPAUSCREEN@@@Z ; add_terrain_3d_buffered_triangle_fan

; 1419 : }

  001ab	5f		 pop	 edi
  001ac	5e		 pop	 esi
  001ad	5b		 pop	 ebx
  001ae	8b e5		 mov	 esp, ebp
  001b0	5d		 pop	 ebp
  001b1	c2 04 00	 ret	 4
?render_3d_terrain_secondary_word_fan@@YGXH@Z ENDP	; render_3d_terrain_secondary_word_fan
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_texture_zy_byte_colour_strip@@YGXH@Z
_TEXT	SEGMENT
_y$1 = -40						; size = 4
_normal_index$2 = -36					; size = 4
_blue$3 = -32						; size = 4
_green$4 = -28						; size = 4
_red$5 = -24						; size = 4
_y_texture_scale$ = -20					; size = 4
_xz_texture_scale$ = -16				; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_texture_zy_byte_colour_strip@@YGXH@Z PROC ; render_3d_terrain_texture_zy_byte_colour_strip, COMDAT

; 1312 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 68	 sub	 esp, 104		; 00000068H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 1313 : 
; 1314 : 	int
; 1315 : 		count,
; 1316 : 		this_point;
; 1317 : 
; 1318 : 	LPD3DTLVERTEX
; 1319 : 		destination_vertices;
; 1320 : 
; 1321 : 	float
; 1322 : 		xz_texture_scale,
; 1323 : 		y_texture_scale;
; 1324 : 
; 1325 : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 1326 : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 ec	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 1327 : 
; 1328 : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00030	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 1329 : 
; 1330 : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 1331 : 
; 1332 : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d c3 01 00
	00		 jge	 $LN3@render_3d_

; 1333 : 	{
; 1334 : 
; 1335 : 		int
; 1336 : 			red,
; 1337 : 			green,
; 1338 : 			blue,
; 1339 : 			normal_index;
; 1340 : 
; 1341 : 		float
; 1342 : 			y;
; 1343 : 	
; 1344 : 		this_point = terrain_3d_sector_point_byte_references[count].point;

  00064	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_point_byte_references@@3PAUTERRAIN_3D_POINT_BYTE_REFERENCE@@A ; terrain_3d_sector_point_byte_references
  00069	03 45 fc	 add	 eax, DWORD PTR _count$[ebp]
  0006c	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  0006f	89 4d f8	 mov	 DWORD PTR _this_point$[ebp], ecx

; 1345 : 	
; 1346 : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00072	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00077	8b 4d f8	 mov	 ecx, DWORD PTR _this_point$[ebp]
  0007a	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  00080	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00084	0f b7 c0	 movzx	 eax, ax
  00087	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0008b	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  00093	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  0009b	f3 0f 11 45 d8	 movss	 DWORD PTR _y$1[ebp], xmm0

; 1347 : 
; 1348 : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].z ) * xz_texture_scale;

  000a0	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000a3	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000a9	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  000ae	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000b2	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000b7	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000ba	c1 e0 05	 shl	 eax, 5
  000bd	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000c0	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 1349 : 		destination_vertices[count].tv = y * y_texture_scale;

  000c6	f3 0f 10 45 d8	 movss	 xmm0, DWORD PTR _y$1[ebp]
  000cb	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000d0	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000d3	c1 e0 05	 shl	 eax, 5
  000d6	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000d9	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 1350 : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000df	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e2	c1 e0 04	 shl	 eax, 4
  000e5	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000e8	c1 e1 05	 shl	 ecx, 5
  000eb	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000ee	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000f4	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 1351 : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000f7	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000fa	c1 e0 04	 shl	 eax, 4
  000fd	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00100	c1 e1 05	 shl	 ecx, 5
  00103	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00106	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0010c	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 1352 : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  00110	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00113	c1 e0 04	 shl	 eax, 4
  00116	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0011e	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00126	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0012e	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00132	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00135	c1 e1 05	 shl	 ecx, 5
  00138	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0013b	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 1353 : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00141	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00144	c1 e0 04	 shl	 eax, 4
  00147	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0014a	c1 e1 05	 shl	 ecx, 5
  0014d	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00150	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00156	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 1354 : 
; 1355 : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  0015a	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0015d	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  00165	89 4d dc	 mov	 DWORD PTR _normal_index$2[ebp], ecx

; 1356 : 
; 1357 : 		asm_convert_float_to_int ( ( current_terrain_type_class->red * terrain_3d_transformed_point_normals[normal_index].r ), &red );

  00168	8d 45 e8	 lea	 eax, DWORD PTR _red$5[ebp]
  0016b	50		 push	 eax
  0016c	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  00172	0f b6 51 0c	 movzx	 edx, BYTE PTR [ecx+12]
  00176	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  0017a	8b 45 dc	 mov	 eax, DWORD PTR _normal_index$2[ebp]
  0017d	c1 e0 04	 shl	 eax, 4
  00180	f3 0f 59 80 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax]
  00188	51		 push	 ecx
  00189	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0018e	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 1358 : 		asm_convert_float_to_int ( ( current_terrain_type_class->green * terrain_3d_transformed_point_normals[normal_index].g ), &green );

  00193	8d 45 e4	 lea	 eax, DWORD PTR _green$4[ebp]
  00196	50		 push	 eax
  00197	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0019d	0f b6 51 0d	 movzx	 edx, BYTE PTR [ecx+13]
  001a1	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  001a5	8b 45 dc	 mov	 eax, DWORD PTR _normal_index$2[ebp]
  001a8	c1 e0 04	 shl	 eax, 4
  001ab	f3 0f 59 80 04
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+4]
  001b3	51		 push	 ecx
  001b4	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001b9	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 1359 : 		asm_convert_float_to_int ( ( current_terrain_type_class->blue * terrain_3d_transformed_point_normals[normal_index].b ), &blue );

  001be	8d 45 e0	 lea	 eax, DWORD PTR _blue$3[ebp]
  001c1	50		 push	 eax
  001c2	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001c8	0f b6 51 0e	 movzx	 edx, BYTE PTR [ecx+14]
  001cc	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  001d0	8b 45 dc	 mov	 eax, DWORD PTR _normal_index$2[ebp]
  001d3	c1 e0 04	 shl	 eax, 4
  001d6	f3 0f 59 80 08
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+8]
  001de	51		 push	 ecx
  001df	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001e4	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 1360 : 
; 1361 : 		destination_vertices[count].color = RGB_MAKE ( red, green, blue );

  001e9	8b 45 e8	 mov	 eax, DWORD PTR _red$5[ebp]
  001ec	c1 e0 10	 shl	 eax, 16			; 00000010H
  001ef	8b 4d e4	 mov	 ecx, DWORD PTR _green$4[ebp]
  001f2	c1 e1 08	 shl	 ecx, 8
  001f5	0b c1		 or	 eax, ecx
  001f7	0b 45 e0	 or	 eax, DWORD PTR _blue$3[ebp]
  001fa	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  001fd	c1 e2 05	 shl	 edx, 5
  00200	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00203	89 44 11 10	 mov	 DWORD PTR [ecx+edx+16], eax

; 1362 : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00207	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0020a	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  00212	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00215	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  00218	c1 e2 05	 shl	 edx, 5
  0021b	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  0021e	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 1363 : 	}

  00222	e9 28 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 1364 : 
; 1365 : 	draw_strip_primitive ( num_points, destination_vertices );

  00227	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  0022a	50		 push	 eax
  0022b	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  0022e	51		 push	 ecx
  0022f	e8 00 00 00 00	 call	 ?draw_strip_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_strip_primitive

; 1366 : }

  00234	5f		 pop	 edi
  00235	5e		 pop	 esi
  00236	5b		 pop	 ebx
  00237	8b e5		 mov	 esp, ebp
  00239	5d		 pop	 ebp
  0023a	c2 04 00	 ret	 4
?render_3d_terrain_texture_zy_byte_colour_strip@@YGXH@Z ENDP ; render_3d_terrain_texture_zy_byte_colour_strip
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_texture_zy_word_colour_strip@@YGXH@Z
_TEXT	SEGMENT
_y$1 = -40						; size = 4
_normal_index$2 = -36					; size = 4
_blue$3 = -32						; size = 4
_green$4 = -28						; size = 4
_red$5 = -24						; size = 4
_y_texture_scale$ = -20					; size = 4
_xz_texture_scale$ = -16				; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_texture_zy_word_colour_strip@@YGXH@Z PROC ; render_3d_terrain_texture_zy_word_colour_strip, COMDAT

; 1251 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 68	 sub	 esp, 104		; 00000068H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 1252 : 
; 1253 : 	int
; 1254 : 		count,
; 1255 : 		this_point;
; 1256 : 
; 1257 : 	LPD3DTLVERTEX
; 1258 : 		destination_vertices;
; 1259 : 
; 1260 : 	float
; 1261 : 		xz_texture_scale,
; 1262 : 		y_texture_scale;
; 1263 : 
; 1264 : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 1265 : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 ec	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 1266 : 
; 1267 : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00030	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 1268 : 
; 1269 : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 1270 : 
; 1271 : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d c5 01 00
	00		 jge	 $LN3@render_3d_

; 1272 : 	{
; 1273 : 
; 1274 : 		int
; 1275 : 			red,
; 1276 : 			green,
; 1277 : 			blue,
; 1278 : 			normal_index;
; 1279 : 
; 1280 : 		float
; 1281 : 			y;
; 1282 : 	
; 1283 : 		this_point = terrain_3d_sector_point_word_references[count].point;

  00064	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00067	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_sector_point_word_references@@3PAUTERRAIN_3D_POINT_WORD_REFERENCE@@A ; terrain_3d_sector_point_word_references
  0006d	0f b7 14 41	 movzx	 edx, WORD PTR [ecx+eax*2]
  00071	89 55 f8	 mov	 DWORD PTR _this_point$[ebp], edx

; 1284 : 	
; 1285 : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00074	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00079	8b 4d f8	 mov	 ecx, DWORD PTR _this_point$[ebp]
  0007c	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  00082	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00086	0f b7 c0	 movzx	 eax, ax
  00089	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0008d	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  00095	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  0009d	f3 0f 11 45 d8	 movss	 DWORD PTR _y$1[ebp], xmm0

; 1286 : 
; 1287 : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].z ) * xz_texture_scale;

  000a2	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000a5	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000ab	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  000b0	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000b4	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000b9	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000bc	c1 e0 05	 shl	 eax, 5
  000bf	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000c2	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 1288 : 		destination_vertices[count].tv = y * y_texture_scale;

  000c8	f3 0f 10 45 d8	 movss	 xmm0, DWORD PTR _y$1[ebp]
  000cd	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000d2	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000d5	c1 e0 05	 shl	 eax, 5
  000d8	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000db	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 1289 : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000e1	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e4	c1 e0 04	 shl	 eax, 4
  000e7	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000ea	c1 e1 05	 shl	 ecx, 5
  000ed	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000f0	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000f6	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 1290 : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000f9	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000fc	c1 e0 04	 shl	 eax, 4
  000ff	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00102	c1 e1 05	 shl	 ecx, 5
  00105	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00108	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0010e	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 1291 : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  00112	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00115	c1 e0 04	 shl	 eax, 4
  00118	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00120	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00128	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  00130	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00134	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00137	c1 e1 05	 shl	 ecx, 5
  0013a	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0013d	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 1292 : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00143	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00146	c1 e0 04	 shl	 eax, 4
  00149	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0014c	c1 e1 05	 shl	 ecx, 5
  0014f	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00152	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00158	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 1293 : 
; 1294 : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  0015c	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0015f	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  00167	89 4d dc	 mov	 DWORD PTR _normal_index$2[ebp], ecx

; 1295 : 
; 1296 : 		asm_convert_float_to_int ( ( current_terrain_type_class->red * terrain_3d_transformed_point_normals[normal_index].r ), &red );

  0016a	8d 45 e8	 lea	 eax, DWORD PTR _red$5[ebp]
  0016d	50		 push	 eax
  0016e	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  00174	0f b6 51 0c	 movzx	 edx, BYTE PTR [ecx+12]
  00178	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  0017c	8b 45 dc	 mov	 eax, DWORD PTR _normal_index$2[ebp]
  0017f	c1 e0 04	 shl	 eax, 4
  00182	f3 0f 59 80 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax]
  0018a	51		 push	 ecx
  0018b	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00190	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 1297 : 		asm_convert_float_to_int ( ( current_terrain_type_class->green * terrain_3d_transformed_point_normals[normal_index].g ), &green );

  00195	8d 45 e4	 lea	 eax, DWORD PTR _green$4[ebp]
  00198	50		 push	 eax
  00199	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0019f	0f b6 51 0d	 movzx	 edx, BYTE PTR [ecx+13]
  001a3	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  001a7	8b 45 dc	 mov	 eax, DWORD PTR _normal_index$2[ebp]
  001aa	c1 e0 04	 shl	 eax, 4
  001ad	f3 0f 59 80 04
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+4]
  001b5	51		 push	 ecx
  001b6	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001bb	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 1298 : 		asm_convert_float_to_int ( ( current_terrain_type_class->blue * terrain_3d_transformed_point_normals[normal_index].b ), &blue );

  001c0	8d 45 e0	 lea	 eax, DWORD PTR _blue$3[ebp]
  001c3	50		 push	 eax
  001c4	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001ca	0f b6 51 0e	 movzx	 edx, BYTE PTR [ecx+14]
  001ce	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  001d2	8b 45 dc	 mov	 eax, DWORD PTR _normal_index$2[ebp]
  001d5	c1 e0 04	 shl	 eax, 4
  001d8	f3 0f 59 80 08
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+8]
  001e0	51		 push	 ecx
  001e1	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001e6	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 1299 : 
; 1300 : 		destination_vertices[count].color = RGB_MAKE ( red, green, blue );

  001eb	8b 45 e8	 mov	 eax, DWORD PTR _red$5[ebp]
  001ee	c1 e0 10	 shl	 eax, 16			; 00000010H
  001f1	8b 4d e4	 mov	 ecx, DWORD PTR _green$4[ebp]
  001f4	c1 e1 08	 shl	 ecx, 8
  001f7	0b c1		 or	 eax, ecx
  001f9	0b 45 e0	 or	 eax, DWORD PTR _blue$3[ebp]
  001fc	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  001ff	c1 e2 05	 shl	 edx, 5
  00202	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00205	89 44 11 10	 mov	 DWORD PTR [ecx+edx+16], eax

; 1301 : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00209	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0020c	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  00214	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00217	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  0021a	c1 e2 05	 shl	 edx, 5
  0021d	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00220	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 1302 : 	}

  00224	e9 26 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 1303 : 
; 1304 : 	draw_strip_primitive ( num_points, destination_vertices );

  00229	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  0022c	50		 push	 eax
  0022d	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  00230	51		 push	 ecx
  00231	e8 00 00 00 00	 call	 ?draw_strip_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_strip_primitive

; 1305 : }

  00236	5f		 pop	 edi
  00237	5e		 pop	 esi
  00238	5b		 pop	 ebx
  00239	8b e5		 mov	 esp, ebp
  0023b	5d		 pop	 ebp
  0023c	c2 04 00	 ret	 4
?render_3d_terrain_texture_zy_word_colour_strip@@YGXH@Z ENDP ; render_3d_terrain_texture_zy_word_colour_strip
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_texture_xy_byte_colour_strip@@YGXH@Z
_TEXT	SEGMENT
_y$1 = -40						; size = 4
_normal_index$2 = -36					; size = 4
_blue$3 = -32						; size = 4
_green$4 = -28						; size = 4
_red$5 = -24						; size = 4
_y_texture_scale$ = -20					; size = 4
_xz_texture_scale$ = -16				; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_texture_xy_byte_colour_strip@@YGXH@Z PROC ; render_3d_terrain_texture_xy_byte_colour_strip, COMDAT

; 1186 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 68	 sub	 esp, 104		; 00000068H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 1187 : 
; 1188 : 	int
; 1189 : 		count,
; 1190 : 		this_point;
; 1191 : 
; 1192 : 	LPD3DTLVERTEX
; 1193 : 		destination_vertices;
; 1194 : 
; 1195 : 	float
; 1196 : 		xz_texture_scale,
; 1197 : 		y_texture_scale;
; 1198 : 
; 1199 : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 1200 : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 ec	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 1201 : 
; 1202 : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00030	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 1203 : 
; 1204 : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 1205 : 
; 1206 : 	//
; 1207 : 	// Always do 3 points in a face, cos they're guaranteed
; 1208 : 	//
; 1209 : 
; 1210 : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d c2 01 00
	00		 jge	 $LN3@render_3d_

; 1211 : 	{
; 1212 : 
; 1213 : 		int
; 1214 : 			red,
; 1215 : 			green,
; 1216 : 			blue,
; 1217 : 			normal_index;
; 1218 : 
; 1219 : 		float
; 1220 : 			y;
; 1221 : 	
; 1222 : 		this_point = terrain_3d_sector_point_byte_references[count].point;

  00064	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_point_byte_references@@3PAUTERRAIN_3D_POINT_BYTE_REFERENCE@@A ; terrain_3d_sector_point_byte_references
  00069	03 45 fc	 add	 eax, DWORD PTR _count$[ebp]
  0006c	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  0006f	89 4d f8	 mov	 DWORD PTR _this_point$[ebp], ecx

; 1223 : 	
; 1224 : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00072	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00077	8b 4d f8	 mov	 ecx, DWORD PTR _this_point$[ebp]
  0007a	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  00080	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00084	0f b7 c0	 movzx	 eax, ax
  00087	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0008b	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  00093	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  0009b	f3 0f 11 45 d8	 movss	 DWORD PTR _y$1[ebp], xmm0

; 1225 : 
; 1226 : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].x ) * xz_texture_scale;

  000a0	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000a3	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000a9	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  000ad	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000b1	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000b6	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000b9	c1 e0 05	 shl	 eax, 5
  000bc	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000bf	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 1227 : 		destination_vertices[count].tv = y * y_texture_scale;

  000c5	f3 0f 10 45 d8	 movss	 xmm0, DWORD PTR _y$1[ebp]
  000ca	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000cf	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000d2	c1 e0 05	 shl	 eax, 5
  000d5	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000d8	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 1228 : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000de	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e1	c1 e0 04	 shl	 eax, 4
  000e4	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000e7	c1 e1 05	 shl	 ecx, 5
  000ea	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000ed	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000f3	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 1229 : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000f6	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000f9	c1 e0 04	 shl	 eax, 4
  000fc	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000ff	c1 e1 05	 shl	 ecx, 5
  00102	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00105	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0010b	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 1230 : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  0010f	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00112	c1 e0 04	 shl	 eax, 4
  00115	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0011d	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00125	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0012d	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00131	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00134	c1 e1 05	 shl	 ecx, 5
  00137	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0013a	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 1231 : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00140	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00143	c1 e0 04	 shl	 eax, 4
  00146	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00149	c1 e1 05	 shl	 ecx, 5
  0014c	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0014f	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00155	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 1232 : 
; 1233 : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  00159	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0015c	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  00164	89 4d dc	 mov	 DWORD PTR _normal_index$2[ebp], ecx

; 1234 : 
; 1235 : 		asm_convert_float_to_int ( ( current_terrain_type_class->red * terrain_3d_transformed_point_normals[normal_index].r ), &red );

  00167	8d 45 e8	 lea	 eax, DWORD PTR _red$5[ebp]
  0016a	50		 push	 eax
  0016b	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  00171	0f b6 51 0c	 movzx	 edx, BYTE PTR [ecx+12]
  00175	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00179	8b 45 dc	 mov	 eax, DWORD PTR _normal_index$2[ebp]
  0017c	c1 e0 04	 shl	 eax, 4
  0017f	f3 0f 59 80 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax]
  00187	51		 push	 ecx
  00188	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0018d	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 1236 : 		asm_convert_float_to_int ( ( current_terrain_type_class->green * terrain_3d_transformed_point_normals[normal_index].g ), &green );

  00192	8d 45 e4	 lea	 eax, DWORD PTR _green$4[ebp]
  00195	50		 push	 eax
  00196	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0019c	0f b6 51 0d	 movzx	 edx, BYTE PTR [ecx+13]
  001a0	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  001a4	8b 45 dc	 mov	 eax, DWORD PTR _normal_index$2[ebp]
  001a7	c1 e0 04	 shl	 eax, 4
  001aa	f3 0f 59 80 04
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+4]
  001b2	51		 push	 ecx
  001b3	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001b8	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 1237 : 		asm_convert_float_to_int ( ( current_terrain_type_class->blue * terrain_3d_transformed_point_normals[normal_index].b ), &blue );

  001bd	8d 45 e0	 lea	 eax, DWORD PTR _blue$3[ebp]
  001c0	50		 push	 eax
  001c1	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001c7	0f b6 51 0e	 movzx	 edx, BYTE PTR [ecx+14]
  001cb	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  001cf	8b 45 dc	 mov	 eax, DWORD PTR _normal_index$2[ebp]
  001d2	c1 e0 04	 shl	 eax, 4
  001d5	f3 0f 59 80 08
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+8]
  001dd	51		 push	 ecx
  001de	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001e3	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 1238 : 
; 1239 : 		destination_vertices[count].color = RGB_MAKE ( red, green, blue );

  001e8	8b 45 e8	 mov	 eax, DWORD PTR _red$5[ebp]
  001eb	c1 e0 10	 shl	 eax, 16			; 00000010H
  001ee	8b 4d e4	 mov	 ecx, DWORD PTR _green$4[ebp]
  001f1	c1 e1 08	 shl	 ecx, 8
  001f4	0b c1		 or	 eax, ecx
  001f6	0b 45 e0	 or	 eax, DWORD PTR _blue$3[ebp]
  001f9	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  001fc	c1 e2 05	 shl	 edx, 5
  001ff	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00202	89 44 11 10	 mov	 DWORD PTR [ecx+edx+16], eax

; 1240 : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00206	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00209	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  00211	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00214	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  00217	c1 e2 05	 shl	 edx, 5
  0021a	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  0021d	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 1241 : 	}

  00221	e9 29 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 1242 : 
; 1243 : 	draw_strip_primitive ( num_points, destination_vertices );

  00226	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00229	50		 push	 eax
  0022a	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  0022d	51		 push	 ecx
  0022e	e8 00 00 00 00	 call	 ?draw_strip_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_strip_primitive

; 1244 : }

  00233	5f		 pop	 edi
  00234	5e		 pop	 esi
  00235	5b		 pop	 ebx
  00236	8b e5		 mov	 esp, ebp
  00238	5d		 pop	 ebp
  00239	c2 04 00	 ret	 4
?render_3d_terrain_texture_xy_byte_colour_strip@@YGXH@Z ENDP ; render_3d_terrain_texture_xy_byte_colour_strip
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_texture_xy_word_colour_strip@@YGXH@Z
_TEXT	SEGMENT
_normal_index$1 = -40					; size = 4
_blue$2 = -36						; size = 4
_green$3 = -32						; size = 4
_red$4 = -28						; size = 4
_y$5 = -24						; size = 4
_y_texture_scale$ = -20					; size = 4
_xz_texture_scale$ = -16				; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_texture_xy_word_colour_strip@@YGXH@Z PROC ; render_3d_terrain_texture_xy_word_colour_strip, COMDAT

; 1123 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 68	 sub	 esp, 104		; 00000068H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 1124 : 
; 1125 : 	int
; 1126 : 		count,
; 1127 : 		this_point;
; 1128 : 
; 1129 : 	LPD3DTLVERTEX
; 1130 : 		destination_vertices;
; 1131 : 
; 1132 : 	float
; 1133 : 		xz_texture_scale,
; 1134 : 		y_texture_scale;
; 1135 : 
; 1136 : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 1137 : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 ec	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 1138 : 
; 1139 : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00030	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 1140 : 
; 1141 : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 1142 : 
; 1143 : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d f6 01 00
	00		 jge	 $LN3@render_3d_

; 1144 : 	{
; 1145 : 
; 1146 : 		float
; 1147 : 			y;
; 1148 : 
; 1149 : 		int
; 1150 : 			red,
; 1151 : 			green,
; 1152 : 			blue,
; 1153 : 			normal_index;
; 1154 : 	
; 1155 : 		this_point = terrain_3d_sector_point_word_references[count].point;

  00064	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00067	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_sector_point_word_references@@3PAUTERRAIN_3D_POINT_WORD_REFERENCE@@A ; terrain_3d_sector_point_word_references
  0006d	0f b7 14 41	 movzx	 edx, WORD PTR [ecx+eax*2]
  00071	89 55 f8	 mov	 DWORD PTR _this_point$[ebp], edx

; 1156 : 	
; 1157 : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00074	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00079	8b 4d f8	 mov	 ecx, DWORD PTR _this_point$[ebp]
  0007c	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  00082	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00086	0f b7 c0	 movzx	 eax, ax
  00089	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0008d	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  00095	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  0009d	f3 0f 11 45 e8	 movss	 DWORD PTR _y$5[ebp], xmm0

; 1158 : 
; 1159 : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].x ) * xz_texture_scale;

  000a2	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000a5	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000ab	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  000af	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000b3	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000b8	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000bb	c1 e0 05	 shl	 eax, 5
  000be	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000c1	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 1160 : 		destination_vertices[count].tv = y * y_texture_scale;

  000c7	f3 0f 10 45 e8	 movss	 xmm0, DWORD PTR _y$5[ebp]
  000cc	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000d1	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000d4	c1 e0 05	 shl	 eax, 5
  000d7	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000da	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 1161 : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000e0	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e3	c1 e0 04	 shl	 eax, 4
  000e6	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000e9	c1 e1 05	 shl	 ecx, 5
  000ec	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000ef	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000f5	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 1162 : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000f8	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000fb	c1 e0 04	 shl	 eax, 4
  000fe	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00101	c1 e1 05	 shl	 ecx, 5
  00104	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00107	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0010d	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 1163 : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  00111	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00114	c1 e0 04	 shl	 eax, 4
  00117	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0011f	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00127	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0012f	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00133	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00136	c1 e1 05	 shl	 ecx, 5
  00139	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0013c	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 1164 : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00142	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00145	c1 e0 04	 shl	 eax, 4
  00148	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0014b	c1 e1 05	 shl	 ecx, 5
  0014e	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00151	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00157	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 1165 : 		destination_vertices[count].color = transformed_3d_point_colours[this_point].colour;

  0015b	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0015e	c1 e0 05	 shl	 eax, 5
  00161	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00164	8b 55 f8	 mov	 edx, DWORD PTR _this_point$[ebp]
  00167	8b 14 d5 00 00
	00 00		 mov	 edx, DWORD PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[edx*8]
  0016e	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 1166 : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00172	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00175	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  0017d	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00180	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  00183	c1 e2 05	 shl	 edx, 5
  00186	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00189	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 1167 : 
; 1168 : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  0018d	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00190	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  00198	89 4d d8	 mov	 DWORD PTR _normal_index$1[ebp], ecx

; 1169 : 
; 1170 : 		asm_convert_float_to_int ( ( current_terrain_type_class->red * terrain_3d_transformed_point_normals[normal_index].r ), &red );

  0019b	8d 45 e4	 lea	 eax, DWORD PTR _red$4[ebp]
  0019e	50		 push	 eax
  0019f	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001a5	0f b6 51 0c	 movzx	 edx, BYTE PTR [ecx+12]
  001a9	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  001ad	8b 45 d8	 mov	 eax, DWORD PTR _normal_index$1[ebp]
  001b0	c1 e0 04	 shl	 eax, 4
  001b3	f3 0f 59 80 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax]
  001bb	51		 push	 ecx
  001bc	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001c1	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 1171 : 		asm_convert_float_to_int ( ( current_terrain_type_class->green * terrain_3d_transformed_point_normals[normal_index].g ), &green );

  001c6	8d 45 e0	 lea	 eax, DWORD PTR _green$3[ebp]
  001c9	50		 push	 eax
  001ca	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001d0	0f b6 51 0d	 movzx	 edx, BYTE PTR [ecx+13]
  001d4	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  001d8	8b 45 d8	 mov	 eax, DWORD PTR _normal_index$1[ebp]
  001db	c1 e0 04	 shl	 eax, 4
  001de	f3 0f 59 80 04
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+4]
  001e6	51		 push	 ecx
  001e7	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001ec	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 1172 : 		asm_convert_float_to_int ( ( current_terrain_type_class->blue * terrain_3d_transformed_point_normals[normal_index].b ), &blue );

  001f1	8d 45 dc	 lea	 eax, DWORD PTR _blue$2[ebp]
  001f4	50		 push	 eax
  001f5	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001fb	0f b6 51 0e	 movzx	 edx, BYTE PTR [ecx+14]
  001ff	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00203	8b 45 d8	 mov	 eax, DWORD PTR _normal_index$1[ebp]
  00206	c1 e0 04	 shl	 eax, 4
  00209	f3 0f 59 80 08
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+8]
  00211	51		 push	 ecx
  00212	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00217	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 1173 : 
; 1174 : 		destination_vertices[count].color = RGB_MAKE ( red, green, blue );

  0021c	8b 45 e4	 mov	 eax, DWORD PTR _red$4[ebp]
  0021f	c1 e0 10	 shl	 eax, 16			; 00000010H
  00222	8b 4d e0	 mov	 ecx, DWORD PTR _green$3[ebp]
  00225	c1 e1 08	 shl	 ecx, 8
  00228	0b c1		 or	 eax, ecx
  0022a	0b 45 dc	 or	 eax, DWORD PTR _blue$2[ebp]
  0022d	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  00230	c1 e2 05	 shl	 edx, 5
  00233	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00236	89 44 11 10	 mov	 DWORD PTR [ecx+edx+16], eax

; 1175 : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  0023a	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0023d	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  00245	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00248	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  0024b	c1 e2 05	 shl	 edx, 5
  0024e	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00251	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 1176 : 	}

  00255	e9 f5 fd ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 1177 : 
; 1178 : 	draw_strip_primitive ( num_points, destination_vertices );

  0025a	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  0025d	50		 push	 eax
  0025e	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  00261	51		 push	 ecx
  00262	e8 00 00 00 00	 call	 ?draw_strip_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_strip_primitive

; 1179 : }

  00267	5f		 pop	 edi
  00268	5e		 pop	 esi
  00269	5b		 pop	 ebx
  0026a	8b e5		 mov	 esp, ebp
  0026c	5d		 pop	 ebp
  0026d	c2 04 00	 ret	 4
?render_3d_terrain_texture_xy_word_colour_strip@@YGXH@Z ENDP ; render_3d_terrain_texture_xy_word_colour_strip
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_texture_zy_byte_colour_fan@@YGXH@Z
_TEXT	SEGMENT
_y$1 = -40						; size = 4
_normal_index$2 = -36					; size = 4
_blue$3 = -32						; size = 4
_green$4 = -28						; size = 4
_red$5 = -24						; size = 4
_y_texture_scale$ = -20					; size = 4
_xz_texture_scale$ = -16				; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_texture_zy_byte_colour_fan@@YGXH@Z PROC ; render_3d_terrain_texture_zy_byte_colour_fan, COMDAT

; 1062 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 68	 sub	 esp, 104		; 00000068H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 1063 : 
; 1064 : 	int
; 1065 : 		count,
; 1066 : 		this_point;
; 1067 : 
; 1068 : 	LPD3DTLVERTEX
; 1069 : 		destination_vertices;
; 1070 : 
; 1071 : 	float
; 1072 : 		xz_texture_scale,
; 1073 : 		y_texture_scale;
; 1074 : 
; 1075 : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 1076 : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 ec	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 1077 : 
; 1078 : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00030	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 1079 : 
; 1080 : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 1081 : 
; 1082 : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d c3 01 00
	00		 jge	 $LN3@render_3d_

; 1083 : 	{
; 1084 : 
; 1085 : 		int
; 1086 : 			red,
; 1087 : 			green,
; 1088 : 			blue,
; 1089 : 			normal_index;
; 1090 : 
; 1091 : 		float
; 1092 : 			y;
; 1093 : 	
; 1094 : 		this_point = terrain_3d_sector_point_byte_references[count].point;

  00064	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_point_byte_references@@3PAUTERRAIN_3D_POINT_BYTE_REFERENCE@@A ; terrain_3d_sector_point_byte_references
  00069	03 45 fc	 add	 eax, DWORD PTR _count$[ebp]
  0006c	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  0006f	89 4d f8	 mov	 DWORD PTR _this_point$[ebp], ecx

; 1095 : 	
; 1096 : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00072	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00077	8b 4d f8	 mov	 ecx, DWORD PTR _this_point$[ebp]
  0007a	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  00080	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00084	0f b7 c0	 movzx	 eax, ax
  00087	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0008b	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  00093	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  0009b	f3 0f 11 45 d8	 movss	 DWORD PTR _y$1[ebp], xmm0

; 1097 : 
; 1098 : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].z ) * xz_texture_scale;

  000a0	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000a3	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000a9	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  000ae	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000b2	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000b7	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000ba	c1 e0 05	 shl	 eax, 5
  000bd	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000c0	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 1099 : 		destination_vertices[count].tv = y * y_texture_scale;

  000c6	f3 0f 10 45 d8	 movss	 xmm0, DWORD PTR _y$1[ebp]
  000cb	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000d0	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000d3	c1 e0 05	 shl	 eax, 5
  000d6	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000d9	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 1100 : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000df	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e2	c1 e0 04	 shl	 eax, 4
  000e5	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000e8	c1 e1 05	 shl	 ecx, 5
  000eb	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000ee	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000f4	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 1101 : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000f7	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000fa	c1 e0 04	 shl	 eax, 4
  000fd	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00100	c1 e1 05	 shl	 ecx, 5
  00103	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00106	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0010c	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 1102 : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  00110	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00113	c1 e0 04	 shl	 eax, 4
  00116	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0011e	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00126	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0012e	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00132	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00135	c1 e1 05	 shl	 ecx, 5
  00138	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0013b	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 1103 : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00141	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00144	c1 e0 04	 shl	 eax, 4
  00147	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0014a	c1 e1 05	 shl	 ecx, 5
  0014d	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00150	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00156	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 1104 : 
; 1105 : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  0015a	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0015d	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  00165	89 4d dc	 mov	 DWORD PTR _normal_index$2[ebp], ecx

; 1106 : 
; 1107 : 		asm_convert_float_to_int ( ( current_terrain_type_class->red * terrain_3d_transformed_point_normals[normal_index].r ), &red );

  00168	8d 45 e8	 lea	 eax, DWORD PTR _red$5[ebp]
  0016b	50		 push	 eax
  0016c	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  00172	0f b6 51 0c	 movzx	 edx, BYTE PTR [ecx+12]
  00176	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  0017a	8b 45 dc	 mov	 eax, DWORD PTR _normal_index$2[ebp]
  0017d	c1 e0 04	 shl	 eax, 4
  00180	f3 0f 59 80 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax]
  00188	51		 push	 ecx
  00189	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0018e	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 1108 : 		asm_convert_float_to_int ( ( current_terrain_type_class->green * terrain_3d_transformed_point_normals[normal_index].g ), &green );

  00193	8d 45 e4	 lea	 eax, DWORD PTR _green$4[ebp]
  00196	50		 push	 eax
  00197	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0019d	0f b6 51 0d	 movzx	 edx, BYTE PTR [ecx+13]
  001a1	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  001a5	8b 45 dc	 mov	 eax, DWORD PTR _normal_index$2[ebp]
  001a8	c1 e0 04	 shl	 eax, 4
  001ab	f3 0f 59 80 04
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+4]
  001b3	51		 push	 ecx
  001b4	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001b9	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 1109 : 		asm_convert_float_to_int ( ( current_terrain_type_class->blue * terrain_3d_transformed_point_normals[normal_index].b ), &blue );

  001be	8d 45 e0	 lea	 eax, DWORD PTR _blue$3[ebp]
  001c1	50		 push	 eax
  001c2	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001c8	0f b6 51 0e	 movzx	 edx, BYTE PTR [ecx+14]
  001cc	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  001d0	8b 45 dc	 mov	 eax, DWORD PTR _normal_index$2[ebp]
  001d3	c1 e0 04	 shl	 eax, 4
  001d6	f3 0f 59 80 08
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+8]
  001de	51		 push	 ecx
  001df	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001e4	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 1110 : 
; 1111 : 		destination_vertices[count].color = RGB_MAKE ( red, green, blue );

  001e9	8b 45 e8	 mov	 eax, DWORD PTR _red$5[ebp]
  001ec	c1 e0 10	 shl	 eax, 16			; 00000010H
  001ef	8b 4d e4	 mov	 ecx, DWORD PTR _green$4[ebp]
  001f2	c1 e1 08	 shl	 ecx, 8
  001f5	0b c1		 or	 eax, ecx
  001f7	0b 45 e0	 or	 eax, DWORD PTR _blue$3[ebp]
  001fa	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  001fd	c1 e2 05	 shl	 edx, 5
  00200	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00203	89 44 11 10	 mov	 DWORD PTR [ecx+edx+16], eax

; 1112 : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00207	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0020a	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  00212	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00215	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  00218	c1 e2 05	 shl	 edx, 5
  0021b	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  0021e	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 1113 : 	}

  00222	e9 28 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 1114 : 
; 1115 : 	draw_fan_primitive ( num_points, destination_vertices );

  00227	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  0022a	50		 push	 eax
  0022b	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  0022e	51		 push	 ecx
  0022f	e8 00 00 00 00	 call	 ?draw_fan_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_fan_primitive

; 1116 : }

  00234	5f		 pop	 edi
  00235	5e		 pop	 esi
  00236	5b		 pop	 ebx
  00237	8b e5		 mov	 esp, ebp
  00239	5d		 pop	 ebp
  0023a	c2 04 00	 ret	 4
?render_3d_terrain_texture_zy_byte_colour_fan@@YGXH@Z ENDP ; render_3d_terrain_texture_zy_byte_colour_fan
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_texture_zy_word_colour_fan@@YGXH@Z
_TEXT	SEGMENT
_y$1 = -40						; size = 4
_normal_index$2 = -36					; size = 4
_blue$3 = -32						; size = 4
_green$4 = -28						; size = 4
_red$5 = -24						; size = 4
_y_texture_scale$ = -20					; size = 4
_xz_texture_scale$ = -16				; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_texture_zy_word_colour_fan@@YGXH@Z PROC ; render_3d_terrain_texture_zy_word_colour_fan, COMDAT

; 1001 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 68	 sub	 esp, 104		; 00000068H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 1002 : 
; 1003 : 	int
; 1004 : 		count,
; 1005 : 		this_point;
; 1006 : 
; 1007 : 	LPD3DTLVERTEX
; 1008 : 		destination_vertices;
; 1009 : 
; 1010 : 	float
; 1011 : 		xz_texture_scale,
; 1012 : 		y_texture_scale;
; 1013 : 
; 1014 : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 1015 : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 ec	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 1016 : 
; 1017 : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00030	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 1018 : 
; 1019 : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 1020 : 
; 1021 : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d c5 01 00
	00		 jge	 $LN3@render_3d_

; 1022 : 	{
; 1023 : 
; 1024 : 		int
; 1025 : 			red,
; 1026 : 			green,
; 1027 : 			blue,
; 1028 : 			normal_index;
; 1029 : 
; 1030 : 		float
; 1031 : 			y;
; 1032 : 	
; 1033 : 		this_point = terrain_3d_sector_point_word_references[count].point;

  00064	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00067	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_sector_point_word_references@@3PAUTERRAIN_3D_POINT_WORD_REFERENCE@@A ; terrain_3d_sector_point_word_references
  0006d	0f b7 14 41	 movzx	 edx, WORD PTR [ecx+eax*2]
  00071	89 55 f8	 mov	 DWORD PTR _this_point$[ebp], edx

; 1034 : 	
; 1035 : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00074	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00079	8b 4d f8	 mov	 ecx, DWORD PTR _this_point$[ebp]
  0007c	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  00082	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00086	0f b7 c0	 movzx	 eax, ax
  00089	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0008d	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  00095	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  0009d	f3 0f 11 45 d8	 movss	 DWORD PTR _y$1[ebp], xmm0

; 1036 : 
; 1037 : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].z ) * xz_texture_scale;

  000a2	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000a5	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000ab	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  000b0	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000b4	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000b9	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000bc	c1 e0 05	 shl	 eax, 5
  000bf	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000c2	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 1038 : 		destination_vertices[count].tv = y * y_texture_scale;

  000c8	f3 0f 10 45 d8	 movss	 xmm0, DWORD PTR _y$1[ebp]
  000cd	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000d2	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000d5	c1 e0 05	 shl	 eax, 5
  000d8	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000db	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 1039 : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000e1	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e4	c1 e0 04	 shl	 eax, 4
  000e7	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000ea	c1 e1 05	 shl	 ecx, 5
  000ed	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000f0	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000f6	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 1040 : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000f9	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000fc	c1 e0 04	 shl	 eax, 4
  000ff	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00102	c1 e1 05	 shl	 ecx, 5
  00105	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00108	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0010e	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 1041 : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  00112	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00115	c1 e0 04	 shl	 eax, 4
  00118	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00120	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00128	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  00130	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00134	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00137	c1 e1 05	 shl	 ecx, 5
  0013a	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0013d	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 1042 : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00143	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00146	c1 e0 04	 shl	 eax, 4
  00149	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0014c	c1 e1 05	 shl	 ecx, 5
  0014f	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00152	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00158	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 1043 : 
; 1044 : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  0015c	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0015f	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  00167	89 4d dc	 mov	 DWORD PTR _normal_index$2[ebp], ecx

; 1045 : 
; 1046 : 		asm_convert_float_to_int ( ( current_terrain_type_class->red * terrain_3d_transformed_point_normals[normal_index].r ), &red );

  0016a	8d 45 e8	 lea	 eax, DWORD PTR _red$5[ebp]
  0016d	50		 push	 eax
  0016e	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  00174	0f b6 51 0c	 movzx	 edx, BYTE PTR [ecx+12]
  00178	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  0017c	8b 45 dc	 mov	 eax, DWORD PTR _normal_index$2[ebp]
  0017f	c1 e0 04	 shl	 eax, 4
  00182	f3 0f 59 80 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax]
  0018a	51		 push	 ecx
  0018b	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00190	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 1047 : 		asm_convert_float_to_int ( ( current_terrain_type_class->green * terrain_3d_transformed_point_normals[normal_index].g ), &green );

  00195	8d 45 e4	 lea	 eax, DWORD PTR _green$4[ebp]
  00198	50		 push	 eax
  00199	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0019f	0f b6 51 0d	 movzx	 edx, BYTE PTR [ecx+13]
  001a3	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  001a7	8b 45 dc	 mov	 eax, DWORD PTR _normal_index$2[ebp]
  001aa	c1 e0 04	 shl	 eax, 4
  001ad	f3 0f 59 80 04
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+4]
  001b5	51		 push	 ecx
  001b6	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001bb	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 1048 : 		asm_convert_float_to_int ( ( current_terrain_type_class->blue * terrain_3d_transformed_point_normals[normal_index].b ), &blue );

  001c0	8d 45 e0	 lea	 eax, DWORD PTR _blue$3[ebp]
  001c3	50		 push	 eax
  001c4	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001ca	0f b6 51 0e	 movzx	 edx, BYTE PTR [ecx+14]
  001ce	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  001d2	8b 45 dc	 mov	 eax, DWORD PTR _normal_index$2[ebp]
  001d5	c1 e0 04	 shl	 eax, 4
  001d8	f3 0f 59 80 08
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+8]
  001e0	51		 push	 ecx
  001e1	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001e6	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 1049 : 
; 1050 : 		destination_vertices[count].color = RGB_MAKE ( red, green, blue );

  001eb	8b 45 e8	 mov	 eax, DWORD PTR _red$5[ebp]
  001ee	c1 e0 10	 shl	 eax, 16			; 00000010H
  001f1	8b 4d e4	 mov	 ecx, DWORD PTR _green$4[ebp]
  001f4	c1 e1 08	 shl	 ecx, 8
  001f7	0b c1		 or	 eax, ecx
  001f9	0b 45 e0	 or	 eax, DWORD PTR _blue$3[ebp]
  001fc	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  001ff	c1 e2 05	 shl	 edx, 5
  00202	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00205	89 44 11 10	 mov	 DWORD PTR [ecx+edx+16], eax

; 1051 : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00209	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0020c	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  00214	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00217	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  0021a	c1 e2 05	 shl	 edx, 5
  0021d	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00220	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 1052 : 	}

  00224	e9 26 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 1053 : 
; 1054 : 	draw_fan_primitive ( num_points, destination_vertices );

  00229	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  0022c	50		 push	 eax
  0022d	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  00230	51		 push	 ecx
  00231	e8 00 00 00 00	 call	 ?draw_fan_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_fan_primitive

; 1055 : }

  00236	5f		 pop	 edi
  00237	5e		 pop	 esi
  00238	5b		 pop	 ebx
  00239	8b e5		 mov	 esp, ebp
  0023b	5d		 pop	 ebp
  0023c	c2 04 00	 ret	 4
?render_3d_terrain_texture_zy_word_colour_fan@@YGXH@Z ENDP ; render_3d_terrain_texture_zy_word_colour_fan
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_texture_xy_byte_colour_fan@@YGXH@Z
_TEXT	SEGMENT
_y$1 = -40						; size = 4
_normal_index$2 = -36					; size = 4
_blue$3 = -32						; size = 4
_green$4 = -28						; size = 4
_red$5 = -24						; size = 4
_y_texture_scale$ = -20					; size = 4
_xz_texture_scale$ = -16				; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_texture_xy_byte_colour_fan@@YGXH@Z PROC ; render_3d_terrain_texture_xy_byte_colour_fan, COMDAT

; 936  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 68	 sub	 esp, 104		; 00000068H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 937  : 
; 938  : 	int
; 939  : 		count,
; 940  : 		this_point;
; 941  : 
; 942  : 	LPD3DTLVERTEX
; 943  : 		destination_vertices;
; 944  : 
; 945  : 	float
; 946  : 		xz_texture_scale,
; 947  : 		y_texture_scale;
; 948  : 
; 949  : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 950  : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 ec	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 951  : 
; 952  : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00030	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 953  : 
; 954  : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 955  : 
; 956  : 	//
; 957  : 	// Always do 3 points in a face, cos they're guaranteed
; 958  : 	//
; 959  : 
; 960  : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d c2 01 00
	00		 jge	 $LN3@render_3d_

; 961  : 	{
; 962  : 
; 963  : 		int
; 964  : 			red,
; 965  : 			green,
; 966  : 			blue,
; 967  : 			normal_index;
; 968  : 
; 969  : 		float
; 970  : 			y;
; 971  : 	
; 972  : 		this_point = terrain_3d_sector_point_byte_references[count].point;

  00064	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_point_byte_references@@3PAUTERRAIN_3D_POINT_BYTE_REFERENCE@@A ; terrain_3d_sector_point_byte_references
  00069	03 45 fc	 add	 eax, DWORD PTR _count$[ebp]
  0006c	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  0006f	89 4d f8	 mov	 DWORD PTR _this_point$[ebp], ecx

; 973  : 	
; 974  : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00072	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00077	8b 4d f8	 mov	 ecx, DWORD PTR _this_point$[ebp]
  0007a	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  00080	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00084	0f b7 c0	 movzx	 eax, ax
  00087	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0008b	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  00093	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  0009b	f3 0f 11 45 d8	 movss	 DWORD PTR _y$1[ebp], xmm0

; 975  : 
; 976  : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].x ) * xz_texture_scale;

  000a0	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000a3	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000a9	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  000ad	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000b1	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000b6	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000b9	c1 e0 05	 shl	 eax, 5
  000bc	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000bf	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 977  : 		destination_vertices[count].tv = y * y_texture_scale;

  000c5	f3 0f 10 45 d8	 movss	 xmm0, DWORD PTR _y$1[ebp]
  000ca	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000cf	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000d2	c1 e0 05	 shl	 eax, 5
  000d5	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000d8	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 978  : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000de	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e1	c1 e0 04	 shl	 eax, 4
  000e4	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000e7	c1 e1 05	 shl	 ecx, 5
  000ea	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000ed	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000f3	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 979  : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000f6	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000f9	c1 e0 04	 shl	 eax, 4
  000fc	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000ff	c1 e1 05	 shl	 ecx, 5
  00102	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00105	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0010b	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 980  : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  0010f	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00112	c1 e0 04	 shl	 eax, 4
  00115	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0011d	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00125	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0012d	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00131	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00134	c1 e1 05	 shl	 ecx, 5
  00137	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0013a	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 981  : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00140	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00143	c1 e0 04	 shl	 eax, 4
  00146	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00149	c1 e1 05	 shl	 ecx, 5
  0014c	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0014f	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00155	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 982  : 
; 983  : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  00159	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0015c	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  00164	89 4d dc	 mov	 DWORD PTR _normal_index$2[ebp], ecx

; 984  : 
; 985  : 		asm_convert_float_to_int ( ( current_terrain_type_class->red * terrain_3d_transformed_point_normals[normal_index].r ), &red );

  00167	8d 45 e8	 lea	 eax, DWORD PTR _red$5[ebp]
  0016a	50		 push	 eax
  0016b	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  00171	0f b6 51 0c	 movzx	 edx, BYTE PTR [ecx+12]
  00175	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00179	8b 45 dc	 mov	 eax, DWORD PTR _normal_index$2[ebp]
  0017c	c1 e0 04	 shl	 eax, 4
  0017f	f3 0f 59 80 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax]
  00187	51		 push	 ecx
  00188	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0018d	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 986  : 		asm_convert_float_to_int ( ( current_terrain_type_class->green * terrain_3d_transformed_point_normals[normal_index].g ), &green );

  00192	8d 45 e4	 lea	 eax, DWORD PTR _green$4[ebp]
  00195	50		 push	 eax
  00196	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0019c	0f b6 51 0d	 movzx	 edx, BYTE PTR [ecx+13]
  001a0	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  001a4	8b 45 dc	 mov	 eax, DWORD PTR _normal_index$2[ebp]
  001a7	c1 e0 04	 shl	 eax, 4
  001aa	f3 0f 59 80 04
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+4]
  001b2	51		 push	 ecx
  001b3	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001b8	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 987  : 		asm_convert_float_to_int ( ( current_terrain_type_class->blue * terrain_3d_transformed_point_normals[normal_index].b ), &blue );

  001bd	8d 45 e0	 lea	 eax, DWORD PTR _blue$3[ebp]
  001c0	50		 push	 eax
  001c1	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001c7	0f b6 51 0e	 movzx	 edx, BYTE PTR [ecx+14]
  001cb	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  001cf	8b 45 dc	 mov	 eax, DWORD PTR _normal_index$2[ebp]
  001d2	c1 e0 04	 shl	 eax, 4
  001d5	f3 0f 59 80 08
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+8]
  001dd	51		 push	 ecx
  001de	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001e3	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 988  : 
; 989  : 		destination_vertices[count].color = RGB_MAKE ( red, green, blue );

  001e8	8b 45 e8	 mov	 eax, DWORD PTR _red$5[ebp]
  001eb	c1 e0 10	 shl	 eax, 16			; 00000010H
  001ee	8b 4d e4	 mov	 ecx, DWORD PTR _green$4[ebp]
  001f1	c1 e1 08	 shl	 ecx, 8
  001f4	0b c1		 or	 eax, ecx
  001f6	0b 45 e0	 or	 eax, DWORD PTR _blue$3[ebp]
  001f9	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  001fc	c1 e2 05	 shl	 edx, 5
  001ff	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00202	89 44 11 10	 mov	 DWORD PTR [ecx+edx+16], eax

; 990  : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00206	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00209	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  00211	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00214	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  00217	c1 e2 05	 shl	 edx, 5
  0021a	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  0021d	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 991  : 	}

  00221	e9 29 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 992  : 
; 993  : 	draw_fan_primitive ( num_points, destination_vertices );

  00226	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00229	50		 push	 eax
  0022a	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  0022d	51		 push	 ecx
  0022e	e8 00 00 00 00	 call	 ?draw_fan_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_fan_primitive

; 994  : }

  00233	5f		 pop	 edi
  00234	5e		 pop	 esi
  00235	5b		 pop	 ebx
  00236	8b e5		 mov	 esp, ebp
  00238	5d		 pop	 ebp
  00239	c2 04 00	 ret	 4
?render_3d_terrain_texture_xy_byte_colour_fan@@YGXH@Z ENDP ; render_3d_terrain_texture_xy_byte_colour_fan
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_texture_xy_word_colour_fan@@YGXH@Z
_TEXT	SEGMENT
_normal_index$1 = -40					; size = 4
_blue$2 = -36						; size = 4
_green$3 = -32						; size = 4
_red$4 = -28						; size = 4
_y$5 = -24						; size = 4
_y_texture_scale$ = -20					; size = 4
_xz_texture_scale$ = -16				; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_texture_xy_word_colour_fan@@YGXH@Z PROC ; render_3d_terrain_texture_xy_word_colour_fan, COMDAT

; 873  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 68	 sub	 esp, 104		; 00000068H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 874  : 
; 875  : 	int
; 876  : 		count,
; 877  : 		this_point;
; 878  : 
; 879  : 	LPD3DTLVERTEX
; 880  : 		destination_vertices;
; 881  : 
; 882  : 	float
; 883  : 		xz_texture_scale,
; 884  : 		y_texture_scale;
; 885  : 
; 886  : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 887  : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 ec	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 888  : 
; 889  : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00030	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 890  : 
; 891  : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 892  : 
; 893  : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d f6 01 00
	00		 jge	 $LN3@render_3d_

; 894  : 	{
; 895  : 
; 896  : 		float
; 897  : 			y;
; 898  : 
; 899  : 		int
; 900  : 			red,
; 901  : 			green,
; 902  : 			blue,
; 903  : 			normal_index;
; 904  : 	
; 905  : 		this_point = terrain_3d_sector_point_word_references[count].point;

  00064	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00067	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_sector_point_word_references@@3PAUTERRAIN_3D_POINT_WORD_REFERENCE@@A ; terrain_3d_sector_point_word_references
  0006d	0f b7 14 41	 movzx	 edx, WORD PTR [ecx+eax*2]
  00071	89 55 f8	 mov	 DWORD PTR _this_point$[ebp], edx

; 906  : 	
; 907  : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00074	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00079	8b 4d f8	 mov	 ecx, DWORD PTR _this_point$[ebp]
  0007c	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  00082	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00086	0f b7 c0	 movzx	 eax, ax
  00089	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0008d	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  00095	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  0009d	f3 0f 11 45 e8	 movss	 DWORD PTR _y$5[ebp], xmm0

; 908  : 
; 909  : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].x ) * xz_texture_scale;

  000a2	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000a5	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000ab	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  000af	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000b3	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000b8	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000bb	c1 e0 05	 shl	 eax, 5
  000be	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000c1	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 910  : 		destination_vertices[count].tv = y * y_texture_scale;

  000c7	f3 0f 10 45 e8	 movss	 xmm0, DWORD PTR _y$5[ebp]
  000cc	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000d1	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000d4	c1 e0 05	 shl	 eax, 5
  000d7	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000da	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 911  : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000e0	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e3	c1 e0 04	 shl	 eax, 4
  000e6	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000e9	c1 e1 05	 shl	 ecx, 5
  000ec	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000ef	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000f5	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 912  : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000f8	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000fb	c1 e0 04	 shl	 eax, 4
  000fe	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00101	c1 e1 05	 shl	 ecx, 5
  00104	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00107	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0010d	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 913  : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  00111	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00114	c1 e0 04	 shl	 eax, 4
  00117	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0011f	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00127	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0012f	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00133	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00136	c1 e1 05	 shl	 ecx, 5
  00139	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0013c	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 914  : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00142	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00145	c1 e0 04	 shl	 eax, 4
  00148	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0014b	c1 e1 05	 shl	 ecx, 5
  0014e	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00151	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00157	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 915  : 		destination_vertices[count].color = transformed_3d_point_colours[this_point].colour;

  0015b	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0015e	c1 e0 05	 shl	 eax, 5
  00161	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00164	8b 55 f8	 mov	 edx, DWORD PTR _this_point$[ebp]
  00167	8b 14 d5 00 00
	00 00		 mov	 edx, DWORD PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[edx*8]
  0016e	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 916  : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00172	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00175	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  0017d	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00180	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  00183	c1 e2 05	 shl	 edx, 5
  00186	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00189	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 917  : 
; 918  : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  0018d	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00190	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  00198	89 4d d8	 mov	 DWORD PTR _normal_index$1[ebp], ecx

; 919  : 
; 920  : 		asm_convert_float_to_int ( ( current_terrain_type_class->red * terrain_3d_transformed_point_normals[normal_index].r ), &red );

  0019b	8d 45 e4	 lea	 eax, DWORD PTR _red$4[ebp]
  0019e	50		 push	 eax
  0019f	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001a5	0f b6 51 0c	 movzx	 edx, BYTE PTR [ecx+12]
  001a9	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  001ad	8b 45 d8	 mov	 eax, DWORD PTR _normal_index$1[ebp]
  001b0	c1 e0 04	 shl	 eax, 4
  001b3	f3 0f 59 80 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax]
  001bb	51		 push	 ecx
  001bc	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001c1	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 921  : 		asm_convert_float_to_int ( ( current_terrain_type_class->green * terrain_3d_transformed_point_normals[normal_index].g ), &green );

  001c6	8d 45 e0	 lea	 eax, DWORD PTR _green$3[ebp]
  001c9	50		 push	 eax
  001ca	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001d0	0f b6 51 0d	 movzx	 edx, BYTE PTR [ecx+13]
  001d4	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  001d8	8b 45 d8	 mov	 eax, DWORD PTR _normal_index$1[ebp]
  001db	c1 e0 04	 shl	 eax, 4
  001de	f3 0f 59 80 04
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+4]
  001e6	51		 push	 ecx
  001e7	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001ec	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 922  : 		asm_convert_float_to_int ( ( current_terrain_type_class->blue * terrain_3d_transformed_point_normals[normal_index].b ), &blue );

  001f1	8d 45 dc	 lea	 eax, DWORD PTR _blue$2[ebp]
  001f4	50		 push	 eax
  001f5	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001fb	0f b6 51 0e	 movzx	 edx, BYTE PTR [ecx+14]
  001ff	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00203	8b 45 d8	 mov	 eax, DWORD PTR _normal_index$1[ebp]
  00206	c1 e0 04	 shl	 eax, 4
  00209	f3 0f 59 80 08
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+8]
  00211	51		 push	 ecx
  00212	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00217	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 923  : 
; 924  : 		destination_vertices[count].color = RGB_MAKE ( red, green, blue );

  0021c	8b 45 e4	 mov	 eax, DWORD PTR _red$4[ebp]
  0021f	c1 e0 10	 shl	 eax, 16			; 00000010H
  00222	8b 4d e0	 mov	 ecx, DWORD PTR _green$3[ebp]
  00225	c1 e1 08	 shl	 ecx, 8
  00228	0b c1		 or	 eax, ecx
  0022a	0b 45 dc	 or	 eax, DWORD PTR _blue$2[ebp]
  0022d	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  00230	c1 e2 05	 shl	 edx, 5
  00233	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00236	89 44 11 10	 mov	 DWORD PTR [ecx+edx+16], eax

; 925  : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  0023a	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0023d	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  00245	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00248	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  0024b	c1 e2 05	 shl	 edx, 5
  0024e	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00251	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 926  : 	}

  00255	e9 f5 fd ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 927  : 
; 928  : 	draw_fan_primitive ( num_points, destination_vertices );

  0025a	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  0025d	50		 push	 eax
  0025e	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  00261	51		 push	 ecx
  00262	e8 00 00 00 00	 call	 ?draw_fan_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_fan_primitive

; 929  : }

  00267	5f		 pop	 edi
  00268	5e		 pop	 esi
  00269	5b		 pop	 ebx
  0026a	8b e5		 mov	 esp, ebp
  0026c	5d		 pop	 ebp
  0026d	c2 04 00	 ret	 4
?render_3d_terrain_texture_xy_word_colour_fan@@YGXH@Z ENDP ; render_3d_terrain_texture_xy_word_colour_fan
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_byte_colour_strip@@YGXH@Z
_TEXT	SEGMENT
_normal_index$1 = -32					; size = 4
_blue$2 = -28						; size = 4
_green$3 = -24						; size = 4
_red$4 = -20						; size = 4
_texture_scale$ = -16					; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_byte_colour_strip@@YGXH@Z PROC	; render_3d_terrain_byte_colour_strip, COMDAT

; 819  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 60	 sub	 esp, 96			; 00000060H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 820  : 
; 821  : 	int
; 822  : 		count,
; 823  : 		this_point;
; 824  : 
; 825  : 	LPD3DTLVERTEX
; 826  : 		destination_vertices;
; 827  : 
; 828  : 	float
; 829  : 		texture_scale;
; 830  : 
; 831  : 	texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _texture_scale$[ebp], xmm0

; 832  : 
; 833  : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00018	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0001b	50		 push	 eax
  0001c	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00021	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 834  : 
; 835  : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00024	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00027	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0002d	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00031	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 836  : 
; 837  : 	for ( count = 0; count < num_points; count++ )

  00037	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0003e	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  00040	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00043	83 c0 01	 add	 eax, 1
  00046	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00049	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0004c	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0004f	0f 8d a1 01 00
	00		 jge	 $LN3@render_3d_

; 838  : 	{
; 839  : 	
; 840  : 		int
; 841  : 			red,
; 842  : 			green,
; 843  : 			blue,
; 844  : 			normal_index;
; 845  : 	
; 846  : 		this_point = terrain_3d_sector_point_byte_references[count].point;

  00055	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_point_byte_references@@3PAUTERRAIN_3D_POINT_BYTE_REFERENCE@@A ; terrain_3d_sector_point_byte_references
  0005a	03 45 fc	 add	 eax, DWORD PTR _count$[ebp]
  0005d	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  00060	89 4d f8	 mov	 DWORD PTR _this_point$[ebp], ecx

; 847  : 	
; 848  : 		destination_vertices[count].tu = ( current_terrain_points_xz[this_point].x ) * texture_scale;

  00063	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00066	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  0006c	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  00070	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00074	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  00079	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0007c	c1 e0 05	 shl	 eax, 5
  0007f	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00082	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 849  : 		destination_vertices[count].tv = ( current_terrain_points_xz[this_point].z ) * texture_scale;

  00088	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0008b	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  00091	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  00096	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  0009a	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  0009f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000a2	c1 e0 05	 shl	 eax, 5
  000a5	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000a8	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 850  : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000ae	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000b1	c1 e0 04	 shl	 eax, 4
  000b4	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000b7	c1 e1 05	 shl	 ecx, 5
  000ba	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000bd	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000c3	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 851  : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000c6	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000c9	c1 e0 04	 shl	 eax, 4
  000cc	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000cf	c1 e1 05	 shl	 ecx, 5
  000d2	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000d5	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  000db	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 852  : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  000df	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e2	c1 e0 04	 shl	 eax, 4
  000e5	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  000ed	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  000f5	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  000fd	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00101	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00104	c1 e1 05	 shl	 ecx, 5
  00107	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0010a	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 853  : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00110	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00113	c1 e0 04	 shl	 eax, 4
  00116	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00119	c1 e1 05	 shl	 ecx, 5
  0011c	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0011f	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00125	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 854  : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00129	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0012c	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  00134	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00137	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  0013a	c1 e2 05	 shl	 edx, 5
  0013d	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00140	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 855  : 
; 856  : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  00144	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00147	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  0014f	89 4d e0	 mov	 DWORD PTR _normal_index$1[ebp], ecx

; 857  : 
; 858  : 		asm_convert_float_to_int ( ( current_terrain_type_class->red * terrain_3d_transformed_point_normals[normal_index].r ), &red );

  00152	8d 45 ec	 lea	 eax, DWORD PTR _red$4[ebp]
  00155	50		 push	 eax
  00156	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0015c	0f b6 51 0c	 movzx	 edx, BYTE PTR [ecx+12]
  00160	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00164	8b 45 e0	 mov	 eax, DWORD PTR _normal_index$1[ebp]
  00167	c1 e0 04	 shl	 eax, 4
  0016a	f3 0f 59 80 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax]
  00172	51		 push	 ecx
  00173	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00178	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 859  : 		asm_convert_float_to_int ( ( current_terrain_type_class->green * terrain_3d_transformed_point_normals[normal_index].g ), &green );

  0017d	8d 45 e8	 lea	 eax, DWORD PTR _green$3[ebp]
  00180	50		 push	 eax
  00181	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  00187	0f b6 51 0d	 movzx	 edx, BYTE PTR [ecx+13]
  0018b	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  0018f	8b 45 e0	 mov	 eax, DWORD PTR _normal_index$1[ebp]
  00192	c1 e0 04	 shl	 eax, 4
  00195	f3 0f 59 80 04
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+4]
  0019d	51		 push	 ecx
  0019e	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001a3	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 860  : 		asm_convert_float_to_int ( ( current_terrain_type_class->blue * terrain_3d_transformed_point_normals[normal_index].b ), &blue );

  001a8	8d 45 e4	 lea	 eax, DWORD PTR _blue$2[ebp]
  001ab	50		 push	 eax
  001ac	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001b2	0f b6 51 0e	 movzx	 edx, BYTE PTR [ecx+14]
  001b6	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  001ba	8b 45 e0	 mov	 eax, DWORD PTR _normal_index$1[ebp]
  001bd	c1 e0 04	 shl	 eax, 4
  001c0	f3 0f 59 80 08
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+8]
  001c8	51		 push	 ecx
  001c9	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001ce	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 861  : 
; 862  : 		destination_vertices[count].color = RGB_MAKE ( red, green, blue );

  001d3	8b 45 ec	 mov	 eax, DWORD PTR _red$4[ebp]
  001d6	c1 e0 10	 shl	 eax, 16			; 00000010H
  001d9	8b 4d e8	 mov	 ecx, DWORD PTR _green$3[ebp]
  001dc	c1 e1 08	 shl	 ecx, 8
  001df	0b c1		 or	 eax, ecx
  001e1	0b 45 e4	 or	 eax, DWORD PTR _blue$2[ebp]
  001e4	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  001e7	c1 e2 05	 shl	 edx, 5
  001ea	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  001ed	89 44 11 10	 mov	 DWORD PTR [ecx+edx+16], eax

; 863  : 	}

  001f1	e9 4a fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 864  : 
; 865  : 	draw_strip_primitive ( num_points, destination_vertices );

  001f6	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  001f9	50		 push	 eax
  001fa	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  001fd	51		 push	 ecx
  001fe	e8 00 00 00 00	 call	 ?draw_strip_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_strip_primitive

; 866  : }

  00203	5f		 pop	 edi
  00204	5e		 pop	 esi
  00205	5b		 pop	 ebx
  00206	8b e5		 mov	 esp, ebp
  00208	5d		 pop	 ebp
  00209	c2 04 00	 ret	 4
?render_3d_terrain_byte_colour_strip@@YGXH@Z ENDP	; render_3d_terrain_byte_colour_strip
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_word_colour_strip@@YGXH@Z
_TEXT	SEGMENT
_normal_index$1 = -32					; size = 4
_blue$2 = -28						; size = 4
_green$3 = -24						; size = 4
_red$4 = -20						; size = 4
_texture_scale$ = -16					; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_word_colour_strip@@YGXH@Z PROC	; render_3d_terrain_word_colour_strip, COMDAT

; 765  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 60	 sub	 esp, 96			; 00000060H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 766  : 
; 767  : 	int
; 768  : 		count,
; 769  : 		this_point;
; 770  : 
; 771  : 	LPD3DTLVERTEX
; 772  : 		destination_vertices;
; 773  : 
; 774  : 	float
; 775  : 		texture_scale;
; 776  : 
; 777  : 	texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _texture_scale$[ebp], xmm0

; 778  : 
; 779  : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00018	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0001b	50		 push	 eax
  0001c	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00021	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 780  : 
; 781  : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00024	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00027	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0002d	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00031	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 782  : 
; 783  : 	for ( count = 0; count < num_points; count++ )

  00037	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0003e	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  00040	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00043	83 c0 01	 add	 eax, 1
  00046	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00049	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0004c	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0004f	0f 8d a3 01 00
	00		 jge	 $LN3@render_3d_

; 784  : 	{
; 785  : 	
; 786  : 		int
; 787  : 			red,
; 788  : 			green,
; 789  : 			blue,
; 790  : 			normal_index;
; 791  : 	
; 792  : 		this_point = terrain_3d_sector_point_word_references[count].point;

  00055	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00058	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_sector_point_word_references@@3PAUTERRAIN_3D_POINT_WORD_REFERENCE@@A ; terrain_3d_sector_point_word_references
  0005e	0f b7 14 41	 movzx	 edx, WORD PTR [ecx+eax*2]
  00062	89 55 f8	 mov	 DWORD PTR _this_point$[ebp], edx

; 793  : 	
; 794  : 		destination_vertices[count].tu = ( current_terrain_points_xz[this_point].x ) * texture_scale;

  00065	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00068	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  0006e	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  00072	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00076	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  0007b	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0007e	c1 e0 05	 shl	 eax, 5
  00081	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00084	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 795  : 		destination_vertices[count].tv = ( current_terrain_points_xz[this_point].z ) * texture_scale;

  0008a	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0008d	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  00093	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  00098	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  0009c	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  000a1	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000a4	c1 e0 05	 shl	 eax, 5
  000a7	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000aa	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 796  : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000b0	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000b3	c1 e0 04	 shl	 eax, 4
  000b6	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000b9	c1 e1 05	 shl	 ecx, 5
  000bc	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000bf	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000c5	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 797  : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000c8	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000cb	c1 e0 04	 shl	 eax, 4
  000ce	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000d1	c1 e1 05	 shl	 ecx, 5
  000d4	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000d7	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  000dd	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 798  : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  000e1	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e4	c1 e0 04	 shl	 eax, 4
  000e7	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  000ef	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  000f7	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  000ff	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00103	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00106	c1 e1 05	 shl	 ecx, 5
  00109	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0010c	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 799  : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00112	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00115	c1 e0 04	 shl	 eax, 4
  00118	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0011b	c1 e1 05	 shl	 ecx, 5
  0011e	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00121	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00127	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 800  : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  0012b	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0012e	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  00136	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00139	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  0013c	c1 e2 05	 shl	 edx, 5
  0013f	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00142	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 801  : 
; 802  : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  00146	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00149	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  00151	89 4d e0	 mov	 DWORD PTR _normal_index$1[ebp], ecx

; 803  : 
; 804  : 		asm_convert_float_to_int ( ( current_terrain_type_class->red * terrain_3d_transformed_point_normals[normal_index].r ), &red );

  00154	8d 45 ec	 lea	 eax, DWORD PTR _red$4[ebp]
  00157	50		 push	 eax
  00158	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0015e	0f b6 51 0c	 movzx	 edx, BYTE PTR [ecx+12]
  00162	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00166	8b 45 e0	 mov	 eax, DWORD PTR _normal_index$1[ebp]
  00169	c1 e0 04	 shl	 eax, 4
  0016c	f3 0f 59 80 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax]
  00174	51		 push	 ecx
  00175	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0017a	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 805  : 		asm_convert_float_to_int ( ( current_terrain_type_class->green * terrain_3d_transformed_point_normals[normal_index].g ), &green );

  0017f	8d 45 e8	 lea	 eax, DWORD PTR _green$3[ebp]
  00182	50		 push	 eax
  00183	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  00189	0f b6 51 0d	 movzx	 edx, BYTE PTR [ecx+13]
  0018d	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00191	8b 45 e0	 mov	 eax, DWORD PTR _normal_index$1[ebp]
  00194	c1 e0 04	 shl	 eax, 4
  00197	f3 0f 59 80 04
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+4]
  0019f	51		 push	 ecx
  001a0	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001a5	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 806  : 		asm_convert_float_to_int ( ( current_terrain_type_class->blue * terrain_3d_transformed_point_normals[normal_index].b ), &blue );

  001aa	8d 45 e4	 lea	 eax, DWORD PTR _blue$2[ebp]
  001ad	50		 push	 eax
  001ae	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001b4	0f b6 51 0e	 movzx	 edx, BYTE PTR [ecx+14]
  001b8	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  001bc	8b 45 e0	 mov	 eax, DWORD PTR _normal_index$1[ebp]
  001bf	c1 e0 04	 shl	 eax, 4
  001c2	f3 0f 59 80 08
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+8]
  001ca	51		 push	 ecx
  001cb	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001d0	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 807  : 
; 808  : 		destination_vertices[count].color = RGB_MAKE ( red, green, blue );

  001d5	8b 45 ec	 mov	 eax, DWORD PTR _red$4[ebp]
  001d8	c1 e0 10	 shl	 eax, 16			; 00000010H
  001db	8b 4d e8	 mov	 ecx, DWORD PTR _green$3[ebp]
  001de	c1 e1 08	 shl	 ecx, 8
  001e1	0b c1		 or	 eax, ecx
  001e3	0b 45 e4	 or	 eax, DWORD PTR _blue$2[ebp]
  001e6	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  001e9	c1 e2 05	 shl	 edx, 5
  001ec	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  001ef	89 44 11 10	 mov	 DWORD PTR [ecx+edx+16], eax

; 809  : 	}

  001f3	e9 48 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 810  : 
; 811  : 	draw_strip_primitive ( num_points, destination_vertices );

  001f8	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  001fb	50		 push	 eax
  001fc	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  001ff	51		 push	 ecx
  00200	e8 00 00 00 00	 call	 ?draw_strip_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_strip_primitive

; 812  : }

  00205	5f		 pop	 edi
  00206	5e		 pop	 esi
  00207	5b		 pop	 ebx
  00208	8b e5		 mov	 esp, ebp
  0020a	5d		 pop	 ebp
  0020b	c2 04 00	 ret	 4
?render_3d_terrain_word_colour_strip@@YGXH@Z ENDP	; render_3d_terrain_word_colour_strip
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_byte_colour_fan@@YGXH@Z
_TEXT	SEGMENT
_normal_index$1 = -32					; size = 4
_blue$2 = -28						; size = 4
_green$3 = -24						; size = 4
_red$4 = -20						; size = 4
_texture_scale$ = -16					; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_byte_colour_fan@@YGXH@Z PROC		; render_3d_terrain_byte_colour_fan, COMDAT

; 711  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 60	 sub	 esp, 96			; 00000060H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 712  : 
; 713  : 	int
; 714  : 		count,
; 715  : 		this_point;
; 716  : 
; 717  : 	LPD3DTLVERTEX
; 718  : 		destination_vertices;
; 719  : 
; 720  : 	float
; 721  : 		texture_scale;
; 722  : 
; 723  : 	texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _texture_scale$[ebp], xmm0

; 724  : 
; 725  : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00018	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0001b	50		 push	 eax
  0001c	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00021	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 726  : 
; 727  : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00024	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00027	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0002d	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00031	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 728  : 
; 729  : 	for ( count = 0; count < num_points; count++ )

  00037	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0003e	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  00040	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00043	83 c0 01	 add	 eax, 1
  00046	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00049	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0004c	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0004f	0f 8d a1 01 00
	00		 jge	 $LN3@render_3d_

; 730  : 	{
; 731  : 	
; 732  : 		int
; 733  : 			red,
; 734  : 			green,
; 735  : 			blue,
; 736  : 			normal_index;
; 737  : 	
; 738  : 		this_point = terrain_3d_sector_point_byte_references[count].point;

  00055	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_point_byte_references@@3PAUTERRAIN_3D_POINT_BYTE_REFERENCE@@A ; terrain_3d_sector_point_byte_references
  0005a	03 45 fc	 add	 eax, DWORD PTR _count$[ebp]
  0005d	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  00060	89 4d f8	 mov	 DWORD PTR _this_point$[ebp], ecx

; 739  : 	
; 740  : 		destination_vertices[count].tu = ( current_terrain_points_xz[this_point].x ) * texture_scale;

  00063	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00066	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  0006c	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  00070	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00074	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  00079	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0007c	c1 e0 05	 shl	 eax, 5
  0007f	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00082	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 741  : 		destination_vertices[count].tv = ( current_terrain_points_xz[this_point].z ) * texture_scale;

  00088	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0008b	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  00091	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  00096	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  0009a	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  0009f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000a2	c1 e0 05	 shl	 eax, 5
  000a5	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000a8	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 742  : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000ae	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000b1	c1 e0 04	 shl	 eax, 4
  000b4	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000b7	c1 e1 05	 shl	 ecx, 5
  000ba	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000bd	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000c3	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 743  : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000c6	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000c9	c1 e0 04	 shl	 eax, 4
  000cc	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000cf	c1 e1 05	 shl	 ecx, 5
  000d2	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000d5	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  000db	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 744  : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  000df	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e2	c1 e0 04	 shl	 eax, 4
  000e5	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  000ed	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  000f5	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  000fd	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00101	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00104	c1 e1 05	 shl	 ecx, 5
  00107	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0010a	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 745  : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00110	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00113	c1 e0 04	 shl	 eax, 4
  00116	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00119	c1 e1 05	 shl	 ecx, 5
  0011c	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0011f	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00125	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 746  : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00129	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0012c	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  00134	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00137	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  0013a	c1 e2 05	 shl	 edx, 5
  0013d	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00140	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 747  : 
; 748  : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  00144	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00147	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  0014f	89 4d e0	 mov	 DWORD PTR _normal_index$1[ebp], ecx

; 749  : 
; 750  : 		asm_convert_float_to_int ( ( current_terrain_type_class->red * terrain_3d_transformed_point_normals[normal_index].r ), &red );

  00152	8d 45 ec	 lea	 eax, DWORD PTR _red$4[ebp]
  00155	50		 push	 eax
  00156	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0015c	0f b6 51 0c	 movzx	 edx, BYTE PTR [ecx+12]
  00160	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00164	8b 45 e0	 mov	 eax, DWORD PTR _normal_index$1[ebp]
  00167	c1 e0 04	 shl	 eax, 4
  0016a	f3 0f 59 80 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax]
  00172	51		 push	 ecx
  00173	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00178	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 751  : 		asm_convert_float_to_int ( ( current_terrain_type_class->green * terrain_3d_transformed_point_normals[normal_index].g ), &green );

  0017d	8d 45 e8	 lea	 eax, DWORD PTR _green$3[ebp]
  00180	50		 push	 eax
  00181	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  00187	0f b6 51 0d	 movzx	 edx, BYTE PTR [ecx+13]
  0018b	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  0018f	8b 45 e0	 mov	 eax, DWORD PTR _normal_index$1[ebp]
  00192	c1 e0 04	 shl	 eax, 4
  00195	f3 0f 59 80 04
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+4]
  0019d	51		 push	 ecx
  0019e	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001a3	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 752  : 		asm_convert_float_to_int ( ( current_terrain_type_class->blue * terrain_3d_transformed_point_normals[normal_index].b ), &blue );

  001a8	8d 45 e4	 lea	 eax, DWORD PTR _blue$2[ebp]
  001ab	50		 push	 eax
  001ac	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001b2	0f b6 51 0e	 movzx	 edx, BYTE PTR [ecx+14]
  001b6	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  001ba	8b 45 e0	 mov	 eax, DWORD PTR _normal_index$1[ebp]
  001bd	c1 e0 04	 shl	 eax, 4
  001c0	f3 0f 59 80 08
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+8]
  001c8	51		 push	 ecx
  001c9	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001ce	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 753  : 
; 754  : 		destination_vertices[count].color = RGB_MAKE ( red, green, blue );

  001d3	8b 45 ec	 mov	 eax, DWORD PTR _red$4[ebp]
  001d6	c1 e0 10	 shl	 eax, 16			; 00000010H
  001d9	8b 4d e8	 mov	 ecx, DWORD PTR _green$3[ebp]
  001dc	c1 e1 08	 shl	 ecx, 8
  001df	0b c1		 or	 eax, ecx
  001e1	0b 45 e4	 or	 eax, DWORD PTR _blue$2[ebp]
  001e4	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  001e7	c1 e2 05	 shl	 edx, 5
  001ea	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  001ed	89 44 11 10	 mov	 DWORD PTR [ecx+edx+16], eax

; 755  : 	}

  001f1	e9 4a fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 756  : 
; 757  : 	draw_fan_primitive ( num_points, destination_vertices );

  001f6	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  001f9	50		 push	 eax
  001fa	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  001fd	51		 push	 ecx
  001fe	e8 00 00 00 00	 call	 ?draw_fan_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_fan_primitive

; 758  : }

  00203	5f		 pop	 edi
  00204	5e		 pop	 esi
  00205	5b		 pop	 ebx
  00206	8b e5		 mov	 esp, ebp
  00208	5d		 pop	 ebp
  00209	c2 04 00	 ret	 4
?render_3d_terrain_byte_colour_fan@@YGXH@Z ENDP		; render_3d_terrain_byte_colour_fan
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_word_colour_fan@@YGXH@Z
_TEXT	SEGMENT
_normal_index$1 = -32					; size = 4
_blue$2 = -28						; size = 4
_green$3 = -24						; size = 4
_red$4 = -20						; size = 4
_texture_scale$ = -16					; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_word_colour_fan@@YGXH@Z PROC		; render_3d_terrain_word_colour_fan, COMDAT

; 657  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 60	 sub	 esp, 96			; 00000060H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 658  : 
; 659  : 	int
; 660  : 		count,
; 661  : 		this_point;
; 662  : 
; 663  : 	LPD3DTLVERTEX
; 664  : 		destination_vertices;
; 665  : 
; 666  : 	float
; 667  : 		texture_scale;
; 668  : 
; 669  : 	texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _texture_scale$[ebp], xmm0

; 670  : 
; 671  : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00018	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0001b	50		 push	 eax
  0001c	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00021	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 672  : 
; 673  : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00024	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00027	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0002d	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00031	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 674  : 
; 675  : 	for ( count = 0; count < num_points; count++ )

  00037	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0003e	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  00040	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00043	83 c0 01	 add	 eax, 1
  00046	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00049	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0004c	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0004f	0f 8d a3 01 00
	00		 jge	 $LN3@render_3d_

; 676  : 	{
; 677  : 	
; 678  : 		int
; 679  : 			red,
; 680  : 			green,
; 681  : 			blue,
; 682  : 			normal_index;
; 683  : 	
; 684  : 		this_point = terrain_3d_sector_point_word_references[count].point;

  00055	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00058	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_sector_point_word_references@@3PAUTERRAIN_3D_POINT_WORD_REFERENCE@@A ; terrain_3d_sector_point_word_references
  0005e	0f b7 14 41	 movzx	 edx, WORD PTR [ecx+eax*2]
  00062	89 55 f8	 mov	 DWORD PTR _this_point$[ebp], edx

; 685  : 	
; 686  : 		destination_vertices[count].tu = ( current_terrain_points_xz[this_point].x ) * texture_scale;

  00065	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00068	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  0006e	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  00072	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00076	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  0007b	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0007e	c1 e0 05	 shl	 eax, 5
  00081	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00084	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 687  : 		destination_vertices[count].tv = ( current_terrain_points_xz[this_point].z ) * texture_scale;

  0008a	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0008d	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  00093	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  00098	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  0009c	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  000a1	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000a4	c1 e0 05	 shl	 eax, 5
  000a7	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000aa	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 688  : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000b0	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000b3	c1 e0 04	 shl	 eax, 4
  000b6	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000b9	c1 e1 05	 shl	 ecx, 5
  000bc	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000bf	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000c5	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 689  : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000c8	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000cb	c1 e0 04	 shl	 eax, 4
  000ce	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000d1	c1 e1 05	 shl	 ecx, 5
  000d4	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000d7	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  000dd	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 690  : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  000e1	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e4	c1 e0 04	 shl	 eax, 4
  000e7	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  000ef	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  000f7	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  000ff	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00103	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00106	c1 e1 05	 shl	 ecx, 5
  00109	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0010c	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 691  : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00112	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00115	c1 e0 04	 shl	 eax, 4
  00118	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0011b	c1 e1 05	 shl	 ecx, 5
  0011e	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00121	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00127	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 692  : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  0012b	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0012e	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  00136	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00139	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  0013c	c1 e2 05	 shl	 edx, 5
  0013f	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00142	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 693  : 
; 694  : 		normal_index = transformed_3d_point_colours[this_point].normal_index;

  00146	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00149	0f b6 0c c5 05
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+5]
  00151	89 4d e0	 mov	 DWORD PTR _normal_index$1[ebp], ecx

; 695  : 
; 696  : 		asm_convert_float_to_int ( ( current_terrain_type_class->red * terrain_3d_transformed_point_normals[normal_index].r ), &red );

  00154	8d 45 ec	 lea	 eax, DWORD PTR _red$4[ebp]
  00157	50		 push	 eax
  00158	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0015e	0f b6 51 0c	 movzx	 edx, BYTE PTR [ecx+12]
  00162	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00166	8b 45 e0	 mov	 eax, DWORD PTR _normal_index$1[ebp]
  00169	c1 e0 04	 shl	 eax, 4
  0016c	f3 0f 59 80 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax]
  00174	51		 push	 ecx
  00175	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0017a	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 697  : 		asm_convert_float_to_int ( ( current_terrain_type_class->green * terrain_3d_transformed_point_normals[normal_index].g ), &green );

  0017f	8d 45 e8	 lea	 eax, DWORD PTR _green$3[ebp]
  00182	50		 push	 eax
  00183	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  00189	0f b6 51 0d	 movzx	 edx, BYTE PTR [ecx+13]
  0018d	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00191	8b 45 e0	 mov	 eax, DWORD PTR _normal_index$1[ebp]
  00194	c1 e0 04	 shl	 eax, 4
  00197	f3 0f 59 80 04
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+4]
  0019f	51		 push	 ecx
  001a0	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001a5	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 698  : 		asm_convert_float_to_int ( ( current_terrain_type_class->blue * terrain_3d_transformed_point_normals[normal_index].b ), &blue );

  001aa	8d 45 e4	 lea	 eax, DWORD PTR _blue$2[ebp]
  001ad	50		 push	 eax
  001ae	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  001b4	0f b6 51 0e	 movzx	 edx, BYTE PTR [ecx+14]
  001b8	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  001bc	8b 45 e0	 mov	 eax, DWORD PTR _normal_index$1[ebp]
  001bf	c1 e0 04	 shl	 eax, 4
  001c2	f3 0f 59 80 08
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_transformed_point_normals@@3PAUTERRAIN_3D_TRANSFORMED_POINT_NORMAL@@A[eax+8]
  001ca	51		 push	 ecx
  001cb	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  001d0	e8 00 00 00 00	 call	 ?asm_convert_float_to_int@@YGXMPAH@Z ; asm_convert_float_to_int

; 699  : 
; 700  : 		destination_vertices[count].color = RGB_MAKE ( red, green, blue );

  001d5	8b 45 ec	 mov	 eax, DWORD PTR _red$4[ebp]
  001d8	c1 e0 10	 shl	 eax, 16			; 00000010H
  001db	8b 4d e8	 mov	 ecx, DWORD PTR _green$3[ebp]
  001de	c1 e1 08	 shl	 ecx, 8
  001e1	0b c1		 or	 eax, ecx
  001e3	0b 45 e4	 or	 eax, DWORD PTR _blue$2[ebp]
  001e6	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  001e9	c1 e2 05	 shl	 edx, 5
  001ec	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  001ef	89 44 11 10	 mov	 DWORD PTR [ecx+edx+16], eax

; 701  : 	}

  001f3	e9 48 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 702  : 
; 703  : 	draw_fan_primitive ( num_points, destination_vertices );

  001f8	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  001fb	50		 push	 eax
  001fc	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  001ff	51		 push	 ecx
  00200	e8 00 00 00 00	 call	 ?draw_fan_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_fan_primitive

; 704  : }

  00205	5f		 pop	 edi
  00206	5e		 pop	 esi
  00207	5b		 pop	 ebx
  00208	8b e5		 mov	 esp, ebp
  0020a	5d		 pop	 ebp
  0020b	c2 04 00	 ret	 4
?render_3d_terrain_word_colour_fan@@YGXH@Z ENDP		; render_3d_terrain_word_colour_fan
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_texture_zy_byte_fan@@YGXH@Z
_TEXT	SEGMENT
_y$1 = -24						; size = 4
_y_texture_scale$ = -20					; size = 4
_xz_texture_scale$ = -16				; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_texture_zy_byte_fan@@YGXH@Z PROC	; render_3d_terrain_texture_zy_byte_fan, COMDAT

; 417  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 58	 sub	 esp, 88			; 00000058H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 418  : 
; 419  : 	int
; 420  : 		count,
; 421  : 		this_point;
; 422  : 
; 423  : 	LPD3DTLVERTEX
; 424  : 		destination_vertices;
; 425  : 
; 426  : 	float
; 427  : 		xz_texture_scale,
; 428  : 		y_texture_scale;
; 429  : 
; 430  : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 431  : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 ec	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 432  : 
; 433  : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00030	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 434  : 
; 435  : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 436  : 
; 437  : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d 2d 01 00
	00		 jge	 $LN3@render_3d_

; 438  : 	{
; 439  : 
; 440  : 		float
; 441  : 			y;
; 442  : 	
; 443  : 		this_point = terrain_3d_sector_point_byte_references[count].point;

  00064	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_point_byte_references@@3PAUTERRAIN_3D_POINT_BYTE_REFERENCE@@A ; terrain_3d_sector_point_byte_references
  00069	03 45 fc	 add	 eax, DWORD PTR _count$[ebp]
  0006c	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  0006f	89 4d f8	 mov	 DWORD PTR _this_point$[ebp], ecx

; 444  : 	
; 445  : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00072	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00077	8b 4d f8	 mov	 ecx, DWORD PTR _this_point$[ebp]
  0007a	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  00080	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00084	0f b7 c0	 movzx	 eax, ax
  00087	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0008b	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  00093	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  0009b	f3 0f 11 45 e8	 movss	 DWORD PTR _y$1[ebp], xmm0

; 446  : 
; 447  : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].z ) * xz_texture_scale;

  000a0	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000a3	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000a9	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  000ae	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000b2	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000b7	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000ba	c1 e0 05	 shl	 eax, 5
  000bd	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000c0	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 448  : 		destination_vertices[count].tv = y * y_texture_scale;

  000c6	f3 0f 10 45 e8	 movss	 xmm0, DWORD PTR _y$1[ebp]
  000cb	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000d0	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000d3	c1 e0 05	 shl	 eax, 5
  000d6	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000d9	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 449  : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000df	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e2	c1 e0 04	 shl	 eax, 4
  000e5	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000e8	c1 e1 05	 shl	 ecx, 5
  000eb	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000ee	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000f4	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 450  : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000f7	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000fa	c1 e0 04	 shl	 eax, 4
  000fd	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00100	c1 e1 05	 shl	 ecx, 5
  00103	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00106	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0010c	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 451  : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  00110	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00113	c1 e0 04	 shl	 eax, 4
  00116	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0011e	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00126	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0012e	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00132	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00135	c1 e1 05	 shl	 ecx, 5
  00138	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0013b	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 452  : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00141	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00144	c1 e0 04	 shl	 eax, 4
  00147	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0014a	c1 e1 05	 shl	 ecx, 5
  0014d	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00150	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00156	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 453  : 		destination_vertices[count].color = transformed_3d_point_colours[this_point].colour;

  0015a	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0015d	c1 e0 05	 shl	 eax, 5
  00160	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00163	8b 55 f8	 mov	 edx, DWORD PTR _this_point$[ebp]
  00166	8b 14 d5 00 00
	00 00		 mov	 edx, DWORD PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[edx*8]
  0016d	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 454  : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00171	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00174	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  0017c	c1 e1 18	 shl	 ecx, 24			; 00000018H
  0017f	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  00182	c1 e2 05	 shl	 edx, 5
  00185	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00188	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 455  : 	}

  0018c	e9 be fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 456  : 
; 457  : 	draw_fan_primitive ( num_points, destination_vertices );

  00191	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00194	50		 push	 eax
  00195	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  00198	51		 push	 ecx
  00199	e8 00 00 00 00	 call	 ?draw_fan_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_fan_primitive

; 458  : }

  0019e	5f		 pop	 edi
  0019f	5e		 pop	 esi
  001a0	5b		 pop	 ebx
  001a1	8b e5		 mov	 esp, ebp
  001a3	5d		 pop	 ebp
  001a4	c2 04 00	 ret	 4
?render_3d_terrain_texture_zy_byte_fan@@YGXH@Z ENDP	; render_3d_terrain_texture_zy_byte_fan
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_texture_zy_word_fan@@YGXH@Z
_TEXT	SEGMENT
_y$1 = -24						; size = 4
_y_texture_scale$ = -20					; size = 4
_xz_texture_scale$ = -16				; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_texture_zy_word_fan@@YGXH@Z PROC	; render_3d_terrain_texture_zy_word_fan, COMDAT

; 369  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 58	 sub	 esp, 88			; 00000058H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 370  : 
; 371  : 	int
; 372  : 		count,
; 373  : 		this_point;
; 374  : 
; 375  : 	LPD3DTLVERTEX
; 376  : 		destination_vertices;
; 377  : 
; 378  : 	float
; 379  : 		xz_texture_scale,
; 380  : 		y_texture_scale;
; 381  : 
; 382  : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 383  : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 ec	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 384  : 
; 385  : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00030	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 386  : 
; 387  : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 388  : 
; 389  : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d 2f 01 00
	00		 jge	 $LN3@render_3d_

; 390  : 	{
; 391  : 
; 392  : 		float
; 393  : 			y;
; 394  : 	
; 395  : 		this_point = terrain_3d_sector_point_word_references[count].point;

  00064	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00067	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_sector_point_word_references@@3PAUTERRAIN_3D_POINT_WORD_REFERENCE@@A ; terrain_3d_sector_point_word_references
  0006d	0f b7 14 41	 movzx	 edx, WORD PTR [ecx+eax*2]
  00071	89 55 f8	 mov	 DWORD PTR _this_point$[ebp], edx

; 396  : 	
; 397  : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00074	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00079	8b 4d f8	 mov	 ecx, DWORD PTR _this_point$[ebp]
  0007c	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  00082	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00086	0f b7 c0	 movzx	 eax, ax
  00089	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0008d	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  00095	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  0009d	f3 0f 11 45 e8	 movss	 DWORD PTR _y$1[ebp], xmm0

; 398  : 
; 399  : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].z ) * xz_texture_scale;

  000a2	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000a5	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000ab	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  000b0	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000b4	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000b9	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000bc	c1 e0 05	 shl	 eax, 5
  000bf	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000c2	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 400  : 		destination_vertices[count].tv = y * y_texture_scale;

  000c8	f3 0f 10 45 e8	 movss	 xmm0, DWORD PTR _y$1[ebp]
  000cd	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000d2	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000d5	c1 e0 05	 shl	 eax, 5
  000d8	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000db	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 401  : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000e1	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e4	c1 e0 04	 shl	 eax, 4
  000e7	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000ea	c1 e1 05	 shl	 ecx, 5
  000ed	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000f0	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000f6	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 402  : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000f9	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000fc	c1 e0 04	 shl	 eax, 4
  000ff	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00102	c1 e1 05	 shl	 ecx, 5
  00105	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00108	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0010e	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 403  : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  00112	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00115	c1 e0 04	 shl	 eax, 4
  00118	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00120	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00128	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  00130	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00134	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00137	c1 e1 05	 shl	 ecx, 5
  0013a	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0013d	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 404  : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00143	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00146	c1 e0 04	 shl	 eax, 4
  00149	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0014c	c1 e1 05	 shl	 ecx, 5
  0014f	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00152	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00158	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 405  : 		destination_vertices[count].color = transformed_3d_point_colours[this_point].colour;

  0015c	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0015f	c1 e0 05	 shl	 eax, 5
  00162	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00165	8b 55 f8	 mov	 edx, DWORD PTR _this_point$[ebp]
  00168	8b 14 d5 00 00
	00 00		 mov	 edx, DWORD PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[edx*8]
  0016f	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 406  : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00173	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00176	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  0017e	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00181	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  00184	c1 e2 05	 shl	 edx, 5
  00187	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  0018a	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 407  : 	}

  0018e	e9 bc fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 408  : 
; 409  : 	draw_fan_primitive ( num_points, destination_vertices );

  00193	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00196	50		 push	 eax
  00197	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  0019a	51		 push	 ecx
  0019b	e8 00 00 00 00	 call	 ?draw_fan_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_fan_primitive

; 410  : }

  001a0	5f		 pop	 edi
  001a1	5e		 pop	 esi
  001a2	5b		 pop	 ebx
  001a3	8b e5		 mov	 esp, ebp
  001a5	5d		 pop	 ebp
  001a6	c2 04 00	 ret	 4
?render_3d_terrain_texture_zy_word_fan@@YGXH@Z ENDP	; render_3d_terrain_texture_zy_word_fan
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_texture_xy_byte_fan@@YGXH@Z
_TEXT	SEGMENT
_y$1 = -24						; size = 4
_y_texture_scale$ = -20					; size = 4
_xz_texture_scale$ = -16				; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_texture_xy_byte_fan@@YGXH@Z PROC	; render_3d_terrain_texture_xy_byte_fan, COMDAT

; 321  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 58	 sub	 esp, 88			; 00000058H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 322  : 
; 323  : 	int
; 324  : 		count,
; 325  : 		this_point;
; 326  : 
; 327  : 	LPD3DTLVERTEX
; 328  : 		destination_vertices;
; 329  : 
; 330  : 	float
; 331  : 		xz_texture_scale,
; 332  : 		y_texture_scale;
; 333  : 
; 334  : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 335  : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 ec	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 336  : 
; 337  : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00030	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 338  : 
; 339  : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 340  : 
; 341  : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d 2c 01 00
	00		 jge	 $LN3@render_3d_

; 342  : 	{
; 343  : 
; 344  : 		float
; 345  : 			y;
; 346  : 	
; 347  : 		this_point = terrain_3d_sector_point_byte_references[count].point;

  00064	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_point_byte_references@@3PAUTERRAIN_3D_POINT_BYTE_REFERENCE@@A ; terrain_3d_sector_point_byte_references
  00069	03 45 fc	 add	 eax, DWORD PTR _count$[ebp]
  0006c	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  0006f	89 4d f8	 mov	 DWORD PTR _this_point$[ebp], ecx

; 348  : 	
; 349  : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00072	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00077	8b 4d f8	 mov	 ecx, DWORD PTR _this_point$[ebp]
  0007a	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  00080	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00084	0f b7 c0	 movzx	 eax, ax
  00087	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0008b	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  00093	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  0009b	f3 0f 11 45 e8	 movss	 DWORD PTR _y$1[ebp], xmm0

; 350  : 
; 351  : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].x ) * xz_texture_scale;

  000a0	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000a3	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000a9	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  000ad	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000b1	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000b6	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000b9	c1 e0 05	 shl	 eax, 5
  000bc	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000bf	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 352  : 		destination_vertices[count].tv = y * y_texture_scale;

  000c5	f3 0f 10 45 e8	 movss	 xmm0, DWORD PTR _y$1[ebp]
  000ca	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000cf	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000d2	c1 e0 05	 shl	 eax, 5
  000d5	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000d8	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 353  : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000de	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e1	c1 e0 04	 shl	 eax, 4
  000e4	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000e7	c1 e1 05	 shl	 ecx, 5
  000ea	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000ed	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000f3	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 354  : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000f6	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000f9	c1 e0 04	 shl	 eax, 4
  000fc	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000ff	c1 e1 05	 shl	 ecx, 5
  00102	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00105	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0010b	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 355  : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  0010f	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00112	c1 e0 04	 shl	 eax, 4
  00115	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0011d	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00125	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0012d	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00131	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00134	c1 e1 05	 shl	 ecx, 5
  00137	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0013a	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 356  : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00140	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00143	c1 e0 04	 shl	 eax, 4
  00146	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00149	c1 e1 05	 shl	 ecx, 5
  0014c	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0014f	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00155	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 357  : 		destination_vertices[count].color = transformed_3d_point_colours[this_point].colour;

  00159	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0015c	c1 e0 05	 shl	 eax, 5
  0015f	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00162	8b 55 f8	 mov	 edx, DWORD PTR _this_point$[ebp]
  00165	8b 14 d5 00 00
	00 00		 mov	 edx, DWORD PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[edx*8]
  0016c	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 358  : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00170	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00173	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  0017b	c1 e1 18	 shl	 ecx, 24			; 00000018H
  0017e	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  00181	c1 e2 05	 shl	 edx, 5
  00184	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00187	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 359  : 	}

  0018b	e9 bf fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 360  : 
; 361  : 	draw_fan_primitive ( num_points, destination_vertices );

  00190	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00193	50		 push	 eax
  00194	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  00197	51		 push	 ecx
  00198	e8 00 00 00 00	 call	 ?draw_fan_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_fan_primitive

; 362  : }

  0019d	5f		 pop	 edi
  0019e	5e		 pop	 esi
  0019f	5b		 pop	 ebx
  001a0	8b e5		 mov	 esp, ebp
  001a2	5d		 pop	 ebp
  001a3	c2 04 00	 ret	 4
?render_3d_terrain_texture_xy_byte_fan@@YGXH@Z ENDP	; render_3d_terrain_texture_xy_byte_fan
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_texture_xy_word_fan@@YGXH@Z
_TEXT	SEGMENT
_y$1 = -24						; size = 4
_y_texture_scale$ = -20					; size = 4
_xz_texture_scale$ = -16				; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_texture_xy_word_fan@@YGXH@Z PROC	; render_3d_terrain_texture_xy_word_fan, COMDAT

; 273  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 58	 sub	 esp, 88			; 00000058H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 274  : 
; 275  : 	int
; 276  : 		count,
; 277  : 		this_point;
; 278  : 
; 279  : 	LPD3DTLVERTEX
; 280  : 		destination_vertices;
; 281  : 
; 282  : 	float
; 283  : 		xz_texture_scale,
; 284  : 		y_texture_scale;
; 285  : 
; 286  : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 287  : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 ec	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 288  : 
; 289  : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00030	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 290  : 
; 291  : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 292  : 
; 293  : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d 2e 01 00
	00		 jge	 $LN3@render_3d_

; 294  : 	{
; 295  : 
; 296  : 		float
; 297  : 			y;
; 298  : 	
; 299  : 		this_point = terrain_3d_sector_point_word_references[count].point;

  00064	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00067	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_sector_point_word_references@@3PAUTERRAIN_3D_POINT_WORD_REFERENCE@@A ; terrain_3d_sector_point_word_references
  0006d	0f b7 14 41	 movzx	 edx, WORD PTR [ecx+eax*2]
  00071	89 55 f8	 mov	 DWORD PTR _this_point$[ebp], edx

; 300  : 	
; 301  : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00074	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00079	8b 4d f8	 mov	 ecx, DWORD PTR _this_point$[ebp]
  0007c	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  00082	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00086	0f b7 c0	 movzx	 eax, ax
  00089	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0008d	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  00095	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  0009d	f3 0f 11 45 e8	 movss	 DWORD PTR _y$1[ebp], xmm0

; 302  : 
; 303  : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].x ) * xz_texture_scale;

  000a2	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000a5	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000ab	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  000af	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000b3	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000b8	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000bb	c1 e0 05	 shl	 eax, 5
  000be	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000c1	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 304  : 		destination_vertices[count].tv = y * y_texture_scale;

  000c7	f3 0f 10 45 e8	 movss	 xmm0, DWORD PTR _y$1[ebp]
  000cc	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000d1	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000d4	c1 e0 05	 shl	 eax, 5
  000d7	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000da	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 305  : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000e0	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e3	c1 e0 04	 shl	 eax, 4
  000e6	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000e9	c1 e1 05	 shl	 ecx, 5
  000ec	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000ef	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000f5	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 306  : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000f8	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000fb	c1 e0 04	 shl	 eax, 4
  000fe	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00101	c1 e1 05	 shl	 ecx, 5
  00104	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00107	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0010d	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 307  : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  00111	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00114	c1 e0 04	 shl	 eax, 4
  00117	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0011f	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00127	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0012f	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00133	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00136	c1 e1 05	 shl	 ecx, 5
  00139	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0013c	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 308  : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00142	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00145	c1 e0 04	 shl	 eax, 4
  00148	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0014b	c1 e1 05	 shl	 ecx, 5
  0014e	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00151	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00157	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 309  : 		destination_vertices[count].color = transformed_3d_point_colours[this_point].colour;

  0015b	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0015e	c1 e0 05	 shl	 eax, 5
  00161	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00164	8b 55 f8	 mov	 edx, DWORD PTR _this_point$[ebp]
  00167	8b 14 d5 00 00
	00 00		 mov	 edx, DWORD PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[edx*8]
  0016e	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 310  : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00172	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00175	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  0017d	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00180	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  00183	c1 e2 05	 shl	 edx, 5
  00186	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00189	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 311  : 	}

  0018d	e9 bd fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 312  : 
; 313  : 	draw_fan_primitive ( num_points, destination_vertices );

  00192	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00195	50		 push	 eax
  00196	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  00199	51		 push	 ecx
  0019a	e8 00 00 00 00	 call	 ?draw_fan_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_fan_primitive

; 314  : }

  0019f	5f		 pop	 edi
  001a0	5e		 pop	 esi
  001a1	5b		 pop	 ebx
  001a2	8b e5		 mov	 esp, ebp
  001a4	5d		 pop	 ebp
  001a5	c2 04 00	 ret	 4
?render_3d_terrain_texture_xy_word_fan@@YGXH@Z ENDP	; render_3d_terrain_texture_xy_word_fan
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_texture_zy_byte_strip@@YGXH@Z
_TEXT	SEGMENT
_y$1 = -24						; size = 4
_y_texture_scale$ = -20					; size = 4
_xz_texture_scale$ = -16				; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_texture_zy_byte_strip@@YGXH@Z PROC	; render_3d_terrain_texture_zy_byte_strip, COMDAT

; 609  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 58	 sub	 esp, 88			; 00000058H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 610  : 
; 611  : 	int
; 612  : 		count,
; 613  : 		this_point;
; 614  : 
; 615  : 	LPD3DTLVERTEX
; 616  : 		destination_vertices;
; 617  : 
; 618  : 	float
; 619  : 		xz_texture_scale,
; 620  : 		y_texture_scale;
; 621  : 
; 622  : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 623  : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 ec	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 624  : 
; 625  : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00030	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 626  : 
; 627  : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 628  : 
; 629  : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d 2d 01 00
	00		 jge	 $LN3@render_3d_

; 630  : 	{
; 631  : 
; 632  : 		float
; 633  : 			y;
; 634  : 	
; 635  : 		this_point = terrain_3d_sector_point_byte_references[count].point;

  00064	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_point_byte_references@@3PAUTERRAIN_3D_POINT_BYTE_REFERENCE@@A ; terrain_3d_sector_point_byte_references
  00069	03 45 fc	 add	 eax, DWORD PTR _count$[ebp]
  0006c	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  0006f	89 4d f8	 mov	 DWORD PTR _this_point$[ebp], ecx

; 636  : 	
; 637  : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00072	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00077	8b 4d f8	 mov	 ecx, DWORD PTR _this_point$[ebp]
  0007a	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  00080	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00084	0f b7 c0	 movzx	 eax, ax
  00087	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0008b	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  00093	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  0009b	f3 0f 11 45 e8	 movss	 DWORD PTR _y$1[ebp], xmm0

; 638  : 
; 639  : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].z ) * xz_texture_scale;

  000a0	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000a3	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000a9	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  000ae	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000b2	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000b7	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000ba	c1 e0 05	 shl	 eax, 5
  000bd	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000c0	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 640  : 		destination_vertices[count].tv = y * y_texture_scale;

  000c6	f3 0f 10 45 e8	 movss	 xmm0, DWORD PTR _y$1[ebp]
  000cb	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000d0	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000d3	c1 e0 05	 shl	 eax, 5
  000d6	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000d9	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 641  : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000df	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e2	c1 e0 04	 shl	 eax, 4
  000e5	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000e8	c1 e1 05	 shl	 ecx, 5
  000eb	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000ee	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000f4	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 642  : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000f7	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000fa	c1 e0 04	 shl	 eax, 4
  000fd	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00100	c1 e1 05	 shl	 ecx, 5
  00103	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00106	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0010c	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 643  : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  00110	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00113	c1 e0 04	 shl	 eax, 4
  00116	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0011e	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00126	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0012e	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00132	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00135	c1 e1 05	 shl	 ecx, 5
  00138	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0013b	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 644  : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00141	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00144	c1 e0 04	 shl	 eax, 4
  00147	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0014a	c1 e1 05	 shl	 ecx, 5
  0014d	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00150	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00156	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 645  : 		destination_vertices[count].color = transformed_3d_point_colours[this_point].colour;

  0015a	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0015d	c1 e0 05	 shl	 eax, 5
  00160	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00163	8b 55 f8	 mov	 edx, DWORD PTR _this_point$[ebp]
  00166	8b 14 d5 00 00
	00 00		 mov	 edx, DWORD PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[edx*8]
  0016d	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 646  : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00171	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00174	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  0017c	c1 e1 18	 shl	 ecx, 24			; 00000018H
  0017f	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  00182	c1 e2 05	 shl	 edx, 5
  00185	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00188	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 647  : 	}

  0018c	e9 be fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 648  : 
; 649  : 	draw_strip_primitive ( num_points, destination_vertices );

  00191	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00194	50		 push	 eax
  00195	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  00198	51		 push	 ecx
  00199	e8 00 00 00 00	 call	 ?draw_strip_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_strip_primitive

; 650  : }

  0019e	5f		 pop	 edi
  0019f	5e		 pop	 esi
  001a0	5b		 pop	 ebx
  001a1	8b e5		 mov	 esp, ebp
  001a3	5d		 pop	 ebp
  001a4	c2 04 00	 ret	 4
?render_3d_terrain_texture_zy_byte_strip@@YGXH@Z ENDP	; render_3d_terrain_texture_zy_byte_strip
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_texture_zy_word_strip@@YGXH@Z
_TEXT	SEGMENT
_y$1 = -24						; size = 4
_y_texture_scale$ = -20					; size = 4
_xz_texture_scale$ = -16				; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_texture_zy_word_strip@@YGXH@Z PROC	; render_3d_terrain_texture_zy_word_strip, COMDAT

; 561  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 58	 sub	 esp, 88			; 00000058H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 562  : 
; 563  : 	int
; 564  : 		count,
; 565  : 		this_point;
; 566  : 
; 567  : 	LPD3DTLVERTEX
; 568  : 		destination_vertices;
; 569  : 
; 570  : 	float
; 571  : 		xz_texture_scale,
; 572  : 		y_texture_scale;
; 573  : 
; 574  : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 575  : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 ec	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 576  : 
; 577  : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00030	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 578  : 
; 579  : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 580  : 
; 581  : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d 2f 01 00
	00		 jge	 $LN3@render_3d_

; 582  : 	{
; 583  : 
; 584  : 		float
; 585  : 			y;
; 586  : 	
; 587  : 		this_point = terrain_3d_sector_point_word_references[count].point;

  00064	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00067	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_sector_point_word_references@@3PAUTERRAIN_3D_POINT_WORD_REFERENCE@@A ; terrain_3d_sector_point_word_references
  0006d	0f b7 14 41	 movzx	 edx, WORD PTR [ecx+eax*2]
  00071	89 55 f8	 mov	 DWORD PTR _this_point$[ebp], edx

; 588  : 	
; 589  : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00074	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00079	8b 4d f8	 mov	 ecx, DWORD PTR _this_point$[ebp]
  0007c	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  00082	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00086	0f b7 c0	 movzx	 eax, ax
  00089	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0008d	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  00095	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  0009d	f3 0f 11 45 e8	 movss	 DWORD PTR _y$1[ebp], xmm0

; 590  : 
; 591  : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].z ) * xz_texture_scale;

  000a2	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000a5	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000ab	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  000b0	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000b4	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000b9	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000bc	c1 e0 05	 shl	 eax, 5
  000bf	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000c2	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 592  : 		destination_vertices[count].tv = y * y_texture_scale;

  000c8	f3 0f 10 45 e8	 movss	 xmm0, DWORD PTR _y$1[ebp]
  000cd	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000d2	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000d5	c1 e0 05	 shl	 eax, 5
  000d8	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000db	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 593  : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000e1	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e4	c1 e0 04	 shl	 eax, 4
  000e7	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000ea	c1 e1 05	 shl	 ecx, 5
  000ed	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000f0	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000f6	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 594  : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000f9	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000fc	c1 e0 04	 shl	 eax, 4
  000ff	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00102	c1 e1 05	 shl	 ecx, 5
  00105	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00108	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0010e	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 595  : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  00112	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00115	c1 e0 04	 shl	 eax, 4
  00118	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00120	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00128	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  00130	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00134	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00137	c1 e1 05	 shl	 ecx, 5
  0013a	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0013d	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 596  : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00143	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00146	c1 e0 04	 shl	 eax, 4
  00149	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0014c	c1 e1 05	 shl	 ecx, 5
  0014f	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00152	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00158	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 597  : 		destination_vertices[count].color = transformed_3d_point_colours[this_point].colour;

  0015c	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0015f	c1 e0 05	 shl	 eax, 5
  00162	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00165	8b 55 f8	 mov	 edx, DWORD PTR _this_point$[ebp]
  00168	8b 14 d5 00 00
	00 00		 mov	 edx, DWORD PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[edx*8]
  0016f	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 598  : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00173	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00176	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  0017e	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00181	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  00184	c1 e2 05	 shl	 edx, 5
  00187	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  0018a	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 599  : 	}

  0018e	e9 bc fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 600  : 
; 601  : 	draw_strip_primitive ( num_points, destination_vertices );

  00193	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00196	50		 push	 eax
  00197	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  0019a	51		 push	 ecx
  0019b	e8 00 00 00 00	 call	 ?draw_strip_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_strip_primitive

; 602  : }

  001a0	5f		 pop	 edi
  001a1	5e		 pop	 esi
  001a2	5b		 pop	 ebx
  001a3	8b e5		 mov	 esp, ebp
  001a5	5d		 pop	 ebp
  001a6	c2 04 00	 ret	 4
?render_3d_terrain_texture_zy_word_strip@@YGXH@Z ENDP	; render_3d_terrain_texture_zy_word_strip
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_texture_xy_byte_strip@@YGXH@Z
_TEXT	SEGMENT
_y$1 = -24						; size = 4
_y_texture_scale$ = -20					; size = 4
_xz_texture_scale$ = -16				; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_texture_xy_byte_strip@@YGXH@Z PROC	; render_3d_terrain_texture_xy_byte_strip, COMDAT

; 513  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 58	 sub	 esp, 88			; 00000058H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 514  : 
; 515  : 	int
; 516  : 		count,
; 517  : 		this_point;
; 518  : 
; 519  : 	LPD3DTLVERTEX
; 520  : 		destination_vertices;
; 521  : 
; 522  : 	float
; 523  : 		xz_texture_scale,
; 524  : 		y_texture_scale;
; 525  : 
; 526  : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 527  : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 ec	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 528  : 
; 529  : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00030	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 530  : 
; 531  : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 532  : 
; 533  : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d 2c 01 00
	00		 jge	 $LN3@render_3d_

; 534  : 	{
; 535  : 
; 536  : 		float
; 537  : 			y;
; 538  : 	
; 539  : 		this_point = terrain_3d_sector_point_byte_references[count].point;

  00064	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_point_byte_references@@3PAUTERRAIN_3D_POINT_BYTE_REFERENCE@@A ; terrain_3d_sector_point_byte_references
  00069	03 45 fc	 add	 eax, DWORD PTR _count$[ebp]
  0006c	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  0006f	89 4d f8	 mov	 DWORD PTR _this_point$[ebp], ecx

; 540  : 	
; 541  : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00072	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00077	8b 4d f8	 mov	 ecx, DWORD PTR _this_point$[ebp]
  0007a	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  00080	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00084	0f b7 c0	 movzx	 eax, ax
  00087	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0008b	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  00093	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  0009b	f3 0f 11 45 e8	 movss	 DWORD PTR _y$1[ebp], xmm0

; 542  : 
; 543  : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].x ) * xz_texture_scale;

  000a0	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000a3	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000a9	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  000ad	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000b1	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000b6	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000b9	c1 e0 05	 shl	 eax, 5
  000bc	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000bf	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 544  : 		destination_vertices[count].tv = y * y_texture_scale;

  000c5	f3 0f 10 45 e8	 movss	 xmm0, DWORD PTR _y$1[ebp]
  000ca	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000cf	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000d2	c1 e0 05	 shl	 eax, 5
  000d5	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000d8	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 545  : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000de	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e1	c1 e0 04	 shl	 eax, 4
  000e4	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000e7	c1 e1 05	 shl	 ecx, 5
  000ea	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000ed	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000f3	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 546  : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000f6	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000f9	c1 e0 04	 shl	 eax, 4
  000fc	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000ff	c1 e1 05	 shl	 ecx, 5
  00102	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00105	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0010b	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 547  : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  0010f	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00112	c1 e0 04	 shl	 eax, 4
  00115	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0011d	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00125	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0012d	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00131	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00134	c1 e1 05	 shl	 ecx, 5
  00137	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0013a	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 548  : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00140	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00143	c1 e0 04	 shl	 eax, 4
  00146	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00149	c1 e1 05	 shl	 ecx, 5
  0014c	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0014f	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00155	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 549  : 		destination_vertices[count].color = transformed_3d_point_colours[this_point].colour;

  00159	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0015c	c1 e0 05	 shl	 eax, 5
  0015f	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00162	8b 55 f8	 mov	 edx, DWORD PTR _this_point$[ebp]
  00165	8b 14 d5 00 00
	00 00		 mov	 edx, DWORD PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[edx*8]
  0016c	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 550  : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00170	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00173	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  0017b	c1 e1 18	 shl	 ecx, 24			; 00000018H
  0017e	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  00181	c1 e2 05	 shl	 edx, 5
  00184	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00187	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 551  : 	}

  0018b	e9 bf fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 552  : 
; 553  : 	draw_strip_primitive ( num_points, destination_vertices );

  00190	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00193	50		 push	 eax
  00194	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  00197	51		 push	 ecx
  00198	e8 00 00 00 00	 call	 ?draw_strip_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_strip_primitive

; 554  : }

  0019d	5f		 pop	 edi
  0019e	5e		 pop	 esi
  0019f	5b		 pop	 ebx
  001a0	8b e5		 mov	 esp, ebp
  001a2	5d		 pop	 ebp
  001a3	c2 04 00	 ret	 4
?render_3d_terrain_texture_xy_byte_strip@@YGXH@Z ENDP	; render_3d_terrain_texture_xy_byte_strip
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_texture_xy_word_strip@@YGXH@Z
_TEXT	SEGMENT
_y$1 = -24						; size = 4
_y_texture_scale$ = -20					; size = 4
_xz_texture_scale$ = -16				; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_texture_xy_word_strip@@YGXH@Z PROC	; render_3d_terrain_texture_xy_word_strip, COMDAT

; 465  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 58	 sub	 esp, 88			; 00000058H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 466  : 
; 467  : 	int
; 468  : 		count,
; 469  : 		this_point;
; 470  : 
; 471  : 	LPD3DTLVERTEX
; 472  : 		destination_vertices;
; 473  : 
; 474  : 	float
; 475  : 		xz_texture_scale,
; 476  : 		y_texture_scale;
; 477  : 
; 478  : 	xz_texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _xz_texture_scale$[ebp], xmm0

; 479  : 	y_texture_scale = current_terrain_type_class->y_texture_scale;

  00018	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0001d	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00022	f3 0f 11 45 ec	 movss	 DWORD PTR _y_texture_scale$[ebp], xmm0

; 480  : 
; 481  : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00027	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00030	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 482  : 
; 483  : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00033	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00036	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0003c	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00040	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 484  : 
; 485  : 	for ( count = 0; count < num_points; count++ )

  00046	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0004d	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  0004f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00052	83 c0 01	 add	 eax, 1
  00055	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00058	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0005b	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0005e	0f 8d 2e 01 00
	00		 jge	 $LN3@render_3d_

; 486  : 	{
; 487  : 
; 488  : 		float
; 489  : 			y;
; 490  : 	
; 491  : 		this_point = terrain_3d_sector_point_word_references[count].point;

  00064	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00067	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_sector_point_word_references@@3PAUTERRAIN_3D_POINT_WORD_REFERENCE@@A ; terrain_3d_sector_point_word_references
  0006d	0f b7 14 41	 movzx	 edx, WORD PTR [ecx+eax*2]
  00071	89 55 f8	 mov	 DWORD PTR _this_point$[ebp], edx

; 492  : 	
; 493  : 		y = terrain_3d_map_minimum_height + ( ( ( float ) current_terrain_points_y[this_point].y ) * terrain_3d_map_scaled_height_difference );

  00074	b8 ff 7f 00 00	 mov	 eax, 32767		; 00007fffH
  00079	8b 4d f8	 mov	 ecx, DWORD PTR _this_point$[ebp]
  0007c	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?current_terrain_points_y@@3PAUTERRAIN_3D_POINT_Y@@A ; current_terrain_points_y
  00082	66 23 04 4a	 and	 ax, WORD PTR [edx+ecx*2]
  00086	0f b7 c0	 movzx	 eax, ax
  00089	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0008d	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_map_scaled_height_difference@@3MA
  00095	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR ?terrain_3d_map_minimum_height@@3MA
  0009d	f3 0f 11 45 e8	 movss	 DWORD PTR _y$1[ebp], xmm0

; 494  : 
; 495  : 		destination_vertices[count].tu = (  current_terrain_points_xz[this_point].x ) * xz_texture_scale;

  000a2	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000a5	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  000ab	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  000af	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  000b3	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _xz_texture_scale$[ebp]
  000b8	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000bb	c1 e0 05	 shl	 eax, 5
  000be	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000c1	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 496  : 		destination_vertices[count].tv = y * y_texture_scale;

  000c7	f3 0f 10 45 e8	 movss	 xmm0, DWORD PTR _y$1[ebp]
  000cc	f3 0f 59 45 ec	 mulss	 xmm0, DWORD PTR _y_texture_scale$[ebp]
  000d1	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000d4	c1 e0 05	 shl	 eax, 5
  000d7	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000da	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 497  : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000e0	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e3	c1 e0 04	 shl	 eax, 4
  000e6	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000e9	c1 e1 05	 shl	 ecx, 5
  000ec	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000ef	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000f5	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 498  : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000f8	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000fb	c1 e0 04	 shl	 eax, 4
  000fe	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00101	c1 e1 05	 shl	 ecx, 5
  00104	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00107	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  0010d	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 499  : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  00111	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00114	c1 e0 04	 shl	 eax, 4
  00117	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  0011f	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  00127	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  0012f	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00133	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00136	c1 e1 05	 shl	 ecx, 5
  00139	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0013c	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 500  : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00142	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00145	c1 e0 04	 shl	 eax, 4
  00148	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0014b	c1 e1 05	 shl	 ecx, 5
  0014e	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00151	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00157	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 501  : 		destination_vertices[count].color = transformed_3d_point_colours[this_point].colour;

  0015b	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0015e	c1 e0 05	 shl	 eax, 5
  00161	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00164	8b 55 f8	 mov	 edx, DWORD PTR _this_point$[ebp]
  00167	8b 14 d5 00 00
	00 00		 mov	 edx, DWORD PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[edx*8]
  0016e	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 502  : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00172	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00175	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  0017d	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00180	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  00183	c1 e2 05	 shl	 edx, 5
  00186	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00189	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 503  : 	}

  0018d	e9 bd fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 504  : 
; 505  : 	draw_strip_primitive ( num_points, destination_vertices );

  00192	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00195	50		 push	 eax
  00196	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  00199	51		 push	 ecx
  0019a	e8 00 00 00 00	 call	 ?draw_strip_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_strip_primitive

; 506  : }

  0019f	5f		 pop	 edi
  001a0	5e		 pop	 esi
  001a1	5b		 pop	 ebx
  001a2	8b e5		 mov	 esp, ebp
  001a4	5d		 pop	 ebp
  001a5	c2 04 00	 ret	 4
?render_3d_terrain_texture_xy_word_strip@@YGXH@Z ENDP	; render_3d_terrain_texture_xy_word_strip
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_byte_strip@@YGXH@Z
_TEXT	SEGMENT
_texture_scale$ = -16					; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_byte_strip@@YGXH@Z PROC		; render_3d_terrain_byte_strip, COMDAT

; 228  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 50	 sub	 esp, 80			; 00000050H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 229  : 
; 230  : 	int
; 231  : 		count,
; 232  : 		this_point;
; 233  : 
; 234  : 	LPD3DTLVERTEX
; 235  : 		destination_vertices;
; 236  : 
; 237  : 	float
; 238  : 		texture_scale;
; 239  : 
; 240  : 	texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _texture_scale$[ebp], xmm0

; 241  : 
; 242  : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00018	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0001b	50		 push	 eax
  0001c	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00021	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 243  : 
; 244  : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00024	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00027	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0002d	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00031	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 245  : 
; 246  : 	//
; 247  : 	// Always do 3 points in a face, cos they're guaranteed
; 248  : 	//
; 249  : 
; 250  : 	for ( count = 0; count < num_points; count++ )

  00037	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0003e	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  00040	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00043	83 c0 01	 add	 eax, 1
  00046	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00049	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0004c	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0004f	0f 8d 0b 01 00
	00		 jge	 $LN3@render_3d_

; 251  : 	{
; 252  : 	
; 253  : 		this_point = terrain_3d_sector_point_byte_references[count].point;

  00055	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_point_byte_references@@3PAUTERRAIN_3D_POINT_BYTE_REFERENCE@@A ; terrain_3d_sector_point_byte_references
  0005a	03 45 fc	 add	 eax, DWORD PTR _count$[ebp]
  0005d	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  00060	89 4d f8	 mov	 DWORD PTR _this_point$[ebp], ecx

; 254  : 	
; 255  : 		destination_vertices[count].tu = ( current_terrain_points_xz[this_point].x ) * texture_scale;

  00063	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00066	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  0006c	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  00070	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00074	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  00079	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0007c	c1 e0 05	 shl	 eax, 5
  0007f	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00082	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 256  : 		destination_vertices[count].tv = ( current_terrain_points_xz[this_point].z ) * texture_scale;

  00088	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0008b	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  00091	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  00096	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  0009a	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  0009f	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000a2	c1 e0 05	 shl	 eax, 5
  000a5	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000a8	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 257  : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000ae	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000b1	c1 e0 04	 shl	 eax, 4
  000b4	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000b7	c1 e1 05	 shl	 ecx, 5
  000ba	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000bd	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000c3	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 258  : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000c6	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000c9	c1 e0 04	 shl	 eax, 4
  000cc	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000cf	c1 e1 05	 shl	 ecx, 5
  000d2	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000d5	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  000db	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 259  : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  000df	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e2	c1 e0 04	 shl	 eax, 4
  000e5	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  000ed	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  000f5	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  000fd	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00101	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00104	c1 e1 05	 shl	 ecx, 5
  00107	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0010a	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 260  : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00110	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00113	c1 e0 04	 shl	 eax, 4
  00116	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00119	c1 e1 05	 shl	 ecx, 5
  0011c	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0011f	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00125	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 261  : 		destination_vertices[count].color = transformed_3d_point_colours[this_point].colour;

  00129	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0012c	c1 e0 05	 shl	 eax, 5
  0012f	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00132	8b 55 f8	 mov	 edx, DWORD PTR _this_point$[ebp]
  00135	8b 14 d5 00 00
	00 00		 mov	 edx, DWORD PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[edx*8]
  0013c	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 262  : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00140	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00143	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  0014b	c1 e1 18	 shl	 ecx, 24			; 00000018H
  0014e	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  00151	c1 e2 05	 shl	 edx, 5
  00154	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00157	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 263  : 	}

  0015b	e9 e0 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 264  : 
; 265  : 	draw_strip_primitive ( num_points, destination_vertices );

  00160	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00163	50		 push	 eax
  00164	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  00167	51		 push	 ecx
  00168	e8 00 00 00 00	 call	 ?draw_strip_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_strip_primitive

; 266  : }

  0016d	5f		 pop	 edi
  0016e	5e		 pop	 esi
  0016f	5b		 pop	 ebx
  00170	8b e5		 mov	 esp, ebp
  00172	5d		 pop	 ebp
  00173	c2 04 00	 ret	 4
?render_3d_terrain_byte_strip@@YGXH@Z ENDP		; render_3d_terrain_byte_strip
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_word_strip@@YGXH@Z
_TEXT	SEGMENT
_texture_scale$ = -16					; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_word_strip@@YGXH@Z PROC		; render_3d_terrain_word_strip, COMDAT

; 187  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 50	 sub	 esp, 80			; 00000050H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 188  : 
; 189  : 	int
; 190  : 		count,
; 191  : 		this_point;
; 192  : 
; 193  : 	LPD3DTLVERTEX
; 194  : 		destination_vertices;
; 195  : 
; 196  : 	float
; 197  : 		texture_scale;
; 198  : 
; 199  : 	texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _texture_scale$[ebp], xmm0

; 200  : 
; 201  : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00018	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0001b	50		 push	 eax
  0001c	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00021	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 202  : 
; 203  : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00024	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00027	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0002d	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00031	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 204  : 
; 205  : 	for ( count = 0; count < num_points; count++ )

  00037	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0003e	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  00040	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00043	83 c0 01	 add	 eax, 1
  00046	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00049	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0004c	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0004f	0f 8d 0d 01 00
	00		 jge	 $LN3@render_3d_

; 206  : 	{
; 207  : 	
; 208  : 		this_point = terrain_3d_sector_point_word_references[count].point;

  00055	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00058	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_sector_point_word_references@@3PAUTERRAIN_3D_POINT_WORD_REFERENCE@@A ; terrain_3d_sector_point_word_references
  0005e	0f b7 14 41	 movzx	 edx, WORD PTR [ecx+eax*2]
  00062	89 55 f8	 mov	 DWORD PTR _this_point$[ebp], edx

; 209  : 	
; 210  : 		destination_vertices[count].tu = ( current_terrain_points_xz[this_point].x ) * texture_scale;

  00065	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00068	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  0006e	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  00072	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00076	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  0007b	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0007e	c1 e0 05	 shl	 eax, 5
  00081	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00084	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 211  : 		destination_vertices[count].tv = ( current_terrain_points_xz[this_point].z ) * texture_scale;

  0008a	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0008d	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  00093	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  00098	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  0009c	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  000a1	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000a4	c1 e0 05	 shl	 eax, 5
  000a7	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  000aa	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 212  : 		destination_vertices[count].sx = transformed_3d_2d_points[this_point].i;

  000b0	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000b3	c1 e0 04	 shl	 eax, 4
  000b6	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000b9	c1 e1 05	 shl	 ecx, 5
  000bc	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000bf	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000c5	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 213  : 		destination_vertices[count].sy = transformed_3d_2d_points[this_point].j;

  000c8	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000cb	c1 e0 04	 shl	 eax, 4
  000ce	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000d1	c1 e1 05	 shl	 ecx, 5
  000d4	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000d7	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  000dd	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 214  : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  000e1	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000e4	c1 e0 04	 shl	 eax, 4
  000e7	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  000ef	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  000f7	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  000ff	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00103	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00106	c1 e1 05	 shl	 ecx, 5
  00109	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0010c	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 215  : 		destination_vertices[count].rhw = transformed_3d_2d_points[this_point].q;

  00112	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00115	c1 e0 04	 shl	 eax, 4
  00118	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0011b	c1 e1 05	 shl	 ecx, 5
  0011e	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00121	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00127	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 216  : 		destination_vertices[count].color = transformed_3d_point_colours[this_point].colour;

  0012b	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0012e	c1 e0 05	 shl	 eax, 5
  00131	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00134	8b 55 f8	 mov	 edx, DWORD PTR _this_point$[ebp]
  00137	8b 14 d5 00 00
	00 00		 mov	 edx, DWORD PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[edx*8]
  0013e	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 217  : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00142	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00145	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  0014d	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00150	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  00153	c1 e2 05	 shl	 edx, 5
  00156	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00159	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 218  : 	}

  0015d	e9 de fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 219  : 
; 220  : 	draw_strip_primitive ( num_points, destination_vertices );

  00162	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00165	50		 push	 eax
  00166	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  00169	51		 push	 ecx
  0016a	e8 00 00 00 00	 call	 ?draw_strip_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_strip_primitive

; 221  : }

  0016f	5f		 pop	 edi
  00170	5e		 pop	 esi
  00171	5b		 pop	 ebx
  00172	8b e5		 mov	 esp, ebp
  00174	5d		 pop	 ebp
  00175	c2 04 00	 ret	 4
?render_3d_terrain_word_strip@@YGXH@Z ENDP		; render_3d_terrain_word_strip
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_byte_fan@@YGXH@Z
_TEXT	SEGMENT
_v$1 = -24						; size = 4
_u$2 = -20						; size = 4
_texture_scale$ = -16					; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_byte_fan@@YGXH@Z PROC		; render_3d_terrain_byte_fan, COMDAT

; 131  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 58	 sub	 esp, 88			; 00000058H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 132  : 
; 133  : 	int
; 134  : 		count,
; 135  : 		this_point;
; 136  : 
; 137  : 	LPD3DTLVERTEX
; 138  : 		destination_vertices;
; 139  : 
; 140  : 	float
; 141  : 		texture_scale;
; 142  : 
; 143  : 	texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _texture_scale$[ebp], xmm0

; 144  : 
; 145  : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00018	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0001b	50		 push	 eax
  0001c	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00021	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 146  : 
; 147  : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00024	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00027	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0002d	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00031	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 148  : 
; 149  : 	for ( count = 0; count < num_points; count++ )

  00037	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0003e	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  00040	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00043	83 c0 01	 add	 eax, 1
  00046	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00049	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0004c	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0004f	0f 8d 33 01 00
	00		 jge	 $LN3@render_3d_

; 150  : 	{
; 151  : 
; 152  : 		float
; 153  : 			u,
; 154  : 			v;
; 155  : 
; 156  : 		this_point = terrain_3d_sector_point_byte_references[count].point;

  00055	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_point_byte_references@@3PAUTERRAIN_3D_POINT_BYTE_REFERENCE@@A ; terrain_3d_sector_point_byte_references
  0005a	03 45 fc	 add	 eax, DWORD PTR _count$[ebp]
  0005d	0f b6 08	 movzx	 ecx, BYTE PTR [eax]
  00060	89 4d f8	 mov	 DWORD PTR _this_point$[ebp], ecx

; 157  : 
; 158  : 		v = current_terrain_points_xz[this_point].z;

  00063	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00066	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  0006c	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  00071	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00075	f3 0f 11 45 e8	 movss	 DWORD PTR _v$1[ebp], xmm0

; 159  : 		u = current_terrain_points_xz[this_point].x;

  0007a	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0007d	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  00083	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  00087	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  0008b	f3 0f 11 45 ec	 movss	 DWORD PTR _u$2[ebp], xmm0

; 160  : 
; 161  : 		*( ( int * ) &destination_vertices[count].sx ) = *( ( int * ) &transformed_3d_2d_points[this_point].i );

  00090	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00093	c1 e0 04	 shl	 eax, 4
  00096	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00099	c1 e1 05	 shl	 ecx, 5
  0009c	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0009f	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000a5	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 162  : 		v *= texture_scale;

  000a8	f3 0f 10 45 e8	 movss	 xmm0, DWORD PTR _v$1[ebp]
  000ad	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  000b2	f3 0f 11 45 e8	 movss	 DWORD PTR _v$1[ebp], xmm0

; 163  : 
; 164  : 		*( ( int * ) &destination_vertices[count].sy ) = *( ( int * ) &transformed_3d_2d_points[this_point].j );

  000b7	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000ba	c1 e0 04	 shl	 eax, 4
  000bd	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000c0	c1 e1 05	 shl	 ecx, 5
  000c3	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000c6	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  000cc	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 165  : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  000d0	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000d3	c1 e0 04	 shl	 eax, 4
  000d6	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  000de	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  000e6	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  000ee	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  000f2	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000f5	c1 e1 05	 shl	 ecx, 5
  000f8	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000fb	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 166  : 
; 167  : 		u *= texture_scale;

  00101	f3 0f 10 45 ec	 movss	 xmm0, DWORD PTR _u$2[ebp]
  00106	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  0010b	f3 0f 11 45 ec	 movss	 DWORD PTR _u$2[ebp], xmm0

; 168  : 
; 169  : 		*( ( int * ) &destination_vertices[count].rhw ) = *( ( int * ) &transformed_3d_2d_points[this_point].q );

  00110	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00113	c1 e0 04	 shl	 eax, 4
  00116	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  00119	c1 e1 05	 shl	 ecx, 5
  0011c	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  0011f	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00125	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 170  : 
; 171  : 		destination_vertices[count].color = transformed_3d_point_colours[this_point].colour;

  00129	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0012c	c1 e0 05	 shl	 eax, 5
  0012f	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00132	8b 55 f8	 mov	 edx, DWORD PTR _this_point$[ebp]
  00135	8b 14 d5 00 00
	00 00		 mov	 edx, DWORD PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[edx*8]
  0013c	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 172  : 
; 173  : 		destination_vertices[count].tv = v;

  00140	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00143	c1 e0 05	 shl	 eax, 5
  00146	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00149	f3 0f 10 45 e8	 movss	 xmm0, DWORD PTR _v$1[ebp]
  0014e	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 174  : 		destination_vertices[count].tu = u;

  00154	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00157	c1 e0 05	 shl	 eax, 5
  0015a	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  0015d	f3 0f 10 45 ec	 movss	 xmm0, DWORD PTR _u$2[ebp]
  00162	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 175  : 
; 176  : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  00168	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0016b	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  00173	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00176	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  00179	c1 e2 05	 shl	 edx, 5
  0017c	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  0017f	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 177  : 	}

  00183	e9 b8 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 178  : 
; 179  : 	draw_fan_primitive ( num_points, destination_vertices );

  00188	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  0018b	50		 push	 eax
  0018c	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  0018f	51		 push	 ecx
  00190	e8 00 00 00 00	 call	 ?draw_fan_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_fan_primitive

; 180  : }

  00195	5f		 pop	 edi
  00196	5e		 pop	 esi
  00197	5b		 pop	 ebx
  00198	8b e5		 mov	 esp, ebp
  0019a	5d		 pop	 ebp
  0019b	c2 04 00	 ret	 4
?render_3d_terrain_byte_fan@@YGXH@Z ENDP		; render_3d_terrain_byte_fan
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrre.c
;	COMDAT ?render_3d_terrain_word_fan@@YGXH@Z
_TEXT	SEGMENT
_v$1 = -24						; size = 4
_u$2 = -20						; size = 4
_texture_scale$ = -16					; size = 4
_destination_vertices$ = -12				; size = 4
_this_point$ = -8					; size = 4
_count$ = -4						; size = 4
_num_points$ = 8					; size = 4
?render_3d_terrain_word_fan@@YGXH@Z PROC		; render_3d_terrain_word_fan, COMDAT

; 74   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 58	 sub	 esp, 88			; 00000058H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 75   : 
; 76   : 	int
; 77   : 		count,
; 78   : 		this_point;
; 79   : 
; 80   : 	LPD3DTLVERTEX
; 81   : 		destination_vertices;
; 82   : 
; 83   : 	float
; 84   : 		texture_scale;
; 85   : 
; 86   : 	texture_scale = current_terrain_type_class->xz_texture_scale;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_terrain_type_class@@3PAUTERRAIN_TYPE_INFO@@A ; current_terrain_type_class
  0000e	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00013	f3 0f 11 45 f0	 movss	 DWORD PTR _texture_scale$[ebp], xmm0

; 87   : 
; 88   : 	destination_vertices = get_d3d_vertices_points_address ( num_points );

  00018	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  0001b	50		 push	 eax
  0001c	e8 00 00 00 00	 call	 ?get_d3d_vertices_points_address@@YGPAU_D3DTLVERTEX@@H@Z ; get_d3d_vertices_points_address
  00021	89 45 f4	 mov	 DWORD PTR _destination_vertices$[ebp], eax

; 89   : 
; 90   : 	terrain_3d_faces_constructed += ( num_points - 2 );

  00024	8b 45 08	 mov	 eax, DWORD PTR _num_points$[ebp]
  00027	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_faces_constructed@@3HA ; terrain_3d_faces_constructed
  0002d	8d 54 01 fe	 lea	 edx, DWORD PTR [ecx+eax-2]
  00031	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_faces_constructed@@3HA, edx ; terrain_3d_faces_constructed

; 91   : 
; 92   : 	for ( count = 0; count < num_points; count++ )

  00037	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0003e	eb 09		 jmp	 SHORT $LN4@render_3d_
$LN2@render_3d_:
  00040	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00043	83 c0 01	 add	 eax, 1
  00046	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@render_3d_:
  00049	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0004c	3b 45 08	 cmp	 eax, DWORD PTR _num_points$[ebp]
  0004f	0f 8d 35 01 00
	00		 jge	 $LN3@render_3d_

; 93   : 	{
; 94   : 
; 95   : 		float
; 96   : 			u,
; 97   : 			v;
; 98   : 
; 99   : 		this_point = terrain_3d_sector_point_word_references[count].point;

  00055	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00058	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_sector_point_word_references@@3PAUTERRAIN_3D_POINT_WORD_REFERENCE@@A ; terrain_3d_sector_point_word_references
  0005e	0f b7 14 41	 movzx	 edx, WORD PTR [ecx+eax*2]
  00062	89 55 f8	 mov	 DWORD PTR _this_point$[ebp], edx

; 100  : 
; 101  : 		v = current_terrain_points_xz[this_point].z;

  00065	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00068	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  0006e	0f bf 54 81 02	 movsx	 edx, WORD PTR [ecx+eax*4+2]
  00073	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  00077	f3 0f 11 45 e8	 movss	 DWORD PTR _v$1[ebp], xmm0

; 102  : 		u = current_terrain_points_xz[this_point].x;

  0007c	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0007f	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_terrain_points_xz@@3PAUTERRAIN_3D_POINT_XZ@@A ; current_terrain_points_xz
  00085	0f bf 14 81	 movsx	 edx, WORD PTR [ecx+eax*4]
  00089	f3 0f 2a c2	 cvtsi2ss xmm0, edx
  0008d	f3 0f 11 45 ec	 movss	 DWORD PTR _u$2[ebp], xmm0

; 103  : 
; 104  : 		*( ( int * ) &destination_vertices[count].sx ) = *( ( int * ) &transformed_3d_2d_points[this_point].i );

  00092	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00095	c1 e0 04	 shl	 eax, 4
  00098	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0009b	c1 e1 05	 shl	 ecx, 5
  0009e	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000a1	8b 80 00 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax]
  000a7	89 04 0a	 mov	 DWORD PTR [edx+ecx], eax

; 105  : 		v *= texture_scale;

  000aa	f3 0f 10 45 e8	 movss	 xmm0, DWORD PTR _v$1[ebp]
  000af	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  000b4	f3 0f 11 45 e8	 movss	 DWORD PTR _v$1[ebp], xmm0

; 106  : 
; 107  : 		*( ( int * ) &destination_vertices[count].sy ) = *( ( int * ) &transformed_3d_2d_points[this_point].j );

  000b9	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000bc	c1 e0 04	 shl	 eax, 4
  000bf	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000c2	c1 e1 05	 shl	 ecx, 5
  000c5	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000c8	8b 80 04 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+4]
  000ce	89 44 0a 04	 mov	 DWORD PTR [edx+ecx+4], eax

; 108  : 
; 109  : 		destination_vertices[count].sz = ( transformed_3d_2d_points[this_point].q * zbuffer_factor ) + zbuffer_constant;

  000d2	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  000d5	c1 e0 04	 shl	 eax, 4
  000d8	f3 0f 5a 80 08
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  000e0	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  000e8	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  000f0	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  000f4	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  000f7	c1 e1 05	 shl	 ecx, 5
  000fa	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  000fd	f3 0f 11 44 0a
	08		 movss	 DWORD PTR [edx+ecx+8], xmm0

; 110  : 
; 111  : 		u *= texture_scale;

  00103	f3 0f 10 45 ec	 movss	 xmm0, DWORD PTR _u$2[ebp]
  00108	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _texture_scale$[ebp]
  0010d	f3 0f 11 45 ec	 movss	 DWORD PTR _u$2[ebp], xmm0

; 112  : 
; 113  : 		*( ( int * ) &destination_vertices[count].rhw ) = *( ( int * ) &transformed_3d_2d_points[this_point].q );

  00112	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  00115	c1 e0 04	 shl	 eax, 4
  00118	8b 4d fc	 mov	 ecx, DWORD PTR _count$[ebp]
  0011b	c1 e1 05	 shl	 ecx, 5
  0011e	8b 55 f4	 mov	 edx, DWORD PTR _destination_vertices$[ebp]
  00121	8b 80 08 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_2d_points@@3PAUOBJECT_TRANSFORMED_2D_POINT@@A[eax+8]
  00127	89 44 0a 0c	 mov	 DWORD PTR [edx+ecx+12], eax

; 114  : 
; 115  : 		destination_vertices[count].color = transformed_3d_point_colours[this_point].colour;

  0012b	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  0012e	c1 e0 05	 shl	 eax, 5
  00131	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  00134	8b 55 f8	 mov	 edx, DWORD PTR _this_point$[ebp]
  00137	8b 14 d5 00 00
	00 00		 mov	 edx, DWORD PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[edx*8]
  0013e	89 54 01 10	 mov	 DWORD PTR [ecx+eax+16], edx

; 116  : 
; 117  : 		destination_vertices[count].tv = v;

  00142	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00145	c1 e0 05	 shl	 eax, 5
  00148	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  0014b	f3 0f 10 45 e8	 movss	 xmm0, DWORD PTR _v$1[ebp]
  00150	f3 0f 11 44 01
	1c		 movss	 DWORD PTR [ecx+eax+28], xmm0

; 118  : 		destination_vertices[count].tu = u;

  00156	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00159	c1 e0 05	 shl	 eax, 5
  0015c	8b 4d f4	 mov	 ecx, DWORD PTR _destination_vertices$[ebp]
  0015f	f3 0f 10 45 ec	 movss	 xmm0, DWORD PTR _u$2[ebp]
  00164	f3 0f 11 44 01
	18		 movss	 DWORD PTR [ecx+eax+24], xmm0

; 119  : 
; 120  : 		destination_vertices[count].specular = RGBA_MAKE ( 0, 0, 0, transformed_3d_point_colours[this_point].fog );

  0016a	8b 45 f8	 mov	 eax, DWORD PTR _this_point$[ebp]
  0016d	0f b6 0c c5 04
	00 00 00	 movzx	 ecx, BYTE PTR ?transformed_3d_point_colours@@3PAUTERRAIN_3D_TRANSFORMED_POINT_COLOUR@@A[eax*8+4]
  00175	c1 e1 18	 shl	 ecx, 24			; 00000018H
  00178	8b 55 fc	 mov	 edx, DWORD PTR _count$[ebp]
  0017b	c1 e2 05	 shl	 edx, 5
  0017e	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  00181	89 4c 10 14	 mov	 DWORD PTR [eax+edx+20], ecx

; 121  : 	}

  00185	e9 b6 fe ff ff	 jmp	 $LN2@render_3d_
$LN3@render_3d_:

; 122  : 
; 123  : 	draw_fan_primitive ( num_points, destination_vertices );

  0018a	8b 45 f4	 mov	 eax, DWORD PTR _destination_vertices$[ebp]
  0018d	50		 push	 eax
  0018e	8b 4d 08	 mov	 ecx, DWORD PTR _num_points$[ebp]
  00191	51		 push	 ecx
  00192	e8 00 00 00 00	 call	 ?draw_fan_primitive@@YGXHPAU_D3DTLVERTEX@@@Z ; draw_fan_primitive

; 124  : }

  00197	5f		 pop	 edi
  00198	5e		 pop	 esi
  00199	5b		 pop	 ebx
  0019a	8b e5		 mov	 esp, ebp
  0019c	5d		 pop	 ebp
  0019d	c2 04 00	 ret	 4
?render_3d_terrain_word_fan@@YGXH@Z ENDP		; render_3d_terrain_word_fan
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\system\fpu.h
;	COMDAT ?asm_convert_float_to_int@@YGXMPAH@Z
_TEXT	SEGMENT
_value$ = 8						; size = 4
_integer$ = 12						; size = 4
?asm_convert_float_to_int@@YGXMPAH@Z PROC		; asm_convert_float_to_int, COMDAT

; 130  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 131  : 
; 132  : 	__asm
; 133  : 	{
; 134  : 
; 135  : 		fld value

  00009	d9 45 08	 fld	 DWORD PTR _value$[ebp]

; 136  : 		mov edx, integer

  0000c	8b 55 0c	 mov	 edx, DWORD PTR _integer$[ebp]

; 137  : 		fistp dword ptr [edx]

  0000f	db 1a		 fistp	 DWORD PTR [edx]

; 138  : 	}
; 139  : }

  00011	5f		 pop	 edi
  00012	5e		 pop	 esi
  00013	5b		 pop	 ebx
  00014	8b e5		 mov	 esp, ebp
  00016	5d		 pop	 ebp
  00017	c2 08 00	 ret	 8
?asm_convert_float_to_int@@YGXMPAH@Z ENDP		; asm_convert_float_to_int
_TEXT	ENDS
END
