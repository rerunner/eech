; Listing generated by Microsoft (R) Optimizing Compiler Version 19.16.27045.0 

	TITLE	C:\Users\nhv90\Projects\eech\aphavoc\source\gunships\cockpits\hind\hi_3dwiper.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRTD
INCLUDELIB OLDNAMES

PUBLIC	?initialise_hind_3d_cockpit_wiper@@YGXXZ	; initialise_hind_3d_cockpit_wiper
PUBLIC	?deinitialise_hind_3d_cockpit_wiper@@YGXXZ	; deinitialise_hind_3d_cockpit_wiper
PUBLIC	?draw_hind_3d_cockpit_wiper@@YGXPAUVIEWPOINT@@@Z ; draw_hind_3d_cockpit_wiper
PUBLIC	__real@3f884c0067e87a69
PUBLIC	__real@3f88937ef07572fd
PUBLIC	__real@bfe84b8401800000
PUBLIC	__real@bfe893011c000000
PUBLIC	__xmm@80000000800000008000000080000000
EXTRN	_memcpy:PROC
EXTRN	?create_screen_for_system_texture@@YGPAUSCREEN@@H@Z:PROC ; create_screen_for_system_texture
EXTRN	?construct_3d_object@@YGPAUOBJECT_3D_INSTANCE@@H@Z:PROC ; construct_3d_object
EXTRN	?destruct_3d_object@@YGXPAUOBJECT_3D_INSTANCE@@@Z:PROC ; destruct_3d_object
EXTRN	?insert_zbiased_relative_object_into_3d_scene@@YGXW4OBJECT_3D_DRAWING_TYPES@@PAUVEC3D@@PAXM@Z:PROC ; insert_zbiased_relative_object_into_3d_scene
EXTRN	?find_sub_object@@YGPAUOBJECT_3D_SUB_INSTANCE@@PAUOBJECT_3D_INSTANCE@@I@Z:PROC ; find_sub_object
EXTRN	?pilot_wiped_rain_texture_screen@@3PAUSCREEN@@A:DWORD ; pilot_wiped_rain_texture_screen
EXTRN	?co_pilot_wiped_rain_texture_screen@@3PAUSCREEN@@A:DWORD ; co_pilot_wiped_rain_texture_screen
EXTRN	?pilot_wiper@@3HA:DWORD				; pilot_wiper
EXTRN	?co_pilot_wiper@@3HA:DWORD			; co_pilot_wiper
EXTRN	?pilot_wipe_type@@3W4WIPE_TYPES@@A:DWORD	; pilot_wipe_type
EXTRN	?co_pilot_wipe_type@@3W4WIPE_TYPES@@A:DWORD	; co_pilot_wipe_type
EXTRN	?wiper_position@@3MA:DWORD			; wiper_position
EXTRN	__fltused:DWORD
_BSS	SEGMENT
?wiper_inst3d@@3PAUOBJECT_3D_INSTANCE@@A DD 01H DUP (?)	; wiper_inst3d
?wiper_arm_object@@3PAUOBJECT_3D_SUB_INSTANCE@@A DD 01H DUP (?) ; wiper_arm_object
?wiper_rod_object@@3PAUOBJECT_3D_SUB_INSTANCE@@A DD 01H DUP (?) ; wiper_rod_object
?wiper_blade_object@@3PAUOBJECT_3D_SUB_INSTANCE@@A DD 01H DUP (?) ; wiper_blade_object
_BSS	ENDS
;	COMDAT __xmm@80000000800000008000000080000000
CONST	SEGMENT
__xmm@80000000800000008000000080000000 DB 00H, 00H, 00H, 080H, 00H, 00H, 00H
	DB	080H, 00H, 00H, 00H, 080H, 00H, 00H, 00H, 080H
CONST	ENDS
;	COMDAT __real@bfe893011c000000
CONST	SEGMENT
__real@bfe893011c000000 DQ 0bfe893011c000000r	; -0.767945
CONST	ENDS
;	COMDAT __real@bfe84b8401800000
CONST	SEGMENT
__real@bfe84b8401800000 DQ 0bfe84b8401800000r	; -0.759218
CONST	ENDS
;	COMDAT __real@3f88937ef07572fd
CONST	SEGMENT
__real@3f88937ef07572fd DQ 03f88937ef07572fdr	; 0.0120001
CONST	ENDS
;	COMDAT __real@3f884c0067e87a69
CONST	SEGMENT
__real@3f884c0067e87a69 DQ 03f884c0067e87a69r	; 0.0118637
CONST	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\aphavoc\source\gunships\cockpits\hind\hi_3dwiper.c
;	COMDAT ?draw_hind_3d_cockpit_wiper@@YGXPAUVIEWPOINT@@@Z
_TEXT	SEGMENT
_vp$ = 8						; size = 4
?draw_hind_3d_cockpit_wiper@@YGXPAUVIEWPOINT@@@Z PROC	; draw_hind_3d_cockpit_wiper, COMDAT

; 36   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 37   : 	//
; 38   : 	// rotate wiper arms
; 39   : 	//
; 40   : 
; 41   : 	wiper_arm_object->relative_roll = rad(-44.0) + wiper_position * (rad (88.0) / MAX_WIPER_POSITION);

  00009	f3 0f 5a 05 00
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?wiper_position@@3MA
  00011	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3f88937ef07572fd
  00019	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR __real@bfe893011c000000
  00021	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00025	a1 00 00 00 00	 mov	 eax, DWORD PTR ?wiper_arm_object@@3PAUOBJECT_3D_SUB_INSTANCE@@A
  0002a	f3 0f 11 40 20	 movss	 DWORD PTR [eax+32], xmm0

; 42   : 	wiper_rod_object->relative_roll = rad(-43.5) + wiper_position * (rad (87.0) / MAX_WIPER_POSITION);

  0002f	f3 0f 5a 05 00
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?wiper_position@@3MA
  00037	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3f884c0067e87a69
  0003f	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR __real@bfe84b8401800000
  00047	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  0004b	a1 00 00 00 00	 mov	 eax, DWORD PTR ?wiper_rod_object@@3PAUOBJECT_3D_SUB_INSTANCE@@A
  00050	f3 0f 11 40 20	 movss	 DWORD PTR [eax+32], xmm0

; 43   : 	
; 44   : 	//
; 45   : 	// rotate wiper blade
; 46   : 	//
; 47   : 
; 48   : 	wiper_blade_object->relative_roll = -wiper_arm_object->relative_roll;

  00055	a1 00 00 00 00	 mov	 eax, DWORD PTR ?wiper_arm_object@@3PAUOBJECT_3D_SUB_INSTANCE@@A
  0005a	f3 0f 10 40 20	 movss	 xmm0, DWORD PTR [eax+32]
  0005f	0f 57 05 00 00
	00 00		 xorps	 xmm0, DWORD PTR __xmm@80000000800000008000000080000000
  00066	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?wiper_blade_object@@3PAUOBJECT_3D_SUB_INSTANCE@@A
  0006c	f3 0f 11 41 20	 movss	 DWORD PTR [ecx+32], xmm0

; 49   : 
; 50   : 	//
; 51   : 	// draw wiper arm and blade
; 52   : 	//
; 53   : 
; 54   : 	memcpy (&wiper_inst3d->vp, vp, sizeof (viewpoint));

  00071	6a 30		 push	 48			; 00000030H
  00073	8b 45 08	 mov	 eax, DWORD PTR _vp$[ebp]
  00076	50		 push	 eax
  00077	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?wiper_inst3d@@3PAUOBJECT_3D_INSTANCE@@A
  0007d	83 c1 08	 add	 ecx, 8
  00080	51		 push	 ecx
  00081	e8 00 00 00 00	 call	 _memcpy
  00086	83 c4 0c	 add	 esp, 12			; 0000000cH

; 55   : 	insert_relative_object_into_3d_scene (OBJECT_3D_DRAW_TYPE_ZBUFFERED_OBJECT, &wiper_inst3d->vp.position, wiper_inst3d);

  00089	51		 push	 ecx
  0008a	0f 57 c0	 xorps	 xmm0, xmm0
  0008d	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00092	a1 00 00 00 00	 mov	 eax, DWORD PTR ?wiper_inst3d@@3PAUOBJECT_3D_INSTANCE@@A
  00097	50		 push	 eax
  00098	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?wiper_inst3d@@3PAUOBJECT_3D_INSTANCE@@A
  0009e	83 c1 08	 add	 ecx, 8
  000a1	51		 push	 ecx
  000a2	6a 02		 push	 2
  000a4	e8 00 00 00 00	 call	 ?insert_zbiased_relative_object_into_3d_scene@@YGXW4OBJECT_3D_DRAWING_TYPES@@PAUVEC3D@@PAXM@Z ; insert_zbiased_relative_object_into_3d_scene

; 56   : }

  000a9	5f		 pop	 edi
  000aa	5e		 pop	 esi
  000ab	5b		 pop	 ebx
  000ac	8b e5		 mov	 esp, ebp
  000ae	5d		 pop	 ebp
  000af	c2 04 00	 ret	 4
?draw_hind_3d_cockpit_wiper@@YGXPAUVIEWPOINT@@@Z ENDP	; draw_hind_3d_cockpit_wiper
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\aphavoc\source\gunships\cockpits\hind\hi_3dwiper.c
;	COMDAT ?deinitialise_hind_3d_cockpit_wiper@@YGXXZ
_TEXT	SEGMENT
?deinitialise_hind_3d_cockpit_wiper@@YGXXZ PROC		; deinitialise_hind_3d_cockpit_wiper, COMDAT

; 31   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 32   : 	destruct_3d_object (wiper_inst3d);

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?wiper_inst3d@@3PAUOBJECT_3D_INSTANCE@@A
  0000e	50		 push	 eax
  0000f	e8 00 00 00 00	 call	 ?destruct_3d_object@@YGXPAUOBJECT_3D_INSTANCE@@@Z ; destruct_3d_object

; 33   : }

  00014	5f		 pop	 edi
  00015	5e		 pop	 esi
  00016	5b		 pop	 ebx
  00017	8b e5		 mov	 esp, ebp
  00019	5d		 pop	 ebp
  0001a	c3		 ret	 0
?deinitialise_hind_3d_cockpit_wiper@@YGXXZ ENDP		; deinitialise_hind_3d_cockpit_wiper
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\aphavoc\source\gunships\cockpits\hind\hi_3dwiper.c
;	COMDAT ?initialise_hind_3d_cockpit_wiper@@YGXXZ
_TEXT	SEGMENT
?initialise_hind_3d_cockpit_wiper@@YGXXZ PROC		; initialise_hind_3d_cockpit_wiper, COMDAT

; 14   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 15   : 	wiper_inst3d = construct_3d_object (OBJECT_3D_MI24V_WIPER);

  00009	68 d5 0a 00 00	 push	 2773			; 00000ad5H
  0000e	e8 00 00 00 00	 call	 ?construct_3d_object@@YGPAUOBJECT_3D_INSTANCE@@H@Z ; construct_3d_object
  00013	a3 00 00 00 00	 mov	 DWORD PTR ?wiper_inst3d@@3PAUOBJECT_3D_INSTANCE@@A, eax

; 16   : 
; 17   : 	pilot_wiper = TRUE;

  00018	c7 05 00 00 00
	00 01 00 00 00	 mov	 DWORD PTR ?pilot_wiper@@3HA, 1 ; pilot_wiper

; 18   : 	pilot_wiped_rain_texture_screen = create_screen_for_system_texture (TEXTURE_INDEX_HAVOC_PILOT_RAIN_WIPE);

  00022	68 0c 08 00 00	 push	 2060			; 0000080cH
  00027	e8 00 00 00 00	 call	 ?create_screen_for_system_texture@@YGPAUSCREEN@@H@Z ; create_screen_for_system_texture
  0002c	a3 00 00 00 00	 mov	 DWORD PTR ?pilot_wiped_rain_texture_screen@@3PAUSCREEN@@A, eax ; pilot_wiped_rain_texture_screen

; 19   : 	pilot_wipe_type = WIPE_TYPE_LEFT_THEN_RIGHT;

  00031	c7 05 00 00 00
	00 01 00 00 00	 mov	 DWORD PTR ?pilot_wipe_type@@3W4WIPE_TYPES@@A, 1 ; pilot_wipe_type

; 20   : 
; 21   : 	co_pilot_wiper = FALSE;

  0003b	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?co_pilot_wiper@@3HA, 0 ; co_pilot_wiper

; 22   : 	co_pilot_wiped_rain_texture_screen = NULL;

  00045	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?co_pilot_wiped_rain_texture_screen@@3PAUSCREEN@@A, 0 ; co_pilot_wiped_rain_texture_screen

; 23   : 	co_pilot_wipe_type = WIPE_TYPE_INVALID;

  0004f	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?co_pilot_wipe_type@@3W4WIPE_TYPES@@A, 0 ; co_pilot_wipe_type

; 24   : 	
; 25   : 	wiper_arm_object = find_sub_object(wiper_inst3d, OBJECT_3D_SUB_OBJECT_HAVOC_VIRTUAL_COCKPIT_WIPER_ARM);

  00059	68 85 00 00 00	 push	 133			; 00000085H
  0005e	a1 00 00 00 00	 mov	 eax, DWORD PTR ?wiper_inst3d@@3PAUOBJECT_3D_INSTANCE@@A
  00063	50		 push	 eax
  00064	e8 00 00 00 00	 call	 ?find_sub_object@@YGPAUOBJECT_3D_SUB_INSTANCE@@PAUOBJECT_3D_INSTANCE@@I@Z ; find_sub_object
  00069	a3 00 00 00 00	 mov	 DWORD PTR ?wiper_arm_object@@3PAUOBJECT_3D_SUB_INSTANCE@@A, eax

; 26   : 	wiper_rod_object = find_sub_object(wiper_inst3d, OBJECT_3D_SUB_OBJECT_HAVOC_VIRTUAL_COCKPIT_WIPER_ROD);

  0006e	68 87 00 00 00	 push	 135			; 00000087H
  00073	a1 00 00 00 00	 mov	 eax, DWORD PTR ?wiper_inst3d@@3PAUOBJECT_3D_INSTANCE@@A
  00078	50		 push	 eax
  00079	e8 00 00 00 00	 call	 ?find_sub_object@@YGPAUOBJECT_3D_SUB_INSTANCE@@PAUOBJECT_3D_INSTANCE@@I@Z ; find_sub_object
  0007e	a3 00 00 00 00	 mov	 DWORD PTR ?wiper_rod_object@@3PAUOBJECT_3D_SUB_INSTANCE@@A, eax

; 27   : 	wiper_blade_object = find_sub_object(wiper_inst3d, OBJECT_3D_SUB_OBJECT_HAVOC_VIRTUAL_COCKPIT_WIPER_BLADE);

  00083	68 86 00 00 00	 push	 134			; 00000086H
  00088	a1 00 00 00 00	 mov	 eax, DWORD PTR ?wiper_inst3d@@3PAUOBJECT_3D_INSTANCE@@A
  0008d	50		 push	 eax
  0008e	e8 00 00 00 00	 call	 ?find_sub_object@@YGPAUOBJECT_3D_SUB_INSTANCE@@PAUOBJECT_3D_INSTANCE@@I@Z ; find_sub_object
  00093	a3 00 00 00 00	 mov	 DWORD PTR ?wiper_blade_object@@3PAUOBJECT_3D_SUB_INSTANCE@@A, eax

; 28   : }

  00098	5f		 pop	 edi
  00099	5e		 pop	 esi
  0009a	5b		 pop	 ebx
  0009b	8b e5		 mov	 esp, ebp
  0009d	5d		 pop	 ebp
  0009e	c3		 ret	 0
?initialise_hind_3d_cockpit_wiper@@YGXXZ ENDP		; initialise_hind_3d_cockpit_wiper
_TEXT	ENDS
END
