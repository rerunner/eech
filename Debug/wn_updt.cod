; Listing generated by Microsoft (R) Optimizing Compiler Version 19.16.27045.0 

	TITLE	C:\Users\nhv90\Projects\eech\aphavoc\source\entity\mobile\weapon\wn_updt.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRTD
INCLUDELIB OLDNAMES

PUBLIC	?overload_weapon_update_functions@@YGXXZ	; overload_weapon_update_functions
PUBLIC	?__LINE__Var@?0??update_server@@YGXPAUENTITY@@@Z@4JA ; `update_server'::`1'::__LINE__Var
PUBLIC	??_C@_0EL@NHDPHOFC@c?3?2users?2nhv90?2projects?2eech?2ap@ ; `string'
EXTRN	?process_assert@@YGXPBD0H@Z:PROC		; process_assert
EXTRN	?update_weapon_animation@@YGXPAUENTITY@@@Z:PROC	; update_weapon_animation
EXTRN	?update_decoy@@YGXPAUENTITY@@@Z:PROC		; update_decoy
EXTRN	?weapon_movement@@YGXPAUENTITY@@@Z:PROC		; weapon_movement
EXTRN	?create_client_server_weapon_killed_explosion_effect@@YGXPAUENTITY@@@Z:PROC ; create_client_server_weapon_killed_explosion_effect
EXTRN	?null_entity_pointer_message@@3PBDB:DWORD	; null_entity_pointer_message
EXTRN	?system_comms_model@@3W4COMMS_MODEL_TYPES@@A:DWORD ; system_comms_model
EXTRN	?fn_destroy_client_server_entity_family@@3PAY01P6GXPAUENTITY@@@ZA:BYTE ; fn_destroy_client_server_entity_family
EXTRN	?fn_update_client_server_entity@@3PAY01P6GXPAUENTITY@@@ZA:BYTE ; fn_update_client_server_entity
EXTRN	?weapon_database@@3PAUWEAPON_DATA@@A:BYTE	; weapon_database
;	COMDAT ??_C@_0EL@NHDPHOFC@c?3?2users?2nhv90?2projects?2eech?2ap@
CONST	SEGMENT
??_C@_0EL@NHDPHOFC@c?3?2users?2nhv90?2projects?2eech?2ap@ DB 'c:\users\nh'
	DB	'v90\projects\eech\aphavoc\source\entity\mobile\weapon\wn_updt'
	DB	'.c', 00H					; `string'
CONST	ENDS
;	COMDAT ?__LINE__Var@?0??update_server@@YGXPAUENTITY@@@Z@4JA
_DATA	SEGMENT
?__LINE__Var@?0??update_server@@YGXPAUENTITY@@@Z@4JA DD 050H ; `update_server'::`1'::__LINE__Var
_DATA	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\aphavoc\source\entity\mobile\weapon\wn_updt.c
;	COMDAT ?update_client@@YGXPAUENTITY@@@Z
_TEXT	SEGMENT
_raw$ = -4						; size = 4
_en$ = 8						; size = 4
?update_client@@YGXPAUENTITY@@@Z PROC			; update_client, COMDAT

; 115  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 116  : 	weapon
; 117  : 		*raw;
; 118  : 
; 119  : 	raw = (weapon *) get_local_entity_data (en);

  00009	8b 45 08	 mov	 eax, DWORD PTR _en$[ebp]
  0000c	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  0000f	89 4d fc	 mov	 DWORD PTR _raw$[ebp], ecx

; 120  : 
; 121  : 	if (raw->mob.kill_next_update)

  00012	8b 45 fc	 mov	 eax, DWORD PTR _raw$[ebp]
  00015	8b 48 7c	 mov	 ecx, DWORD PTR [eax+124]
  00018	c1 e9 03	 shr	 ecx, 3
  0001b	83 e1 03	 and	 ecx, 3
  0001e	74 02		 je	 SHORT $LN2@update_cli

; 122  : 	{
; 123  : 		return;

  00020	eb 32		 jmp	 SHORT $LN1@update_cli
$LN2@update_cli:

; 124  : 	}
; 125  : 
; 126  : 	weapon_movement (en);

  00022	8b 45 08	 mov	 eax, DWORD PTR _en$[ebp]
  00025	50		 push	 eax
  00026	e8 00 00 00 00	 call	 ?weapon_movement@@YGXPAUENTITY@@@Z ; weapon_movement

; 127  : 
; 128  : 	update_weapon_animation (en);

  0002b	8b 45 08	 mov	 eax, DWORD PTR _en$[ebp]
  0002e	50		 push	 eax
  0002f	e8 00 00 00 00	 call	 ?update_weapon_animation@@YGXPAUENTITY@@@Z ; update_weapon_animation

; 129  : 
; 130  : 	if (raw->kill_code != WEAPON_KILL_CODE_OK)

  00034	8b 45 fc	 mov	 eax, DWORD PTR _raw$[ebp]
  00037	8b 88 8c 00 00
	00		 mov	 ecx, DWORD PTR [eax+140]
  0003d	83 e1 07	 and	 ecx, 7
  00040	74 12		 je	 SHORT $LN1@update_cli

; 131  : 	{
; 132  : 		raw->mob.kill_next_update = TRUE;

  00042	8b 45 fc	 mov	 eax, DWORD PTR _raw$[ebp]
  00045	8b 48 7c	 mov	 ecx, DWORD PTR [eax+124]
  00048	83 e1 e7	 and	 ecx, -25		; ffffffe7H
  0004b	83 c9 08	 or	 ecx, 8
  0004e	8b 55 fc	 mov	 edx, DWORD PTR _raw$[ebp]
  00051	89 4a 7c	 mov	 DWORD PTR [edx+124], ecx
$LN1@update_cli:

; 133  : 	}
; 134  : }

  00054	5f		 pop	 edi
  00055	5e		 pop	 esi
  00056	5b		 pop	 ebx
  00057	8b e5		 mov	 esp, ebp
  00059	5d		 pop	 ebp
  0005a	c2 04 00	 ret	 4
?update_client@@YGXPAUENTITY@@@Z ENDP			; update_client
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\aphavoc\source\entity\mobile\weapon\wn_updt.c
;	COMDAT ?update_server@@YGXPAUENTITY@@@Z
_TEXT	SEGMENT
tv76 = -72						; size = 4
_raw$ = -4						; size = 4
_en$ = 8						; size = 4
?update_server@@YGXPAUENTITY@@@Z PROC			; update_server, COMDAT

; 80   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 48	 sub	 esp, 72			; 00000048H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 81   : 	weapon
; 82   : 		*raw;
; 83   : 
; 84   : 	raw = (weapon *) get_local_entity_data (en);

  00009	8b 45 08	 mov	 eax, DWORD PTR _en$[ebp]
  0000c	8b 48 04	 mov	 ecx, DWORD PTR [eax+4]
  0000f	89 4d fc	 mov	 DWORD PTR _raw$[ebp], ecx

; 85   : 
; 86   : 	if (raw->mob.kill_next_update)

  00012	8b 45 fc	 mov	 eax, DWORD PTR _raw$[ebp]
  00015	8b 48 7c	 mov	 ecx, DWORD PTR [eax+124]
  00018	c1 e9 03	 shr	 ecx, 3
  0001b	83 e1 03	 and	 ecx, 3
  0001e	74 4c		 je	 SHORT $LN2@update_ser

; 87   : 	{
; 88   : 		destroy_client_server_entity_family (en);

  00020	83 7d 08 00	 cmp	 DWORD PTR _en$[ebp], 0
  00024	74 0a		 je	 SHORT $LN6@update_ser
  00026	8b 45 08	 mov	 eax, DWORD PTR _en$[ebp]
  00029	8b 08		 mov	 ecx, DWORD PTR [eax]
  0002b	89 4d b8	 mov	 DWORD PTR tv76[ebp], ecx
  0002e	eb 21		 jmp	 SHORT $LN7@update_ser
$LN6@update_ser:
  00030	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?__LINE__Var@?0??update_server@@YGXPAUENTITY@@@Z@4JA
  00036	83 c2 08	 add	 edx, 8
  00039	52		 push	 edx
  0003a	68 00 00 00 00	 push	 OFFSET ??_C@_0EL@NHDPHOFC@c?3?2users?2nhv90?2projects?2eech?2ap@
  0003f	a1 00 00 00 00	 mov	 eax, DWORD PTR ?null_entity_pointer_message@@3PBDB ; null_entity_pointer_message
  00044	50		 push	 eax
  00045	e8 00 00 00 00	 call	 ?process_assert@@YGXPBD0H@Z ; process_assert
  0004a	c7 45 b8 00 00
	00 00		 mov	 DWORD PTR tv76[ebp], 0
$LN7@update_ser:
  00051	8b 4d 08	 mov	 ecx, DWORD PTR _en$[ebp]
  00054	51		 push	 ecx
  00055	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?system_comms_model@@3W4COMMS_MODEL_TYPES@@A ; system_comms_model
  0005b	c1 e2 02	 shl	 edx, 2
  0005e	8b 45 b8	 mov	 eax, DWORD PTR tv76[ebp]
  00061	8b 8c c2 00 00
	00 00		 mov	 ecx, DWORD PTR ?fn_destroy_client_server_entity_family@@3PAY01P6GXPAUENTITY@@@ZA[edx+eax*8]
  00068	ff d1		 call	 ecx

; 89   : 
; 90   : 		return;

  0006a	eb 56		 jmp	 SHORT $LN1@update_ser
$LN2@update_ser:

; 91   : 	}
; 92   : 
; 93   : 	weapon_movement (en);

  0006c	8b 45 08	 mov	 eax, DWORD PTR _en$[ebp]
  0006f	50		 push	 eax
  00070	e8 00 00 00 00	 call	 ?weapon_movement@@YGXPAUENTITY@@@Z ; weapon_movement

; 94   : 
; 95   : 	update_weapon_animation (en);

  00075	8b 45 08	 mov	 eax, DWORD PTR _en$[ebp]
  00078	50		 push	 eax
  00079	e8 00 00 00 00	 call	 ?update_weapon_animation@@YGXPAUENTITY@@@Z ; update_weapon_animation

; 96   : 
; 97   : 	if (weapon_database[raw->mob.sub_type].decoy_type != WEAPON_DECOY_TYPE_NONE)

  0007e	8b 45 fc	 mov	 eax, DWORD PTR _raw$[ebp]
  00081	69 08 e0 00 00
	00		 imul	 ecx, DWORD PTR [eax], 224
  00087	83 b9 20 00 00
	00 00		 cmp	 DWORD PTR ?weapon_database@@3PAUWEAPON_DATA@@A[ecx+32], 0
  0008e	74 09		 je	 SHORT $LN3@update_ser

; 98   : 	{
; 99   : 		update_decoy (en);

  00090	8b 45 08	 mov	 eax, DWORD PTR _en$[ebp]
  00093	50		 push	 eax
  00094	e8 00 00 00 00	 call	 ?update_decoy@@YGXPAUENTITY@@@Z ; update_decoy
$LN3@update_ser:

; 100  : 	}
; 101  : 
; 102  : 	if (raw->kill_code != WEAPON_KILL_CODE_OK)

  00099	8b 45 fc	 mov	 eax, DWORD PTR _raw$[ebp]
  0009c	8b 88 8c 00 00
	00		 mov	 ecx, DWORD PTR [eax+140]
  000a2	83 e1 07	 and	 ecx, 7
  000a5	74 1b		 je	 SHORT $LN1@update_ser

; 103  : 	{
; 104  : 		create_client_server_weapon_killed_explosion_effect (en);

  000a7	8b 45 08	 mov	 eax, DWORD PTR _en$[ebp]
  000aa	50		 push	 eax
  000ab	e8 00 00 00 00	 call	 ?create_client_server_weapon_killed_explosion_effect@@YGXPAUENTITY@@@Z ; create_client_server_weapon_killed_explosion_effect

; 105  : 
; 106  : 		raw->mob.kill_next_update = TRUE;

  000b0	8b 45 fc	 mov	 eax, DWORD PTR _raw$[ebp]
  000b3	8b 48 7c	 mov	 ecx, DWORD PTR [eax+124]
  000b6	83 e1 e7	 and	 ecx, -25		; ffffffe7H
  000b9	83 c9 08	 or	 ecx, 8
  000bc	8b 55 fc	 mov	 edx, DWORD PTR _raw$[ebp]
  000bf	89 4a 7c	 mov	 DWORD PTR [edx+124], ecx
$LN1@update_ser:

; 107  : 	}
; 108  : }

  000c2	5f		 pop	 edi
  000c3	5e		 pop	 esi
  000c4	5b		 pop	 ebx
  000c5	8b e5		 mov	 esp, ebp
  000c7	5d		 pop	 ebp
  000c8	c2 04 00	 ret	 4
?update_server@@YGXPAUENTITY@@@Z ENDP			; update_server
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\aphavoc\source\entity\mobile\weapon\wn_updt.c
;	COMDAT ?overload_weapon_update_functions@@YGXXZ
_TEXT	SEGMENT
?overload_weapon_update_functions@@YGXXZ PROC		; overload_weapon_update_functions, COMDAT

; 141  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 142  : 	fn_update_client_server_entity[ENTITY_TYPE_WEAPON][COMMS_MODEL_SERVER]	= update_server;

  00009	b8 08 00 00 00	 mov	 eax, 8
  0000e	6b c8 25	 imul	 ecx, eax, 37
  00011	ba 04 00 00 00	 mov	 edx, 4
  00016	6b c2 00	 imul	 eax, edx, 0
  00019	c7 84 01 00 00
	00 00 00 00 00
	00		 mov	 DWORD PTR ?fn_update_client_server_entity@@3PAY01P6GXPAUENTITY@@@ZA[ecx+eax], OFFSET ?update_server@@YGXPAUENTITY@@@Z ; update_server

; 143  : 
; 144  : 	fn_update_client_server_entity[ENTITY_TYPE_WEAPON][COMMS_MODEL_CLIENT]  = update_client;

  00024	b8 08 00 00 00	 mov	 eax, 8
  00029	6b c8 25	 imul	 ecx, eax, 37
  0002c	ba 04 00 00 00	 mov	 edx, 4
  00031	c1 e2 00	 shl	 edx, 0
  00034	c7 84 11 00 00
	00 00 00 00 00
	00		 mov	 DWORD PTR ?fn_update_client_server_entity@@3PAY01P6GXPAUENTITY@@@ZA[ecx+edx], OFFSET ?update_client@@YGXPAUENTITY@@@Z ; update_client

; 145  : }

  0003f	5f		 pop	 edi
  00040	5e		 pop	 esi
  00041	5b		 pop	 ebx
  00042	8b e5		 mov	 esp, ebp
  00044	5d		 pop	 ebp
  00045	c3		 ret	 0
?overload_weapon_update_functions@@YGXXZ ENDP		; overload_weapon_update_functions
_TEXT	ENDS
END
