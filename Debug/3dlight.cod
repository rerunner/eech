; Listing generated by Microsoft (R) Optimizing Compiler Version 19.16.27045.0 

	TITLE	C:\Users\nhv90\Projects\eech\modules\3d\3dlight.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRTD
INCLUDELIB OLDNAMES

PUBLIC	?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A		; ambient_3d_light
PUBLIC	?current_3d_sun@@3PAULIGHT_3D_SOURCE@@A		; current_3d_sun
PUBLIC	?current_3d_lights@@3PAULIGHT_3D_SOURCE@@A	; current_3d_lights
PUBLIC	?light_3d_array@@3PAULIGHT_3D_SOURCE@@A		; light_3d_array
PUBLIC	?shadows_enabled@@3HA				; shadows_enabled
PUBLIC	?shadows_strength@@3MA				; shadows_strength
PUBLIC	?saved_current_3d_lights@@3PAULIGHT_3D_SOURCE@@A ; saved_current_3d_lights
PUBLIC	?recoloured_light_array@@3PAULIGHT_3D_SOURCE@@A	; recoloured_light_array
_BSS	SEGMENT
?current_3d_sun@@3PAULIGHT_3D_SOURCE@@A DD 01H DUP (?)	; current_3d_sun
?current_3d_lights@@3PAULIGHT_3D_SOURCE@@A DD 01H DUP (?) ; current_3d_lights
?light_3d_array@@3PAULIGHT_3D_SOURCE@@A DB 01e00H DUP (?) ; light_3d_array
?shadows_enabled@@3HA DD 01H DUP (?)			; shadows_enabled
?shadows_strength@@3MA DD 01H DUP (?)			; shadows_strength
?saved_current_3d_lights@@3PAULIGHT_3D_SOURCE@@A DD 01H DUP (?) ; saved_current_3d_lights
?recoloured_light_array@@3PAULIGHT_3D_SOURCE@@A DB 0780H DUP (?) ; recoloured_light_array
_BSS	ENDS
_DATA	SEGMENT
?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A DD 000000000r ; 0 ; ambient_3d_light
	DD	000000000r			; 0
	DD	000000000r			; 0
	DD	03dcccccdr			; 0.1
	DD	03dcccccdr			; 0.1
	DD	03dcccccdr			; 0.1
	DD	03dcccccdr			; 0.1
	DD	03f800000r			; 1
	DD	000000000r			; 0
	DD	000000000r			; 0
	DD	000000000r			; 0
	ORG $+16
_DATA	ENDS
PUBLIC	?set_3d_main_light_source@@YGXPAUENV_3D@@PAULIGHT_COLOUR@@PAUVEC3D@@H@Z ; set_3d_main_light_source
PUBLIC	?get_3d_ambient_light_level@@YGXPAM00@Z		; get_3d_ambient_light_level
PUBLIC	?set_3d_ambient_light_level@@YGXMMM@Z		; set_3d_ambient_light_level
PUBLIC	?create_light_3d_source@@YGPAULIGHT_3D_SOURCE@@W4LIGHT_3D_TYPE@@HPAUVEC3D@@MMMM@Z ; create_light_3d_source
PUBLIC	?destroy_light_3d_source@@YGXPAULIGHT_3D_SOURCE@@@Z ; destroy_light_3d_source
PUBLIC	?reset_light_3d_sources_in_3d_scene@@YGXXZ	; reset_light_3d_sources_in_3d_scene
PUBLIC	?set_3d_ambient_light_source@@YGXPAUENV_3D@@PAULIGHT_COLOUR@@@Z ; set_3d_ambient_light_source
PUBLIC	?insert_light_3d_source_into_3d_scene@@YGXPAULIGHT_3D_SOURCE@@@Z ; insert_light_3d_source_into_3d_scene
PUBLIC	?insert_main_3d_light_into_3d_scene@@YGXPAULIGHT_3D_SOURCE@@@Z ; insert_main_3d_light_into_3d_scene
PUBLIC	?remove_light_3d_source_from_3d_scene@@YGXPAULIGHT_3D_SOURCE@@@Z ; remove_light_3d_source_from_3d_scene
PUBLIC	?set_light_3d_source_colour@@YGXPAULIGHT_3D_SOURCE@@MMM@Z ; set_light_3d_source_colour
PUBLIC	?set_light_3d_source_radius@@YGXPAULIGHT_3D_SOURCE@@M@Z ; set_light_3d_source_radius
PUBLIC	?copy_and_recolour_current_3d_lights@@YGXUREAL_COLOUR@@@Z ; copy_and_recolour_current_3d_lights
PUBLIC	?restore_uncoloured_current_3d_lights@@YGXXZ	; restore_uncoloured_current_3d_lights
PUBLIC	?__LINE__Var@?0??destroy_light_3d_source@@YGXPAULIGHT_3D_SOURCE@@@Z@4JA ; `destroy_light_3d_source'::`1'::__LINE__Var
PUBLIC	??_C@_0DC@HBFNOLFE@c?3?2users?2nhv90?2projects?2eech?2mo@ ; `string'
PUBLIC	??_C@_05OEPGNJB@light@				; `string'
PUBLIC	?__LINE__Var@?0??set_3d_ambient_light_source@@YGXPAUENV_3D@@PAULIGHT_COLOUR@@@Z@4JA ; `set_3d_ambient_light_source'::`1'::__LINE__Var
PUBLIC	??_C@_03OJGPBPII@env@				; `string'
PUBLIC	?__LINE__Var@?0??set_3d_main_light_source@@YGXPAUENV_3D@@PAULIGHT_COLOUR@@PAUVEC3D@@H@Z@4JA ; `set_3d_main_light_source'::`1'::__LINE__Var
PUBLIC	?__LINE__Var@?0??insert_light_3d_source_into_3d_scene@@YGXPAULIGHT_3D_SOURCE@@@Z@4JA ; `insert_light_3d_source_into_3d_scene'::`1'::__LINE__Var
PUBLIC	?__LINE__Var@?0??remove_light_3d_source_from_3d_scene@@YGXPAULIGHT_3D_SOURCE@@@Z@4JA ; `remove_light_3d_source_from_3d_scene'::`1'::__LINE__Var
PUBLIC	?__LINE__Var@?0??set_light_3d_source_colour@@YGXPAULIGHT_3D_SOURCE@@MMM@Z@4JA ; `set_light_3d_source_colour'::`1'::__LINE__Var
PUBLIC	?__LINE__Var@?0??set_light_3d_source_radius@@YGXPAULIGHT_3D_SOURCE@@M@Z@4JA ; `set_light_3d_source_radius'::`1'::__LINE__Var
PUBLIC	__real@3fbc28f5c28f5c29
PUBLIC	__real@3fd3333333333333
PUBLIC	__real@3fe2e147ae147ae1
PUBLIC	__real@3ffddd97f62b6ae8
PUBLIC	__real@406fe00000000000
EXTRN	?process_assert@@YGXPBD0H@Z:PROC		; process_assert
EXTRN	?safe_malloc_memory@@YGPAXI@Z:PROC		; safe_malloc_memory
EXTRN	?safe_free@@YGXPAX@Z:PROC			; safe_free
EXTRN	?active_3d_environment@@3PAUENV_3D@@A:DWORD	; active_3d_environment
EXTRN	__fltused:DWORD
;	COMDAT __real@406fe00000000000
CONST	SEGMENT
__real@406fe00000000000 DQ 0406fe00000000000r	; 255
CONST	ENDS
;	COMDAT __real@3ffddd97f62b6ae8
CONST	SEGMENT
__real@3ffddd97f62b6ae8 DQ 03ffddd97f62b6ae8r	; 1.8666
CONST	ENDS
;	COMDAT __real@3fe2e147ae147ae1
CONST	SEGMENT
__real@3fe2e147ae147ae1 DQ 03fe2e147ae147ae1r	; 0.59
CONST	ENDS
;	COMDAT __real@3fd3333333333333
CONST	SEGMENT
__real@3fd3333333333333 DQ 03fd3333333333333r	; 0.3
CONST	ENDS
;	COMDAT __real@3fbc28f5c28f5c29
CONST	SEGMENT
__real@3fbc28f5c28f5c29 DQ 03fbc28f5c28f5c29r	; 0.11
CONST	ENDS
;	COMDAT ?__LINE__Var@?0??set_light_3d_source_radius@@YGXPAULIGHT_3D_SOURCE@@M@Z@4JA
_DATA	SEGMENT
?__LINE__Var@?0??set_light_3d_source_radius@@YGXPAULIGHT_3D_SOURCE@@M@Z@4JA DD 0193H ; `set_light_3d_source_radius'::`1'::__LINE__Var
_DATA	ENDS
;	COMDAT ?__LINE__Var@?0??set_light_3d_source_colour@@YGXPAULIGHT_3D_SOURCE@@MMM@Z@4JA
_DATA	SEGMENT
?__LINE__Var@?0??set_light_3d_source_colour@@YGXPAULIGHT_3D_SOURCE@@MMM@Z@4JA DD 0183H ; `set_light_3d_source_colour'::`1'::__LINE__Var
_DATA	ENDS
;	COMDAT ?__LINE__Var@?0??remove_light_3d_source_from_3d_scene@@YGXPAULIGHT_3D_SOURCE@@@Z@4JA
_DATA	SEGMENT
?__LINE__Var@?0??remove_light_3d_source_from_3d_scene@@YGXPAULIGHT_3D_SOURCE@@@Z@4JA DD 0143H ; `remove_light_3d_source_from_3d_scene'::`1'::__LINE__Var
_DATA	ENDS
;	COMDAT ?__LINE__Var@?0??insert_light_3d_source_into_3d_scene@@YGXPAULIGHT_3D_SOURCE@@@Z@4JA
_DATA	SEGMENT
?__LINE__Var@?0??insert_light_3d_source_into_3d_scene@@YGXPAULIGHT_3D_SOURCE@@@Z@4JA DD 0efH ; `insert_light_3d_source_into_3d_scene'::`1'::__LINE__Var
_DATA	ENDS
;	COMDAT ?__LINE__Var@?0??set_3d_main_light_source@@YGXPAUENV_3D@@PAULIGHT_COLOUR@@PAUVEC3D@@H@Z@4JA
_DATA	SEGMENT
?__LINE__Var@?0??set_3d_main_light_source@@YGXPAUENV_3D@@PAULIGHT_COLOUR@@PAUVEC3D@@H@Z@4JA DD 0dfH ; `set_3d_main_light_source'::`1'::__LINE__Var
_DATA	ENDS
;	COMDAT ??_C@_03OJGPBPII@env@
CONST	SEGMENT
??_C@_03OJGPBPII@env@ DB 'env', 00H			; `string'
CONST	ENDS
;	COMDAT ?__LINE__Var@?0??set_3d_ambient_light_source@@YGXPAUENV_3D@@PAULIGHT_COLOUR@@@Z@4JA
_DATA	SEGMENT
?__LINE__Var@?0??set_3d_ambient_light_source@@YGXPAUENV_3D@@PAULIGHT_COLOUR@@@Z@4JA DD 0d1H ; `set_3d_ambient_light_source'::`1'::__LINE__Var
_DATA	ENDS
;	COMDAT ??_C@_05OEPGNJB@light@
CONST	SEGMENT
??_C@_05OEPGNJB@light@ DB 'light', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_0DC@HBFNOLFE@c?3?2users?2nhv90?2projects?2eech?2mo@
CONST	SEGMENT
??_C@_0DC@HBFNOLFE@c?3?2users?2nhv90?2projects?2eech?2mo@ DB 'c:\users\nh'
	DB	'v90\projects\eech\modules\3d\3dlight.c', 00H ; `string'
CONST	ENDS
;	COMDAT ?__LINE__Var@?0??destroy_light_3d_source@@YGXPAULIGHT_3D_SOURCE@@@Z@4JA
_DATA	SEGMENT
?__LINE__Var@?0??destroy_light_3d_source@@YGXPAULIGHT_3D_SOURCE@@@Z@4JA DD 0bbH ; `destroy_light_3d_source'::`1'::__LINE__Var
_DATA	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3dlight.c
;	COMDAT ?restore_uncoloured_current_3d_lights@@YGXXZ
_TEXT	SEGMENT
?restore_uncoloured_current_3d_lights@@YGXXZ PROC	; restore_uncoloured_current_3d_lights, COMDAT

; 516  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 517  : 
; 518  : 	ambient_3d_light = recoloured_light_array[0];

  00009	b8 3c 00 00 00	 mov	 eax, 60			; 0000003cH
  0000e	6b f0 00	 imul	 esi, eax, 0
  00011	81 c6 00 00 00
	00		 add	 esi, OFFSET ?recoloured_light_array@@3PAULIGHT_3D_SOURCE@@A ; recoloured_light_array
  00017	b9 0f 00 00 00	 mov	 ecx, 15			; 0000000fH
  0001c	bf 00 00 00 00	 mov	 edi, OFFSET ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A ; ambient_3d_light
  00021	f3 a5		 rep movsd

; 519  : 
; 520  : 	current_3d_lights = saved_current_3d_lights;

  00023	a1 00 00 00 00	 mov	 eax, DWORD PTR ?saved_current_3d_lights@@3PAULIGHT_3D_SOURCE@@A ; saved_current_3d_lights
  00028	a3 00 00 00 00	 mov	 DWORD PTR ?current_3d_lights@@3PAULIGHT_3D_SOURCE@@A, eax ; current_3d_lights

; 521  : }

  0002d	5f		 pop	 edi
  0002e	5e		 pop	 esi
  0002f	5b		 pop	 ebx
  00030	8b e5		 mov	 esp, ebp
  00032	5d		 pop	 ebp
  00033	c3		 ret	 0
?restore_uncoloured_current_3d_lights@@YGXXZ ENDP	; restore_uncoloured_current_3d_lights
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3dlight.c
;	COMDAT ?copy_and_recolour_current_3d_lights@@YGXUREAL_COLOUR@@@Z
_TEXT	SEGMENT
_grey$1 = -16						; size = 4
_blue$ = -12						; size = 4
_green$ = -8						; size = 4
_red$ = -4						; size = 4
_colour$ = 8						; size = 4
?copy_and_recolour_current_3d_lights@@YGXUREAL_COLOUR@@@Z PROC ; copy_and_recolour_current_3d_lights, COMDAT

; 415  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 50	 sub	 esp, 80			; 00000050H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 416  : 
; 417  : 	float
; 418  : 		red,
; 419  : 		green,
; 420  : 		blue;
; 421  : 
; 422  : 	red = colour.red;

  00009	0f b6 45 0a	 movzx	 eax, BYTE PTR _colour$[ebp+2]
  0000d	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  00011	f3 0f 11 45 fc	 movss	 DWORD PTR _red$[ebp], xmm0

; 423  : 	green = colour.green;

  00016	0f b6 45 09	 movzx	 eax, BYTE PTR _colour$[ebp+1]
  0001a	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0001e	f3 0f 11 45 f8	 movss	 DWORD PTR _green$[ebp], xmm0

; 424  : 	blue = colour.blue;

  00023	0f b6 45 08	 movzx	 eax, BYTE PTR _colour$[ebp]
  00027	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0002b	f3 0f 11 45 f4	 movss	 DWORD PTR _blue$[ebp], xmm0

; 425  : 
; 426  : 	red /= 255.0;

  00030	f3 0f 5a 45 fc	 cvtss2sd xmm0, DWORD PTR _red$[ebp]
  00035	f2 0f 5e 05 00
	00 00 00	 divsd	 xmm0, QWORD PTR __real@406fe00000000000
  0003d	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00041	f3 0f 11 45 fc	 movss	 DWORD PTR _red$[ebp], xmm0

; 427  : 	green /= 255.0;

  00046	f3 0f 5a 45 f8	 cvtss2sd xmm0, DWORD PTR _green$[ebp]
  0004b	f2 0f 5e 05 00
	00 00 00	 divsd	 xmm0, QWORD PTR __real@406fe00000000000
  00053	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00057	f3 0f 11 45 f8	 movss	 DWORD PTR _green$[ebp], xmm0

; 428  : 	blue /= 255.0;

  0005c	f3 0f 5a 45 f4	 cvtss2sd xmm0, DWORD PTR _blue$[ebp]
  00061	f2 0f 5e 05 00
	00 00 00	 divsd	 xmm0, QWORD PTR __real@406fe00000000000
  00069	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  0006d	f3 0f 11 45 f4	 movss	 DWORD PTR _blue$[ebp], xmm0

; 429  : 
; 430  : 	red *= 1.8666;

  00072	f3 0f 5a 45 fc	 cvtss2sd xmm0, DWORD PTR _red$[ebp]
  00077	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3ffddd97f62b6ae8
  0007f	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00083	f3 0f 11 45 fc	 movss	 DWORD PTR _red$[ebp], xmm0

; 431  : 	green *= 1.8666;

  00088	f3 0f 5a 45 f8	 cvtss2sd xmm0, DWORD PTR _green$[ebp]
  0008d	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3ffddd97f62b6ae8
  00095	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00099	f3 0f 11 45 f8	 movss	 DWORD PTR _green$[ebp], xmm0

; 432  : 	blue *= 1.8666;

  0009e	f3 0f 5a 45 f4	 cvtss2sd xmm0, DWORD PTR _blue$[ebp]
  000a3	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3ffddd97f62b6ae8
  000ab	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  000af	f3 0f 11 45 f4	 movss	 DWORD PTR _blue$[ebp], xmm0

; 433  : 
; 434  : 	if (active_3d_environment->render_filter != RENDER_CLEAR )

  000b4	a1 00 00 00 00	 mov	 eax, DWORD PTR ?active_3d_environment@@3PAUENV_3D@@A ; active_3d_environment
  000b9	83 b8 d0 02 00
	00 01		 cmp	 DWORD PTR [eax+720], 1
  000c0	0f 84 93 00 00
	00		 je	 $LN2@copy_and_r

; 435  : 	{
; 436  : 
; 437  : 		float
; 438  : 			grey;
; 439  : 
; 440  : 		grey = red * 0.3 + green * 0.59 + blue + 0.11;

  000c6	f3 0f 5a 45 fc	 cvtss2sd xmm0, DWORD PTR _red$[ebp]
  000cb	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3fd3333333333333
  000d3	f3 0f 5a 4d f8	 cvtss2sd xmm1, DWORD PTR _green$[ebp]
  000d8	f2 0f 59 0d 00
	00 00 00	 mulsd	 xmm1, QWORD PTR __real@3fe2e147ae147ae1
  000e0	f2 0f 58 c1	 addsd	 xmm0, xmm1
  000e4	f3 0f 5a 4d f4	 cvtss2sd xmm1, DWORD PTR _blue$[ebp]
  000e9	f2 0f 58 c1	 addsd	 xmm0, xmm1
  000ed	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR __real@3fbc28f5c28f5c29
  000f5	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  000f9	f3 0f 11 45 f0	 movss	 DWORD PTR _grey$1[ebp], xmm0

; 441  : 	
; 442  : 		//
; 443  : 		// Save the current ambient light
; 444  : 		//
; 445  : 	
; 446  : 		recoloured_light_array[0] = ambient_3d_light;

  000fe	b8 3c 00 00 00	 mov	 eax, 60			; 0000003cH
  00103	6b f8 00	 imul	 edi, eax, 0
  00106	81 c7 00 00 00
	00		 add	 edi, OFFSET ?recoloured_light_array@@3PAULIGHT_3D_SOURCE@@A ; recoloured_light_array
  0010c	b9 0f 00 00 00	 mov	 ecx, 15			; 0000000fH
  00111	be 00 00 00 00	 mov	 esi, OFFSET ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A ; ambient_3d_light
  00116	f3 a5		 rep movsd

; 447  : 	
; 448  : 		ambient_3d_light.colour.red *= grey;

  00118	f3 0f 10 05 18
	00 00 00	 movss	 xmm0, DWORD PTR ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A+24
  00120	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _grey$1[ebp]
  00125	f3 0f 11 05 18
	00 00 00	 movss	 DWORD PTR ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A+24, xmm0

; 449  : 		ambient_3d_light.colour.green *= grey;

  0012d	f3 0f 10 05 1c
	00 00 00	 movss	 xmm0, DWORD PTR ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A+28
  00135	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _grey$1[ebp]
  0013a	f3 0f 11 05 1c
	00 00 00	 movss	 DWORD PTR ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A+28, xmm0

; 450  : 		ambient_3d_light.colour.blue *= grey;

  00142	f3 0f 10 05 20
	00 00 00	 movss	 xmm0, DWORD PTR ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A+32
  0014a	f3 0f 59 45 f0	 mulss	 xmm0, DWORD PTR _grey$1[ebp]
  0014f	f3 0f 11 05 20
	00 00 00	 movss	 DWORD PTR ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A+32, xmm0

; 451  : 	}
; 452  : 	else

  00157	eb 59		 jmp	 SHORT $LN3@copy_and_r
$LN2@copy_and_r:

; 453  : 	{
; 454  : 	
; 455  : 		//
; 456  : 		// Save the current ambient light
; 457  : 		//
; 458  : 	
; 459  : 		recoloured_light_array[0] = ambient_3d_light;

  00159	b8 3c 00 00 00	 mov	 eax, 60			; 0000003cH
  0015e	6b f8 00	 imul	 edi, eax, 0
  00161	81 c7 00 00 00
	00		 add	 edi, OFFSET ?recoloured_light_array@@3PAULIGHT_3D_SOURCE@@A ; recoloured_light_array
  00167	b9 0f 00 00 00	 mov	 ecx, 15			; 0000000fH
  0016c	be 00 00 00 00	 mov	 esi, OFFSET ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A ; ambient_3d_light
  00171	f3 a5		 rep movsd

; 460  : 	
; 461  : 		ambient_3d_light.colour.red *= red;

  00173	f3 0f 10 05 18
	00 00 00	 movss	 xmm0, DWORD PTR ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A+24
  0017b	f3 0f 59 45 fc	 mulss	 xmm0, DWORD PTR _red$[ebp]
  00180	f3 0f 11 05 18
	00 00 00	 movss	 DWORD PTR ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A+24, xmm0

; 462  : 		ambient_3d_light.colour.green *= green;

  00188	f3 0f 10 05 1c
	00 00 00	 movss	 xmm0, DWORD PTR ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A+28
  00190	f3 0f 59 45 f8	 mulss	 xmm0, DWORD PTR _green$[ebp]
  00195	f3 0f 11 05 1c
	00 00 00	 movss	 DWORD PTR ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A+28, xmm0

; 463  : 		ambient_3d_light.colour.blue *= blue;

  0019d	f3 0f 10 05 20
	00 00 00	 movss	 xmm0, DWORD PTR ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A+32
  001a5	f3 0f 59 45 f4	 mulss	 xmm0, DWORD PTR _blue$[ebp]
  001aa	f3 0f 11 05 20
	00 00 00	 movss	 DWORD PTR ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A+32, xmm0
$LN3@copy_and_r:

; 464  : 	}
; 465  : 
; 466  : 	if ( current_3d_lights )

  001b2	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?current_3d_lights@@3PAULIGHT_3D_SOURCE@@A, 0 ; current_3d_lights
  001b9	74 14		 je	 SHORT $LN4@copy_and_r

; 467  : 	{
; 468  : /*
; 469  : 		light_3d_source
; 470  : 			*lights;
; 471  : 	
; 472  : 		int
; 473  : 			current_recoloured_light_index;
; 474  : 
; 475  : 		current_recoloured_light_index = 1;
; 476  : 	
; 477  : 		lights = current_3d_lights;
; 478  : 
; 479  : 		while ( lights )
; 480  : 		{
; 481  : 
; 482  : 			recoloured_light_array[current_recoloured_light_index] = *lights;
; 483  : 
; 484  : 			recoloured_light_array[current_recoloured_light_index].colour.red *= red;
; 485  : 			recoloured_light_array[current_recoloured_light_index].colour.green *= green;
; 486  : 			recoloured_light_array[current_recoloured_light_index].colour.blue *= blue;
; 487  : 
; 488  : 			recoloured_light_array[current_recoloured_light_index].pred = NULL;
; 489  : 			recoloured_light_array[current_recoloured_light_index].succ = NULL;
; 490  : 
; 491  : 			if ( current_recoloured_light_index != 0 )
; 492  : 			{
; 493  : 
; 494  : 				recoloured_light_array[current_recoloured_light_index].pred = &recoloured_light_array[current_recoloured_light_index-1];
; 495  : 				recoloured_light_array[current_recoloured_light_index-1].succ = &recoloured_light_array[current_recoloured_light_index];
; 496  : 			}
; 497  : 
; 498  : 			lights = lights->succ;
; 499  : 
; 500  : 			current_recoloured_light_index++;
; 501  : 		}
; 502  : 		*/
; 503  : 
; 504  : 		saved_current_3d_lights = current_3d_lights;

  001bb	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_3d_lights@@3PAULIGHT_3D_SOURCE@@A ; current_3d_lights
  001c0	a3 00 00 00 00	 mov	 DWORD PTR ?saved_current_3d_lights@@3PAULIGHT_3D_SOURCE@@A, eax ; saved_current_3d_lights

; 505  : 
; 506  : //		current_3d_lights = &recoloured_light_array[1];
; 507  : 		current_3d_lights = NULL;

  001c5	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?current_3d_lights@@3PAULIGHT_3D_SOURCE@@A, 0 ; current_3d_lights
$LN4@copy_and_r:

; 508  : 	}
; 509  : }

  001cf	5f		 pop	 edi
  001d0	5e		 pop	 esi
  001d1	5b		 pop	 ebx
  001d2	8b e5		 mov	 esp, ebp
  001d4	5d		 pop	 ebp
  001d5	c2 04 00	 ret	 4
?copy_and_recolour_current_3d_lights@@YGXUREAL_COLOUR@@@Z ENDP ; copy_and_recolour_current_3d_lights
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3dlight.c
;	COMDAT ?set_light_3d_source_radius@@YGXPAULIGHT_3D_SOURCE@@M@Z
_TEXT	SEGMENT
_light$ = 8						; size = 4
_radius$ = 12						; size = 4
?set_light_3d_source_radius@@YGXPAULIGHT_3D_SOURCE@@M@Z PROC ; set_light_3d_source_radius, COMDAT

; 403  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 404  : 
; 405  : 	ASSERT ( light );

  00009	83 7d 08 00	 cmp	 DWORD PTR _light$[ebp], 0
  0000d	75 18		 jne	 SHORT $LN2@set_light_
  0000f	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?0??set_light_3d_source_radius@@YGXPAULIGHT_3D_SOURCE@@M@Z@4JA
  00014	83 c0 02	 add	 eax, 2
  00017	50		 push	 eax
  00018	68 00 00 00 00	 push	 OFFSET ??_C@_0DC@HBFNOLFE@c?3?2users?2nhv90?2projects?2eech?2mo@
  0001d	68 00 00 00 00	 push	 OFFSET ??_C@_05OEPGNJB@light@
  00022	e8 00 00 00 00	 call	 ?process_assert@@YGXPBD0H@Z ; process_assert
$LN2@set_light_:

; 406  : 
; 407  : 	light->radius = radius;

  00027	8b 45 08	 mov	 eax, DWORD PTR _light$[ebp]
  0002a	f3 0f 10 45 0c	 movss	 xmm0, DWORD PTR _radius$[ebp]
  0002f	f3 0f 11 40 2c	 movss	 DWORD PTR [eax+44], xmm0

; 408  : }

  00034	5f		 pop	 edi
  00035	5e		 pop	 esi
  00036	5b		 pop	 ebx
  00037	8b e5		 mov	 esp, ebp
  00039	5d		 pop	 ebp
  0003a	c2 08 00	 ret	 8
?set_light_3d_source_radius@@YGXPAULIGHT_3D_SOURCE@@M@Z ENDP ; set_light_3d_source_radius
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3dlight.c
;	COMDAT ?set_light_3d_source_colour@@YGXPAULIGHT_3D_SOURCE@@MMM@Z
_TEXT	SEGMENT
_light$ = 8						; size = 4
_red$ = 12						; size = 4
_green$ = 16						; size = 4
_blue$ = 20						; size = 4
?set_light_3d_source_colour@@YGXPAULIGHT_3D_SOURCE@@MMM@Z PROC ; set_light_3d_source_colour, COMDAT

; 387  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 388  : 
; 389  : 	ASSERT ( light );

  00009	83 7d 08 00	 cmp	 DWORD PTR _light$[ebp], 0
  0000d	75 18		 jne	 SHORT $LN2@set_light_
  0000f	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?0??set_light_3d_source_colour@@YGXPAULIGHT_3D_SOURCE@@MMM@Z@4JA
  00014	83 c0 02	 add	 eax, 2
  00017	50		 push	 eax
  00018	68 00 00 00 00	 push	 OFFSET ??_C@_0DC@HBFNOLFE@c?3?2users?2nhv90?2projects?2eech?2mo@
  0001d	68 00 00 00 00	 push	 OFFSET ??_C@_05OEPGNJB@light@
  00022	e8 00 00 00 00	 call	 ?process_assert@@YGXPBD0H@Z ; process_assert
$LN2@set_light_:

; 390  : 
; 391  : 	light->colour.red = red;

  00027	8b 45 08	 mov	 eax, DWORD PTR _light$[ebp]
  0002a	f3 0f 10 45 0c	 movss	 xmm0, DWORD PTR _red$[ebp]
  0002f	f3 0f 11 40 18	 movss	 DWORD PTR [eax+24], xmm0

; 392  : 
; 393  : 	light->colour.green = green;

  00034	8b 45 08	 mov	 eax, DWORD PTR _light$[ebp]
  00037	f3 0f 10 45 10	 movss	 xmm0, DWORD PTR _green$[ebp]
  0003c	f3 0f 11 40 1c	 movss	 DWORD PTR [eax+28], xmm0

; 394  : 
; 395  : 	light->colour.blue = blue;

  00041	8b 45 08	 mov	 eax, DWORD PTR _light$[ebp]
  00044	f3 0f 10 45 14	 movss	 xmm0, DWORD PTR _blue$[ebp]
  00049	f3 0f 11 40 20	 movss	 DWORD PTR [eax+32], xmm0

; 396  : }

  0004e	5f		 pop	 edi
  0004f	5e		 pop	 esi
  00050	5b		 pop	 ebx
  00051	8b e5		 mov	 esp, ebp
  00053	5d		 pop	 ebp
  00054	c2 10 00	 ret	 16			; 00000010H
?set_light_3d_source_colour@@YGXPAULIGHT_3D_SOURCE@@MMM@Z ENDP ; set_light_3d_source_colour
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3dlight.c
;	COMDAT ?remove_light_3d_source_from_3d_scene@@YGXPAULIGHT_3D_SOURCE@@@Z
_TEXT	SEGMENT
_this_light$ = -4					; size = 4
_light$ = 8						; size = 4
?remove_light_3d_source_from_3d_scene@@YGXPAULIGHT_3D_SOURCE@@@Z PROC ; remove_light_3d_source_from_3d_scene, COMDAT

; 323  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 324  : 
; 325  : 	light_3d_source
; 326  : 		*this_light;
; 327  : 
; 328  : 	ASSERT ( light );

  00009	83 7d 08 00	 cmp	 DWORD PTR _light$[ebp], 0
  0000d	75 18		 jne	 SHORT $LN4@remove_lig
  0000f	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?0??remove_light_3d_source_from_3d_scene@@YGXPAULIGHT_3D_SOURCE@@@Z@4JA
  00014	83 c0 05	 add	 eax, 5
  00017	50		 push	 eax
  00018	68 00 00 00 00	 push	 OFFSET ??_C@_0DC@HBFNOLFE@c?3?2users?2nhv90?2projects?2eech?2mo@
  0001d	68 00 00 00 00	 push	 OFFSET ??_C@_05OEPGNJB@light@
  00022	e8 00 00 00 00	 call	 ?process_assert@@YGXPBD0H@Z ; process_assert
$LN4@remove_lig:

; 329  : 
; 330  : 	if ( current_3d_lights )

  00027	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?current_3d_lights@@3PAULIGHT_3D_SOURCE@@A, 0 ; current_3d_lights
  0002e	0f 84 8b 00 00
	00		 je	 $LN1@remove_lig

; 331  : 	{
; 332  : 	
; 333  : 		if ( light == current_3d_lights )

  00034	8b 45 08	 mov	 eax, DWORD PTR _light$[ebp]
  00037	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?current_3d_lights@@3PAULIGHT_3D_SOURCE@@A ; current_3d_lights
  0003d	75 22		 jne	 SHORT $LN6@remove_lig

; 334  : 		{
; 335  : 	
; 336  : 			current_3d_lights = light->succ;

  0003f	8b 45 08	 mov	 eax, DWORD PTR _light$[ebp]
  00042	8b 48 38	 mov	 ecx, DWORD PTR [eax+56]
  00045	89 0d 00 00 00
	00		 mov	 DWORD PTR ?current_3d_lights@@3PAULIGHT_3D_SOURCE@@A, ecx ; current_3d_lights

; 337  : 	
; 338  : 			light->succ = NULL;

  0004b	8b 45 08	 mov	 eax, DWORD PTR _light$[ebp]
  0004e	c7 40 38 00 00
	00 00		 mov	 DWORD PTR [eax+56], 0

; 339  : 	
; 340  : 			light->pred = NULL;

  00055	8b 45 08	 mov	 eax, DWORD PTR _light$[ebp]
  00058	c7 40 34 00 00
	00 00		 mov	 DWORD PTR [eax+52], 0

; 341  : 		}
; 342  : 		else

  0005f	eb 5e		 jmp	 SHORT $LN1@remove_lig
$LN6@remove_lig:

; 343  : 		{
; 344  : 		
; 345  : 			//
; 346  : 			// Go through checking the light is in the scene
; 347  : 			//
; 348  : 		
; 349  : 			this_light = current_3d_lights;

  00061	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_3d_lights@@3PAULIGHT_3D_SOURCE@@A ; current_3d_lights
  00066	89 45 fc	 mov	 DWORD PTR _this_light$[ebp], eax
$LN2@remove_lig:

; 350  : 		
; 351  : 			while ( this_light )

  00069	83 7d fc 00	 cmp	 DWORD PTR _this_light$[ebp], 0
  0006d	74 50		 je	 SHORT $LN1@remove_lig

; 352  : 			{
; 353  : 		
; 354  : 				if ( this_light == light )

  0006f	8b 45 fc	 mov	 eax, DWORD PTR _this_light$[ebp]
  00072	3b 45 08	 cmp	 eax, DWORD PTR _light$[ebp]
  00075	75 3d		 jne	 SHORT $LN8@remove_lig

; 355  : 				{
; 356  : 	
; 357  : 					//
; 358  : 					// The light MUST have a previous light source, as its not at the head of the lights list.
; 359  : 					//
; 360  : 	
; 361  : 					light->pred->succ = light->succ;

  00077	8b 45 08	 mov	 eax, DWORD PTR _light$[ebp]
  0007a	8b 48 34	 mov	 ecx, DWORD PTR [eax+52]
  0007d	8b 55 08	 mov	 edx, DWORD PTR _light$[ebp]
  00080	8b 42 38	 mov	 eax, DWORD PTR [edx+56]
  00083	89 41 38	 mov	 DWORD PTR [ecx+56], eax

; 362  : 	
; 363  : 					if ( light->succ )

  00086	8b 45 08	 mov	 eax, DWORD PTR _light$[ebp]
  00089	83 78 38 00	 cmp	 DWORD PTR [eax+56], 0
  0008d	74 0f		 je	 SHORT $LN9@remove_lig

; 364  : 					{
; 365  : 	
; 366  : 						light->succ->pred = light->pred;

  0008f	8b 45 08	 mov	 eax, DWORD PTR _light$[ebp]
  00092	8b 48 38	 mov	 ecx, DWORD PTR [eax+56]
  00095	8b 55 08	 mov	 edx, DWORD PTR _light$[ebp]
  00098	8b 42 34	 mov	 eax, DWORD PTR [edx+52]
  0009b	89 41 34	 mov	 DWORD PTR [ecx+52], eax
$LN9@remove_lig:

; 367  : 					}
; 368  : 			
; 369  : 					light->pred = NULL;

  0009e	8b 45 08	 mov	 eax, DWORD PTR _light$[ebp]
  000a1	c7 40 34 00 00
	00 00		 mov	 DWORD PTR [eax+52], 0

; 370  : 				
; 371  : 					light->succ = NULL;

  000a8	8b 45 08	 mov	 eax, DWORD PTR _light$[ebp]
  000ab	c7 40 38 00 00
	00 00		 mov	 DWORD PTR [eax+56], 0

; 372  : 			
; 373  : 					break;

  000b2	eb 0b		 jmp	 SHORT $LN1@remove_lig
$LN8@remove_lig:

; 374  : 				}
; 375  : 		
; 376  : 				this_light = this_light->succ;

  000b4	8b 45 fc	 mov	 eax, DWORD PTR _this_light$[ebp]
  000b7	8b 48 38	 mov	 ecx, DWORD PTR [eax+56]
  000ba	89 4d fc	 mov	 DWORD PTR _this_light$[ebp], ecx

; 377  : 			}

  000bd	eb aa		 jmp	 SHORT $LN2@remove_lig
$LN1@remove_lig:

; 378  : 		}
; 379  : 	}
; 380  : }

  000bf	5f		 pop	 edi
  000c0	5e		 pop	 esi
  000c1	5b		 pop	 ebx
  000c2	8b e5		 mov	 esp, ebp
  000c4	5d		 pop	 ebp
  000c5	c2 04 00	 ret	 4
?remove_light_3d_source_from_3d_scene@@YGXPAULIGHT_3D_SOURCE@@@Z ENDP ; remove_light_3d_source_from_3d_scene
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3dlight.c
;	COMDAT ?insert_main_3d_light_into_3d_scene@@YGXPAULIGHT_3D_SOURCE@@@Z
_TEXT	SEGMENT
_sun$ = 8						; size = 4
?insert_main_3d_light_into_3d_scene@@YGXPAULIGHT_3D_SOURCE@@@Z PROC ; insert_main_3d_light_into_3d_scene, COMDAT

; 286  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 287  : 
; 288  : 	//
; 289  : 	// Remove the main 3d light from the list of lights, and put it in again
; 290  : 	//
; 291  : 
; 292  : 	remove_light_3d_source_from_3d_scene ( sun );

  00009	8b 45 08	 mov	 eax, DWORD PTR _sun$[ebp]
  0000c	50		 push	 eax
  0000d	e8 00 00 00 00	 call	 ?remove_light_3d_source_from_3d_scene@@YGXPAULIGHT_3D_SOURCE@@@Z ; remove_light_3d_source_from_3d_scene

; 293  : 
; 294  : 	if ( current_3d_lights )

  00012	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?current_3d_lights@@3PAULIGHT_3D_SOURCE@@A, 0 ; current_3d_lights
  00019	74 2b		 je	 SHORT $LN2@insert_mai

; 295  : 	{
; 296  : 
; 297  : 		sun->pred = NULL;

  0001b	8b 45 08	 mov	 eax, DWORD PTR _sun$[ebp]
  0001e	c7 40 34 00 00
	00 00		 mov	 DWORD PTR [eax+52], 0

; 298  : 
; 299  : 		sun->succ = current_3d_lights;

  00025	8b 45 08	 mov	 eax, DWORD PTR _sun$[ebp]
  00028	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?current_3d_lights@@3PAULIGHT_3D_SOURCE@@A ; current_3d_lights
  0002e	89 48 38	 mov	 DWORD PTR [eax+56], ecx

; 300  : 
; 301  : 		current_3d_lights->pred = sun;

  00031	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_3d_lights@@3PAULIGHT_3D_SOURCE@@A ; current_3d_lights
  00036	8b 4d 08	 mov	 ecx, DWORD PTR _sun$[ebp]
  00039	89 48 34	 mov	 DWORD PTR [eax+52], ecx

; 302  : 
; 303  : 		current_3d_lights = sun;

  0003c	8b 45 08	 mov	 eax, DWORD PTR _sun$[ebp]
  0003f	a3 00 00 00 00	 mov	 DWORD PTR ?current_3d_lights@@3PAULIGHT_3D_SOURCE@@A, eax ; current_3d_lights

; 304  : 	}
; 305  : 	else

  00044	eb 1c		 jmp	 SHORT $LN3@insert_mai
$LN2@insert_mai:

; 306  : 	{
; 307  : 
; 308  : 		current_3d_lights = sun;

  00046	8b 45 08	 mov	 eax, DWORD PTR _sun$[ebp]
  00049	a3 00 00 00 00	 mov	 DWORD PTR ?current_3d_lights@@3PAULIGHT_3D_SOURCE@@A, eax ; current_3d_lights

; 309  : 
; 310  : 		sun->pred = NULL;

  0004e	8b 45 08	 mov	 eax, DWORD PTR _sun$[ebp]
  00051	c7 40 34 00 00
	00 00		 mov	 DWORD PTR [eax+52], 0

; 311  : 
; 312  : 		sun->succ = NULL;

  00058	8b 45 08	 mov	 eax, DWORD PTR _sun$[ebp]
  0005b	c7 40 38 00 00
	00 00		 mov	 DWORD PTR [eax+56], 0
$LN3@insert_mai:

; 313  : 	}
; 314  : 
; 315  : 	current_3d_sun = sun;

  00062	8b 45 08	 mov	 eax, DWORD PTR _sun$[ebp]
  00065	a3 00 00 00 00	 mov	 DWORD PTR ?current_3d_sun@@3PAULIGHT_3D_SOURCE@@A, eax ; current_3d_sun

; 316  : }

  0006a	5f		 pop	 edi
  0006b	5e		 pop	 esi
  0006c	5b		 pop	 ebx
  0006d	8b e5		 mov	 esp, ebp
  0006f	5d		 pop	 ebp
  00070	c2 04 00	 ret	 4
?insert_main_3d_light_into_3d_scene@@YGXPAULIGHT_3D_SOURCE@@@Z ENDP ; insert_main_3d_light_into_3d_scene
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3dlight.c
;	COMDAT ?insert_light_3d_source_into_3d_scene@@YGXPAULIGHT_3D_SOURCE@@@Z
_TEXT	SEGMENT
_last_light$1 = -8					; size = 4
_this_light$2 = -4					; size = 4
_light$ = 8						; size = 4
?insert_light_3d_source_into_3d_scene@@YGXPAULIGHT_3D_SOURCE@@@Z PROC ; insert_light_3d_source_into_3d_scene, COMDAT

; 239  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 48	 sub	 esp, 72			; 00000048H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 240  : 
; 241  : 	ASSERT ( light );

  00009	83 7d 08 00	 cmp	 DWORD PTR _light$[ebp], 0
  0000d	75 18		 jne	 SHORT $LN4@insert_lig
  0000f	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?0??insert_light_3d_source_into_3d_scene@@YGXPAULIGHT_3D_SOURCE@@@Z@4JA
  00014	83 c0 02	 add	 eax, 2
  00017	50		 push	 eax
  00018	68 00 00 00 00	 push	 OFFSET ??_C@_0DC@HBFNOLFE@c?3?2users?2nhv90?2projects?2eech?2mo@
  0001d	68 00 00 00 00	 push	 OFFSET ??_C@_05OEPGNJB@light@
  00022	e8 00 00 00 00	 call	 ?process_assert@@YGXPBD0H@Z ; process_assert
$LN4@insert_lig:

; 242  : 
; 243  : 	if ( current_3d_lights )

  00027	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?current_3d_lights@@3PAULIGHT_3D_SOURCE@@A, 0 ; current_3d_lights
  0002e	74 3d		 je	 SHORT $LN5@insert_lig

; 244  : 	{
; 245  : 
; 246  : 		light_3d_source
; 247  : 			*this_light,
; 248  : 			*last_light;
; 249  : 
; 250  : 		//
; 251  : 		// Insert at the end of the light list
; 252  : 		//
; 253  : 
; 254  : 		this_light = current_3d_lights;

  00030	a1 00 00 00 00	 mov	 eax, DWORD PTR ?current_3d_lights@@3PAULIGHT_3D_SOURCE@@A ; current_3d_lights
  00035	89 45 fc	 mov	 DWORD PTR _this_light$2[ebp], eax
$LN2@insert_lig:

; 255  : 
; 256  : 		while ( this_light )

  00038	83 7d fc 00	 cmp	 DWORD PTR _this_light$2[ebp], 0
  0003c	74 11		 je	 SHORT $LN3@insert_lig

; 257  : 		{
; 258  : 
; 259  : 			last_light = this_light;

  0003e	8b 45 fc	 mov	 eax, DWORD PTR _this_light$2[ebp]
  00041	89 45 f8	 mov	 DWORD PTR _last_light$1[ebp], eax

; 260  : 
; 261  : 			this_light = this_light->succ;

  00044	8b 45 fc	 mov	 eax, DWORD PTR _this_light$2[ebp]
  00047	8b 48 38	 mov	 ecx, DWORD PTR [eax+56]
  0004a	89 4d fc	 mov	 DWORD PTR _this_light$2[ebp], ecx

; 262  : 		}

  0004d	eb e9		 jmp	 SHORT $LN2@insert_lig
$LN3@insert_lig:

; 263  : 
; 264  : 		light->pred = last_light;

  0004f	8b 45 08	 mov	 eax, DWORD PTR _light$[ebp]
  00052	8b 4d f8	 mov	 ecx, DWORD PTR _last_light$1[ebp]
  00055	89 48 34	 mov	 DWORD PTR [eax+52], ecx

; 265  : 
; 266  : 		light->succ = NULL;

  00058	8b 45 08	 mov	 eax, DWORD PTR _light$[ebp]
  0005b	c7 40 38 00 00
	00 00		 mov	 DWORD PTR [eax+56], 0

; 267  : 
; 268  : 		last_light->succ = light;

  00062	8b 45 f8	 mov	 eax, DWORD PTR _last_light$1[ebp]
  00065	8b 4d 08	 mov	 ecx, DWORD PTR _light$[ebp]
  00068	89 48 38	 mov	 DWORD PTR [eax+56], ecx

; 269  : 	}
; 270  : 	else

  0006b	eb 1c		 jmp	 SHORT $LN1@insert_lig
$LN5@insert_lig:

; 271  : 	{
; 272  : 
; 273  : 		light->pred = NULL;

  0006d	8b 45 08	 mov	 eax, DWORD PTR _light$[ebp]
  00070	c7 40 34 00 00
	00 00		 mov	 DWORD PTR [eax+52], 0

; 274  : 
; 275  : 		light->succ = NULL;

  00077	8b 45 08	 mov	 eax, DWORD PTR _light$[ebp]
  0007a	c7 40 38 00 00
	00 00		 mov	 DWORD PTR [eax+56], 0

; 276  : 
; 277  : 		current_3d_lights = light;

  00081	8b 45 08	 mov	 eax, DWORD PTR _light$[ebp]
  00084	a3 00 00 00 00	 mov	 DWORD PTR ?current_3d_lights@@3PAULIGHT_3D_SOURCE@@A, eax ; current_3d_lights
$LN1@insert_lig:

; 278  : 	}
; 279  : }

  00089	5f		 pop	 edi
  0008a	5e		 pop	 esi
  0008b	5b		 pop	 ebx
  0008c	8b e5		 mov	 esp, ebp
  0008e	5d		 pop	 ebp
  0008f	c2 04 00	 ret	 4
?insert_light_3d_source_into_3d_scene@@YGXPAULIGHT_3D_SOURCE@@@Z ENDP ; insert_light_3d_source_into_3d_scene
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3dlight.c
;	COMDAT ?set_3d_ambient_light_source@@YGXPAUENV_3D@@PAULIGHT_COLOUR@@@Z
_TEXT	SEGMENT
_env$ = 8						; size = 4
_colour$ = 12						; size = 4
?set_3d_ambient_light_source@@YGXPAUENV_3D@@PAULIGHT_COLOUR@@@Z PROC ; set_3d_ambient_light_source, COMDAT

; 209  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 210  : 
; 211  : 	ASSERT ( env );

  00009	83 7d 08 00	 cmp	 DWORD PTR _env$[ebp], 0
  0000d	75 18		 jne	 SHORT $LN2@set_3d_amb
  0000f	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?0??set_3d_ambient_light_source@@YGXPAUENV_3D@@PAULIGHT_COLOUR@@@Z@4JA
  00014	83 c0 02	 add	 eax, 2
  00017	50		 push	 eax
  00018	68 00 00 00 00	 push	 OFFSET ??_C@_0DC@HBFNOLFE@c?3?2users?2nhv90?2projects?2eech?2mo@
  0001d	68 00 00 00 00	 push	 OFFSET ??_C@_03OJGPBPII@env@
  00022	e8 00 00 00 00	 call	 ?process_assert@@YGXPBD0H@Z ; process_assert
$LN2@set_3d_amb:

; 212  : 
; 213  : 	env->ambient_light.red = colour->red;

  00027	8b 45 08	 mov	 eax, DWORD PTR _env$[ebp]
  0002a	8b 4d 0c	 mov	 ecx, DWORD PTR _colour$[ebp]
  0002d	8b 11		 mov	 edx, DWORD PTR [ecx]
  0002f	89 90 d8 01 00
	00		 mov	 DWORD PTR [eax+472], edx

; 214  : 	env->ambient_light.green = colour->green;

  00035	8b 45 08	 mov	 eax, DWORD PTR _env$[ebp]
  00038	8b 4d 0c	 mov	 ecx, DWORD PTR _colour$[ebp]
  0003b	8b 51 04	 mov	 edx, DWORD PTR [ecx+4]
  0003e	89 90 dc 01 00
	00		 mov	 DWORD PTR [eax+476], edx

; 215  : 	env->ambient_light.blue = colour->blue;

  00044	8b 45 08	 mov	 eax, DWORD PTR _env$[ebp]
  00047	8b 4d 0c	 mov	 ecx, DWORD PTR _colour$[ebp]
  0004a	8b 51 08	 mov	 edx, DWORD PTR [ecx+8]
  0004d	89 90 e0 01 00
	00		 mov	 DWORD PTR [eax+480], edx

; 216  : }

  00053	5f		 pop	 edi
  00054	5e		 pop	 esi
  00055	5b		 pop	 ebx
  00056	8b e5		 mov	 esp, ebp
  00058	5d		 pop	 ebp
  00059	c2 08 00	 ret	 8
?set_3d_ambient_light_source@@YGXPAUENV_3D@@PAULIGHT_COLOUR@@@Z ENDP ; set_3d_ambient_light_source
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3dlight.c
;	COMDAT ?reset_light_3d_sources_in_3d_scene@@YGXXZ
_TEXT	SEGMENT
?reset_light_3d_sources_in_3d_scene@@YGXXZ PROC		; reset_light_3d_sources_in_3d_scene, COMDAT

; 199  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 200  : 
; 201  : 	current_3d_lights = NULL;

  00009	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?current_3d_lights@@3PAULIGHT_3D_SOURCE@@A, 0 ; current_3d_lights

; 202  : }

  00013	5f		 pop	 edi
  00014	5e		 pop	 esi
  00015	5b		 pop	 ebx
  00016	8b e5		 mov	 esp, ebp
  00018	5d		 pop	 ebp
  00019	c3		 ret	 0
?reset_light_3d_sources_in_3d_scene@@YGXXZ ENDP		; reset_light_3d_sources_in_3d_scene
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3dlight.c
;	COMDAT ?destroy_light_3d_source@@YGXPAULIGHT_3D_SOURCE@@@Z
_TEXT	SEGMENT
_light$ = 8						; size = 4
?destroy_light_3d_source@@YGXPAULIGHT_3D_SOURCE@@@Z PROC ; destroy_light_3d_source, COMDAT

; 187  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 188  : 
; 189  : 	ASSERT ( light );

  00009	83 7d 08 00	 cmp	 DWORD PTR _light$[ebp], 0
  0000d	75 18		 jne	 SHORT $LN2@destroy_li
  0000f	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?0??destroy_light_3d_source@@YGXPAULIGHT_3D_SOURCE@@@Z@4JA
  00014	83 c0 02	 add	 eax, 2
  00017	50		 push	 eax
  00018	68 00 00 00 00	 push	 OFFSET ??_C@_0DC@HBFNOLFE@c?3?2users?2nhv90?2projects?2eech?2mo@
  0001d	68 00 00 00 00	 push	 OFFSET ??_C@_05OEPGNJB@light@
  00022	e8 00 00 00 00	 call	 ?process_assert@@YGXPBD0H@Z ; process_assert
$LN2@destroy_li:

; 190  : 
; 191  : 	safe_free ( light );

  00027	8b 45 08	 mov	 eax, DWORD PTR _light$[ebp]
  0002a	50		 push	 eax
  0002b	e8 00 00 00 00	 call	 ?safe_free@@YGXPAX@Z	; safe_free

; 192  : }

  00030	5f		 pop	 edi
  00031	5e		 pop	 esi
  00032	5b		 pop	 ebx
  00033	8b e5		 mov	 esp, ebp
  00035	5d		 pop	 ebp
  00036	c2 04 00	 ret	 4
?destroy_light_3d_source@@YGXPAULIGHT_3D_SOURCE@@@Z ENDP ; destroy_light_3d_source
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3dlight.c
;	COMDAT ?create_light_3d_source@@YGPAULIGHT_3D_SOURCE@@W4LIGHT_3D_TYPE@@HPAUVEC3D@@MMMM@Z
_TEXT	SEGMENT
_light$ = -4						; size = 4
_type$ = 8						; size = 4
_specular$ = 12						; size = 4
_position$ = 16						; size = 4
_radius$ = 20						; size = 4
_red$ = 24						; size = 4
_green$ = 28						; size = 4
_blue$ = 32						; size = 4
?create_light_3d_source@@YGPAULIGHT_3D_SOURCE@@W4LIGHT_3D_TYPE@@HPAUVEC3D@@MMMM@Z PROC ; create_light_3d_source, COMDAT

; 138  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 139  : 
; 140  : 	light_3d_source
; 141  : 		*light;
; 142  : 
; 143  : 	light = ( light_3d_source * ) safe_malloc ( sizeof ( light_3d_source ) );

  00009	6a 3c		 push	 60			; 0000003cH
  0000b	e8 00 00 00 00	 call	 ?safe_malloc_memory@@YGPAXI@Z ; safe_malloc_memory
  00010	89 45 fc	 mov	 DWORD PTR _light$[ebp], eax

; 144  : 
; 145  : 	if ( light )

  00013	83 7d fc 00	 cmp	 DWORD PTR _light$[ebp], 0
  00017	0f 84 a8 00 00
	00		 je	 $LN2@create_lig

; 146  : 	{
; 147  : 
; 148  : 		//
; 149  : 		// Dependant on the type of light, position is either the position, or the direction
; 150  : 		//
; 151  : 
; 152  : 		light->type = type;

  0001d	8b 45 fc	 mov	 eax, DWORD PTR _light$[ebp]
  00020	8b 4d 08	 mov	 ecx, DWORD PTR _type$[ebp]
  00023	89 48 30	 mov	 DWORD PTR [eax+48], ecx

; 153  : 
; 154  : 		light->colour.red = red;

  00026	8b 45 fc	 mov	 eax, DWORD PTR _light$[ebp]
  00029	f3 0f 10 45 18	 movss	 xmm0, DWORD PTR _red$[ebp]
  0002e	f3 0f 11 40 18	 movss	 DWORD PTR [eax+24], xmm0

; 155  : 		light->colour.green = green;

  00033	8b 45 fc	 mov	 eax, DWORD PTR _light$[ebp]
  00036	f3 0f 10 45 1c	 movss	 xmm0, DWORD PTR _green$[ebp]
  0003b	f3 0f 11 40 1c	 movss	 DWORD PTR [eax+28], xmm0

; 156  : 		light->colour.blue = blue;

  00040	8b 45 fc	 mov	 eax, DWORD PTR _light$[ebp]
  00043	f3 0f 10 45 20	 movss	 xmm0, DWORD PTR _blue$[ebp]
  00048	f3 0f 11 40 20	 movss	 DWORD PTR [eax+32], xmm0

; 157  : 
; 158  : 		if ( specular )

  0004d	83 7d 0c 00	 cmp	 DWORD PTR _specular$[ebp], 0
  00051	74 3d		 je	 SHORT $LN4@create_lig

; 159  : 		{
; 160  : 
; 161  : 			light->intensity = ( red * 0.3 ) + ( green * 0.59 ) + ( blue * 0.11 );

  00053	f3 0f 5a 45 18	 cvtss2sd xmm0, DWORD PTR _red$[ebp]
  00058	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3fd3333333333333
  00060	f3 0f 5a 4d 1c	 cvtss2sd xmm1, DWORD PTR _green$[ebp]
  00065	f2 0f 59 0d 00
	00 00 00	 mulsd	 xmm1, QWORD PTR __real@3fe2e147ae147ae1
  0006d	f2 0f 58 c1	 addsd	 xmm0, xmm1
  00071	f3 0f 5a 4d 20	 cvtss2sd xmm1, DWORD PTR _blue$[ebp]
  00076	f2 0f 59 0d 00
	00 00 00	 mulsd	 xmm1, QWORD PTR __real@3fbc28f5c28f5c29
  0007e	f2 0f 58 c1	 addsd	 xmm0, xmm1
  00082	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00086	8b 45 fc	 mov	 eax, DWORD PTR _light$[ebp]
  00089	f3 0f 11 40 28	 movss	 DWORD PTR [eax+40], xmm0

; 162  : 		}
; 163  : 		else

  0008e	eb 0b		 jmp	 SHORT $LN5@create_lig
$LN4@create_lig:

; 164  : 		{
; 165  : 
; 166  : 			light->intensity = 0.0;

  00090	8b 45 fc	 mov	 eax, DWORD PTR _light$[ebp]
  00093	0f 57 c0	 xorps	 xmm0, xmm0
  00096	f3 0f 11 40 28	 movss	 DWORD PTR [eax+40], xmm0
$LN5@create_lig:

; 167  : 		}
; 168  : 
; 169  : 		light->light_position = *position;

  0009b	8b 45 10	 mov	 eax, DWORD PTR _position$[ebp]
  0009e	8b 4d fc	 mov	 ecx, DWORD PTR _light$[ebp]
  000a1	8b 10		 mov	 edx, DWORD PTR [eax]
  000a3	89 11		 mov	 DWORD PTR [ecx], edx
  000a5	8b 50 04	 mov	 edx, DWORD PTR [eax+4]
  000a8	89 51 04	 mov	 DWORD PTR [ecx+4], edx
  000ab	8b 40 08	 mov	 eax, DWORD PTR [eax+8]
  000ae	89 41 08	 mov	 DWORD PTR [ecx+8], eax

; 170  : 
; 171  : 		light->radius = radius;

  000b1	8b 45 fc	 mov	 eax, DWORD PTR _light$[ebp]
  000b4	f3 0f 10 45 14	 movss	 xmm0, DWORD PTR _radius$[ebp]
  000b9	f3 0f 11 40 2c	 movss	 DWORD PTR [eax+44], xmm0

; 172  : 
; 173  : 		return ( light );

  000be	8b 45 fc	 mov	 eax, DWORD PTR _light$[ebp]
  000c1	eb 04		 jmp	 SHORT $LN3@create_lig

; 174  : 	}
; 175  : 	else

  000c3	eb 02		 jmp	 SHORT $LN3@create_lig
$LN2@create_lig:

; 176  : 	{
; 177  : 
; 178  : 		return ( NULL );

  000c5	33 c0		 xor	 eax, eax
$LN3@create_lig:

; 179  : 	}
; 180  : }

  000c7	5f		 pop	 edi
  000c8	5e		 pop	 esi
  000c9	5b		 pop	 ebx
  000ca	8b e5		 mov	 esp, ebp
  000cc	5d		 pop	 ebp
  000cd	c2 1c 00	 ret	 28			; 0000001cH
?create_light_3d_source@@YGPAULIGHT_3D_SOURCE@@W4LIGHT_3D_TYPE@@HPAUVEC3D@@MMMM@Z ENDP ; create_light_3d_source
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3dlight.c
;	COMDAT ?set_3d_ambient_light_level@@YGXMMM@Z
_TEXT	SEGMENT
_red$ = 8						; size = 4
_green$ = 12						; size = 4
_blue$ = 16						; size = 4
?set_3d_ambient_light_level@@YGXMMM@Z PROC		; set_3d_ambient_light_level, COMDAT

; 124  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 125  : 
; 126  : 	ambient_3d_light.colour.red = red;

  00009	f3 0f 10 45 08	 movss	 xmm0, DWORD PTR _red$[ebp]
  0000e	f3 0f 11 05 18
	00 00 00	 movss	 DWORD PTR ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A+24, xmm0

; 127  : 	ambient_3d_light.colour.green = green;

  00016	f3 0f 10 45 0c	 movss	 xmm0, DWORD PTR _green$[ebp]
  0001b	f3 0f 11 05 1c
	00 00 00	 movss	 DWORD PTR ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A+28, xmm0

; 128  : 	ambient_3d_light.colour.blue = blue;

  00023	f3 0f 10 45 10	 movss	 xmm0, DWORD PTR _blue$[ebp]
  00028	f3 0f 11 05 20
	00 00 00	 movss	 DWORD PTR ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A+32, xmm0

; 129  : 
; 130  : //	ambient_3d_light.colour.intensity = ( ( red * 0.3 ) + ( green * 0.59 ) + ( blue * 0.11 ) );
; 131  : }

  00030	5f		 pop	 edi
  00031	5e		 pop	 esi
  00032	5b		 pop	 ebx
  00033	8b e5		 mov	 esp, ebp
  00035	5d		 pop	 ebp
  00036	c2 0c 00	 ret	 12			; 0000000cH
?set_3d_ambient_light_level@@YGXMMM@Z ENDP		; set_3d_ambient_light_level
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3dlight.c
;	COMDAT ?get_3d_ambient_light_level@@YGXPAM00@Z
_TEXT	SEGMENT
_red$ = 8						; size = 4
_green$ = 12						; size = 4
_blue$ = 16						; size = 4
?get_3d_ambient_light_level@@YGXPAM00@Z PROC		; get_3d_ambient_light_level, COMDAT

; 112  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 113  : 
; 114  : 	*red = ambient_3d_light.colour.red;

  00009	8b 45 08	 mov	 eax, DWORD PTR _red$[ebp]
  0000c	f3 0f 10 05 18
	00 00 00	 movss	 xmm0, DWORD PTR ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A+24
  00014	f3 0f 11 00	 movss	 DWORD PTR [eax], xmm0

; 115  : 	*green = ambient_3d_light.colour.green;

  00018	8b 45 0c	 mov	 eax, DWORD PTR _green$[ebp]
  0001b	f3 0f 10 05 1c
	00 00 00	 movss	 xmm0, DWORD PTR ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A+28
  00023	f3 0f 11 00	 movss	 DWORD PTR [eax], xmm0

; 116  : 	*blue = ambient_3d_light.colour.blue;

  00027	8b 45 10	 mov	 eax, DWORD PTR _blue$[ebp]
  0002a	f3 0f 10 05 20
	00 00 00	 movss	 xmm0, DWORD PTR ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A+32
  00032	f3 0f 11 00	 movss	 DWORD PTR [eax], xmm0

; 117  : }

  00036	5f		 pop	 edi
  00037	5e		 pop	 esi
  00038	5b		 pop	 ebx
  00039	8b e5		 mov	 esp, ebp
  0003b	5d		 pop	 ebp
  0003c	c2 0c 00	 ret	 12			; 0000000cH
?get_3d_ambient_light_level@@YGXPAM00@Z ENDP		; get_3d_ambient_light_level
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3dlight.c
;	COMDAT ?set_3d_main_light_source@@YGXPAUENV_3D@@PAULIGHT_COLOUR@@PAUVEC3D@@H@Z
_TEXT	SEGMENT
_env$ = 8						; size = 4
_colour$ = 12						; size = 4
_direction$ = 16					; size = 4
_shadows$ = 20						; size = 4
?set_3d_main_light_source@@YGXPAUENV_3D@@PAULIGHT_COLOUR@@PAUVEC3D@@H@Z PROC ; set_3d_main_light_source, COMDAT

; 223  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 224  : 
; 225  : 	ASSERT ( env );

  00009	83 7d 08 00	 cmp	 DWORD PTR _env$[ebp], 0
  0000d	75 18		 jne	 SHORT $LN2@set_3d_mai
  0000f	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?0??set_3d_main_light_source@@YGXPAUENV_3D@@PAULIGHT_COLOUR@@PAUVEC3D@@H@Z@4JA
  00014	83 c0 02	 add	 eax, 2
  00017	50		 push	 eax
  00018	68 00 00 00 00	 push	 OFFSET ??_C@_0DC@HBFNOLFE@c?3?2users?2nhv90?2projects?2eech?2mo@
  0001d	68 00 00 00 00	 push	 OFFSET ??_C@_03OJGPBPII@env@
  00022	e8 00 00 00 00	 call	 ?process_assert@@YGXPBD0H@Z ; process_assert
$LN2@set_3d_mai:

; 226  : 
; 227  : 	env->main_3d_light.colour = *colour;

  00027	8b 45 08	 mov	 eax, DWORD PTR _env$[ebp]
  0002a	05 78 02 00 00	 add	 eax, 632		; 00000278H
  0002f	8b 4d 0c	 mov	 ecx, DWORD PTR _colour$[ebp]
  00032	8b 11		 mov	 edx, DWORD PTR [ecx]
  00034	89 10		 mov	 DWORD PTR [eax], edx
  00036	8b 51 04	 mov	 edx, DWORD PTR [ecx+4]
  00039	89 50 04	 mov	 DWORD PTR [eax+4], edx
  0003c	8b 51 08	 mov	 edx, DWORD PTR [ecx+8]
  0003f	89 50 08	 mov	 DWORD PTR [eax+8], edx
  00042	8b 49 0c	 mov	 ecx, DWORD PTR [ecx+12]
  00045	89 48 0c	 mov	 DWORD PTR [eax+12], ecx

; 228  : 	env->main_3d_light.light_direction = *direction;

  00048	8b 45 08	 mov	 eax, DWORD PTR _env$[ebp]
  0004b	05 60 02 00 00	 add	 eax, 608		; 00000260H
  00050	8b 4d 10	 mov	 ecx, DWORD PTR _direction$[ebp]
  00053	8b 11		 mov	 edx, DWORD PTR [ecx]
  00055	89 10		 mov	 DWORD PTR [eax], edx
  00057	8b 51 04	 mov	 edx, DWORD PTR [ecx+4]
  0005a	89 50 04	 mov	 DWORD PTR [eax+4], edx
  0005d	8b 49 08	 mov	 ecx, DWORD PTR [ecx+8]
  00060	89 48 08	 mov	 DWORD PTR [eax+8], ecx

; 229  : 	env->main_3d_light.type = LIGHT_3D_TYPE_DIRECTIONAL;

  00063	8b 45 08	 mov	 eax, DWORD PTR _env$[ebp]
  00066	c7 80 90 02 00
	00 01 00 00 00	 mov	 DWORD PTR [eax+656], 1

; 230  : 
; 231  : 	env->shadows_enabled = shadows;

  00070	8b 45 08	 mov	 eax, DWORD PTR _env$[ebp]
  00073	8b 4d 14	 mov	 ecx, DWORD PTR _shadows$[ebp]
  00076	89 88 9c 02 00
	00		 mov	 DWORD PTR [eax+668], ecx

; 232  : }

  0007c	5f		 pop	 edi
  0007d	5e		 pop	 esi
  0007e	5b		 pop	 ebx
  0007f	8b e5		 mov	 esp, ebp
  00081	5d		 pop	 ebp
  00082	c2 10 00	 ret	 16			; 00000010H
?set_3d_main_light_source@@YGXPAUENV_3D@@PAULIGHT_COLOUR@@PAUVEC3D@@H@Z ENDP ; set_3d_main_light_source
_TEXT	ENDS
END
