; Listing generated by Microsoft (R) Optimizing Compiler Version 19.16.27045.0 

	TITLE	C:\Users\nhv90\Projects\eech\modules\graphics\textscrn.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRTD
INCLUDELIB OLDNAMES

PUBLIC	?create_texture_screen_data@@YGXPAUSCREEN@@HHW4TEXTURE_MAP_TYPES@@HH@Z ; create_texture_screen_data
PUBLIC	?create_system_texture_screen_mapping@@YGXPAUSCREEN@@H@Z ; create_system_texture_screen_mapping
PUBLIC	?get_screen_texture@@YGPAUSCREEN@@PAU1@@Z	; get_screen_texture
PUBLIC	?flush_screen_texture_graphics@@YGXPAUSCREEN@@@Z ; flush_screen_texture_graphics
PUBLIC	??_C@_0EG@GHBJMBJL@Creating?5user?5texture?5screen?3?5?$CF@ ; `string'
PUBLIC	?__LINE__Var@?0??create_system_texture_screen_mapping@@YGXPAUSCREEN@@H@Z@4JA ; `create_system_texture_screen_mapping'::`1'::__LINE__Var
PUBLIC	??_C@_0DJ@BBBIDBIL@c?3?2users?2nhv90?2projects?2eech?2mo@ ; `string'
PUBLIC	??_C@_0CN@FHPBHJBK@system_textures?$FLtexture_index?$FN?9@ ; `string'
PUBLIC	?__LINE__Var@?0??flush_screen_texture_graphics@@YGXPAUSCREEN@@@Z@4JA ; `flush_screen_texture_graphics'::`1'::__LINE__Var
PUBLIC	??_C@_0M@EIMDIJJI@this_screen@			; `string'
PUBLIC	?__LINE__Var@?0??get_screen_texture@@YGPAUSCREEN@@PAU2@@Z@4JA ; `get_screen_texture'::`1'::__LINE__Var
EXTRN	_memcpy:PROC
EXTRN	?process_assert@@YGXPBD0H@Z:PROC		; process_assert
EXTRN	?debug_log@@YAXPBDZZ:PROC			; debug_log
EXTRN	?f3d_texture_create@@YGXPAUSCREEN@@HHIHH@Z:PROC	; f3d_texture_create
EXTRN	?system_textures@@3PAPAUSCREEN@@A:BYTE		; system_textures
;	COMDAT ?__LINE__Var@?0??get_screen_texture@@YGPAUSCREEN@@PAU2@@Z@4JA
_DATA	SEGMENT
?__LINE__Var@?0??get_screen_texture@@YGPAUSCREEN@@PAU2@@Z@4JA DD 081H ; `get_screen_texture'::`1'::__LINE__Var
_DATA	ENDS
;	COMDAT ??_C@_0M@EIMDIJJI@this_screen@
CONST	SEGMENT
??_C@_0M@EIMDIJJI@this_screen@ DB 'this_screen', 00H	; `string'
CONST	ENDS
;	COMDAT ?__LINE__Var@?0??flush_screen_texture_graphics@@YGXPAUSCREEN@@@Z@4JA
_DATA	SEGMENT
?__LINE__Var@?0??flush_screen_texture_graphics@@YGXPAUSCREEN@@@Z@4JA DD 077H ; `flush_screen_texture_graphics'::`1'::__LINE__Var
_DATA	ENDS
;	COMDAT ??_C@_0CN@FHPBHJBK@system_textures?$FLtexture_index?$FN?9@
CONST	SEGMENT
??_C@_0CN@FHPBHJBK@system_textures?$FLtexture_index?$FN?9@ DB 'system_tex'
	DB	'tures[texture_index]->clone_screen', 00H	; `string'
CONST	ENDS
;	COMDAT ??_C@_0DJ@BBBIDBIL@c?3?2users?2nhv90?2projects?2eech?2mo@
CONST	SEGMENT
??_C@_0DJ@BBBIDBIL@c?3?2users?2nhv90?2projects?2eech?2mo@ DB 'c:\users\nh'
	DB	'v90\projects\eech\modules\graphics\textscrn.c', 00H ; `string'
CONST	ENDS
;	COMDAT ?__LINE__Var@?0??create_system_texture_screen_mapping@@YGXPAUSCREEN@@H@Z@4JA
_DATA	SEGMENT
?__LINE__Var@?0??create_system_texture_screen_mapping@@YGXPAUSCREEN@@H@Z@4JA DD 05cH ; `create_system_texture_screen_mapping'::`1'::__LINE__Var
_DATA	ENDS
;	COMDAT ??_C@_0EG@GHBJMBJL@Creating?5user?5texture?5screen?3?5?$CF@
CONST	SEGMENT
??_C@_0EG@GHBJMBJL@Creating?5user?5texture?5screen?3?5?$CF@ DB 'Creating '
	DB	'user texture screen: %d, %d ( %d mipmaps ) ( %d render to ) ', 00H ; `string'
CONST	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\graphics\textscrn.c
;	COMDAT ?flush_screen_texture_graphics@@YGXPAUSCREEN@@@Z
_TEXT	SEGMENT
_this_screen$ = 8					; size = 4
?flush_screen_texture_graphics@@YGXPAUSCREEN@@@Z PROC	; flush_screen_texture_graphics, COMDAT

; 119  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 120  : 
; 121  : 	ASSERT ( this_screen );

  00009	83 7d 08 00	 cmp	 DWORD PTR _this_screen$[ebp], 0
  0000d	75 18		 jne	 SHORT $LN1@flush_scre
  0000f	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?0??flush_screen_texture_graphics@@YGXPAUSCREEN@@@Z@4JA
  00014	83 c0 02	 add	 eax, 2
  00017	50		 push	 eax
  00018	68 00 00 00 00	 push	 OFFSET ??_C@_0DJ@BBBIDBIL@c?3?2users?2nhv90?2projects?2eech?2mo@
  0001d	68 00 00 00 00	 push	 OFFSET ??_C@_0M@EIMDIJJI@this_screen@
  00022	e8 00 00 00 00	 call	 ?process_assert@@YGXPBD0H@Z ; process_assert
$LN1@flush_scre:

; 122  : }

  00027	5f		 pop	 edi
  00028	5e		 pop	 esi
  00029	5b		 pop	 ebx
  0002a	8b e5		 mov	 esp, ebp
  0002c	5d		 pop	 ebp
  0002d	c2 04 00	 ret	 4
?flush_screen_texture_graphics@@YGXPAUSCREEN@@@Z ENDP	; flush_screen_texture_graphics
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\graphics\textscrn.c
;	COMDAT ?get_screen_texture@@YGPAUSCREEN@@PAU1@@Z
_TEXT	SEGMENT
_this_screen$ = 8					; size = 4
?get_screen_texture@@YGPAUSCREEN@@PAU1@@Z PROC		; get_screen_texture, COMDAT

; 129  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 130  : 
; 131  : 	ASSERT ( this_screen );

  00009	83 7d 08 00	 cmp	 DWORD PTR _this_screen$[ebp], 0
  0000d	75 18		 jne	 SHORT $LN2@get_screen
  0000f	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?0??get_screen_texture@@YGPAUSCREEN@@PAU2@@Z@4JA
  00014	83 c0 02	 add	 eax, 2
  00017	50		 push	 eax
  00018	68 00 00 00 00	 push	 OFFSET ??_C@_0DJ@BBBIDBIL@c?3?2users?2nhv90?2projects?2eech?2mo@
  0001d	68 00 00 00 00	 push	 OFFSET ??_C@_0M@EIMDIJJI@this_screen@
  00022	e8 00 00 00 00	 call	 ?process_assert@@YGXPBD0H@Z ; process_assert
$LN2@get_screen:

; 132  : 
; 133  : 	return ( this_screen );

  00027	8b 45 08	 mov	 eax, DWORD PTR _this_screen$[ebp]

; 134  : }

  0002a	5f		 pop	 edi
  0002b	5e		 pop	 esi
  0002c	5b		 pop	 ebx
  0002d	8b e5		 mov	 esp, ebp
  0002f	5d		 pop	 ebp
  00030	c2 04 00	 ret	 4
?get_screen_texture@@YGPAUSCREEN@@PAU1@@Z ENDP		; get_screen_texture
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\graphics\textscrn.c
;	COMDAT ?create_system_texture_screen_mapping@@YGXPAUSCREEN@@H@Z
_TEXT	SEGMENT
_texture$ = -4						; size = 4
_this_screen$ = 8					; size = 4
_texture_index$ = 12					; size = 4
?create_system_texture_screen_mapping@@YGXPAUSCREEN@@H@Z PROC ; create_system_texture_screen_mapping, COMDAT

; 92   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 93   : 
; 94   : 	screen
; 95   : 		*texture;
; 96   : 
; 97   : 	//
; 98   : 	// Usurp a system texture
; 99   : 	//
; 100  : 
; 101  : 	if ( system_textures[texture_index]->used )

  00009	8b 45 0c	 mov	 eax, DWORD PTR _texture_index$[ebp]
  0000c	8b 0c 85 00 00
	00 00		 mov	 ecx, DWORD PTR ?system_textures@@3PAPAUSCREEN@@A[eax*4]
  00013	66 8b 51 0a	 mov	 dx, WORD PTR [ecx+10]
  00017	66 d1 ea	 shr	 dx, 1
  0001a	66 83 e2 01	 and	 dx, 1
  0001e	0f b7 c2	 movzx	 eax, dx
  00021	85 c0		 test	 eax, eax
  00023	74 35		 je	 SHORT $LN2@create_sys

; 102  : 	{
; 103  : 
; 104  : 		ASSERT ( system_textures[texture_index]->clone_screen );

  00025	8b 45 0c	 mov	 eax, DWORD PTR _texture_index$[ebp]
  00028	8b 0c 85 00 00
	00 00		 mov	 ecx, DWORD PTR ?system_textures@@3PAPAUSCREEN@@A[eax*4]
  0002f	66 8b 51 0a	 mov	 dx, WORD PTR [ecx+10]
  00033	66 c1 ea 03	 shr	 dx, 3
  00037	66 83 e2 01	 and	 dx, 1
  0003b	0f b7 c2	 movzx	 eax, dx
  0003e	85 c0		 test	 eax, eax
  00040	75 18		 jne	 SHORT $LN2@create_sys
  00042	a1 00 00 00 00	 mov	 eax, DWORD PTR ?__LINE__Var@?0??create_system_texture_screen_mapping@@YGXPAUSCREEN@@H@Z@4JA
  00047	83 c0 0c	 add	 eax, 12			; 0000000cH
  0004a	50		 push	 eax
  0004b	68 00 00 00 00	 push	 OFFSET ??_C@_0DJ@BBBIDBIL@c?3?2users?2nhv90?2projects?2eech?2mo@
  00050	68 00 00 00 00	 push	 OFFSET ??_C@_0CN@FHPBHJBK@system_textures?$FLtexture_index?$FN?9@
  00055	e8 00 00 00 00	 call	 ?process_assert@@YGXPBD0H@Z ; process_assert
$LN2@create_sys:

; 105  : 	}
; 106  : 
; 107  : 	texture = system_textures[texture_index];

  0005a	8b 45 0c	 mov	 eax, DWORD PTR _texture_index$[ebp]
  0005d	8b 0c 85 00 00
	00 00		 mov	 ecx, DWORD PTR ?system_textures@@3PAPAUSCREEN@@A[eax*4]
  00064	89 4d fc	 mov	 DWORD PTR _texture$[ebp], ecx

; 108  : 
; 109  : 	memcpy ( texture, this_screen, sizeof ( screen ) );

  00067	6a 30		 push	 48			; 00000030H
  00069	8b 45 08	 mov	 eax, DWORD PTR _this_screen$[ebp]
  0006c	50		 push	 eax
  0006d	8b 4d fc	 mov	 ecx, DWORD PTR _texture$[ebp]
  00070	51		 push	 ecx
  00071	e8 00 00 00 00	 call	 _memcpy
  00076	83 c4 0c	 add	 esp, 12			; 0000000cH

; 110  : 
; 111  : 	texture->clone_screen = TRUE;

  00079	8b 45 fc	 mov	 eax, DWORD PTR _texture$[ebp]
  0007c	66 8b 48 0a	 mov	 cx, WORD PTR [eax+10]
  00080	66 83 c9 08	 or	 cx, 8
  00084	8b 55 fc	 mov	 edx, DWORD PTR _texture$[ebp]
  00087	66 89 4a 0a	 mov	 WORD PTR [edx+10], cx

; 112  : }

  0008b	5f		 pop	 edi
  0008c	5e		 pop	 esi
  0008d	5b		 pop	 ebx
  0008e	8b e5		 mov	 esp, ebp
  00090	5d		 pop	 ebp
  00091	c2 08 00	 ret	 8
?create_system_texture_screen_mapping@@YGXPAUSCREEN@@H@Z ENDP ; create_system_texture_screen_mapping
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\graphics\textscrn.c
;	COMDAT ?create_texture_screen_data@@YGXPAUSCREEN@@HHW4TEXTURE_MAP_TYPES@@HH@Z
_TEXT	SEGMENT
_texture$ = 8						; size = 4
_width$ = 12						; size = 4
_height$ = 16						; size = 4
_type$ = 20						; size = 4
_number_of_mipmaps$ = 24				; size = 4
_renderto$ = 28						; size = 4
?create_texture_screen_data@@YGXPAUSCREEN@@HHW4TEXTURE_MAP_TYPES@@HH@Z PROC ; create_texture_screen_data, COMDAT

; 81   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 82   : 	debug_log ( "Creating user texture screen: %d, %d ( %d mipmaps ) ( %d render to ) ", width, height, number_of_mipmaps, renderto );

  00009	8b 45 1c	 mov	 eax, DWORD PTR _renderto$[ebp]
  0000c	50		 push	 eax
  0000d	8b 4d 18	 mov	 ecx, DWORD PTR _number_of_mipmaps$[ebp]
  00010	51		 push	 ecx
  00011	8b 55 10	 mov	 edx, DWORD PTR _height$[ebp]
  00014	52		 push	 edx
  00015	8b 45 0c	 mov	 eax, DWORD PTR _width$[ebp]
  00018	50		 push	 eax
  00019	68 00 00 00 00	 push	 OFFSET ??_C@_0EG@GHBJMBJL@Creating?5user?5texture?5screen?3?5?$CF@
  0001e	e8 00 00 00 00	 call	 ?debug_log@@YAXPBDZZ	; debug_log
  00023	83 c4 14	 add	 esp, 20			; 00000014H

; 83   : 
; 84   : 	f3d_texture_create(texture, width, height, type, number_of_mipmaps, renderto);

  00026	8b 45 1c	 mov	 eax, DWORD PTR _renderto$[ebp]
  00029	50		 push	 eax
  0002a	8b 4d 18	 mov	 ecx, DWORD PTR _number_of_mipmaps$[ebp]
  0002d	51		 push	 ecx
  0002e	8b 55 14	 mov	 edx, DWORD PTR _type$[ebp]
  00031	52		 push	 edx
  00032	8b 45 10	 mov	 eax, DWORD PTR _height$[ebp]
  00035	50		 push	 eax
  00036	8b 4d 0c	 mov	 ecx, DWORD PTR _width$[ebp]
  00039	51		 push	 ecx
  0003a	8b 55 08	 mov	 edx, DWORD PTR _texture$[ebp]
  0003d	52		 push	 edx
  0003e	e8 00 00 00 00	 call	 ?f3d_texture_create@@YGXPAUSCREEN@@HHIHH@Z ; f3d_texture_create

; 85   : }

  00043	5f		 pop	 edi
  00044	5e		 pop	 esi
  00045	5b		 pop	 ebx
  00046	8b e5		 mov	 esp, ebp
  00048	5d		 pop	 ebp
  00049	c2 18 00	 ret	 24			; 00000018H
?create_texture_screen_data@@YGXPAUSCREEN@@HHW4TEXTURE_MAP_TYPES@@HH@Z ENDP ; create_texture_screen_data
_TEXT	ENDS
END
