; Listing generated by Microsoft (R) Optimizing Compiler Version 19.16.27045.0 

	TITLE	C:\Users\nhv90\Projects\eech\modules\3d\3drain.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRTD
INCLUDELIB OLDNAMES

PUBLIC	?generate_lookup_outcode@@YGHHHHH@Z		; generate_lookup_outcode
PUBLIC	?initialise_3d_rain@@YGXMPAUVEC3D@@@Z		; initialise_3d_rain
PUBLIC	?set_3d_snow_texture@@YGXH@Z			; set_3d_snow_texture
PUBLIC	?set_3d_rain_speed@@YGXM@Z			; set_3d_rain_speed
PUBLIC	?set_3d_rain_special_snow_flag@@YGXH@Z		; set_3d_rain_special_snow_flag
PUBLIC	?invalidate_3d_rain@@YGXXZ			; invalidate_3d_rain
PUBLIC	?set_3d_rain_wind@@YGXPAUVEC3D@@M@Z		; set_3d_rain_wind
PUBLIC	?update_3d_rain@@YGXPAUENV_3D@@MQAY02M@Z	; update_3d_rain
PUBLIC	?draw_3d_rain@@YGXXZ				; draw_3d_rain
PUBLIC	__real@00000000
PUBLIC	__real@3e99999a
PUBLIC	__real@3f00002000400080
PUBLIC	__real@3f10000000000000
PUBLIC	__real@3f800000
PUBLIC	__real@3fa999999999999a
PUBLIC	__real@3fbc28f5c28f5c29
PUBLIC	__real@3fc999999999999a
PUBLIC	__real@3fd3333333333333
PUBLIC	__real@3fe0000000000000
PUBLIC	__real@3fe2e147ae147ae1
PUBLIC	__real@3fe999999999999a
PUBLIC	__real@3ff0000000000000
PUBLIC	__real@3ff8000000000000
PUBLIC	__real@40000000
PUBLIC	__real@4020000000000000
PUBLIC	__real@4030000000000000
PUBLIC	__real@4040000000000000
PUBLIC	__real@4059800000000000
PUBLIC	__real@40800000
PUBLIC	__real@42480000
PUBLIC	__real@42a00000
PUBLIC	__real@43200000
PUBLIC	__real@437f0000
PUBLIC	__real@44000000
PUBLIC	__real@c2a00000
PUBLIC	__real@c3200000
PUBLIC	__real@c4000000
EXTRN	?normalise_any_3d_vector@@YGMPAUVEC3D@@@Z:PROC	; normalise_any_3d_vector
EXTRN	?get_3d_vector_magnitude@@YGMPBUVEC3D@@@Z:PROC	; get_3d_vector_magnitude
EXTRN	?clip_3d_polygon@@YGPAUVERTEX@@PAU1@H@Z:PROC	; clip_3d_polygon
EXTRN	?generate_3d_outcode@@YGHMM@Z:PROC		; generate_3d_outcode
EXTRN	?draw_line_primitive@@YGXPAU_D3DTLVERTEX@@@Z:PROC ; draw_line_primitive
EXTRN	?flush_line_primitives@@YGXXZ:PROC		; flush_line_primitives
EXTRN	?set_d3d_alpha_fog_zbuffer@@YGXHHHH@Z:PROC	; set_d3d_alpha_fog_zbuffer
EXTRN	?set_d3d_int_state@@YGXW4_D3DRENDERSTATETYPE@@K@Z:PROC ; set_d3d_int_state
EXTRN	?set_d3d_texture@@YGXHPAUSCREEN@@@Z:PROC	; set_d3d_texture
EXTRN	?set_d3d_texture_stage_state@@YGXHHH@Z:PROC	; set_d3d_texture_stage_state
EXTRN	?get_d3d_line_vertices_points_address@@YGPAU_D3DTLVERTEX@@XZ:PROC ; get_d3d_line_vertices_points_address
EXTRN	?draw_wbuffered_flat_shaded_textured_polygon@@YGXPAUVERTEX@@UREAL_COLOUR@@1@Z:PROC ; draw_wbuffered_flat_shaded_textured_polygon
EXTRN	?hither_clip_3d_polygon@@YGPAUVERTEX@@PAU1@PAH@Z:PROC ; hither_clip_3d_polygon
EXTRN	?construct_3d_line@@YGPAUVERTEX@@PAUPOINT_3D_PLAIN_REFERENCE@@HPAH@Z:PROC ; construct_3d_line
EXTRN	?get_cloud_3d_base_height@@YGMXZ:PROC		; get_cloud_3d_base_height
EXTRN	?random_number_seed@@3HA:DWORD			; random_number_seed
EXTRN	?active_viewport@@3UVIEWPORT@@A:BYTE		; active_viewport
EXTRN	?clip_3d_coord@@3HA:DWORD			; clip_3d_coord
EXTRN	?clip_hither@@3MA:DWORD				; clip_hither
EXTRN	?d3d_fog_intensity@@3KA:DWORD			; d3d_fog_intensity
EXTRN	?system_textures@@3PAPAUSCREEN@@A:BYTE		; system_textures
EXTRN	?zbuffer_factor@@3NA:QWORD			; zbuffer_factor
EXTRN	?zbuffer_constant@@3NA:QWORD			; zbuffer_constant
EXTRN	?active_3d_environment@@3PAUENV_3D@@A:DWORD	; active_3d_environment
EXTRN	?visual_3d_vp@@3PAUVIEWPOINT@@A:DWORD		; visual_3d_vp
EXTRN	?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A:BYTE	; ambient_3d_light
EXTRN	?rotation_3d@@3PAY02MA:BYTE			; rotation_3d
EXTRN	?scaled_rotation@@3PAY02MA:BYTE			; scaled_rotation
EXTRN	?transformed_3d_points@@3PAUVERTEX@@A:BYTE	; transformed_3d_points
EXTRN	__fltused:DWORD
_BSS	SEGMENT
?number_of_weather_particles_allowed@@3PAURAINDROP_SETTINGS@@A DQ 05H DUP (?) ; number_of_weather_particles_allowed
?time_rain_last_updated@@3MA DD 01H DUP (?)		; time_rain_last_updated
?rain_3d_delta_time@@3MA DD 01H DUP (?)			; rain_3d_delta_time
?rain_3d_wind_speed@@3MA DD 01H DUP (?)			; rain_3d_wind_speed
?rain_3d_speed@@3MA DD 01H DUP (?)			; rain_3d_speed
?snow_particle_radius@@3MA DD 01H DUP (?)		; snow_particle_radius
?rain_3d_wind_direction@@3UVEC3D@@A DB 0cH DUP (?)	; rain_3d_wind_direction
?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A DB 0e000H DUP (?) ; rain_3d_drops
?rain_3d_raindrops_valid@@3HA DD 01H DUP (?)		; rain_3d_raindrops_valid
?rain_3d_snowdrops_valid@@3HA DD 01H DUP (?)		; rain_3d_snowdrops_valid
?snow_3d_texture@@3PAUSCREEN@@A DD 01H DUP (?)		; snow_3d_texture
?special_snow_flag@@3HA DD 01H DUP (?)			; special_snow_flag
_BSS	ENDS
;	COMDAT __real@c4000000
CONST	SEGMENT
__real@c4000000 DD 0c4000000r			; -512
CONST	ENDS
;	COMDAT __real@c3200000
CONST	SEGMENT
__real@c3200000 DD 0c3200000r			; -160
CONST	ENDS
;	COMDAT __real@c2a00000
CONST	SEGMENT
__real@c2a00000 DD 0c2a00000r			; -80
CONST	ENDS
;	COMDAT __real@44000000
CONST	SEGMENT
__real@44000000 DD 044000000r			; 512
CONST	ENDS
;	COMDAT __real@437f0000
CONST	SEGMENT
__real@437f0000 DD 0437f0000r			; 255
CONST	ENDS
;	COMDAT __real@43200000
CONST	SEGMENT
__real@43200000 DD 043200000r			; 160
CONST	ENDS
;	COMDAT __real@42a00000
CONST	SEGMENT
__real@42a00000 DD 042a00000r			; 80
CONST	ENDS
;	COMDAT __real@42480000
CONST	SEGMENT
__real@42480000 DD 042480000r			; 50
CONST	ENDS
;	COMDAT __real@40800000
CONST	SEGMENT
__real@40800000 DD 040800000r			; 4
CONST	ENDS
;	COMDAT __real@4059800000000000
CONST	SEGMENT
__real@4059800000000000 DQ 04059800000000000r	; 102
CONST	ENDS
;	COMDAT __real@4040000000000000
CONST	SEGMENT
__real@4040000000000000 DQ 04040000000000000r	; 32
CONST	ENDS
;	COMDAT __real@4030000000000000
CONST	SEGMENT
__real@4030000000000000 DQ 04030000000000000r	; 16
CONST	ENDS
;	COMDAT __real@4020000000000000
CONST	SEGMENT
__real@4020000000000000 DQ 04020000000000000r	; 8
CONST	ENDS
;	COMDAT __real@40000000
CONST	SEGMENT
__real@40000000 DD 040000000r			; 2
CONST	ENDS
;	COMDAT __real@3ff8000000000000
CONST	SEGMENT
__real@3ff8000000000000 DQ 03ff8000000000000r	; 1.5
CONST	ENDS
;	COMDAT __real@3ff0000000000000
CONST	SEGMENT
__real@3ff0000000000000 DQ 03ff0000000000000r	; 1
CONST	ENDS
;	COMDAT __real@3fe999999999999a
CONST	SEGMENT
__real@3fe999999999999a DQ 03fe999999999999ar	; 0.8
CONST	ENDS
;	COMDAT __real@3fe2e147ae147ae1
CONST	SEGMENT
__real@3fe2e147ae147ae1 DQ 03fe2e147ae147ae1r	; 0.59
CONST	ENDS
;	COMDAT __real@3fe0000000000000
CONST	SEGMENT
__real@3fe0000000000000 DQ 03fe0000000000000r	; 0.5
CONST	ENDS
;	COMDAT __real@3fd3333333333333
CONST	SEGMENT
__real@3fd3333333333333 DQ 03fd3333333333333r	; 0.3
CONST	ENDS
;	COMDAT __real@3fc999999999999a
CONST	SEGMENT
__real@3fc999999999999a DQ 03fc999999999999ar	; 0.2
CONST	ENDS
;	COMDAT __real@3fbc28f5c28f5c29
CONST	SEGMENT
__real@3fbc28f5c28f5c29 DQ 03fbc28f5c28f5c29r	; 0.11
CONST	ENDS
;	COMDAT __real@3fa999999999999a
CONST	SEGMENT
__real@3fa999999999999a DQ 03fa999999999999ar	; 0.05
CONST	ENDS
;	COMDAT __real@3f800000
CONST	SEGMENT
__real@3f800000 DD 03f800000r			; 1
CONST	ENDS
;	COMDAT __real@3f10000000000000
CONST	SEGMENT
__real@3f10000000000000 DQ 03f10000000000000r	; 6.10352e-05
CONST	ENDS
;	COMDAT __real@3f00002000400080
CONST	SEGMENT
__real@3f00002000400080 DQ 03f00002000400080r	; 3.05185e-05
CONST	ENDS
;	COMDAT __real@3e99999a
CONST	SEGMENT
__real@3e99999a DD 03e99999ar			; 0.3
CONST	ENDS
;	COMDAT __real@00000000
CONST	SEGMENT
__real@00000000 DD 000000000r			; 0
CONST	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3drain.c
;	COMDAT ?transform_3d_snow@@YGXXZ
_TEXT	SEGMENT
_j$1 = -80						; size = 4
_i$2 = -76						; size = 4
_q$3 = -72						; size = 4
_points$4 = -68						; size = 4
_z$5 = -64						; size = 4
_y$6 = -60						; size = 4
_x$7 = -56						; size = 4
_rel$ = -52						; size = 12
_iymin$ = -40						; size = 4
_iymax$ = -36						; size = 4
_ixmin$ = -32						; size = 4
_ixmax$ = -28						; size = 4
_oymin$ = -24						; size = 4
_oymax$ = -20						; size = 4
_oxmin$ = -16						; size = 4
_oxmax$ = -12						; size = 4
_result_points$ = -8					; size = 4
_count$ = -4						; size = 4
?transform_3d_snow@@YGXXZ PROC				; transform_3d_snow, COMDAT

; 1198 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 90 00 00
	00		 sub	 esp, 144		; 00000090H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi

; 1199 : 
; 1200 : 	int
; 1201 : 		count;
; 1202 : 
; 1203 : 	vertex
; 1204 : 		*result_points;
; 1205 : 
; 1206 : 	float
; 1207 : 		oxmax,
; 1208 : 		oxmin,
; 1209 : 		oymax,
; 1210 : 		oymin;
; 1211 : 
; 1212 : 	int
; 1213 : 		ixmax,
; 1214 : 		ixmin,
; 1215 : 		iymax,
; 1216 : 		iymin;
; 1217 : 
; 1218 : 	vec3d
; 1219 : 		rel;
; 1220 : 
; 1221 : 
; 1222 : 	//
; 1223 : 	// Go through rotating/translating the rain positions, current and predicted, and draw lines accordingly.
; 1224 : 	//
; 1225 : 
; 1226 : 	//
; 1227 : 	// We only need the fpu to be in single precision mode
; 1228 : 	//
; 1229 : 
; 1230 : //	set_fpu_precision_mode_single ();
; 1231 : 
; 1232 : 	result_points = transformed_3d_points;

  0000c	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _result_points$[ebp], OFFSET ?transformed_3d_points@@3PAUVERTEX@@A ; transformed_3d_points

; 1233 : 
; 1234 : 	scaled_rotation[0][0] = rotation_3d[0][0] * active_3d_environment->screen_i_scale;

  00013	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00018	6b c8 00	 imul	 ecx, eax, 0
  0001b	ba 04 00 00 00	 mov	 edx, 4
  00020	6b c2 00	 imul	 eax, edx, 0
  00023	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?active_3d_environment@@3PAUENV_3D@@A ; active_3d_environment
  00029	f3 0f 10 84 01
	00 00 00 00	 movss	 xmm0, DWORD PTR ?rotation_3d@@3PAY02MA[ecx+eax]
  00032	f3 0f 59 02	 mulss	 xmm0, DWORD PTR [edx]
  00036	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  0003b	6b c8 00	 imul	 ecx, eax, 0
  0003e	ba 04 00 00 00	 mov	 edx, 4
  00043	6b c2 00	 imul	 eax, edx, 0
  00046	f3 0f 11 84 01
	00 00 00 00	 movss	 DWORD PTR ?scaled_rotation@@3PAY02MA[ecx+eax], xmm0

; 1235 : 	scaled_rotation[0][1] = rotation_3d[0][1] * active_3d_environment->screen_j_scale;

  0004f	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00054	6b c8 00	 imul	 ecx, eax, 0
  00057	ba 04 00 00 00	 mov	 edx, 4
  0005c	c1 e2 00	 shl	 edx, 0
  0005f	a1 00 00 00 00	 mov	 eax, DWORD PTR ?active_3d_environment@@3PAUENV_3D@@A ; active_3d_environment
  00064	f3 0f 10 84 11
	00 00 00 00	 movss	 xmm0, DWORD PTR ?rotation_3d@@3PAY02MA[ecx+edx]
  0006d	f3 0f 59 40 04	 mulss	 xmm0, DWORD PTR [eax+4]
  00072	b9 0c 00 00 00	 mov	 ecx, 12			; 0000000cH
  00077	6b d1 00	 imul	 edx, ecx, 0
  0007a	b8 04 00 00 00	 mov	 eax, 4
  0007f	c1 e0 00	 shl	 eax, 0
  00082	f3 0f 11 84 02
	00 00 00 00	 movss	 DWORD PTR ?scaled_rotation@@3PAY02MA[edx+eax], xmm0

; 1236 : 	scaled_rotation[0][2] = rotation_3d[0][2];

  0008b	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00090	6b c8 00	 imul	 ecx, eax, 0
  00093	ba 04 00 00 00	 mov	 edx, 4
  00098	d1 e2		 shl	 edx, 1
  0009a	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  0009f	6b c0 00	 imul	 eax, eax, 0
  000a2	be 04 00 00 00	 mov	 esi, 4
  000a7	d1 e6		 shl	 esi, 1
  000a9	8b 8c 11 00 00
	00 00		 mov	 ecx, DWORD PTR ?rotation_3d@@3PAY02MA[ecx+edx]
  000b0	89 8c 30 00 00
	00 00		 mov	 DWORD PTR ?scaled_rotation@@3PAY02MA[eax+esi], ecx

; 1237 : 
; 1238 : 	scaled_rotation[1][0] = rotation_3d[1][0] * active_3d_environment->screen_i_scale;

  000b7	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  000bc	c1 e0 00	 shl	 eax, 0
  000bf	b9 04 00 00 00	 mov	 ecx, 4
  000c4	6b d1 00	 imul	 edx, ecx, 0
  000c7	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?active_3d_environment@@3PAUENV_3D@@A ; active_3d_environment
  000cd	f3 0f 10 84 10
	00 00 00 00	 movss	 xmm0, DWORD PTR ?rotation_3d@@3PAY02MA[eax+edx]
  000d6	f3 0f 59 01	 mulss	 xmm0, DWORD PTR [ecx]
  000da	ba 0c 00 00 00	 mov	 edx, 12			; 0000000cH
  000df	c1 e2 00	 shl	 edx, 0
  000e2	b8 04 00 00 00	 mov	 eax, 4
  000e7	6b c8 00	 imul	 ecx, eax, 0
  000ea	f3 0f 11 84 0a
	00 00 00 00	 movss	 DWORD PTR ?scaled_rotation@@3PAY02MA[edx+ecx], xmm0

; 1239 : 	scaled_rotation[1][1] = rotation_3d[1][1] * active_3d_environment->screen_j_scale;

  000f3	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  000f8	c1 e0 00	 shl	 eax, 0
  000fb	b9 04 00 00 00	 mov	 ecx, 4
  00100	c1 e1 00	 shl	 ecx, 0
  00103	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?active_3d_environment@@3PAUENV_3D@@A ; active_3d_environment
  00109	f3 0f 10 84 08
	00 00 00 00	 movss	 xmm0, DWORD PTR ?rotation_3d@@3PAY02MA[eax+ecx]
  00112	f3 0f 59 42 04	 mulss	 xmm0, DWORD PTR [edx+4]
  00117	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  0011c	c1 e0 00	 shl	 eax, 0
  0011f	b9 04 00 00 00	 mov	 ecx, 4
  00124	c1 e1 00	 shl	 ecx, 0
  00127	f3 0f 11 84 08
	00 00 00 00	 movss	 DWORD PTR ?scaled_rotation@@3PAY02MA[eax+ecx], xmm0

; 1240 : 	scaled_rotation[1][2] = rotation_3d[1][2];

  00130	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00135	c1 e0 00	 shl	 eax, 0
  00138	b9 04 00 00 00	 mov	 ecx, 4
  0013d	d1 e1		 shl	 ecx, 1
  0013f	ba 0c 00 00 00	 mov	 edx, 12			; 0000000cH
  00144	c1 e2 00	 shl	 edx, 0
  00147	be 04 00 00 00	 mov	 esi, 4
  0014c	d1 e6		 shl	 esi, 1
  0014e	8b 84 08 00 00
	00 00		 mov	 eax, DWORD PTR ?rotation_3d@@3PAY02MA[eax+ecx]
  00155	89 84 32 00 00
	00 00		 mov	 DWORD PTR ?scaled_rotation@@3PAY02MA[edx+esi], eax

; 1241 : 
; 1242 : 	scaled_rotation[2][0] = rotation_3d[2][0] * active_3d_environment->screen_i_scale;

  0015c	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00161	d1 e0		 shl	 eax, 1
  00163	b9 04 00 00 00	 mov	 ecx, 4
  00168	6b d1 00	 imul	 edx, ecx, 0
  0016b	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?active_3d_environment@@3PAUENV_3D@@A ; active_3d_environment
  00171	f3 0f 10 84 10
	00 00 00 00	 movss	 xmm0, DWORD PTR ?rotation_3d@@3PAY02MA[eax+edx]
  0017a	f3 0f 59 01	 mulss	 xmm0, DWORD PTR [ecx]
  0017e	ba 0c 00 00 00	 mov	 edx, 12			; 0000000cH
  00183	d1 e2		 shl	 edx, 1
  00185	b8 04 00 00 00	 mov	 eax, 4
  0018a	6b c8 00	 imul	 ecx, eax, 0
  0018d	f3 0f 11 84 0a
	00 00 00 00	 movss	 DWORD PTR ?scaled_rotation@@3PAY02MA[edx+ecx], xmm0

; 1243 : 	scaled_rotation[2][1] = rotation_3d[2][1] * active_3d_environment->screen_j_scale;

  00196	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  0019b	d1 e0		 shl	 eax, 1
  0019d	b9 04 00 00 00	 mov	 ecx, 4
  001a2	c1 e1 00	 shl	 ecx, 0
  001a5	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?active_3d_environment@@3PAUENV_3D@@A ; active_3d_environment
  001ab	f3 0f 10 84 08
	00 00 00 00	 movss	 xmm0, DWORD PTR ?rotation_3d@@3PAY02MA[eax+ecx]
  001b4	f3 0f 59 42 04	 mulss	 xmm0, DWORD PTR [edx+4]
  001b9	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  001be	d1 e0		 shl	 eax, 1
  001c0	b9 04 00 00 00	 mov	 ecx, 4
  001c5	c1 e1 00	 shl	 ecx, 0
  001c8	f3 0f 11 84 08
	00 00 00 00	 movss	 DWORD PTR ?scaled_rotation@@3PAY02MA[eax+ecx], xmm0

; 1244 : 	scaled_rotation[2][2] = rotation_3d[2][2];

  001d1	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  001d6	d1 e0		 shl	 eax, 1
  001d8	b9 04 00 00 00	 mov	 ecx, 4
  001dd	d1 e1		 shl	 ecx, 1
  001df	ba 0c 00 00 00	 mov	 edx, 12			; 0000000cH
  001e4	d1 e2		 shl	 edx, 1
  001e6	be 04 00 00 00	 mov	 esi, 4
  001eb	d1 e6		 shl	 esi, 1
  001ed	8b 84 08 00 00
	00 00		 mov	 eax, DWORD PTR ?rotation_3d@@3PAY02MA[eax+ecx]
  001f4	89 84 32 00 00
	00 00		 mov	 DWORD PTR ?scaled_rotation@@3PAY02MA[edx+esi], eax

; 1245 : 
; 1246 : 	for ( count = 0; count < TOTAL_3D_RAINDROPS; count++ )

  001fb	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  00202	eb 09		 jmp	 SHORT $LN4@transform_
$LN2@transform_:
  00204	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00207	83 c0 01	 add	 eax, 1
  0020a	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@transform_:
  0020d	81 7d fc 00 08
	00 00		 cmp	 DWORD PTR _count$[ebp], 2048 ; 00000800H
  00214	0f 8d ec 02 00
	00		 jge	 $LN3@transform_

; 1247 : 	{
; 1248 : 
; 1249 : 		float
; 1250 : 			x,
; 1251 : 			y,
; 1252 : 			z;
; 1253 : 
; 1254 : 		vec3d
; 1255 : 			*points;
; 1256 : 
; 1257 : 		if ( rain_3d_drops[count].type == RAINDROP_SNOW )

  0021a	6b 45 fc 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  0021e	83 b8 18 00 00
	00 02		 cmp	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+24], 2
  00225	0f 85 d6 02 00
	00		 jne	 $LN7@transform_

; 1258 : 		{
; 1259 : 	
; 1260 : 			points = &rain_3d_drops[count].current_position;

  0022b	6b 45 fc 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  0022f	05 00 00 00 00	 add	 eax, OFFSET ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A
  00234	89 45 bc	 mov	 DWORD PTR _points$4[ebp], eax

; 1261 : 
; 1262 : 			rel.x = points->x - visual_3d_vp->x;

  00237	8b 45 bc	 mov	 eax, DWORD PTR _points$4[ebp]
  0023a	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  00240	f3 0f 10 00	 movss	 xmm0, DWORD PTR [eax]
  00244	f3 0f 5c 01	 subss	 xmm0, DWORD PTR [ecx]
  00248	f3 0f 11 45 cc	 movss	 DWORD PTR _rel$[ebp], xmm0

; 1263 : 			rel.y = points->y - visual_3d_vp->y;

  0024d	8b 45 bc	 mov	 eax, DWORD PTR _points$4[ebp]
  00250	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  00256	f3 0f 10 40 04	 movss	 xmm0, DWORD PTR [eax+4]
  0025b	f3 0f 5c 41 04	 subss	 xmm0, DWORD PTR [ecx+4]
  00260	f3 0f 11 45 d0	 movss	 DWORD PTR _rel$[ebp+4], xmm0

; 1264 : 			rel.z = points->z - visual_3d_vp->z;

  00265	8b 45 bc	 mov	 eax, DWORD PTR _points$4[ebp]
  00268	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  0026e	f3 0f 10 40 08	 movss	 xmm0, DWORD PTR [eax+8]
  00273	f3 0f 5c 41 08	 subss	 xmm0, DWORD PTR [ecx+8]
  00278	f3 0f 11 45 d4	 movss	 DWORD PTR _rel$[ebp+8], xmm0

; 1265 : 
; 1266 : 			z = rel.x * scaled_rotation[0][2] + rel.y * scaled_rotation[1][2] + rel.z * scaled_rotation[2][2];

  0027d	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00282	6b c8 00	 imul	 ecx, eax, 0
  00285	ba 04 00 00 00	 mov	 edx, 4
  0028a	d1 e2		 shl	 edx, 1
  0028c	f3 0f 10 45 cc	 movss	 xmm0, DWORD PTR _rel$[ebp]
  00291	f3 0f 59 84 11
	00 00 00 00	 mulss	 xmm0, DWORD PTR ?scaled_rotation@@3PAY02MA[ecx+edx]
  0029a	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  0029f	c1 e0 00	 shl	 eax, 0
  002a2	b9 04 00 00 00	 mov	 ecx, 4
  002a7	d1 e1		 shl	 ecx, 1
  002a9	f3 0f 10 4d d0	 movss	 xmm1, DWORD PTR _rel$[ebp+4]
  002ae	f3 0f 59 8c 08
	00 00 00 00	 mulss	 xmm1, DWORD PTR ?scaled_rotation@@3PAY02MA[eax+ecx]
  002b7	f3 0f 58 c1	 addss	 xmm0, xmm1
  002bb	ba 0c 00 00 00	 mov	 edx, 12			; 0000000cH
  002c0	d1 e2		 shl	 edx, 1
  002c2	b8 04 00 00 00	 mov	 eax, 4
  002c7	d1 e0		 shl	 eax, 1
  002c9	f3 0f 10 4d d4	 movss	 xmm1, DWORD PTR _rel$[ebp+8]
  002ce	f3 0f 59 8c 02
	00 00 00 00	 mulss	 xmm1, DWORD PTR ?scaled_rotation@@3PAY02MA[edx+eax]
  002d7	f3 0f 58 c1	 addss	 xmm0, xmm1
  002db	f3 0f 11 45 c0	 movss	 DWORD PTR _z$5[ebp], xmm0

; 1267 : 			x = rel.x * scaled_rotation[0][0] + rel.y * scaled_rotation[1][0] + rel.z * scaled_rotation[2][0];

  002e0	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  002e5	6b c8 00	 imul	 ecx, eax, 0
  002e8	ba 04 00 00 00	 mov	 edx, 4
  002ed	6b c2 00	 imul	 eax, edx, 0
  002f0	f3 0f 10 45 cc	 movss	 xmm0, DWORD PTR _rel$[ebp]
  002f5	f3 0f 59 84 01
	00 00 00 00	 mulss	 xmm0, DWORD PTR ?scaled_rotation@@3PAY02MA[ecx+eax]
  002fe	b9 0c 00 00 00	 mov	 ecx, 12			; 0000000cH
  00303	c1 e1 00	 shl	 ecx, 0
  00306	ba 04 00 00 00	 mov	 edx, 4
  0030b	6b c2 00	 imul	 eax, edx, 0
  0030e	f3 0f 10 4d d0	 movss	 xmm1, DWORD PTR _rel$[ebp+4]
  00313	f3 0f 59 8c 01
	00 00 00 00	 mulss	 xmm1, DWORD PTR ?scaled_rotation@@3PAY02MA[ecx+eax]
  0031c	f3 0f 58 c1	 addss	 xmm0, xmm1
  00320	b9 0c 00 00 00	 mov	 ecx, 12			; 0000000cH
  00325	d1 e1		 shl	 ecx, 1
  00327	ba 04 00 00 00	 mov	 edx, 4
  0032c	6b c2 00	 imul	 eax, edx, 0
  0032f	f3 0f 10 4d d4	 movss	 xmm1, DWORD PTR _rel$[ebp+8]
  00334	f3 0f 59 8c 01
	00 00 00 00	 mulss	 xmm1, DWORD PTR ?scaled_rotation@@3PAY02MA[ecx+eax]
  0033d	f3 0f 58 c1	 addss	 xmm0, xmm1
  00341	f3 0f 11 45 c8	 movss	 DWORD PTR _x$7[ebp], xmm0

; 1268 : 			y = rel.x * scaled_rotation[0][1] + rel.y * scaled_rotation[1][1] + rel.z * scaled_rotation[2][1];

  00346	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  0034b	6b c8 00	 imul	 ecx, eax, 0
  0034e	ba 04 00 00 00	 mov	 edx, 4
  00353	c1 e2 00	 shl	 edx, 0
  00356	f3 0f 10 45 cc	 movss	 xmm0, DWORD PTR _rel$[ebp]
  0035b	f3 0f 59 84 11
	00 00 00 00	 mulss	 xmm0, DWORD PTR ?scaled_rotation@@3PAY02MA[ecx+edx]
  00364	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00369	c1 e0 00	 shl	 eax, 0
  0036c	b9 04 00 00 00	 mov	 ecx, 4
  00371	c1 e1 00	 shl	 ecx, 0
  00374	f3 0f 10 4d d0	 movss	 xmm1, DWORD PTR _rel$[ebp+4]
  00379	f3 0f 59 8c 08
	00 00 00 00	 mulss	 xmm1, DWORD PTR ?scaled_rotation@@3PAY02MA[eax+ecx]
  00382	f3 0f 58 c1	 addss	 xmm0, xmm1
  00386	ba 0c 00 00 00	 mov	 edx, 12			; 0000000cH
  0038b	d1 e2		 shl	 edx, 1
  0038d	b8 04 00 00 00	 mov	 eax, 4
  00392	c1 e0 00	 shl	 eax, 0
  00395	f3 0f 10 4d d4	 movss	 xmm1, DWORD PTR _rel$[ebp+8]
  0039a	f3 0f 59 8c 02
	00 00 00 00	 mulss	 xmm1, DWORD PTR ?scaled_rotation@@3PAY02MA[edx+eax]
  003a3	f3 0f 58 c1	 addss	 xmm0, xmm1
  003a7	f3 0f 11 45 c4	 movss	 DWORD PTR _y$6[ebp], xmm0

; 1269 : 
; 1270 : 			if ( *( ( int * ) &z ) >= *( ( int * ) &clip_hither ) )

  003ac	8b 45 c0	 mov	 eax, DWORD PTR _z$5[ebp]
  003af	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?clip_hither@@3MA
  003b5	0f 8c 2b 01 00
	00		 jl	 $LN6@transform_

; 1271 : 			{
; 1272 : 	
; 1273 : 				float
; 1274 : 					q,
; 1275 : 					i,
; 1276 : 					j;
; 1277 : 	
; 1278 : 				result_points->x = x;

  003bb	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  003be	f3 0f 10 45 c8	 movss	 xmm0, DWORD PTR _x$7[ebp]
  003c3	f3 0f 11 00	 movss	 DWORD PTR [eax], xmm0

; 1279 : 				result_points->y = y;

  003c7	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  003ca	f3 0f 10 45 c4	 movss	 xmm0, DWORD PTR _y$6[ebp]
  003cf	f3 0f 11 40 04	 movss	 DWORD PTR [eax+4], xmm0

; 1280 : 				result_points->z = z;

  003d4	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  003d7	f3 0f 10 45 c0	 movss	 xmm0, DWORD PTR _z$5[ebp]
  003dc	f3 0f 11 40 08	 movss	 DWORD PTR [eax+8], xmm0

; 1281 : 	
; 1282 : 				q = 1.0 / z;

  003e1	f3 0f 5a 45 c0	 cvtss2sd xmm0, DWORD PTR _z$5[ebp]
  003e6	f2 0f 10 0d 00
	00 00 00	 movsd	 xmm1, QWORD PTR __real@3ff0000000000000
  003ee	f2 0f 5e c8	 divsd	 xmm1, xmm0
  003f2	f2 0f 5a c1	 cvtsd2ss xmm0, xmm1
  003f6	f3 0f 11 45 b8	 movss	 DWORD PTR _q$3[ebp], xmm0

; 1283 : 				i = ( x * q );

  003fb	f3 0f 10 45 c8	 movss	 xmm0, DWORD PTR _x$7[ebp]
  00400	f3 0f 59 45 b8	 mulss	 xmm0, DWORD PTR _q$3[ebp]
  00405	f3 0f 11 45 b4	 movss	 DWORD PTR _i$2[ebp], xmm0

; 1284 : 				j = ( y * q );

  0040a	f3 0f 10 45 c4	 movss	 xmm0, DWORD PTR _y$6[ebp]
  0040f	f3 0f 59 45 b8	 mulss	 xmm0, DWORD PTR _q$3[ebp]
  00414	f3 0f 11 45 b0	 movss	 DWORD PTR _j$1[ebp], xmm0

; 1285 : 	
; 1286 : 				result_points->j = active_3d_environment->y_origin - j;

  00419	a1 00 00 00 00	 mov	 eax, DWORD PTR ?active_3d_environment@@3PAUENV_3D@@A ; active_3d_environment
  0041e	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00423	f3 0f 5c 45 b0	 subss	 xmm0, DWORD PTR _j$1[ebp]
  00428	8b 4d f8	 mov	 ecx, DWORD PTR _result_points$[ebp]
  0042b	f3 0f 11 41 14	 movss	 DWORD PTR [ecx+20], xmm0

; 1287 : 				result_points->i = active_3d_environment->x_origin + i;

  00430	a1 00 00 00 00	 mov	 eax, DWORD PTR ?active_3d_environment@@3PAUENV_3D@@A ; active_3d_environment
  00435	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  0043a	f3 0f 58 45 b4	 addss	 xmm0, DWORD PTR _i$2[ebp]
  0043f	8b 4d f8	 mov	 ecx, DWORD PTR _result_points$[ebp]
  00442	f3 0f 11 41 10	 movss	 DWORD PTR [ecx+16], xmm0

; 1288 : 	
; 1289 : 				result_points->q = q;

  00447	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  0044a	f3 0f 10 45 b8	 movss	 xmm0, DWORD PTR _q$3[ebp]
  0044f	f3 0f 11 40 0c	 movss	 DWORD PTR [eax+12], xmm0

; 1290 : 	
; 1291 : 				oxmax = active_viewport.x_max - result_points->i;

  00454	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  00457	f3 0f 10 05 08
	00 00 00	 movss	 xmm0, DWORD PTR ?active_viewport@@3UVIEWPORT@@A+8
  0045f	f3 0f 5c 40 10	 subss	 xmm0, DWORD PTR [eax+16]
  00464	f3 0f 11 45 f4	 movss	 DWORD PTR _oxmax$[ebp], xmm0

; 1292 : 				oxmin = result_points->i - active_viewport.x_min;

  00469	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  0046c	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00471	f3 0f 5c 05 00
	00 00 00	 subss	 xmm0, DWORD PTR ?active_viewport@@3UVIEWPORT@@A
  00479	f3 0f 11 45 f0	 movss	 DWORD PTR _oxmin$[ebp], xmm0

; 1293 : 				oymax = active_viewport.y_max - result_points->j;

  0047e	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  00481	f3 0f 10 05 0c
	00 00 00	 movss	 xmm0, DWORD PTR ?active_viewport@@3UVIEWPORT@@A+12
  00489	f3 0f 5c 40 14	 subss	 xmm0, DWORD PTR [eax+20]
  0048e	f3 0f 11 45 ec	 movss	 DWORD PTR _oymax$[ebp], xmm0

; 1294 : 				oymin = result_points->j - active_viewport.y_min;

  00493	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  00496	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  0049b	f3 0f 5c 05 04
	00 00 00	 subss	 xmm0, DWORD PTR ?active_viewport@@3UVIEWPORT@@A+4
  004a3	f3 0f 11 45 e8	 movss	 DWORD PTR _oymin$[ebp], xmm0

; 1295 : 			
; 1296 : 				ixmax = *( ( int * ) &oxmax );

  004a8	8b 45 f4	 mov	 eax, DWORD PTR _oxmax$[ebp]
  004ab	89 45 e4	 mov	 DWORD PTR _ixmax$[ebp], eax

; 1297 : 				ixmin = *( ( int * ) &oxmin );

  004ae	8b 45 f0	 mov	 eax, DWORD PTR _oxmin$[ebp]
  004b1	89 45 e0	 mov	 DWORD PTR _ixmin$[ebp], eax

; 1298 : 				iymax = *( ( int * ) &oymax );

  004b4	8b 45 ec	 mov	 eax, DWORD PTR _oymax$[ebp]
  004b7	89 45 dc	 mov	 DWORD PTR _iymax$[ebp], eax

; 1299 : 				iymin = *( ( int * ) &oymin );

  004ba	8b 45 e8	 mov	 eax, DWORD PTR _oymin$[ebp]
  004bd	89 45 d8	 mov	 DWORD PTR _iymin$[ebp], eax

; 1300 : 			
; 1301 : 				result_points->outcode = generate_lookup_outcode ( ixmin, iymin, ixmax, iymax );

  004c0	8b 45 dc	 mov	 eax, DWORD PTR _iymax$[ebp]
  004c3	50		 push	 eax
  004c4	8b 4d e4	 mov	 ecx, DWORD PTR _ixmax$[ebp]
  004c7	51		 push	 ecx
  004c8	8b 55 d8	 mov	 edx, DWORD PTR _iymin$[ebp]
  004cb	52		 push	 edx
  004cc	8b 45 e0	 mov	 eax, DWORD PTR _ixmin$[ebp]
  004cf	50		 push	 eax
  004d0	e8 00 00 00 00	 call	 ?generate_lookup_outcode@@YGHHHHH@Z ; generate_lookup_outcode
  004d5	8b 4d f8	 mov	 ecx, DWORD PTR _result_points$[ebp]
  004d8	88 41 2c	 mov	 BYTE PTR [ecx+44], al

; 1302 : 
; 1303 : 				result_points++;

  004db	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  004de	83 c0 40	 add	 eax, 64			; 00000040H
  004e1	89 45 f8	 mov	 DWORD PTR _result_points$[ebp], eax

; 1304 : 			}
; 1305 : 			else

  004e4	eb 1b		 jmp	 SHORT $LN7@transform_
$LN6@transform_:

; 1306 : 			{
; 1307 : 	
; 1308 : 				//
; 1309 : 				// Tag this snowdrop as invalid now
; 1310 : 				//
; 1311 : 
; 1312 : 				rain_3d_drops[count].type = RAINDROP_INVALID;

  004e6	6b 45 fc 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  004ea	c7 80 18 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+24], 0

; 1313 : 
; 1314 : 				rain_3d_snowdrops_valid--;

  004f4	a1 00 00 00 00	 mov	 eax, DWORD PTR ?rain_3d_snowdrops_valid@@3HA
  004f9	83 e8 01	 sub	 eax, 1
  004fc	a3 00 00 00 00	 mov	 DWORD PTR ?rain_3d_snowdrops_valid@@3HA, eax
$LN7@transform_:

; 1315 : 			}
; 1316 : 		}
; 1317 : 	}

  00501	e9 fe fc ff ff	 jmp	 $LN2@transform_
$LN3@transform_:

; 1318 : 
; 1319 : //	set_fpu_precision_mode_double ();
; 1320 : }

  00506	5f		 pop	 edi
  00507	5e		 pop	 esi
  00508	5b		 pop	 ebx
  00509	8b e5		 mov	 esp, ebp
  0050b	5d		 pop	 ebp
  0050c	c3		 ret	 0
?transform_3d_snow@@YGXXZ ENDP				; transform_3d_snow
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3drain.c
;	COMDAT ?transform_3d_rain@@YGXXZ
_TEXT	SEGMENT
_j$1 = -92						; size = 4
_i$2 = -88						; size = 4
_q$3 = -84						; size = 4
_j$4 = -80						; size = 4
_i$5 = -76						; size = 4
_q$6 = -72						; size = 4
_rel$7 = -68						; size = 12
_points$8 = -56						; size = 4
_z$9 = -52						; size = 4
_y$10 = -48						; size = 4
_x$11 = -44						; size = 4
_iymin$ = -40						; size = 4
_iymax$ = -36						; size = 4
_ixmin$ = -32						; size = 4
_ixmax$ = -28						; size = 4
_oymin$ = -24						; size = 4
_oymax$ = -20						; size = 4
_oxmin$ = -16						; size = 4
_oxmax$ = -12						; size = 4
_result_points$ = -8					; size = 4
_count$ = -4						; size = 4
?transform_3d_rain@@YGXXZ PROC				; transform_3d_rain, COMDAT

; 1010 : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 9c 00 00
	00		 sub	 esp, 156		; 0000009cH
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi

; 1011 : 
; 1012 : 	int
; 1013 : 		count;
; 1014 : 
; 1015 : 	vertex
; 1016 : 		*result_points;
; 1017 : 
; 1018 : 	float
; 1019 : 		oxmax,
; 1020 : 		oxmin,
; 1021 : 		oymax,
; 1022 : 		oymin;
; 1023 : 
; 1024 : 	int
; 1025 : 		ixmax,
; 1026 : 		ixmin,
; 1027 : 		iymax,
; 1028 : 		iymin;
; 1029 : 
; 1030 : 
; 1031 : 	//
; 1032 : 	// Go through rotating/translating the rain positions, current and predicted, and draw lines accordingly.
; 1033 : 	//
; 1034 : 
; 1035 : 	//
; 1036 : 	// We only need the fpu to be in single precision mode
; 1037 : 	//
; 1038 : 
; 1039 : //	set_fpu_precision_mode_single ();
; 1040 : 
; 1041 : 	result_points = transformed_3d_points;

  0000c	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _result_points$[ebp], OFFSET ?transformed_3d_points@@3PAUVERTEX@@A ; transformed_3d_points

; 1042 : 
; 1043 : 	scaled_rotation[0][0] = rotation_3d[0][0] * active_3d_environment->screen_i_scale;

  00013	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00018	6b c8 00	 imul	 ecx, eax, 0
  0001b	ba 04 00 00 00	 mov	 edx, 4
  00020	6b c2 00	 imul	 eax, edx, 0
  00023	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?active_3d_environment@@3PAUENV_3D@@A ; active_3d_environment
  00029	f3 0f 10 84 01
	00 00 00 00	 movss	 xmm0, DWORD PTR ?rotation_3d@@3PAY02MA[ecx+eax]
  00032	f3 0f 59 02	 mulss	 xmm0, DWORD PTR [edx]
  00036	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  0003b	6b c8 00	 imul	 ecx, eax, 0
  0003e	ba 04 00 00 00	 mov	 edx, 4
  00043	6b c2 00	 imul	 eax, edx, 0
  00046	f3 0f 11 84 01
	00 00 00 00	 movss	 DWORD PTR ?scaled_rotation@@3PAY02MA[ecx+eax], xmm0

; 1044 : 	scaled_rotation[0][1] = rotation_3d[0][1] * active_3d_environment->screen_j_scale;

  0004f	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00054	6b c8 00	 imul	 ecx, eax, 0
  00057	ba 04 00 00 00	 mov	 edx, 4
  0005c	c1 e2 00	 shl	 edx, 0
  0005f	a1 00 00 00 00	 mov	 eax, DWORD PTR ?active_3d_environment@@3PAUENV_3D@@A ; active_3d_environment
  00064	f3 0f 10 84 11
	00 00 00 00	 movss	 xmm0, DWORD PTR ?rotation_3d@@3PAY02MA[ecx+edx]
  0006d	f3 0f 59 40 04	 mulss	 xmm0, DWORD PTR [eax+4]
  00072	b9 0c 00 00 00	 mov	 ecx, 12			; 0000000cH
  00077	6b d1 00	 imul	 edx, ecx, 0
  0007a	b8 04 00 00 00	 mov	 eax, 4
  0007f	c1 e0 00	 shl	 eax, 0
  00082	f3 0f 11 84 02
	00 00 00 00	 movss	 DWORD PTR ?scaled_rotation@@3PAY02MA[edx+eax], xmm0

; 1045 : 	scaled_rotation[0][2] = rotation_3d[0][2];

  0008b	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00090	6b c8 00	 imul	 ecx, eax, 0
  00093	ba 04 00 00 00	 mov	 edx, 4
  00098	d1 e2		 shl	 edx, 1
  0009a	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  0009f	6b c0 00	 imul	 eax, eax, 0
  000a2	be 04 00 00 00	 mov	 esi, 4
  000a7	d1 e6		 shl	 esi, 1
  000a9	8b 8c 11 00 00
	00 00		 mov	 ecx, DWORD PTR ?rotation_3d@@3PAY02MA[ecx+edx]
  000b0	89 8c 30 00 00
	00 00		 mov	 DWORD PTR ?scaled_rotation@@3PAY02MA[eax+esi], ecx

; 1046 : 
; 1047 : 	scaled_rotation[1][0] = rotation_3d[1][0] * active_3d_environment->screen_i_scale;

  000b7	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  000bc	c1 e0 00	 shl	 eax, 0
  000bf	b9 04 00 00 00	 mov	 ecx, 4
  000c4	6b d1 00	 imul	 edx, ecx, 0
  000c7	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?active_3d_environment@@3PAUENV_3D@@A ; active_3d_environment
  000cd	f3 0f 10 84 10
	00 00 00 00	 movss	 xmm0, DWORD PTR ?rotation_3d@@3PAY02MA[eax+edx]
  000d6	f3 0f 59 01	 mulss	 xmm0, DWORD PTR [ecx]
  000da	ba 0c 00 00 00	 mov	 edx, 12			; 0000000cH
  000df	c1 e2 00	 shl	 edx, 0
  000e2	b8 04 00 00 00	 mov	 eax, 4
  000e7	6b c8 00	 imul	 ecx, eax, 0
  000ea	f3 0f 11 84 0a
	00 00 00 00	 movss	 DWORD PTR ?scaled_rotation@@3PAY02MA[edx+ecx], xmm0

; 1048 : 	scaled_rotation[1][1] = rotation_3d[1][1] * active_3d_environment->screen_j_scale;

  000f3	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  000f8	c1 e0 00	 shl	 eax, 0
  000fb	b9 04 00 00 00	 mov	 ecx, 4
  00100	c1 e1 00	 shl	 ecx, 0
  00103	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?active_3d_environment@@3PAUENV_3D@@A ; active_3d_environment
  00109	f3 0f 10 84 08
	00 00 00 00	 movss	 xmm0, DWORD PTR ?rotation_3d@@3PAY02MA[eax+ecx]
  00112	f3 0f 59 42 04	 mulss	 xmm0, DWORD PTR [edx+4]
  00117	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  0011c	c1 e0 00	 shl	 eax, 0
  0011f	b9 04 00 00 00	 mov	 ecx, 4
  00124	c1 e1 00	 shl	 ecx, 0
  00127	f3 0f 11 84 08
	00 00 00 00	 movss	 DWORD PTR ?scaled_rotation@@3PAY02MA[eax+ecx], xmm0

; 1049 : 	scaled_rotation[1][2] = rotation_3d[1][2];

  00130	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00135	c1 e0 00	 shl	 eax, 0
  00138	b9 04 00 00 00	 mov	 ecx, 4
  0013d	d1 e1		 shl	 ecx, 1
  0013f	ba 0c 00 00 00	 mov	 edx, 12			; 0000000cH
  00144	c1 e2 00	 shl	 edx, 0
  00147	be 04 00 00 00	 mov	 esi, 4
  0014c	d1 e6		 shl	 esi, 1
  0014e	8b 84 08 00 00
	00 00		 mov	 eax, DWORD PTR ?rotation_3d@@3PAY02MA[eax+ecx]
  00155	89 84 32 00 00
	00 00		 mov	 DWORD PTR ?scaled_rotation@@3PAY02MA[edx+esi], eax

; 1050 : 
; 1051 : 	scaled_rotation[2][0] = rotation_3d[2][0] * active_3d_environment->screen_i_scale;

  0015c	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00161	d1 e0		 shl	 eax, 1
  00163	b9 04 00 00 00	 mov	 ecx, 4
  00168	6b d1 00	 imul	 edx, ecx, 0
  0016b	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?active_3d_environment@@3PAUENV_3D@@A ; active_3d_environment
  00171	f3 0f 10 84 10
	00 00 00 00	 movss	 xmm0, DWORD PTR ?rotation_3d@@3PAY02MA[eax+edx]
  0017a	f3 0f 59 01	 mulss	 xmm0, DWORD PTR [ecx]
  0017e	ba 0c 00 00 00	 mov	 edx, 12			; 0000000cH
  00183	d1 e2		 shl	 edx, 1
  00185	b8 04 00 00 00	 mov	 eax, 4
  0018a	6b c8 00	 imul	 ecx, eax, 0
  0018d	f3 0f 11 84 0a
	00 00 00 00	 movss	 DWORD PTR ?scaled_rotation@@3PAY02MA[edx+ecx], xmm0

; 1052 : 	scaled_rotation[2][1] = rotation_3d[2][1] * active_3d_environment->screen_j_scale;

  00196	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  0019b	d1 e0		 shl	 eax, 1
  0019d	b9 04 00 00 00	 mov	 ecx, 4
  001a2	c1 e1 00	 shl	 ecx, 0
  001a5	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?active_3d_environment@@3PAUENV_3D@@A ; active_3d_environment
  001ab	f3 0f 10 84 08
	00 00 00 00	 movss	 xmm0, DWORD PTR ?rotation_3d@@3PAY02MA[eax+ecx]
  001b4	f3 0f 59 42 04	 mulss	 xmm0, DWORD PTR [edx+4]
  001b9	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  001be	d1 e0		 shl	 eax, 1
  001c0	b9 04 00 00 00	 mov	 ecx, 4
  001c5	c1 e1 00	 shl	 ecx, 0
  001c8	f3 0f 11 84 08
	00 00 00 00	 movss	 DWORD PTR ?scaled_rotation@@3PAY02MA[eax+ecx], xmm0

; 1053 : 	scaled_rotation[2][2] = rotation_3d[2][2];

  001d1	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  001d6	d1 e0		 shl	 eax, 1
  001d8	b9 04 00 00 00	 mov	 ecx, 4
  001dd	d1 e1		 shl	 ecx, 1
  001df	ba 0c 00 00 00	 mov	 edx, 12			; 0000000cH
  001e4	d1 e2		 shl	 edx, 1
  001e6	be 04 00 00 00	 mov	 esi, 4
  001eb	d1 e6		 shl	 esi, 1
  001ed	8b 84 08 00 00
	00 00		 mov	 eax, DWORD PTR ?rotation_3d@@3PAY02MA[eax+ecx]
  001f4	89 84 32 00 00
	00 00		 mov	 DWORD PTR ?scaled_rotation@@3PAY02MA[edx+esi], eax

; 1054 : 
; 1055 : 	for ( count = 0; count < TOTAL_3D_RAINDROPS; count++ )

  001fb	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  00202	eb 09		 jmp	 SHORT $LN4@transform_
$LN2@transform_:
  00204	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00207	83 c0 01	 add	 eax, 1
  0020a	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@transform_:
  0020d	81 7d fc 00 08
	00 00		 cmp	 DWORD PTR _count$[ebp], 2048 ; 00000800H
  00214	0f 8d 11 06 00
	00		 jge	 $LN3@transform_

; 1056 : 	{
; 1057 : 
; 1058 : 		float
; 1059 : 			x,
; 1060 : 			y,
; 1061 : 			z;
; 1062 : 
; 1063 : 		vec3d
; 1064 : 			*points;
; 1065 : 
; 1066 : 		if ( rain_3d_drops[count].type == RAINDROP_RAIN )

  0021a	6b 45 fc 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  0021e	83 b8 18 00 00
	00 01		 cmp	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+24], 1
  00225	0f 85 fb 05 00
	00		 jne	 $LN5@transform_

; 1067 : 		{
; 1068 : 
; 1069 : 			vec3d
; 1070 : 				rel;
; 1071 : 
; 1072 : 			points = &rain_3d_drops[count].current_position;

  0022b	6b 45 fc 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  0022f	05 00 00 00 00	 add	 eax, OFFSET ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A
  00234	89 45 c8	 mov	 DWORD PTR _points$8[ebp], eax

; 1073 : 
; 1074 : 			rel.x = points->x - visual_3d_vp->x;

  00237	8b 45 c8	 mov	 eax, DWORD PTR _points$8[ebp]
  0023a	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  00240	f3 0f 10 00	 movss	 xmm0, DWORD PTR [eax]
  00244	f3 0f 5c 01	 subss	 xmm0, DWORD PTR [ecx]
  00248	f3 0f 11 45 bc	 movss	 DWORD PTR _rel$7[ebp], xmm0

; 1075 : 			rel.y = points->y - visual_3d_vp->y;

  0024d	8b 45 c8	 mov	 eax, DWORD PTR _points$8[ebp]
  00250	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  00256	f3 0f 10 40 04	 movss	 xmm0, DWORD PTR [eax+4]
  0025b	f3 0f 5c 41 04	 subss	 xmm0, DWORD PTR [ecx+4]
  00260	f3 0f 11 45 c0	 movss	 DWORD PTR _rel$7[ebp+4], xmm0

; 1076 : 			rel.z = points->z - visual_3d_vp->z;

  00265	8b 45 c8	 mov	 eax, DWORD PTR _points$8[ebp]
  00268	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  0026e	f3 0f 10 40 08	 movss	 xmm0, DWORD PTR [eax+8]
  00273	f3 0f 5c 41 08	 subss	 xmm0, DWORD PTR [ecx+8]
  00278	f3 0f 11 45 c4	 movss	 DWORD PTR _rel$7[ebp+8], xmm0

; 1077 : 	
; 1078 : 			z = rel.x * scaled_rotation[0][2] + rel.y * scaled_rotation[1][2] + rel.z * scaled_rotation[2][2];

  0027d	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00282	6b c8 00	 imul	 ecx, eax, 0
  00285	ba 04 00 00 00	 mov	 edx, 4
  0028a	d1 e2		 shl	 edx, 1
  0028c	f3 0f 10 45 bc	 movss	 xmm0, DWORD PTR _rel$7[ebp]
  00291	f3 0f 59 84 11
	00 00 00 00	 mulss	 xmm0, DWORD PTR ?scaled_rotation@@3PAY02MA[ecx+edx]
  0029a	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  0029f	c1 e0 00	 shl	 eax, 0
  002a2	b9 04 00 00 00	 mov	 ecx, 4
  002a7	d1 e1		 shl	 ecx, 1
  002a9	f3 0f 10 4d c0	 movss	 xmm1, DWORD PTR _rel$7[ebp+4]
  002ae	f3 0f 59 8c 08
	00 00 00 00	 mulss	 xmm1, DWORD PTR ?scaled_rotation@@3PAY02MA[eax+ecx]
  002b7	f3 0f 58 c1	 addss	 xmm0, xmm1
  002bb	ba 0c 00 00 00	 mov	 edx, 12			; 0000000cH
  002c0	d1 e2		 shl	 edx, 1
  002c2	b8 04 00 00 00	 mov	 eax, 4
  002c7	d1 e0		 shl	 eax, 1
  002c9	f3 0f 10 4d c4	 movss	 xmm1, DWORD PTR _rel$7[ebp+8]
  002ce	f3 0f 59 8c 02
	00 00 00 00	 mulss	 xmm1, DWORD PTR ?scaled_rotation@@3PAY02MA[edx+eax]
  002d7	f3 0f 58 c1	 addss	 xmm0, xmm1
  002db	f3 0f 11 45 cc	 movss	 DWORD PTR _z$9[ebp], xmm0

; 1079 : 			x = rel.x * scaled_rotation[0][0] + rel.y * scaled_rotation[1][0] + rel.z * scaled_rotation[2][0];

  002e0	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  002e5	6b c8 00	 imul	 ecx, eax, 0
  002e8	ba 04 00 00 00	 mov	 edx, 4
  002ed	6b c2 00	 imul	 eax, edx, 0
  002f0	f3 0f 10 45 bc	 movss	 xmm0, DWORD PTR _rel$7[ebp]
  002f5	f3 0f 59 84 01
	00 00 00 00	 mulss	 xmm0, DWORD PTR ?scaled_rotation@@3PAY02MA[ecx+eax]
  002fe	b9 0c 00 00 00	 mov	 ecx, 12			; 0000000cH
  00303	c1 e1 00	 shl	 ecx, 0
  00306	ba 04 00 00 00	 mov	 edx, 4
  0030b	6b c2 00	 imul	 eax, edx, 0
  0030e	f3 0f 10 4d c0	 movss	 xmm1, DWORD PTR _rel$7[ebp+4]
  00313	f3 0f 59 8c 01
	00 00 00 00	 mulss	 xmm1, DWORD PTR ?scaled_rotation@@3PAY02MA[ecx+eax]
  0031c	f3 0f 58 c1	 addss	 xmm0, xmm1
  00320	b9 0c 00 00 00	 mov	 ecx, 12			; 0000000cH
  00325	d1 e1		 shl	 ecx, 1
  00327	ba 04 00 00 00	 mov	 edx, 4
  0032c	6b c2 00	 imul	 eax, edx, 0
  0032f	f3 0f 10 4d c4	 movss	 xmm1, DWORD PTR _rel$7[ebp+8]
  00334	f3 0f 59 8c 01
	00 00 00 00	 mulss	 xmm1, DWORD PTR ?scaled_rotation@@3PAY02MA[ecx+eax]
  0033d	f3 0f 58 c1	 addss	 xmm0, xmm1
  00341	f3 0f 11 45 d4	 movss	 DWORD PTR _x$11[ebp], xmm0

; 1080 : 			y = rel.x * scaled_rotation[0][1] + rel.y * scaled_rotation[1][1] + rel.z * scaled_rotation[2][1];

  00346	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  0034b	6b c8 00	 imul	 ecx, eax, 0
  0034e	ba 04 00 00 00	 mov	 edx, 4
  00353	c1 e2 00	 shl	 edx, 0
  00356	f3 0f 10 45 bc	 movss	 xmm0, DWORD PTR _rel$7[ebp]
  0035b	f3 0f 59 84 11
	00 00 00 00	 mulss	 xmm0, DWORD PTR ?scaled_rotation@@3PAY02MA[ecx+edx]
  00364	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00369	c1 e0 00	 shl	 eax, 0
  0036c	b9 04 00 00 00	 mov	 ecx, 4
  00371	c1 e1 00	 shl	 ecx, 0
  00374	f3 0f 10 4d c0	 movss	 xmm1, DWORD PTR _rel$7[ebp+4]
  00379	f3 0f 59 8c 08
	00 00 00 00	 mulss	 xmm1, DWORD PTR ?scaled_rotation@@3PAY02MA[eax+ecx]
  00382	f3 0f 58 c1	 addss	 xmm0, xmm1
  00386	ba 0c 00 00 00	 mov	 edx, 12			; 0000000cH
  0038b	d1 e2		 shl	 edx, 1
  0038d	b8 04 00 00 00	 mov	 eax, 4
  00392	c1 e0 00	 shl	 eax, 0
  00395	f3 0f 10 4d c4	 movss	 xmm1, DWORD PTR _rel$7[ebp+8]
  0039a	f3 0f 59 8c 02
	00 00 00 00	 mulss	 xmm1, DWORD PTR ?scaled_rotation@@3PAY02MA[edx+eax]
  003a3	f3 0f 58 c1	 addss	 xmm0, xmm1
  003a7	f3 0f 11 45 d0	 movss	 DWORD PTR _y$10[ebp], xmm0

; 1081 : 	
; 1082 : 			if ( *( ( int * ) &z ) >= *( ( int * ) &clip_hither ) )

  003ac	8b 45 cc	 mov	 eax, DWORD PTR _z$9[ebp]
  003af	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?clip_hither@@3MA
  003b5	0f 8c 22 01 00
	00		 jl	 $LN6@transform_

; 1083 : 			{
; 1084 : 	
; 1085 : 				float
; 1086 : 					q,
; 1087 : 					i,
; 1088 : 					j;
; 1089 : 	
; 1090 : 				result_points->x = x;

  003bb	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  003be	f3 0f 10 45 d4	 movss	 xmm0, DWORD PTR _x$11[ebp]
  003c3	f3 0f 11 00	 movss	 DWORD PTR [eax], xmm0

; 1091 : 				result_points->y = y;

  003c7	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  003ca	f3 0f 10 45 d0	 movss	 xmm0, DWORD PTR _y$10[ebp]
  003cf	f3 0f 11 40 04	 movss	 DWORD PTR [eax+4], xmm0

; 1092 : 				result_points->z = z;

  003d4	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  003d7	f3 0f 10 45 cc	 movss	 xmm0, DWORD PTR _z$9[ebp]
  003dc	f3 0f 11 40 08	 movss	 DWORD PTR [eax+8], xmm0

; 1093 : 	
; 1094 : 				q = 1.0 / z;

  003e1	f3 0f 5a 45 cc	 cvtss2sd xmm0, DWORD PTR _z$9[ebp]
  003e6	f2 0f 10 0d 00
	00 00 00	 movsd	 xmm1, QWORD PTR __real@3ff0000000000000
  003ee	f2 0f 5e c8	 divsd	 xmm1, xmm0
  003f2	f2 0f 5a c1	 cvtsd2ss xmm0, xmm1
  003f6	f3 0f 11 45 b8	 movss	 DWORD PTR _q$6[ebp], xmm0

; 1095 : 				i = ( x * q );

  003fb	f3 0f 10 45 d4	 movss	 xmm0, DWORD PTR _x$11[ebp]
  00400	f3 0f 59 45 b8	 mulss	 xmm0, DWORD PTR _q$6[ebp]
  00405	f3 0f 11 45 b4	 movss	 DWORD PTR _i$5[ebp], xmm0

; 1096 : 				j = ( y * q );

  0040a	f3 0f 10 45 d0	 movss	 xmm0, DWORD PTR _y$10[ebp]
  0040f	f3 0f 59 45 b8	 mulss	 xmm0, DWORD PTR _q$6[ebp]
  00414	f3 0f 11 45 b0	 movss	 DWORD PTR _j$4[ebp], xmm0

; 1097 : 	
; 1098 : 				result_points->j = active_3d_environment->y_origin - j;

  00419	a1 00 00 00 00	 mov	 eax, DWORD PTR ?active_3d_environment@@3PAUENV_3D@@A ; active_3d_environment
  0041e	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00423	f3 0f 5c 45 b0	 subss	 xmm0, DWORD PTR _j$4[ebp]
  00428	8b 4d f8	 mov	 ecx, DWORD PTR _result_points$[ebp]
  0042b	f3 0f 11 41 14	 movss	 DWORD PTR [ecx+20], xmm0

; 1099 : 				result_points->i = active_3d_environment->x_origin + i;

  00430	a1 00 00 00 00	 mov	 eax, DWORD PTR ?active_3d_environment@@3PAUENV_3D@@A ; active_3d_environment
  00435	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  0043a	f3 0f 58 45 b4	 addss	 xmm0, DWORD PTR _i$5[ebp]
  0043f	8b 4d f8	 mov	 ecx, DWORD PTR _result_points$[ebp]
  00442	f3 0f 11 41 10	 movss	 DWORD PTR [ecx+16], xmm0

; 1100 : 	
; 1101 : 				result_points->q = q;

  00447	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  0044a	f3 0f 10 45 b8	 movss	 xmm0, DWORD PTR _q$6[ebp]
  0044f	f3 0f 11 40 0c	 movss	 DWORD PTR [eax+12], xmm0

; 1102 : 	
; 1103 : 				oxmax = active_viewport.x_max - result_points->i;

  00454	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  00457	f3 0f 10 05 08
	00 00 00	 movss	 xmm0, DWORD PTR ?active_viewport@@3UVIEWPORT@@A+8
  0045f	f3 0f 5c 40 10	 subss	 xmm0, DWORD PTR [eax+16]
  00464	f3 0f 11 45 f4	 movss	 DWORD PTR _oxmax$[ebp], xmm0

; 1104 : 				oxmin = result_points->i - active_viewport.x_min;

  00469	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  0046c	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00471	f3 0f 5c 05 00
	00 00 00	 subss	 xmm0, DWORD PTR ?active_viewport@@3UVIEWPORT@@A
  00479	f3 0f 11 45 f0	 movss	 DWORD PTR _oxmin$[ebp], xmm0

; 1105 : 				oymax = active_viewport.y_max - result_points->j;

  0047e	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  00481	f3 0f 10 05 0c
	00 00 00	 movss	 xmm0, DWORD PTR ?active_viewport@@3UVIEWPORT@@A+12
  00489	f3 0f 5c 40 14	 subss	 xmm0, DWORD PTR [eax+20]
  0048e	f3 0f 11 45 ec	 movss	 DWORD PTR _oymax$[ebp], xmm0

; 1106 : 				oymin = result_points->j - active_viewport.y_min;

  00493	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  00496	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  0049b	f3 0f 5c 05 04
	00 00 00	 subss	 xmm0, DWORD PTR ?active_viewport@@3UVIEWPORT@@A+4
  004a3	f3 0f 11 45 e8	 movss	 DWORD PTR _oymin$[ebp], xmm0

; 1107 : 			
; 1108 : 				ixmax = *( ( int * ) &oxmax );

  004a8	8b 45 f4	 mov	 eax, DWORD PTR _oxmax$[ebp]
  004ab	89 45 e4	 mov	 DWORD PTR _ixmax$[ebp], eax

; 1109 : 				ixmin = *( ( int * ) &oxmin );

  004ae	8b 45 f0	 mov	 eax, DWORD PTR _oxmin$[ebp]
  004b1	89 45 e0	 mov	 DWORD PTR _ixmin$[ebp], eax

; 1110 : 				iymax = *( ( int * ) &oymax );

  004b4	8b 45 ec	 mov	 eax, DWORD PTR _oymax$[ebp]
  004b7	89 45 dc	 mov	 DWORD PTR _iymax$[ebp], eax

; 1111 : 				iymin = *( ( int * ) &oymin );

  004ba	8b 45 e8	 mov	 eax, DWORD PTR _oymin$[ebp]
  004bd	89 45 d8	 mov	 DWORD PTR _iymin$[ebp], eax

; 1112 : 			
; 1113 : 				result_points->outcode = generate_lookup_outcode ( ixmin, iymin, ixmax, iymax );

  004c0	8b 45 dc	 mov	 eax, DWORD PTR _iymax$[ebp]
  004c3	50		 push	 eax
  004c4	8b 4d e4	 mov	 ecx, DWORD PTR _ixmax$[ebp]
  004c7	51		 push	 ecx
  004c8	8b 55 d8	 mov	 edx, DWORD PTR _iymin$[ebp]
  004cb	52		 push	 edx
  004cc	8b 45 e0	 mov	 eax, DWORD PTR _ixmin$[ebp]
  004cf	50		 push	 eax
  004d0	e8 00 00 00 00	 call	 ?generate_lookup_outcode@@YGHHHHH@Z ; generate_lookup_outcode
  004d5	8b 4d f8	 mov	 ecx, DWORD PTR _result_points$[ebp]
  004d8	88 41 2c	 mov	 BYTE PTR [ecx+44], al

; 1114 : 			}
; 1115 : 			else

  004db	eb 48		 jmp	 SHORT $LN7@transform_
$LN6@transform_:

; 1116 : 			{
; 1117 : 	
; 1118 : 				result_points->outcode = CLIP_HITHER;

  004dd	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  004e0	c6 40 2c 20	 mov	 BYTE PTR [eax+44], 32	; 00000020H

; 1119 : 				result_points->z = z;

  004e4	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  004e7	f3 0f 10 45 cc	 movss	 xmm0, DWORD PTR _z$9[ebp]
  004ec	f3 0f 11 40 08	 movss	 DWORD PTR [eax+8], xmm0

; 1120 : 				result_points->x = x;

  004f1	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  004f4	f3 0f 10 45 d4	 movss	 xmm0, DWORD PTR _x$11[ebp]
  004f9	f3 0f 11 00	 movss	 DWORD PTR [eax], xmm0

; 1121 : 				result_points->y = y;

  004fd	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  00500	f3 0f 10 45 d0	 movss	 xmm0, DWORD PTR _y$10[ebp]
  00505	f3 0f 11 40 04	 movss	 DWORD PTR [eax+4], xmm0

; 1122 : 
; 1123 : 				//
; 1124 : 				// Mark this raindrop as invalid now
; 1125 : 				//
; 1126 : 
; 1127 : 				rain_3d_drops[count].type = RAINDROP_INVALID;

  0050a	6b 45 fc 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  0050e	c7 80 18 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+24], 0

; 1128 : 
; 1129 : 				rain_3d_raindrops_valid--;

  00518	a1 00 00 00 00	 mov	 eax, DWORD PTR ?rain_3d_raindrops_valid@@3HA
  0051d	83 e8 01	 sub	 eax, 1
  00520	a3 00 00 00 00	 mov	 DWORD PTR ?rain_3d_raindrops_valid@@3HA, eax
$LN7@transform_:

; 1130 : 			}
; 1131 : 	
; 1132 : 			result_points++;

  00525	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  00528	83 c0 40	 add	 eax, 64			; 00000040H
  0052b	89 45 f8	 mov	 DWORD PTR _result_points$[ebp], eax

; 1133 : 	
; 1134 : 			points = &rain_3d_drops[count].predicted_position;

  0052e	6b 45 fc 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  00532	05 0c 00 00 00	 add	 eax, OFFSET ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A+12
  00537	89 45 c8	 mov	 DWORD PTR _points$8[ebp], eax

; 1135 : 	
; 1136 : 			rel.x = points->x - visual_3d_vp->x;

  0053a	8b 45 c8	 mov	 eax, DWORD PTR _points$8[ebp]
  0053d	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  00543	f3 0f 10 00	 movss	 xmm0, DWORD PTR [eax]
  00547	f3 0f 5c 01	 subss	 xmm0, DWORD PTR [ecx]
  0054b	f3 0f 11 45 bc	 movss	 DWORD PTR _rel$7[ebp], xmm0

; 1137 : 			rel.y = points->y - visual_3d_vp->y;

  00550	8b 45 c8	 mov	 eax, DWORD PTR _points$8[ebp]
  00553	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  00559	f3 0f 10 40 04	 movss	 xmm0, DWORD PTR [eax+4]
  0055e	f3 0f 5c 41 04	 subss	 xmm0, DWORD PTR [ecx+4]
  00563	f3 0f 11 45 c0	 movss	 DWORD PTR _rel$7[ebp+4], xmm0

; 1138 : 			rel.z = points->z - visual_3d_vp->z;

  00568	8b 45 c8	 mov	 eax, DWORD PTR _points$8[ebp]
  0056b	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  00571	f3 0f 10 40 08	 movss	 xmm0, DWORD PTR [eax+8]
  00576	f3 0f 5c 41 08	 subss	 xmm0, DWORD PTR [ecx+8]
  0057b	f3 0f 11 45 c4	 movss	 DWORD PTR _rel$7[ebp+8], xmm0

; 1139 : 
; 1140 : 			z = rel.x * scaled_rotation[0][2] + rel.y * scaled_rotation[1][2] + rel.z * scaled_rotation[2][2];

  00580	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00585	6b c8 00	 imul	 ecx, eax, 0
  00588	ba 04 00 00 00	 mov	 edx, 4
  0058d	d1 e2		 shl	 edx, 1
  0058f	f3 0f 10 45 bc	 movss	 xmm0, DWORD PTR _rel$7[ebp]
  00594	f3 0f 59 84 11
	00 00 00 00	 mulss	 xmm0, DWORD PTR ?scaled_rotation@@3PAY02MA[ecx+edx]
  0059d	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  005a2	c1 e0 00	 shl	 eax, 0
  005a5	b9 04 00 00 00	 mov	 ecx, 4
  005aa	d1 e1		 shl	 ecx, 1
  005ac	f3 0f 10 4d c0	 movss	 xmm1, DWORD PTR _rel$7[ebp+4]
  005b1	f3 0f 59 8c 08
	00 00 00 00	 mulss	 xmm1, DWORD PTR ?scaled_rotation@@3PAY02MA[eax+ecx]
  005ba	f3 0f 58 c1	 addss	 xmm0, xmm1
  005be	ba 0c 00 00 00	 mov	 edx, 12			; 0000000cH
  005c3	d1 e2		 shl	 edx, 1
  005c5	b8 04 00 00 00	 mov	 eax, 4
  005ca	d1 e0		 shl	 eax, 1
  005cc	f3 0f 10 4d c4	 movss	 xmm1, DWORD PTR _rel$7[ebp+8]
  005d1	f3 0f 59 8c 02
	00 00 00 00	 mulss	 xmm1, DWORD PTR ?scaled_rotation@@3PAY02MA[edx+eax]
  005da	f3 0f 58 c1	 addss	 xmm0, xmm1
  005de	f3 0f 11 45 cc	 movss	 DWORD PTR _z$9[ebp], xmm0

; 1141 : 			x = rel.x * scaled_rotation[0][0] + rel.y * scaled_rotation[1][0] + rel.z * scaled_rotation[2][0];

  005e3	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  005e8	6b c8 00	 imul	 ecx, eax, 0
  005eb	ba 04 00 00 00	 mov	 edx, 4
  005f0	6b c2 00	 imul	 eax, edx, 0
  005f3	f3 0f 10 45 bc	 movss	 xmm0, DWORD PTR _rel$7[ebp]
  005f8	f3 0f 59 84 01
	00 00 00 00	 mulss	 xmm0, DWORD PTR ?scaled_rotation@@3PAY02MA[ecx+eax]
  00601	b9 0c 00 00 00	 mov	 ecx, 12			; 0000000cH
  00606	c1 e1 00	 shl	 ecx, 0
  00609	ba 04 00 00 00	 mov	 edx, 4
  0060e	6b c2 00	 imul	 eax, edx, 0
  00611	f3 0f 10 4d c0	 movss	 xmm1, DWORD PTR _rel$7[ebp+4]
  00616	f3 0f 59 8c 01
	00 00 00 00	 mulss	 xmm1, DWORD PTR ?scaled_rotation@@3PAY02MA[ecx+eax]
  0061f	f3 0f 58 c1	 addss	 xmm0, xmm1
  00623	b9 0c 00 00 00	 mov	 ecx, 12			; 0000000cH
  00628	d1 e1		 shl	 ecx, 1
  0062a	ba 04 00 00 00	 mov	 edx, 4
  0062f	6b c2 00	 imul	 eax, edx, 0
  00632	f3 0f 10 4d c4	 movss	 xmm1, DWORD PTR _rel$7[ebp+8]
  00637	f3 0f 59 8c 01
	00 00 00 00	 mulss	 xmm1, DWORD PTR ?scaled_rotation@@3PAY02MA[ecx+eax]
  00640	f3 0f 58 c1	 addss	 xmm0, xmm1
  00644	f3 0f 11 45 d4	 movss	 DWORD PTR _x$11[ebp], xmm0

; 1142 : 			y = rel.x * scaled_rotation[0][1] + rel.y * scaled_rotation[1][1] + rel.z * scaled_rotation[2][1];

  00649	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  0064e	6b c8 00	 imul	 ecx, eax, 0
  00651	ba 04 00 00 00	 mov	 edx, 4
  00656	c1 e2 00	 shl	 edx, 0
  00659	f3 0f 10 45 bc	 movss	 xmm0, DWORD PTR _rel$7[ebp]
  0065e	f3 0f 59 84 11
	00 00 00 00	 mulss	 xmm0, DWORD PTR ?scaled_rotation@@3PAY02MA[ecx+edx]
  00667	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  0066c	c1 e0 00	 shl	 eax, 0
  0066f	b9 04 00 00 00	 mov	 ecx, 4
  00674	c1 e1 00	 shl	 ecx, 0
  00677	f3 0f 10 4d c0	 movss	 xmm1, DWORD PTR _rel$7[ebp+4]
  0067c	f3 0f 59 8c 08
	00 00 00 00	 mulss	 xmm1, DWORD PTR ?scaled_rotation@@3PAY02MA[eax+ecx]
  00685	f3 0f 58 c1	 addss	 xmm0, xmm1
  00689	ba 0c 00 00 00	 mov	 edx, 12			; 0000000cH
  0068e	d1 e2		 shl	 edx, 1
  00690	b8 04 00 00 00	 mov	 eax, 4
  00695	c1 e0 00	 shl	 eax, 0
  00698	f3 0f 10 4d c4	 movss	 xmm1, DWORD PTR _rel$7[ebp+8]
  0069d	f3 0f 59 8c 02
	00 00 00 00	 mulss	 xmm1, DWORD PTR ?scaled_rotation@@3PAY02MA[edx+eax]
  006a6	f3 0f 58 c1	 addss	 xmm0, xmm1
  006aa	f3 0f 11 45 d0	 movss	 DWORD PTR _y$10[ebp], xmm0

; 1143 : 
; 1144 : 			if ( *( ( int * ) &z ) >= *( ( int * ) &clip_hither ) )

  006af	8b 45 cc	 mov	 eax, DWORD PTR _z$9[ebp]
  006b2	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?clip_hither@@3MA
  006b8	0f 8c 32 01 00
	00		 jl	 $LN8@transform_

; 1145 : 			{
; 1146 : 	
; 1147 : 				float
; 1148 : 					q,
; 1149 : 					i,
; 1150 : 					j;
; 1151 : 	
; 1152 : 				result_points->x = x;

  006be	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  006c1	f3 0f 10 45 d4	 movss	 xmm0, DWORD PTR _x$11[ebp]
  006c6	f3 0f 11 00	 movss	 DWORD PTR [eax], xmm0

; 1153 : 				result_points->y = y;

  006ca	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  006cd	f3 0f 10 45 d0	 movss	 xmm0, DWORD PTR _y$10[ebp]
  006d2	f3 0f 11 40 04	 movss	 DWORD PTR [eax+4], xmm0

; 1154 : 				result_points->z = z;

  006d7	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  006da	f3 0f 10 45 cc	 movss	 xmm0, DWORD PTR _z$9[ebp]
  006df	f3 0f 11 40 08	 movss	 DWORD PTR [eax+8], xmm0

; 1155 : 	
; 1156 : 				q = 1.0 / z;

  006e4	f3 0f 5a 45 cc	 cvtss2sd xmm0, DWORD PTR _z$9[ebp]
  006e9	f2 0f 10 0d 00
	00 00 00	 movsd	 xmm1, QWORD PTR __real@3ff0000000000000
  006f1	f2 0f 5e c8	 divsd	 xmm1, xmm0
  006f5	f2 0f 5a c1	 cvtsd2ss xmm0, xmm1
  006f9	f3 0f 11 45 ac	 movss	 DWORD PTR _q$3[ebp], xmm0

; 1157 : 				i = ( x * q );

  006fe	f3 0f 10 45 d4	 movss	 xmm0, DWORD PTR _x$11[ebp]
  00703	f3 0f 59 45 ac	 mulss	 xmm0, DWORD PTR _q$3[ebp]
  00708	f3 0f 11 45 a8	 movss	 DWORD PTR _i$2[ebp], xmm0

; 1158 : 				j = ( y * q );

  0070d	f3 0f 10 45 d0	 movss	 xmm0, DWORD PTR _y$10[ebp]
  00712	f3 0f 59 45 ac	 mulss	 xmm0, DWORD PTR _q$3[ebp]
  00717	f3 0f 11 45 a4	 movss	 DWORD PTR _j$1[ebp], xmm0

; 1159 : 	
; 1160 : 				result_points->j = active_3d_environment->y_origin - j + 1;

  0071c	a1 00 00 00 00	 mov	 eax, DWORD PTR ?active_3d_environment@@3PAUENV_3D@@A ; active_3d_environment
  00721	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  00726	f3 0f 5c 45 a4	 subss	 xmm0, DWORD PTR _j$1[ebp]
  0072b	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR __real@3f800000
  00733	8b 4d f8	 mov	 ecx, DWORD PTR _result_points$[ebp]
  00736	f3 0f 11 41 14	 movss	 DWORD PTR [ecx+20], xmm0

; 1161 : 				result_points->i = active_3d_environment->x_origin + i + 1;

  0073b	a1 00 00 00 00	 mov	 eax, DWORD PTR ?active_3d_environment@@3PAUENV_3D@@A ; active_3d_environment
  00740	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00745	f3 0f 58 45 a8	 addss	 xmm0, DWORD PTR _i$2[ebp]
  0074a	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR __real@3f800000
  00752	8b 4d f8	 mov	 ecx, DWORD PTR _result_points$[ebp]
  00755	f3 0f 11 41 10	 movss	 DWORD PTR [ecx+16], xmm0

; 1162 : 	
; 1163 : 				result_points->q = q;

  0075a	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  0075d	f3 0f 10 45 ac	 movss	 xmm0, DWORD PTR _q$3[ebp]
  00762	f3 0f 11 40 0c	 movss	 DWORD PTR [eax+12], xmm0

; 1164 : 	
; 1165 : 				oxmax = active_viewport.x_max - result_points->i;

  00767	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  0076a	f3 0f 10 05 08
	00 00 00	 movss	 xmm0, DWORD PTR ?active_viewport@@3UVIEWPORT@@A+8
  00772	f3 0f 5c 40 10	 subss	 xmm0, DWORD PTR [eax+16]
  00777	f3 0f 11 45 f4	 movss	 DWORD PTR _oxmax$[ebp], xmm0

; 1166 : 				oxmin = result_points->i - active_viewport.x_min;

  0077c	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  0077f	f3 0f 10 40 10	 movss	 xmm0, DWORD PTR [eax+16]
  00784	f3 0f 5c 05 00
	00 00 00	 subss	 xmm0, DWORD PTR ?active_viewport@@3UVIEWPORT@@A
  0078c	f3 0f 11 45 f0	 movss	 DWORD PTR _oxmin$[ebp], xmm0

; 1167 : 				oymax = active_viewport.y_max - result_points->j;

  00791	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  00794	f3 0f 10 05 0c
	00 00 00	 movss	 xmm0, DWORD PTR ?active_viewport@@3UVIEWPORT@@A+12
  0079c	f3 0f 5c 40 14	 subss	 xmm0, DWORD PTR [eax+20]
  007a1	f3 0f 11 45 ec	 movss	 DWORD PTR _oymax$[ebp], xmm0

; 1168 : 				oymin = result_points->j - active_viewport.y_min;

  007a6	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  007a9	f3 0f 10 40 14	 movss	 xmm0, DWORD PTR [eax+20]
  007ae	f3 0f 5c 05 04
	00 00 00	 subss	 xmm0, DWORD PTR ?active_viewport@@3UVIEWPORT@@A+4
  007b6	f3 0f 11 45 e8	 movss	 DWORD PTR _oymin$[ebp], xmm0

; 1169 : 			
; 1170 : 				ixmax = *( ( int * ) &oxmax );

  007bb	8b 45 f4	 mov	 eax, DWORD PTR _oxmax$[ebp]
  007be	89 45 e4	 mov	 DWORD PTR _ixmax$[ebp], eax

; 1171 : 				ixmin = *( ( int * ) &oxmin );

  007c1	8b 45 f0	 mov	 eax, DWORD PTR _oxmin$[ebp]
  007c4	89 45 e0	 mov	 DWORD PTR _ixmin$[ebp], eax

; 1172 : 				iymax = *( ( int * ) &oymax );

  007c7	8b 45 ec	 mov	 eax, DWORD PTR _oymax$[ebp]
  007ca	89 45 dc	 mov	 DWORD PTR _iymax$[ebp], eax

; 1173 : 				iymin = *( ( int * ) &oymin );

  007cd	8b 45 e8	 mov	 eax, DWORD PTR _oymin$[ebp]
  007d0	89 45 d8	 mov	 DWORD PTR _iymin$[ebp], eax

; 1174 : 			
; 1175 : 				result_points->outcode = generate_lookup_outcode ( ixmin, iymin, ixmax, iymax );

  007d3	8b 45 dc	 mov	 eax, DWORD PTR _iymax$[ebp]
  007d6	50		 push	 eax
  007d7	8b 4d e4	 mov	 ecx, DWORD PTR _ixmax$[ebp]
  007da	51		 push	 ecx
  007db	8b 55 d8	 mov	 edx, DWORD PTR _iymin$[ebp]
  007de	52		 push	 edx
  007df	8b 45 e0	 mov	 eax, DWORD PTR _ixmin$[ebp]
  007e2	50		 push	 eax
  007e3	e8 00 00 00 00	 call	 ?generate_lookup_outcode@@YGHHHHH@Z ; generate_lookup_outcode
  007e8	8b 4d f8	 mov	 ecx, DWORD PTR _result_points$[ebp]
  007eb	88 41 2c	 mov	 BYTE PTR [ecx+44], al

; 1176 : 			}
; 1177 : 			else

  007ee	eb 2d		 jmp	 SHORT $LN9@transform_
$LN8@transform_:

; 1178 : 			{
; 1179 : 
; 1180 : 				result_points->outcode = CLIP_HITHER;

  007f0	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  007f3	c6 40 2c 20	 mov	 BYTE PTR [eax+44], 32	; 00000020H

; 1181 : 				result_points->z = z;

  007f7	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  007fa	f3 0f 10 45 cc	 movss	 xmm0, DWORD PTR _z$9[ebp]
  007ff	f3 0f 11 40 08	 movss	 DWORD PTR [eax+8], xmm0

; 1182 : 				result_points->x = x;

  00804	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  00807	f3 0f 10 45 d4	 movss	 xmm0, DWORD PTR _x$11[ebp]
  0080c	f3 0f 11 00	 movss	 DWORD PTR [eax], xmm0

; 1183 : 				result_points->y = y;

  00810	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  00813	f3 0f 10 45 d0	 movss	 xmm0, DWORD PTR _y$10[ebp]
  00818	f3 0f 11 40 04	 movss	 DWORD PTR [eax+4], xmm0
$LN9@transform_:

; 1184 : 			}
; 1185 : 	
; 1186 : 			result_points++;

  0081d	8b 45 f8	 mov	 eax, DWORD PTR _result_points$[ebp]
  00820	83 c0 40	 add	 eax, 64			; 00000040H
  00823	89 45 f8	 mov	 DWORD PTR _result_points$[ebp], eax
$LN5@transform_:

; 1187 : 		}
; 1188 : 	}

  00826	e9 d9 f9 ff ff	 jmp	 $LN2@transform_
$LN3@transform_:

; 1189 : 
; 1190 : //	set_fpu_precision_mode_double ();
; 1191 : }

  0082b	5f		 pop	 edi
  0082c	5e		 pop	 esi
  0082d	5b		 pop	 ebx
  0082e	8b e5		 mov	 esp, ebp
  00830	5d		 pop	 ebp
  00831	c3		 ret	 0
?transform_3d_rain@@YGXXZ ENDP				; transform_3d_rain
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3drain.c
;	COMDAT ?draw_3d_rain@@YGXXZ
_TEXT	SEGMENT
tv164 = -396						; size = 4
tv165 = -392						; size = 4
_outcode$1 = -324					; size = 4
_height$2 = -320					; size = 4
_width$3 = -316						; size = 4
_snow_quad$4 = -312					; size = 256
_poly$5 = -56						; size = 4
_snow_colour$6 = -52					; size = 4
_snow_specular$7 = -48					; size = 4
_vptr$8 = -44						; size = 4
_vertices$9 = -40					; size = 4
_point2$10 = -36					; size = 4
_point1$11 = -32					; size = 4
_line$12 = -28						; size = 4
_rain_whiteness$13 = -24				; size = 4
_rain_intensity$14 = -20				; size = 4
_number_of_valid_raindrops$15 = -16			; size = 4
_outcode$ = -12						; size = 4
_count$ = -8						; size = 4
_rain_point_references$ = -4				; size = 4
?draw_3d_rain@@YGXXZ PROC				; draw_3d_rain, COMDAT

; 715  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 8c 01 00
	00		 sub	 esp, 396		; 0000018cH
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi

; 716  : 
; 717  : 	point_3d_plain_reference
; 718  : 		rain_point_references[2];
; 719  : 
; 720  : 	int
; 721  : 		count,
; 722  : 		outcode;
; 723  : 
; 724  : 	//
; 725  : 	// Calculate the rotation matrix, to transform rain drops relative to the view.
; 726  : 	//
; 727  : 
; 728  : 	rotation_3d[0][0] = ( visual_3d_vp->xv.x );

  0000c	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00011	6b c8 00	 imul	 ecx, eax, 0
  00014	ba 04 00 00 00	 mov	 edx, 4
  00019	6b c2 00	 imul	 eax, edx, 0
  0001c	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  00022	8b 52 0c	 mov	 edx, DWORD PTR [edx+12]
  00025	89 94 01 00 00
	00 00		 mov	 DWORD PTR ?rotation_3d@@3PAY02MA[ecx+eax], edx

; 729  : 	rotation_3d[0][1] = ( visual_3d_vp->yv.x );

  0002c	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00031	6b c8 00	 imul	 ecx, eax, 0
  00034	ba 04 00 00 00	 mov	 edx, 4
  00039	c1 e2 00	 shl	 edx, 0
  0003c	a1 00 00 00 00	 mov	 eax, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  00041	8b 40 18	 mov	 eax, DWORD PTR [eax+24]
  00044	89 84 11 00 00
	00 00		 mov	 DWORD PTR ?rotation_3d@@3PAY02MA[ecx+edx], eax

; 730  : 	rotation_3d[0][2] = ( visual_3d_vp->zv.x );

  0004b	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00050	6b c8 00	 imul	 ecx, eax, 0
  00053	ba 04 00 00 00	 mov	 edx, 4
  00058	d1 e2		 shl	 edx, 1
  0005a	a1 00 00 00 00	 mov	 eax, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  0005f	8b 40 24	 mov	 eax, DWORD PTR [eax+36]
  00062	89 84 11 00 00
	00 00		 mov	 DWORD PTR ?rotation_3d@@3PAY02MA[ecx+edx], eax

; 731  : 
; 732  : 	rotation_3d[1][0] = ( visual_3d_vp->xv.y );

  00069	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  0006e	c1 e0 00	 shl	 eax, 0
  00071	b9 04 00 00 00	 mov	 ecx, 4
  00076	6b d1 00	 imul	 edx, ecx, 0
  00079	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  0007f	8b 49 10	 mov	 ecx, DWORD PTR [ecx+16]
  00082	89 8c 10 00 00
	00 00		 mov	 DWORD PTR ?rotation_3d@@3PAY02MA[eax+edx], ecx

; 733  : 	rotation_3d[1][1] = ( visual_3d_vp->yv.y );

  00089	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  0008e	c1 e0 00	 shl	 eax, 0
  00091	b9 04 00 00 00	 mov	 ecx, 4
  00096	c1 e1 00	 shl	 ecx, 0
  00099	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  0009f	8b 52 1c	 mov	 edx, DWORD PTR [edx+28]
  000a2	89 94 08 00 00
	00 00		 mov	 DWORD PTR ?rotation_3d@@3PAY02MA[eax+ecx], edx

; 734  : 	rotation_3d[1][2] = ( visual_3d_vp->zv.y );

  000a9	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  000ae	c1 e0 00	 shl	 eax, 0
  000b1	b9 04 00 00 00	 mov	 ecx, 4
  000b6	d1 e1		 shl	 ecx, 1
  000b8	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  000be	8b 52 28	 mov	 edx, DWORD PTR [edx+40]
  000c1	89 94 08 00 00
	00 00		 mov	 DWORD PTR ?rotation_3d@@3PAY02MA[eax+ecx], edx

; 735  : 
; 736  : 	rotation_3d[2][0] = ( visual_3d_vp->xv.z );

  000c8	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  000cd	d1 e0		 shl	 eax, 1
  000cf	b9 04 00 00 00	 mov	 ecx, 4
  000d4	6b d1 00	 imul	 edx, ecx, 0
  000d7	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  000dd	8b 49 14	 mov	 ecx, DWORD PTR [ecx+20]
  000e0	89 8c 10 00 00
	00 00		 mov	 DWORD PTR ?rotation_3d@@3PAY02MA[eax+edx], ecx

; 737  : 	rotation_3d[2][1] = ( visual_3d_vp->yv.z );

  000e7	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  000ec	d1 e0		 shl	 eax, 1
  000ee	b9 04 00 00 00	 mov	 ecx, 4
  000f3	c1 e1 00	 shl	 ecx, 0
  000f6	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  000fc	8b 52 20	 mov	 edx, DWORD PTR [edx+32]
  000ff	89 94 08 00 00
	00 00		 mov	 DWORD PTR ?rotation_3d@@3PAY02MA[eax+ecx], edx

; 738  : 	rotation_3d[2][2] = ( visual_3d_vp->zv.z );

  00106	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  0010b	d1 e0		 shl	 eax, 1
  0010d	b9 04 00 00 00	 mov	 ecx, 4
  00112	d1 e1		 shl	 ecx, 1
  00114	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  0011a	8b 52 2c	 mov	 edx, DWORD PTR [edx+44]
  0011d	89 94 08 00 00
	00 00		 mov	 DWORD PTR ?rotation_3d@@3PAY02MA[eax+ecx], edx

; 739  : 
; 740  : 	if ( rain_3d_raindrops_valid )

  00124	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?rain_3d_raindrops_valid@@3HA, 0
  0012b	0f 84 0e 03 00
	00		 je	 $LN8@draw_3d_ra

; 741  : 	{
; 742  : 
; 743  : 		int
; 744  : 			number_of_valid_raindrops;
; 745  : 
; 746  : 		float
; 747  : 			rain_intensity;
; 748  : 
; 749  : 		int
; 750  : 			rain_whiteness;
; 751  : 
; 752  : 
; 753  : 		rain_intensity = ambient_3d_light.colour.red * 0.3 + ambient_3d_light.colour.green * 0.59 * ambient_3d_light.colour.blue * 0.11;

  00131	f3 0f 5a 05 18
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A+24
  00139	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3fd3333333333333
  00141	f3 0f 5a 0d 1c
	00 00 00	 cvtss2sd xmm1, DWORD PTR ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A+28
  00149	f2 0f 59 0d 00
	00 00 00	 mulsd	 xmm1, QWORD PTR __real@3fe2e147ae147ae1
  00151	f3 0f 5a 15 20
	00 00 00	 cvtss2sd xmm2, DWORD PTR ?ambient_3d_light@@3ULIGHT_3D_SOURCE@@A+32
  00159	f2 0f 59 ca	 mulsd	 xmm1, xmm2
  0015d	f2 0f 59 0d 00
	00 00 00	 mulsd	 xmm1, QWORD PTR __real@3fbc28f5c28f5c29
  00165	f2 0f 58 c1	 addsd	 xmm0, xmm1
  00169	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  0016d	f3 0f 11 45 ec	 movss	 DWORD PTR _rain_intensity$14[ebp], xmm0

; 754  : 
; 755  : 		rain_intensity *= 4;

  00172	f3 0f 10 45 ec	 movss	 xmm0, DWORD PTR _rain_intensity$14[ebp]
  00177	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR __real@40800000
  0017f	f3 0f 11 45 ec	 movss	 DWORD PTR _rain_intensity$14[ebp], xmm0

; 756  : 
; 757  : 		rain_intensity *= 255;

  00184	f3 0f 10 45 ec	 movss	 xmm0, DWORD PTR _rain_intensity$14[ebp]
  00189	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR __real@437f0000
  00191	f3 0f 11 45 ec	 movss	 DWORD PTR _rain_intensity$14[ebp], xmm0

; 758  : 
; 759  : 		rain_intensity = bound ( rain_intensity, 0, 255 );

  00196	0f 57 c0	 xorps	 xmm0, xmm0
  00199	0f 2f 45 ec	 comiss	 xmm0, DWORD PTR _rain_intensity$14[ebp]
  0019d	76 0d		 jbe	 SHORT $LN21@draw_3d_ra
  0019f	0f 57 c0	 xorps	 xmm0, xmm0
  001a2	f3 0f 11 85 78
	fe ff ff	 movss	 DWORD PTR tv165[ebp], xmm0
  001aa	eb 3d		 jmp	 SHORT $LN22@draw_3d_ra
$LN21@draw_3d_ra:
  001ac	f3 0f 10 45 ec	 movss	 xmm0, DWORD PTR _rain_intensity$14[ebp]
  001b1	0f 2f 05 00 00
	00 00		 comiss	 xmm0, DWORD PTR __real@437f0000
  001b8	76 12		 jbe	 SHORT $LN19@draw_3d_ra
  001ba	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@437f0000
  001c2	f3 0f 11 85 74
	fe ff ff	 movss	 DWORD PTR tv164[ebp], xmm0
  001ca	eb 0d		 jmp	 SHORT $LN20@draw_3d_ra
$LN19@draw_3d_ra:
  001cc	f3 0f 10 45 ec	 movss	 xmm0, DWORD PTR _rain_intensity$14[ebp]
  001d1	f3 0f 11 85 74
	fe ff ff	 movss	 DWORD PTR tv164[ebp], xmm0
$LN20@draw_3d_ra:
  001d9	f3 0f 10 85 74
	fe ff ff	 movss	 xmm0, DWORD PTR tv164[ebp]
  001e1	f3 0f 11 85 78
	fe ff ff	 movss	 DWORD PTR tv165[ebp], xmm0
$LN22@draw_3d_ra:
  001e9	f3 0f 10 85 78
	fe ff ff	 movss	 xmm0, DWORD PTR tv165[ebp]
  001f1	f3 0f 11 45 ec	 movss	 DWORD PTR _rain_intensity$14[ebp], xmm0

; 760  : 
; 761  : 		rain_whiteness = rain_intensity;

  001f6	f3 0f 2c 45 ec	 cvttss2si eax, DWORD PTR _rain_intensity$14[ebp]
  001fb	89 45 e8	 mov	 DWORD PTR _rain_whiteness$13[ebp], eax

; 762  : 
; 763  : 		//
; 764  : 		// Remeber the number of valid raindrops
; 765  : 		//
; 766  : 
; 767  : 		number_of_valid_raindrops = rain_3d_raindrops_valid;

  001fe	a1 00 00 00 00	 mov	 eax, DWORD PTR ?rain_3d_raindrops_valid@@3HA
  00203	89 45 f0	 mov	 DWORD PTR _number_of_valid_raindrops$15[ebp], eax

; 768  : 
; 769  : 		//
; 770  : 		// Rotate the rain - putting the results in transformed_3d_points
; 771  : 		//
; 772  : 	
; 773  : 		transform_3d_rain ();

  00206	e8 00 00 00 00	 call	 ?transform_3d_rain@@YGXXZ ; transform_3d_rain

; 774  : 	
; 775  : 		//
; 776  : 		// Go through pairing up the transformed points, drawing lines between them.
; 777  : 		//
; 778  : 	
; 779  : 		rain_point_references[0].point = 0;

  0020b	b8 02 00 00 00	 mov	 eax, 2
  00210	6b c8 00	 imul	 ecx, eax, 0
  00213	33 d2		 xor	 edx, edx
  00215	66 89 54 0d fc	 mov	 WORD PTR _rain_point_references$[ebp+ecx], dx

; 780  : 		rain_point_references[1].point = 1;

  0021a	b8 02 00 00 00	 mov	 eax, 2
  0021f	c1 e0 00	 shl	 eax, 0
  00222	b9 01 00 00 00	 mov	 ecx, 1
  00227	66 89 4c 05 fc	 mov	 WORD PTR _rain_point_references$[ebp+eax], cx

; 781  : 	
; 782  : 		set_d3d_alpha_fog_zbuffer ( TRUE, FALSE, TRUE, FALSE );

  0022c	6a 00		 push	 0
  0022e	6a 01		 push	 1
  00230	6a 00		 push	 0
  00232	6a 01		 push	 1
  00234	e8 00 00 00 00	 call	 ?set_d3d_alpha_fog_zbuffer@@YGXHHHH@Z ; set_d3d_alpha_fog_zbuffer

; 783  : 
; 784  : 		set_d3d_int_state ( D3DRENDERSTATE_SHADEMODE, D3DSHADE_GOURAUD );

  00239	6a 02		 push	 2
  0023b	6a 09		 push	 9
  0023d	e8 00 00 00 00	 call	 ?set_d3d_int_state@@YGXW4_D3DRENDERSTATETYPE@@K@Z ; set_d3d_int_state

; 785  : 
; 786  : 		set_d3d_texture ( 0, NULL );

  00242	6a 00		 push	 0
  00244	6a 00		 push	 0
  00246	e8 00 00 00 00	 call	 ?set_d3d_texture@@YGXHPAUSCREEN@@@Z ; set_d3d_texture

; 787  : 
; 788  : 		set_d3d_texture_stage_state ( 0, D3DTSS_COLOROP, D3DTOP_DISABLE );

  0024b	6a 01		 push	 1
  0024d	6a 01		 push	 1
  0024f	6a 00		 push	 0
  00251	e8 00 00 00 00	 call	 ?set_d3d_texture_stage_state@@YGXHHH@Z ; set_d3d_texture_stage_state

; 789  : 		set_d3d_texture_stage_state ( 0, D3DTSS_ALPHAOP, D3DTOP_DISABLE );

  00256	6a 01		 push	 1
  00258	6a 04		 push	 4
  0025a	6a 00		 push	 0
  0025c	e8 00 00 00 00	 call	 ?set_d3d_texture_stage_state@@YGXHHH@Z ; set_d3d_texture_stage_state

; 790  : 
; 791  : 		for ( count = 0; count < number_of_valid_raindrops; count++ )

  00261	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  00268	eb 09		 jmp	 SHORT $LN4@draw_3d_ra
$LN2@draw_3d_ra:
  0026a	8b 45 f8	 mov	 eax, DWORD PTR _count$[ebp]
  0026d	83 c0 01	 add	 eax, 1
  00270	89 45 f8	 mov	 DWORD PTR _count$[ebp], eax
$LN4@draw_3d_ra:
  00273	8b 45 f8	 mov	 eax, DWORD PTR _count$[ebp]
  00276	3b 45 f0	 cmp	 eax, DWORD PTR _number_of_valid_raindrops$15[ebp]
  00279	0f 8d ae 01 00
	00		 jge	 $LN3@draw_3d_ra

; 792  : 		{
; 793  : 	
; 794  : 			vertex
; 795  : 				*line;
; 796  : 	
; 797  : 			//
; 798  : 			// Construct the 3d line
; 799  : 			//
; 800  : 	
; 801  : 			clip_3d_coord = 0;

  0027f	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?clip_3d_coord@@3HA, 0 ; clip_3d_coord

; 802  : 	
; 803  : 			line = construct_3d_line ( rain_point_references, ( count * 2 ), &outcode );

  00289	8d 45 f4	 lea	 eax, DWORD PTR _outcode$[ebp]
  0028c	50		 push	 eax
  0028d	8b 4d f8	 mov	 ecx, DWORD PTR _count$[ebp]
  00290	d1 e1		 shl	 ecx, 1
  00292	51		 push	 ecx
  00293	8d 55 fc	 lea	 edx, DWORD PTR _rain_point_references$[ebp]
  00296	52		 push	 edx
  00297	e8 00 00 00 00	 call	 ?construct_3d_line@@YGPAUVERTEX@@PAUPOINT_3D_PLAIN_REFERENCE@@HPAH@Z ; construct_3d_line
  0029c	89 45 e4	 mov	 DWORD PTR _line$12[ebp], eax

; 804  : 
; 805  : 			if ( line )

  0029f	83 7d e4 00	 cmp	 DWORD PTR _line$12[ebp], 0
  002a3	0f 84 7f 01 00
	00		 je	 $LN13@draw_3d_ra

; 806  : 			{
; 807  : 
; 808  : 				line->red = rain_whiteness;

  002a9	8b 45 e4	 mov	 eax, DWORD PTR _line$12[ebp]
  002ac	8a 4d e8	 mov	 cl, BYTE PTR _rain_whiteness$13[ebp]
  002af	88 48 32	 mov	 BYTE PTR [eax+50], cl

; 809  : 				line->green = rain_whiteness;

  002b2	8b 45 e4	 mov	 eax, DWORD PTR _line$12[ebp]
  002b5	8a 4d e8	 mov	 cl, BYTE PTR _rain_whiteness$13[ebp]
  002b8	88 48 31	 mov	 BYTE PTR [eax+49], cl

; 810  : 				line->blue = rain_whiteness;

  002bb	8b 45 e4	 mov	 eax, DWORD PTR _line$12[ebp]
  002be	8a 4d e8	 mov	 cl, BYTE PTR _rain_whiteness$13[ebp]
  002c1	88 48 30	 mov	 BYTE PTR [eax+48], cl

; 811  : 				line->alpha = 32;

  002c4	8b 45 e4	 mov	 eax, DWORD PTR _line$12[ebp]
  002c7	c6 40 33 20	 mov	 BYTE PTR [eax+51], 32	; 00000020H

; 812  : 
; 813  : 				line->next_vertex->red = rain_whiteness;

  002cb	8b 45 e4	 mov	 eax, DWORD PTR _line$12[ebp]
  002ce	8b 48 28	 mov	 ecx, DWORD PTR [eax+40]
  002d1	8a 55 e8	 mov	 dl, BYTE PTR _rain_whiteness$13[ebp]
  002d4	88 51 32	 mov	 BYTE PTR [ecx+50], dl

; 814  : 				line->next_vertex->green = rain_whiteness;

  002d7	8b 45 e4	 mov	 eax, DWORD PTR _line$12[ebp]
  002da	8b 48 28	 mov	 ecx, DWORD PTR [eax+40]
  002dd	8a 55 e8	 mov	 dl, BYTE PTR _rain_whiteness$13[ebp]
  002e0	88 51 31	 mov	 BYTE PTR [ecx+49], dl

; 815  : 				line->next_vertex->blue = rain_whiteness;

  002e3	8b 45 e4	 mov	 eax, DWORD PTR _line$12[ebp]
  002e6	8b 48 28	 mov	 ecx, DWORD PTR [eax+40]
  002e9	8a 55 e8	 mov	 dl, BYTE PTR _rain_whiteness$13[ebp]
  002ec	88 51 30	 mov	 BYTE PTR [ecx+48], dl

; 816  : 				line->next_vertex->alpha = 192;

  002ef	8b 45 e4	 mov	 eax, DWORD PTR _line$12[ebp]
  002f2	8b 48 28	 mov	 ecx, DWORD PTR [eax+40]
  002f5	c6 41 33 c0	 mov	 BYTE PTR [ecx+51], 192	; 000000c0H

; 817  : 		
; 818  : 				if ( outcode & CLIP_HITHER )

  002f9	8b 45 f4	 mov	 eax, DWORD PTR _outcode$[ebp]
  002fc	83 e0 20	 and	 eax, 32			; 00000020H
  002ff	74 10		 je	 SHORT $LN10@draw_3d_ra

; 819  : 				{
; 820  : 			
; 821  : 					line = hither_clip_3d_polygon ( line, &outcode );

  00301	8d 45 f4	 lea	 eax, DWORD PTR _outcode$[ebp]
  00304	50		 push	 eax
  00305	8b 4d e4	 mov	 ecx, DWORD PTR _line$12[ebp]
  00308	51		 push	 ecx
  00309	e8 00 00 00 00	 call	 ?hither_clip_3d_polygon@@YGPAUVERTEX@@PAU1@PAH@Z ; hither_clip_3d_polygon
  0030e	89 45 e4	 mov	 DWORD PTR _line$12[ebp], eax
$LN10@draw_3d_ra:

; 822  : 				}
; 823  : 	
; 824  : 				if ( line )

  00311	83 7d e4 00	 cmp	 DWORD PTR _line$12[ebp], 0
  00315	0f 84 0d 01 00
	00		 je	 $LN13@draw_3d_ra

; 825  : 				{
; 826  : 		
; 827  : 					if ( outcode )

  0031b	83 7d f4 00	 cmp	 DWORD PTR _outcode$[ebp], 0
  0031f	74 10		 je	 SHORT $LN12@draw_3d_ra

; 828  : 					{
; 829  : 				
; 830  : 						line = clip_3d_polygon ( line, outcode );

  00321	8b 45 f4	 mov	 eax, DWORD PTR _outcode$[ebp]
  00324	50		 push	 eax
  00325	8b 4d e4	 mov	 ecx, DWORD PTR _line$12[ebp]
  00328	51		 push	 ecx
  00329	e8 00 00 00 00	 call	 ?clip_3d_polygon@@YGPAUVERTEX@@PAU1@H@Z ; clip_3d_polygon
  0032e	89 45 e4	 mov	 DWORD PTR _line$12[ebp], eax
$LN12@draw_3d_ra:

; 831  : 					}
; 832  : 	
; 833  : 					if ( line )

  00331	83 7d e4 00	 cmp	 DWORD PTR _line$12[ebp], 0
  00335	0f 84 ed 00 00
	00		 je	 $LN13@draw_3d_ra

; 834  : 					{
; 835  : 	
; 836  : 						vertex
; 837  : 							*point1,
; 838  : 							*point2;
; 839  : 					
; 840  : 						LPD3DTLVERTEX
; 841  : 							vertices,
; 842  : 							vptr;
; 843  : 
; 844  : 						vertices = get_d3d_line_vertices_points_address ();

  0033b	e8 00 00 00 00	 call	 ?get_d3d_line_vertices_points_address@@YGPAU_D3DTLVERTEX@@XZ ; get_d3d_line_vertices_points_address
  00340	89 45 d8	 mov	 DWORD PTR _vertices$9[ebp], eax

; 845  : 					
; 846  : 						vptr = vertices;

  00343	8b 45 d8	 mov	 eax, DWORD PTR _vertices$9[ebp]
  00346	89 45 d4	 mov	 DWORD PTR _vptr$8[ebp], eax

; 847  : 					
; 848  : 						point2 = line;

  00349	8b 45 e4	 mov	 eax, DWORD PTR _line$12[ebp]
  0034c	89 45 dc	 mov	 DWORD PTR _point2$10[ebp], eax

; 849  : 					
; 850  : 						point1 = line->next_vertex;

  0034f	8b 45 e4	 mov	 eax, DWORD PTR _line$12[ebp]
  00352	8b 48 28	 mov	 ecx, DWORD PTR [eax+40]
  00355	89 4d e0	 mov	 DWORD PTR _point1$11[ebp], ecx

; 851  : 					
; 852  : 						*( ( int * ) &vptr->sx ) = *( ( int * ) &point1->i );

  00358	8b 45 d4	 mov	 eax, DWORD PTR _vptr$8[ebp]
  0035b	8b 4d e0	 mov	 ecx, DWORD PTR _point1$11[ebp]
  0035e	8b 51 10	 mov	 edx, DWORD PTR [ecx+16]
  00361	89 10		 mov	 DWORD PTR [eax], edx

; 853  : 						*( ( int * ) &vptr->sy ) = *( ( int * ) &point1->j );

  00363	8b 45 d4	 mov	 eax, DWORD PTR _vptr$8[ebp]
  00366	8b 4d e0	 mov	 ecx, DWORD PTR _point1$11[ebp]
  00369	8b 51 14	 mov	 edx, DWORD PTR [ecx+20]
  0036c	89 50 04	 mov	 DWORD PTR [eax+4], edx

; 854  : 						*( ( int * ) &vptr->rhw ) = *( ( int * ) &point1->q );

  0036f	8b 45 d4	 mov	 eax, DWORD PTR _vptr$8[ebp]
  00372	8b 4d e0	 mov	 ecx, DWORD PTR _point1$11[ebp]
  00375	8b 51 0c	 mov	 edx, DWORD PTR [ecx+12]
  00378	89 50 0c	 mov	 DWORD PTR [eax+12], edx

; 855  : 						vptr->sz = ( point1->q * zbuffer_factor ) + zbuffer_constant;

  0037b	8b 45 e0	 mov	 eax, DWORD PTR _point1$11[ebp]
  0037e	f3 0f 5a 40 0c	 cvtss2sd xmm0, DWORD PTR [eax+12]
  00383	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  0038b	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  00393	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00397	8b 4d d4	 mov	 ecx, DWORD PTR _vptr$8[ebp]
  0039a	f3 0f 11 41 08	 movss	 DWORD PTR [ecx+8], xmm0

; 856  : 					
; 857  : 						vptr->color = point1->colour;

  0039f	8b 45 d4	 mov	 eax, DWORD PTR _vptr$8[ebp]
  003a2	8b 4d e0	 mov	 ecx, DWORD PTR _point1$11[ebp]
  003a5	8b 51 30	 mov	 edx, DWORD PTR [ecx+48]
  003a8	89 50 10	 mov	 DWORD PTR [eax+16], edx

; 858  : 						vptr->specular = d3d_fog_intensity;

  003ab	8b 45 d4	 mov	 eax, DWORD PTR _vptr$8[ebp]
  003ae	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?d3d_fog_intensity@@3KA ; d3d_fog_intensity
  003b4	89 48 14	 mov	 DWORD PTR [eax+20], ecx

; 859  : 					
; 860  : 						vptr++;

  003b7	8b 45 d4	 mov	 eax, DWORD PTR _vptr$8[ebp]
  003ba	83 c0 20	 add	 eax, 32			; 00000020H
  003bd	89 45 d4	 mov	 DWORD PTR _vptr$8[ebp], eax

; 861  : 					
; 862  : 						*( ( int * ) &vptr->sx ) = *( ( int * ) &point2->i );

  003c0	8b 45 d4	 mov	 eax, DWORD PTR _vptr$8[ebp]
  003c3	8b 4d dc	 mov	 ecx, DWORD PTR _point2$10[ebp]
  003c6	8b 51 10	 mov	 edx, DWORD PTR [ecx+16]
  003c9	89 10		 mov	 DWORD PTR [eax], edx

; 863  : 						*( ( int * ) &vptr->sy ) = *( ( int * ) &point2->j );

  003cb	8b 45 d4	 mov	 eax, DWORD PTR _vptr$8[ebp]
  003ce	8b 4d dc	 mov	 ecx, DWORD PTR _point2$10[ebp]
  003d1	8b 51 14	 mov	 edx, DWORD PTR [ecx+20]
  003d4	89 50 04	 mov	 DWORD PTR [eax+4], edx

; 864  : 						*( ( int * ) &vptr->rhw ) = *( ( int * ) &point2->q );

  003d7	8b 45 d4	 mov	 eax, DWORD PTR _vptr$8[ebp]
  003da	8b 4d dc	 mov	 ecx, DWORD PTR _point2$10[ebp]
  003dd	8b 51 0c	 mov	 edx, DWORD PTR [ecx+12]
  003e0	89 50 0c	 mov	 DWORD PTR [eax+12], edx

; 865  : 						vptr->sz = ( point2->q * zbuffer_factor ) + zbuffer_constant;

  003e3	8b 45 dc	 mov	 eax, DWORD PTR _point2$10[ebp]
  003e6	f3 0f 5a 40 0c	 cvtss2sd xmm0, DWORD PTR [eax+12]
  003eb	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR ?zbuffer_factor@@3NA
  003f3	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR ?zbuffer_constant@@3NA
  003fb	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  003ff	8b 4d d4	 mov	 ecx, DWORD PTR _vptr$8[ebp]
  00402	f3 0f 11 41 08	 movss	 DWORD PTR [ecx+8], xmm0

; 866  : 					
; 867  : 						vptr->color = point2->colour;

  00407	8b 45 d4	 mov	 eax, DWORD PTR _vptr$8[ebp]
  0040a	8b 4d dc	 mov	 ecx, DWORD PTR _point2$10[ebp]
  0040d	8b 51 30	 mov	 edx, DWORD PTR [ecx+48]
  00410	89 50 10	 mov	 DWORD PTR [eax+16], edx

; 868  : 						vptr->specular = d3d_fog_intensity;

  00413	8b 45 d4	 mov	 eax, DWORD PTR _vptr$8[ebp]
  00416	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?d3d_fog_intensity@@3KA ; d3d_fog_intensity
  0041c	89 48 14	 mov	 DWORD PTR [eax+20], ecx

; 869  : 					
; 870  : 						draw_line_primitive ( vertices );

  0041f	8b 45 d8	 mov	 eax, DWORD PTR _vertices$9[ebp]
  00422	50		 push	 eax
  00423	e8 00 00 00 00	 call	 ?draw_line_primitive@@YGXPAU_D3DTLVERTEX@@@Z ; draw_line_primitive
$LN13@draw_3d_ra:

; 871  : 					}
; 872  : 				}
; 873  : 			}
; 874  : 		}

  00428	e9 3d fe ff ff	 jmp	 $LN2@draw_3d_ra
$LN3@draw_3d_ra:

; 875  : 
; 876  : 		flush_line_primitives ();

  0042d	e8 00 00 00 00	 call	 ?flush_line_primitives@@YGXXZ ; flush_line_primitives

; 877  : 
; 878  : 		set_d3d_alpha_fog_zbuffer ( FALSE, TRUE, TRUE, TRUE );

  00432	6a 01		 push	 1
  00434	6a 01		 push	 1
  00436	6a 01		 push	 1
  00438	6a 00		 push	 0
  0043a	e8 00 00 00 00	 call	 ?set_d3d_alpha_fog_zbuffer@@YGXHHHH@Z ; set_d3d_alpha_fog_zbuffer
$LN8@draw_3d_ra:

; 879  : 	}
; 880  : 
; 881  : 	if ( rain_3d_snowdrops_valid )

  0043f	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?rain_3d_snowdrops_valid@@3HA, 0
  00446	0f 84 fe 05 00
	00		 je	 $LN14@draw_3d_ra

; 882  : 	{
; 883  : 
; 884  : 		real_colour
; 885  : 			snow_specular,
; 886  : 			snow_colour;
; 887  : 	
; 888  : 		//
; 889  : 		// Rotate the rain - putting the results in transformed_3d_points
; 890  : 		//
; 891  : 	
; 892  : 		transform_3d_snow ();

  0044c	e8 00 00 00 00	 call	 ?transform_3d_snow@@YGXXZ ; transform_3d_snow

; 893  : 
; 894  : 		set_d3d_alpha_fog_zbuffer ( TRUE, FALSE, FALSE, FALSE );

  00451	6a 00		 push	 0
  00453	6a 00		 push	 0
  00455	6a 00		 push	 0
  00457	6a 01		 push	 1
  00459	e8 00 00 00 00	 call	 ?set_d3d_alpha_fog_zbuffer@@YGXHHHH@Z ; set_d3d_alpha_fog_zbuffer

; 895  : 
; 896  : 		//
; 897  : 		// First, set the snow texture
; 898  : 		//
; 899  : 
; 900  : 		set_d3d_texture ( 0, snow_3d_texture );

  0045e	a1 00 00 00 00	 mov	 eax, DWORD PTR ?snow_3d_texture@@3PAUSCREEN@@A
  00463	50		 push	 eax
  00464	6a 00		 push	 0
  00466	e8 00 00 00 00	 call	 ?set_d3d_texture@@YGXHPAUSCREEN@@@Z ; set_d3d_texture

; 901  : 
; 902  : 		set_d3d_texture_stage_state ( 0, D3DTSS_ADDRESSU, D3DTADDRESS_CLAMP );

  0046b	6a 03		 push	 3
  0046d	6a 0d		 push	 13			; 0000000dH
  0046f	6a 00		 push	 0
  00471	e8 00 00 00 00	 call	 ?set_d3d_texture_stage_state@@YGXHHH@Z ; set_d3d_texture_stage_state

; 903  : 		set_d3d_texture_stage_state ( 0, D3DTSS_ADDRESSV, D3DTADDRESS_CLAMP );

  00476	6a 03		 push	 3
  00478	6a 0e		 push	 14			; 0000000eH
  0047a	6a 00		 push	 0
  0047c	e8 00 00 00 00	 call	 ?set_d3d_texture_stage_state@@YGXHHH@Z ; set_d3d_texture_stage_state

; 904  : 		set_d3d_texture_stage_state ( 0, D3DTSS_MAGFILTER, D3DTFG_LINEAR );

  00481	6a 02		 push	 2
  00483	6a 10		 push	 16			; 00000010H
  00485	6a 00		 push	 0
  00487	e8 00 00 00 00	 call	 ?set_d3d_texture_stage_state@@YGXHHH@Z ; set_d3d_texture_stage_state

; 905  : 		set_d3d_texture_stage_state ( 0, D3DTSS_MINFILTER, D3DTFN_LINEAR );

  0048c	6a 02		 push	 2
  0048e	6a 11		 push	 17			; 00000011H
  00490	6a 00		 push	 0
  00492	e8 00 00 00 00	 call	 ?set_d3d_texture_stage_state@@YGXHHH@Z ; set_d3d_texture_stage_state

; 906  : 
; 907  : 		set_d3d_texture_stage_state ( 0, D3DTSS_COLOROP, D3DTOP_MODULATE );

  00497	6a 04		 push	 4
  00499	6a 01		 push	 1
  0049b	6a 00		 push	 0
  0049d	e8 00 00 00 00	 call	 ?set_d3d_texture_stage_state@@YGXHHH@Z ; set_d3d_texture_stage_state

; 908  : 		set_d3d_texture_stage_state ( 0, D3DTSS_COLORARG1, D3DTA_TEXTURE );

  004a2	6a 02		 push	 2
  004a4	6a 02		 push	 2
  004a6	6a 00		 push	 0
  004a8	e8 00 00 00 00	 call	 ?set_d3d_texture_stage_state@@YGXHHH@Z ; set_d3d_texture_stage_state

; 909  : 		set_d3d_texture_stage_state ( 0, D3DTSS_COLORARG2, D3DTA_DIFFUSE );

  004ad	6a 00		 push	 0
  004af	6a 03		 push	 3
  004b1	6a 00		 push	 0
  004b3	e8 00 00 00 00	 call	 ?set_d3d_texture_stage_state@@YGXHHH@Z ; set_d3d_texture_stage_state

; 910  : 
; 911  : 		set_d3d_texture_stage_state ( 0, D3DTSS_ALPHAOP, D3DTOP_MODULATE );

  004b8	6a 04		 push	 4
  004ba	6a 04		 push	 4
  004bc	6a 00		 push	 0
  004be	e8 00 00 00 00	 call	 ?set_d3d_texture_stage_state@@YGXHHH@Z ; set_d3d_texture_stage_state

; 912  : 		set_d3d_texture_stage_state ( 0, D3DTSS_ALPHAARG1, D3DTA_TEXTURE );

  004c3	6a 02		 push	 2
  004c5	6a 05		 push	 5
  004c7	6a 00		 push	 0
  004c9	e8 00 00 00 00	 call	 ?set_d3d_texture_stage_state@@YGXHHH@Z ; set_d3d_texture_stage_state

; 913  : 		set_d3d_texture_stage_state ( 0, D3DTSS_ALPHAARG2, D3DTA_DIFFUSE );

  004ce	6a 00		 push	 0
  004d0	6a 06		 push	 6
  004d2	6a 00		 push	 0
  004d4	e8 00 00 00 00	 call	 ?set_d3d_texture_stage_state@@YGXHHH@Z ; set_d3d_texture_stage_state

; 914  : 
; 915  : 		snow_colour.red = 255;

  004d9	c6 45 ce ff	 mov	 BYTE PTR _snow_colour$6[ebp+2], 255 ; 000000ffH

; 916  : 		snow_colour.green = 255;

  004dd	c6 45 cd ff	 mov	 BYTE PTR _snow_colour$6[ebp+1], 255 ; 000000ffH

; 917  : 		snow_colour.blue = 255;

  004e1	c6 45 cc ff	 mov	 BYTE PTR _snow_colour$6[ebp], 255 ; 000000ffH

; 918  : 		snow_colour.alpha = 255;

  004e5	c6 45 cf ff	 mov	 BYTE PTR _snow_colour$6[ebp+3], 255 ; 000000ffH

; 919  : 
; 920  : 		snow_specular.colour = d3d_fog_intensity;

  004e9	a1 00 00 00 00	 mov	 eax, DWORD PTR ?d3d_fog_intensity@@3KA ; d3d_fog_intensity
  004ee	89 45 d0	 mov	 DWORD PTR _snow_specular$7[ebp], eax

; 921  : 	
; 922  : 		for ( count = 0; count < rain_3d_snowdrops_valid; count++ )

  004f1	c7 45 f8 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  004f8	eb 09		 jmp	 SHORT $LN7@draw_3d_ra
$LN5@draw_3d_ra:
  004fa	8b 45 f8	 mov	 eax, DWORD PTR _count$[ebp]
  004fd	83 c0 01	 add	 eax, 1
  00500	89 45 f8	 mov	 DWORD PTR _count$[ebp], eax
$LN7@draw_3d_ra:
  00503	8b 45 f8	 mov	 eax, DWORD PTR _count$[ebp]
  00506	3b 05 00 00 00
	00		 cmp	 eax, DWORD PTR ?rain_3d_snowdrops_valid@@3HA
  0050c	0f 8d 2b 05 00
	00		 jge	 $LN6@draw_3d_ra

; 923  : 		{
; 924  : 
; 925  : 			vertex
; 926  : 				*poly,
; 927  : 				snow_quad[4];
; 928  : 
; 929  : 			if ( !transformed_3d_points[count].outcode )

  00512	8b 45 f8	 mov	 eax, DWORD PTR _count$[ebp]
  00515	c1 e0 06	 shl	 eax, 6
  00518	0f b6 88 2c 00
	00 00		 movzx	 ecx, BYTE PTR ?transformed_3d_points@@3PAUVERTEX@@A[eax+44]
  0051f	85 c9		 test	 ecx, ecx
  00521	0f 85 11 05 00
	00		 jne	 $LN17@draw_3d_ra

; 930  : 			{
; 931  : 
; 932  : 				float
; 933  : 					width,
; 934  : 					height;
; 935  : 
; 936  : 				int
; 937  : 					outcode;
; 938  : 
; 939  : 				//
; 940  : 				// We know the raindrop is on the screen ( to a certain extent )
; 941  : 				//
; 942  : 
; 943  : 				width = active_3d_environment->screen_i_scale * snow_particle_radius * transformed_3d_points[count].q;

  00527	a1 00 00 00 00	 mov	 eax, DWORD PTR ?active_3d_environment@@3PAUENV_3D@@A ; active_3d_environment
  0052c	f3 0f 10 00	 movss	 xmm0, DWORD PTR [eax]
  00530	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?snow_particle_radius@@3MA
  00538	8b 4d f8	 mov	 ecx, DWORD PTR _count$[ebp]
  0053b	c1 e1 06	 shl	 ecx, 6
  0053e	f3 0f 59 81 0c
	00 00 00	 mulss	 xmm0, DWORD PTR ?transformed_3d_points@@3PAUVERTEX@@A[ecx+12]
  00546	f3 0f 11 85 c4
	fe ff ff	 movss	 DWORD PTR _width$3[ebp], xmm0

; 944  : 				height = active_3d_environment->screen_j_scale * snow_particle_radius * transformed_3d_points[count].q;

  0054e	a1 00 00 00 00	 mov	 eax, DWORD PTR ?active_3d_environment@@3PAUENV_3D@@A ; active_3d_environment
  00553	f3 0f 10 40 04	 movss	 xmm0, DWORD PTR [eax+4]
  00558	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?snow_particle_radius@@3MA
  00560	8b 4d f8	 mov	 ecx, DWORD PTR _count$[ebp]
  00563	c1 e1 06	 shl	 ecx, 6
  00566	f3 0f 59 81 0c
	00 00 00	 mulss	 xmm0, DWORD PTR ?transformed_3d_points@@3PAUVERTEX@@A[ecx+12]
  0056e	f3 0f 11 85 c0
	fe ff ff	 movss	 DWORD PTR _height$2[ebp], xmm0

; 945  : 
; 946  : 				snow_quad[0].q = transformed_3d_points[count].q;

  00576	8b 45 f8	 mov	 eax, DWORD PTR _count$[ebp]
  00579	c1 e0 06	 shl	 eax, 6
  0057c	b9 40 00 00 00	 mov	 ecx, 64			; 00000040H
  00581	6b d1 00	 imul	 edx, ecx, 0
  00584	8b 80 0c 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_points@@3PAUVERTEX@@A[eax+12]
  0058a	89 84 15 d4 fe
	ff ff		 mov	 DWORD PTR _snow_quad$4[ebp+edx+12], eax

; 947  : 				snow_quad[0].i = transformed_3d_points[count].i - ( width / 2 );

  00591	8b 45 f8	 mov	 eax, DWORD PTR _count$[ebp]
  00594	c1 e0 06	 shl	 eax, 6
  00597	f3 0f 10 85 c4
	fe ff ff	 movss	 xmm0, DWORD PTR _width$3[ebp]
  0059f	f3 0f 5e 05 00
	00 00 00	 divss	 xmm0, DWORD PTR __real@40000000
  005a7	f3 0f 10 88 10
	00 00 00	 movss	 xmm1, DWORD PTR ?transformed_3d_points@@3PAUVERTEX@@A[eax+16]
  005af	f3 0f 5c c8	 subss	 xmm1, xmm0
  005b3	b9 40 00 00 00	 mov	 ecx, 64			; 00000040H
  005b8	6b d1 00	 imul	 edx, ecx, 0
  005bb	f3 0f 11 8c 15
	d8 fe ff ff	 movss	 DWORD PTR _snow_quad$4[ebp+edx+16], xmm1

; 948  : 				snow_quad[0].j = transformed_3d_points[count].j - ( height / 2 );

  005c4	8b 45 f8	 mov	 eax, DWORD PTR _count$[ebp]
  005c7	c1 e0 06	 shl	 eax, 6
  005ca	f3 0f 10 85 c0
	fe ff ff	 movss	 xmm0, DWORD PTR _height$2[ebp]
  005d2	f3 0f 5e 05 00
	00 00 00	 divss	 xmm0, DWORD PTR __real@40000000
  005da	f3 0f 10 88 14
	00 00 00	 movss	 xmm1, DWORD PTR ?transformed_3d_points@@3PAUVERTEX@@A[eax+20]
  005e2	f3 0f 5c c8	 subss	 xmm1, xmm0
  005e6	b9 40 00 00 00	 mov	 ecx, 64			; 00000040H
  005eb	6b d1 00	 imul	 edx, ecx, 0
  005ee	f3 0f 11 8c 15
	dc fe ff ff	 movss	 DWORD PTR _snow_quad$4[ebp+edx+20], xmm1

; 949  : 				snow_quad[0].u = 0;

  005f7	b8 40 00 00 00	 mov	 eax, 64			; 00000040H
  005fc	6b c8 00	 imul	 ecx, eax, 0
  005ff	0f 57 c0	 xorps	 xmm0, xmm0
  00602	f3 0f 11 84 0d
	e0 fe ff ff	 movss	 DWORD PTR _snow_quad$4[ebp+ecx+24], xmm0

; 950  : 				snow_quad[0].v = 0;

  0060b	b8 40 00 00 00	 mov	 eax, 64			; 00000040H
  00610	6b c8 00	 imul	 ecx, eax, 0
  00613	0f 57 c0	 xorps	 xmm0, xmm0
  00616	f3 0f 11 84 0d
	e4 fe ff ff	 movss	 DWORD PTR _snow_quad$4[ebp+ecx+28], xmm0

; 951  : 				snow_quad[0].outcode = generate_3d_outcode ( snow_quad[0].i, snow_quad[0].j );

  0061f	b8 40 00 00 00	 mov	 eax, 64			; 00000040H
  00624	6b c8 00	 imul	 ecx, eax, 0
  00627	51		 push	 ecx
  00628	f3 0f 10 84 0d
	dc fe ff ff	 movss	 xmm0, DWORD PTR _snow_quad$4[ebp+ecx+20]
  00631	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00636	ba 40 00 00 00	 mov	 edx, 64			; 00000040H
  0063b	6b c2 00	 imul	 eax, edx, 0
  0063e	51		 push	 ecx
  0063f	f3 0f 10 84 05
	d8 fe ff ff	 movss	 xmm0, DWORD PTR _snow_quad$4[ebp+eax+16]
  00648	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0064d	e8 00 00 00 00	 call	 ?generate_3d_outcode@@YGHMM@Z ; generate_3d_outcode
  00652	b9 40 00 00 00	 mov	 ecx, 64			; 00000040H
  00657	6b d1 00	 imul	 edx, ecx, 0
  0065a	88 84 15 f4 fe
	ff ff		 mov	 BYTE PTR _snow_quad$4[ebp+edx+44], al

; 952  : 				snow_quad[0].next_vertex = &snow_quad[1];

  00661	b8 40 00 00 00	 mov	 eax, 64			; 00000040H
  00666	c1 e0 00	 shl	 eax, 0
  00669	8d 8c 05 c8 fe
	ff ff		 lea	 ecx, DWORD PTR _snow_quad$4[ebp+eax]
  00670	ba 40 00 00 00	 mov	 edx, 64			; 00000040H
  00675	6b c2 00	 imul	 eax, edx, 0
  00678	89 8c 05 f0 fe
	ff ff		 mov	 DWORD PTR _snow_quad$4[ebp+eax+40], ecx

; 953  : 
; 954  : 				snow_quad[1].q = transformed_3d_points[count].q;

  0067f	8b 45 f8	 mov	 eax, DWORD PTR _count$[ebp]
  00682	c1 e0 06	 shl	 eax, 6
  00685	b9 40 00 00 00	 mov	 ecx, 64			; 00000040H
  0068a	c1 e1 00	 shl	 ecx, 0
  0068d	8b 90 0c 00 00
	00		 mov	 edx, DWORD PTR ?transformed_3d_points@@3PAUVERTEX@@A[eax+12]
  00693	89 94 0d d4 fe
	ff ff		 mov	 DWORD PTR _snow_quad$4[ebp+ecx+12], edx

; 955  : 				snow_quad[1].i = transformed_3d_points[count].i + ( width / 2 );

  0069a	8b 45 f8	 mov	 eax, DWORD PTR _count$[ebp]
  0069d	c1 e0 06	 shl	 eax, 6
  006a0	f3 0f 10 85 c4
	fe ff ff	 movss	 xmm0, DWORD PTR _width$3[ebp]
  006a8	f3 0f 5e 05 00
	00 00 00	 divss	 xmm0, DWORD PTR __real@40000000
  006b0	f3 0f 58 80 10
	00 00 00	 addss	 xmm0, DWORD PTR ?transformed_3d_points@@3PAUVERTEX@@A[eax+16]
  006b8	b9 40 00 00 00	 mov	 ecx, 64			; 00000040H
  006bd	c1 e1 00	 shl	 ecx, 0
  006c0	f3 0f 11 84 0d
	d8 fe ff ff	 movss	 DWORD PTR _snow_quad$4[ebp+ecx+16], xmm0

; 956  : 				snow_quad[1].j = transformed_3d_points[count].j - ( height / 2 );

  006c9	8b 45 f8	 mov	 eax, DWORD PTR _count$[ebp]
  006cc	c1 e0 06	 shl	 eax, 6
  006cf	f3 0f 10 85 c0
	fe ff ff	 movss	 xmm0, DWORD PTR _height$2[ebp]
  006d7	f3 0f 5e 05 00
	00 00 00	 divss	 xmm0, DWORD PTR __real@40000000
  006df	f3 0f 10 88 14
	00 00 00	 movss	 xmm1, DWORD PTR ?transformed_3d_points@@3PAUVERTEX@@A[eax+20]
  006e7	f3 0f 5c c8	 subss	 xmm1, xmm0
  006eb	b9 40 00 00 00	 mov	 ecx, 64			; 00000040H
  006f0	c1 e1 00	 shl	 ecx, 0
  006f3	f3 0f 11 8c 0d
	dc fe ff ff	 movss	 DWORD PTR _snow_quad$4[ebp+ecx+20], xmm1

; 957  : 				snow_quad[1].u = 1;

  006fc	b8 40 00 00 00	 mov	 eax, 64			; 00000040H
  00701	c1 e0 00	 shl	 eax, 0
  00704	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@3f800000
  0070c	f3 0f 11 84 05
	e0 fe ff ff	 movss	 DWORD PTR _snow_quad$4[ebp+eax+24], xmm0

; 958  : 				snow_quad[1].v = 0;

  00715	b8 40 00 00 00	 mov	 eax, 64			; 00000040H
  0071a	c1 e0 00	 shl	 eax, 0
  0071d	0f 57 c0	 xorps	 xmm0, xmm0
  00720	f3 0f 11 84 05
	e4 fe ff ff	 movss	 DWORD PTR _snow_quad$4[ebp+eax+28], xmm0

; 959  : 				snow_quad[1].outcode = generate_3d_outcode ( snow_quad[1].i, snow_quad[1].j );

  00729	b8 40 00 00 00	 mov	 eax, 64			; 00000040H
  0072e	c1 e0 00	 shl	 eax, 0
  00731	51		 push	 ecx
  00732	f3 0f 10 84 05
	dc fe ff ff	 movss	 xmm0, DWORD PTR _snow_quad$4[ebp+eax+20]
  0073b	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00740	b9 40 00 00 00	 mov	 ecx, 64			; 00000040H
  00745	c1 e1 00	 shl	 ecx, 0
  00748	51		 push	 ecx
  00749	f3 0f 10 84 0d
	d8 fe ff ff	 movss	 xmm0, DWORD PTR _snow_quad$4[ebp+ecx+16]
  00752	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00757	e8 00 00 00 00	 call	 ?generate_3d_outcode@@YGHMM@Z ; generate_3d_outcode
  0075c	ba 40 00 00 00	 mov	 edx, 64			; 00000040H
  00761	c1 e2 00	 shl	 edx, 0
  00764	88 84 15 f4 fe
	ff ff		 mov	 BYTE PTR _snow_quad$4[ebp+edx+44], al

; 960  : 				snow_quad[1].next_vertex = &snow_quad[2];

  0076b	b8 40 00 00 00	 mov	 eax, 64			; 00000040H
  00770	d1 e0		 shl	 eax, 1
  00772	8d 8c 05 c8 fe
	ff ff		 lea	 ecx, DWORD PTR _snow_quad$4[ebp+eax]
  00779	ba 40 00 00 00	 mov	 edx, 64			; 00000040H
  0077e	c1 e2 00	 shl	 edx, 0
  00781	89 8c 15 f0 fe
	ff ff		 mov	 DWORD PTR _snow_quad$4[ebp+edx+40], ecx

; 961  : 
; 962  : 				snow_quad[2].q = transformed_3d_points[count].q;

  00788	8b 45 f8	 mov	 eax, DWORD PTR _count$[ebp]
  0078b	c1 e0 06	 shl	 eax, 6
  0078e	b9 40 00 00 00	 mov	 ecx, 64			; 00000040H
  00793	d1 e1		 shl	 ecx, 1
  00795	8b 90 0c 00 00
	00		 mov	 edx, DWORD PTR ?transformed_3d_points@@3PAUVERTEX@@A[eax+12]
  0079b	89 94 0d d4 fe
	ff ff		 mov	 DWORD PTR _snow_quad$4[ebp+ecx+12], edx

; 963  : 				snow_quad[2].i = transformed_3d_points[count].i + ( width / 2 );

  007a2	8b 45 f8	 mov	 eax, DWORD PTR _count$[ebp]
  007a5	c1 e0 06	 shl	 eax, 6
  007a8	f3 0f 10 85 c4
	fe ff ff	 movss	 xmm0, DWORD PTR _width$3[ebp]
  007b0	f3 0f 5e 05 00
	00 00 00	 divss	 xmm0, DWORD PTR __real@40000000
  007b8	f3 0f 58 80 10
	00 00 00	 addss	 xmm0, DWORD PTR ?transformed_3d_points@@3PAUVERTEX@@A[eax+16]
  007c0	b9 40 00 00 00	 mov	 ecx, 64			; 00000040H
  007c5	d1 e1		 shl	 ecx, 1
  007c7	f3 0f 11 84 0d
	d8 fe ff ff	 movss	 DWORD PTR _snow_quad$4[ebp+ecx+16], xmm0

; 964  : 				snow_quad[2].j = transformed_3d_points[count].j + ( height / 2 );

  007d0	8b 45 f8	 mov	 eax, DWORD PTR _count$[ebp]
  007d3	c1 e0 06	 shl	 eax, 6
  007d6	f3 0f 10 85 c0
	fe ff ff	 movss	 xmm0, DWORD PTR _height$2[ebp]
  007de	f3 0f 5e 05 00
	00 00 00	 divss	 xmm0, DWORD PTR __real@40000000
  007e6	f3 0f 58 80 14
	00 00 00	 addss	 xmm0, DWORD PTR ?transformed_3d_points@@3PAUVERTEX@@A[eax+20]
  007ee	b9 40 00 00 00	 mov	 ecx, 64			; 00000040H
  007f3	d1 e1		 shl	 ecx, 1
  007f5	f3 0f 11 84 0d
	dc fe ff ff	 movss	 DWORD PTR _snow_quad$4[ebp+ecx+20], xmm0

; 965  : 				snow_quad[2].u = 1;

  007fe	b8 40 00 00 00	 mov	 eax, 64			; 00000040H
  00803	d1 e0		 shl	 eax, 1
  00805	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@3f800000
  0080d	f3 0f 11 84 05
	e0 fe ff ff	 movss	 DWORD PTR _snow_quad$4[ebp+eax+24], xmm0

; 966  : 				snow_quad[2].v = 1;

  00816	b8 40 00 00 00	 mov	 eax, 64			; 00000040H
  0081b	d1 e0		 shl	 eax, 1
  0081d	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@3f800000
  00825	f3 0f 11 84 05
	e4 fe ff ff	 movss	 DWORD PTR _snow_quad$4[ebp+eax+28], xmm0

; 967  : 				snow_quad[2].outcode = generate_3d_outcode ( snow_quad[2].i, snow_quad[2].j );

  0082e	b8 40 00 00 00	 mov	 eax, 64			; 00000040H
  00833	d1 e0		 shl	 eax, 1
  00835	51		 push	 ecx
  00836	f3 0f 10 84 05
	dc fe ff ff	 movss	 xmm0, DWORD PTR _snow_quad$4[ebp+eax+20]
  0083f	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00844	b9 40 00 00 00	 mov	 ecx, 64			; 00000040H
  00849	d1 e1		 shl	 ecx, 1
  0084b	51		 push	 ecx
  0084c	f3 0f 10 84 0d
	d8 fe ff ff	 movss	 xmm0, DWORD PTR _snow_quad$4[ebp+ecx+16]
  00855	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0085a	e8 00 00 00 00	 call	 ?generate_3d_outcode@@YGHMM@Z ; generate_3d_outcode
  0085f	ba 40 00 00 00	 mov	 edx, 64			; 00000040H
  00864	d1 e2		 shl	 edx, 1
  00866	88 84 15 f4 fe
	ff ff		 mov	 BYTE PTR _snow_quad$4[ebp+edx+44], al

; 968  : 				snow_quad[2].next_vertex = &snow_quad[3];

  0086d	b8 40 00 00 00	 mov	 eax, 64			; 00000040H
  00872	6b c8 03	 imul	 ecx, eax, 3
  00875	8d 94 0d c8 fe
	ff ff		 lea	 edx, DWORD PTR _snow_quad$4[ebp+ecx]
  0087c	b8 40 00 00 00	 mov	 eax, 64			; 00000040H
  00881	d1 e0		 shl	 eax, 1
  00883	89 94 05 f0 fe
	ff ff		 mov	 DWORD PTR _snow_quad$4[ebp+eax+40], edx

; 969  : 
; 970  : 				snow_quad[3].q = transformed_3d_points[count].q;

  0088a	8b 45 f8	 mov	 eax, DWORD PTR _count$[ebp]
  0088d	c1 e0 06	 shl	 eax, 6
  00890	b9 40 00 00 00	 mov	 ecx, 64			; 00000040H
  00895	6b d1 03	 imul	 edx, ecx, 3
  00898	8b 80 0c 00 00
	00		 mov	 eax, DWORD PTR ?transformed_3d_points@@3PAUVERTEX@@A[eax+12]
  0089e	89 84 15 d4 fe
	ff ff		 mov	 DWORD PTR _snow_quad$4[ebp+edx+12], eax

; 971  : 				snow_quad[3].i = transformed_3d_points[count].i - ( width / 2 );

  008a5	8b 45 f8	 mov	 eax, DWORD PTR _count$[ebp]
  008a8	c1 e0 06	 shl	 eax, 6
  008ab	f3 0f 10 85 c4
	fe ff ff	 movss	 xmm0, DWORD PTR _width$3[ebp]
  008b3	f3 0f 5e 05 00
	00 00 00	 divss	 xmm0, DWORD PTR __real@40000000
  008bb	f3 0f 10 88 10
	00 00 00	 movss	 xmm1, DWORD PTR ?transformed_3d_points@@3PAUVERTEX@@A[eax+16]
  008c3	f3 0f 5c c8	 subss	 xmm1, xmm0
  008c7	b9 40 00 00 00	 mov	 ecx, 64			; 00000040H
  008cc	6b d1 03	 imul	 edx, ecx, 3
  008cf	f3 0f 11 8c 15
	d8 fe ff ff	 movss	 DWORD PTR _snow_quad$4[ebp+edx+16], xmm1

; 972  : 				snow_quad[3].j = transformed_3d_points[count].j + ( height / 2 );

  008d8	8b 45 f8	 mov	 eax, DWORD PTR _count$[ebp]
  008db	c1 e0 06	 shl	 eax, 6
  008de	f3 0f 10 85 c0
	fe ff ff	 movss	 xmm0, DWORD PTR _height$2[ebp]
  008e6	f3 0f 5e 05 00
	00 00 00	 divss	 xmm0, DWORD PTR __real@40000000
  008ee	f3 0f 58 80 14
	00 00 00	 addss	 xmm0, DWORD PTR ?transformed_3d_points@@3PAUVERTEX@@A[eax+20]
  008f6	b9 40 00 00 00	 mov	 ecx, 64			; 00000040H
  008fb	6b d1 03	 imul	 edx, ecx, 3
  008fe	f3 0f 11 84 15
	dc fe ff ff	 movss	 DWORD PTR _snow_quad$4[ebp+edx+20], xmm0

; 973  : 				snow_quad[3].u = 0;

  00907	b8 40 00 00 00	 mov	 eax, 64			; 00000040H
  0090c	6b c8 03	 imul	 ecx, eax, 3
  0090f	0f 57 c0	 xorps	 xmm0, xmm0
  00912	f3 0f 11 84 0d
	e0 fe ff ff	 movss	 DWORD PTR _snow_quad$4[ebp+ecx+24], xmm0

; 974  : 				snow_quad[3].v = 1;

  0091b	b8 40 00 00 00	 mov	 eax, 64			; 00000040H
  00920	6b c8 03	 imul	 ecx, eax, 3
  00923	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@3f800000
  0092b	f3 0f 11 84 0d
	e4 fe ff ff	 movss	 DWORD PTR _snow_quad$4[ebp+ecx+28], xmm0

; 975  : 				snow_quad[3].outcode = generate_3d_outcode ( snow_quad[3].i, snow_quad[3].j );

  00934	b8 40 00 00 00	 mov	 eax, 64			; 00000040H
  00939	6b c8 03	 imul	 ecx, eax, 3
  0093c	51		 push	 ecx
  0093d	f3 0f 10 84 0d
	dc fe ff ff	 movss	 xmm0, DWORD PTR _snow_quad$4[ebp+ecx+20]
  00946	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0094b	ba 40 00 00 00	 mov	 edx, 64			; 00000040H
  00950	6b c2 03	 imul	 eax, edx, 3
  00953	51		 push	 ecx
  00954	f3 0f 10 84 05
	d8 fe ff ff	 movss	 xmm0, DWORD PTR _snow_quad$4[ebp+eax+16]
  0095d	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00962	e8 00 00 00 00	 call	 ?generate_3d_outcode@@YGHMM@Z ; generate_3d_outcode
  00967	b9 40 00 00 00	 mov	 ecx, 64			; 00000040H
  0096c	6b d1 03	 imul	 edx, ecx, 3
  0096f	88 84 15 f4 fe
	ff ff		 mov	 BYTE PTR _snow_quad$4[ebp+edx+44], al

; 976  : 				snow_quad[3].next_vertex = NULL;

  00976	b8 40 00 00 00	 mov	 eax, 64			; 00000040H
  0097b	6b c8 03	 imul	 ecx, eax, 3
  0097e	c7 84 0d f0 fe
	ff ff 00 00 00
	00		 mov	 DWORD PTR _snow_quad$4[ebp+ecx+40], 0

; 977  : 
; 978  : 				outcode = snow_quad[0].outcode;

  00989	b8 40 00 00 00	 mov	 eax, 64			; 00000040H
  0098e	6b c8 00	 imul	 ecx, eax, 0
  00991	0f b6 94 0d f4
	fe ff ff	 movzx	 edx, BYTE PTR _snow_quad$4[ebp+ecx+44]
  00999	89 95 bc fe ff
	ff		 mov	 DWORD PTR _outcode$1[ebp], edx

; 979  : 				outcode |= snow_quad[1].outcode;

  0099f	b8 40 00 00 00	 mov	 eax, 64			; 00000040H
  009a4	c1 e0 00	 shl	 eax, 0
  009a7	0f b6 8c 05 f4
	fe ff ff	 movzx	 ecx, BYTE PTR _snow_quad$4[ebp+eax+44]
  009af	0b 8d bc fe ff
	ff		 or	 ecx, DWORD PTR _outcode$1[ebp]
  009b5	89 8d bc fe ff
	ff		 mov	 DWORD PTR _outcode$1[ebp], ecx

; 980  : 				outcode |= snow_quad[2].outcode;

  009bb	b8 40 00 00 00	 mov	 eax, 64			; 00000040H
  009c0	d1 e0		 shl	 eax, 1
  009c2	0f b6 8c 05 f4
	fe ff ff	 movzx	 ecx, BYTE PTR _snow_quad$4[ebp+eax+44]
  009ca	0b 8d bc fe ff
	ff		 or	 ecx, DWORD PTR _outcode$1[ebp]
  009d0	89 8d bc fe ff
	ff		 mov	 DWORD PTR _outcode$1[ebp], ecx

; 981  : 				outcode |= snow_quad[3].outcode;

  009d6	b8 40 00 00 00	 mov	 eax, 64			; 00000040H
  009db	6b c8 03	 imul	 ecx, eax, 3
  009de	0f b6 94 0d f4
	fe ff ff	 movzx	 edx, BYTE PTR _snow_quad$4[ebp+ecx+44]
  009e6	0b 95 bc fe ff
	ff		 or	 edx, DWORD PTR _outcode$1[ebp]
  009ec	89 95 bc fe ff
	ff		 mov	 DWORD PTR _outcode$1[ebp], edx

; 982  : 
; 983  : 				poly = snow_quad;

  009f2	8d 85 c8 fe ff
	ff		 lea	 eax, DWORD PTR _snow_quad$4[ebp]
  009f8	89 45 c8	 mov	 DWORD PTR _poly$5[ebp], eax

; 984  : 
; 985  : 				if ( outcode )

  009fb	83 bd bc fe ff
	ff 00		 cmp	 DWORD PTR _outcode$1[ebp], 0
  00a02	74 1d		 je	 SHORT $LN16@draw_3d_ra

; 986  : 				{
; 987  : 
; 988  : 					clip_3d_coord = 0;

  00a04	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?clip_3d_coord@@3HA, 0 ; clip_3d_coord

; 989  : 
; 990  : 					poly = clip_3d_polygon ( poly, outcode );

  00a0e	8b 85 bc fe ff
	ff		 mov	 eax, DWORD PTR _outcode$1[ebp]
  00a14	50		 push	 eax
  00a15	8b 4d c8	 mov	 ecx, DWORD PTR _poly$5[ebp]
  00a18	51		 push	 ecx
  00a19	e8 00 00 00 00	 call	 ?clip_3d_polygon@@YGPAUVERTEX@@PAU1@H@Z ; clip_3d_polygon
  00a1e	89 45 c8	 mov	 DWORD PTR _poly$5[ebp], eax
$LN16@draw_3d_ra:

; 991  : 				}
; 992  : 
; 993  : 				if ( poly )

  00a21	83 7d c8 00	 cmp	 DWORD PTR _poly$5[ebp], 0
  00a25	74 11		 je	 SHORT $LN17@draw_3d_ra

; 994  : 				{
; 995  : 
; 996  : 					draw_wbuffered_flat_shaded_textured_polygon ( poly, snow_colour, snow_specular );

  00a27	8b 45 d0	 mov	 eax, DWORD PTR _snow_specular$7[ebp]
  00a2a	50		 push	 eax
  00a2b	8b 4d cc	 mov	 ecx, DWORD PTR _snow_colour$6[ebp]
  00a2e	51		 push	 ecx
  00a2f	8b 55 c8	 mov	 edx, DWORD PTR _poly$5[ebp]
  00a32	52		 push	 edx
  00a33	e8 00 00 00 00	 call	 ?draw_wbuffered_flat_shaded_textured_polygon@@YGXPAUVERTEX@@UREAL_COLOUR@@1@Z ; draw_wbuffered_flat_shaded_textured_polygon
$LN17@draw_3d_ra:

; 997  : 				}
; 998  : 			}
; 999  : 		}

  00a38	e9 bd fa ff ff	 jmp	 $LN5@draw_3d_ra
$LN6@draw_3d_ra:

; 1000 : 
; 1001 : 		set_d3d_alpha_fog_zbuffer ( FALSE, TRUE, TRUE, TRUE );

  00a3d	6a 01		 push	 1
  00a3f	6a 01		 push	 1
  00a41	6a 01		 push	 1
  00a43	6a 00		 push	 0
  00a45	e8 00 00 00 00	 call	 ?set_d3d_alpha_fog_zbuffer@@YGXHHHH@Z ; set_d3d_alpha_fog_zbuffer
$LN14@draw_3d_ra:

; 1002 : 	}
; 1003 : }

  00a4a	5f		 pop	 edi
  00a4b	5e		 pop	 esi
  00a4c	5b		 pop	 ebx
  00a4d	8b e5		 mov	 esp, ebp
  00a4f	5d		 pop	 ebp
  00a50	c3		 ret	 0
?draw_3d_rain@@YGXXZ ENDP				; draw_3d_rain
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3drain.c
;	COMDAT ?update_3d_rain@@YGXPAUENV_3D@@MQAY02M@Z
_TEXT	SEGMENT
tv767 = -248						; size = 4
tv232 = -248						; size = 4
_creation_distance$1 = -180				; size = 4
_z$2 = -176						; size = 4
_y$3 = -172						; size = 4
_x$4 = -168						; size = 4
_creation_distance$5 = -164				; size = 4
_z$6 = -160						; size = 4
_y$7 = -156						; size = 4
_x$8 = -152						; size = 4
_relative_speed$9 = -148				; size = 4
_rel$10 = -144						; size = 12
_snow_noise$11 = -132					; size = 12
_rel$12 = -120						; size = 12
_creation_vector$ = -108				; size = 12
_rain_streak_displacement$ = -96			; size = 12
_snow_drift_displacement$ = -84				; size = 12
_rain_displacement$ = -72				; size = 12
_distance_moved$ = -60					; size = 12
_weather_t$ = -48					; size = 4
_snow_fall_displacement$ = -44				; size = 4
_snow_displacement_magnitude$ = -40			; size = 4
_displacement_magnitude$ = -36				; size = 4
_count$ = -32						; size = 4
_creation_allowed$ = -28				; size = 4
_total_snowdrop_number$ = -24				; size = 4
_end_snowdrop_number$ = -20				; size = 4
_start_snowdrop_number$ = -16				; size = 4
_total_raindrop_number$ = -12				; size = 4
_end_raindrop_number$ = -8				; size = 4
_start_raindrop_number$ = -4				; size = 4
_env$ = 8						; size = 4
_time$ = 12						; size = 4
_view_attitude$ = 16					; size = 4
?update_3d_rain@@YGXPAUENV_3D@@MQAY02M@Z PROC		; update_3d_rain, COMDAT

; 260  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec f8 00 00
	00		 sub	 esp, 248		; 000000f8H
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi

; 261  : 
; 262  : 	int
; 263  : 		start_raindrop_number,
; 264  : 		end_raindrop_number,
; 265  : 		total_raindrop_number,
; 266  : 
; 267  : 		start_snowdrop_number,
; 268  : 		end_snowdrop_number,
; 269  : 		total_snowdrop_number,
; 270  : 
; 271  : 		creation_allowed,
; 272  : 		count;
; 273  : 
; 274  : 	float
; 275  : 		displacement_magnitude,
; 276  : 		snow_displacement_magnitude,
; 277  : 		snow_fall_displacement,
; 278  : 		weather_t;
; 279  : 
; 280  : 	vec3d
; 281  : 		distance_moved,
; 282  : 		rain_displacement,
; 283  : 		snow_drift_displacement,
; 284  : 		rain_streak_displacement,
; 285  : 		creation_vector;
; 286  : 
; 287  : 	//
; 288  : 	// Calculate how many rain drops we should have. This is a linear scale, from 0, to TOTAL_3D_RAINDROPS.
; 289  : 	//  DRY = 0
; 290  : 	//  LIGHT_RAIN = TOTAL_3D_RAINDROPS / 2
; 291  : 	//  HEAVY_RAIN = TOTAL_3D_RAINDROPS
; 292  : 	//
; 293  : 
; 294  : 	if ( visual_3d_vp )

  0000c	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A, 0 ; visual_3d_vp
  00013	74 30		 je	 SHORT $LN10@update_3d_

; 295  : 	{
; 296  : 	
; 297  : 		if ( visual_3d_vp->position.y > get_cloud_3d_base_height () )

  00015	e8 00 00 00 00	 call	 ?get_cloud_3d_base_height@@YGMXZ ; get_cloud_3d_base_height
  0001a	d9 9d 08 ff ff
	ff		 fstp	 DWORD PTR tv767[ebp]
  00020	a1 00 00 00 00	 mov	 eax, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  00025	f3 0f 10 40 04	 movss	 xmm0, DWORD PTR [eax+4]
  0002a	0f 2f 85 08 ff
	ff ff		 comiss	 xmm0, DWORD PTR tv767[ebp]
  00031	76 09		 jbe	 SHORT $LN12@update_3d_

; 298  : 		{
; 299  : 	
; 300  : 			creation_allowed = FALSE;

  00033	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _creation_allowed$[ebp], 0

; 301  : 		}
; 302  : 		else

  0003a	eb 07		 jmp	 SHORT $LN13@update_3d_
$LN12@update_3d_:

; 303  : 		{
; 304  : 	
; 305  : 			creation_allowed = TRUE;

  0003c	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _creation_allowed$[ebp], 1
$LN13@update_3d_:

; 306  : 		}
; 307  : 	}
; 308  : 	else

  00043	eb 07		 jmp	 SHORT $LN11@update_3d_
$LN10@update_3d_:

; 309  : 	{
; 310  : 
; 311  : 		creation_allowed = FALSE;

  00045	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _creation_allowed$[ebp], 0
$LN11@update_3d_:

; 312  : 	}
; 313  : 
; 314  : 	start_raindrop_number = number_of_weather_particles_allowed[env->weathermode].number_of_raindrops;

  0004c	8b 45 08	 mov	 eax, DWORD PTR _env$[ebp]
  0004f	8b 88 d4 02 00
	00		 mov	 ecx, DWORD PTR [eax+724]
  00055	8b 14 cd 00 00
	00 00		 mov	 edx, DWORD PTR ?number_of_weather_particles_allowed@@3PAURAINDROP_SETTINGS@@A[ecx*8]
  0005c	89 55 fc	 mov	 DWORD PTR _start_raindrop_number$[ebp], edx

; 315  : 	start_snowdrop_number = number_of_weather_particles_allowed[env->weathermode].number_of_snowdrops;

  0005f	8b 45 08	 mov	 eax, DWORD PTR _env$[ebp]
  00062	8b 88 d4 02 00
	00		 mov	 ecx, DWORD PTR [eax+724]
  00068	8b 14 cd 04 00
	00 00		 mov	 edx, DWORD PTR ?number_of_weather_particles_allowed@@3PAURAINDROP_SETTINGS@@A[ecx*8+4]
  0006f	89 55 f0	 mov	 DWORD PTR _start_snowdrop_number$[ebp], edx

; 316  : 
; 317  : 	end_raindrop_number = number_of_weather_particles_allowed[env->target_weathermode].number_of_raindrops;

  00072	8b 45 08	 mov	 eax, DWORD PTR _env$[ebp]
  00075	8b 88 d8 02 00
	00		 mov	 ecx, DWORD PTR [eax+728]
  0007b	8b 14 cd 00 00
	00 00		 mov	 edx, DWORD PTR ?number_of_weather_particles_allowed@@3PAURAINDROP_SETTINGS@@A[ecx*8]
  00082	89 55 f8	 mov	 DWORD PTR _end_raindrop_number$[ebp], edx

; 318  : 	end_snowdrop_number = number_of_weather_particles_allowed[env->target_weathermode].number_of_snowdrops;

  00085	8b 45 08	 mov	 eax, DWORD PTR _env$[ebp]
  00088	8b 88 d8 02 00
	00		 mov	 ecx, DWORD PTR [eax+728]
  0008e	8b 14 cd 04 00
	00 00		 mov	 edx, DWORD PTR ?number_of_weather_particles_allowed@@3PAURAINDROP_SETTINGS@@A[ecx*8+4]
  00095	89 55 ec	 mov	 DWORD PTR _end_snowdrop_number$[ebp], edx

; 319  : 
; 320  : 	weather_t = env->weather_targetdistance;

  00098	8b 45 08	 mov	 eax, DWORD PTR _env$[ebp]
  0009b	f3 0f 10 80 dc
	02 00 00	 movss	 xmm0, DWORD PTR [eax+732]
  000a3	f3 0f 11 45 d0	 movss	 DWORD PTR _weather_t$[ebp], xmm0

; 321  : 
; 322  : 	if ( weather_t == 0 )

  000a8	f3 0f 10 45 d0	 movss	 xmm0, DWORD PTR _weather_t$[ebp]
  000ad	0f 2e 05 00 00
	00 00		 ucomiss xmm0, DWORD PTR __real@00000000
  000b4	9f		 lahf
  000b5	f6 c4 44	 test	 ah, 68			; 00000044H
  000b8	7a 0e		 jp	 SHORT $LN14@update_3d_

; 323  : 	{
; 324  : 
; 325  : 		total_raindrop_number = start_raindrop_number;

  000ba	8b 45 fc	 mov	 eax, DWORD PTR _start_raindrop_number$[ebp]
  000bd	89 45 f4	 mov	 DWORD PTR _total_raindrop_number$[ebp], eax

; 326  : 		total_snowdrop_number = start_snowdrop_number;

  000c0	8b 45 f0	 mov	 eax, DWORD PTR _start_snowdrop_number$[ebp]
  000c3	89 45 e8	 mov	 DWORD PTR _total_snowdrop_number$[ebp], eax
  000c6	eb 5e		 jmp	 SHORT $LN17@update_3d_
$LN14@update_3d_:

; 327  : 	}
; 328  : 	else if ( weather_t == 1 )

  000c8	f3 0f 10 45 d0	 movss	 xmm0, DWORD PTR _weather_t$[ebp]
  000cd	0f 2e 05 00 00
	00 00		 ucomiss xmm0, DWORD PTR __real@3f800000
  000d4	9f		 lahf
  000d5	f6 c4 44	 test	 ah, 68			; 00000044H
  000d8	7a 0e		 jp	 SHORT $LN16@update_3d_

; 329  : 	{
; 330  : 
; 331  : 		total_raindrop_number = end_raindrop_number;

  000da	8b 45 f8	 mov	 eax, DWORD PTR _end_raindrop_number$[ebp]
  000dd	89 45 f4	 mov	 DWORD PTR _total_raindrop_number$[ebp], eax

; 332  : 		total_snowdrop_number = end_snowdrop_number;

  000e0	8b 45 ec	 mov	 eax, DWORD PTR _end_snowdrop_number$[ebp]
  000e3	89 45 e8	 mov	 DWORD PTR _total_snowdrop_number$[ebp], eax

; 333  : 	}
; 334  : 	else

  000e6	eb 3e		 jmp	 SHORT $LN17@update_3d_
$LN16@update_3d_:

; 335  : 	{
; 336  : 
; 337  : 		total_raindrop_number = start_raindrop_number + ( ( ( float ) ( end_raindrop_number - start_raindrop_number ) ) * weather_t );

  000e8	f3 0f 2a 45 fc	 cvtsi2ss xmm0, DWORD PTR _start_raindrop_number$[ebp]
  000ed	8b 45 f8	 mov	 eax, DWORD PTR _end_raindrop_number$[ebp]
  000f0	2b 45 fc	 sub	 eax, DWORD PTR _start_raindrop_number$[ebp]
  000f3	f3 0f 2a c8	 cvtsi2ss xmm1, eax
  000f7	f3 0f 59 4d d0	 mulss	 xmm1, DWORD PTR _weather_t$[ebp]
  000fc	f3 0f 58 c1	 addss	 xmm0, xmm1
  00100	f3 0f 2c c8	 cvttss2si ecx, xmm0
  00104	89 4d f4	 mov	 DWORD PTR _total_raindrop_number$[ebp], ecx

; 338  : 		total_snowdrop_number = start_snowdrop_number + ( ( ( float ) ( end_snowdrop_number - start_snowdrop_number ) ) * weather_t );

  00107	f3 0f 2a 45 f0	 cvtsi2ss xmm0, DWORD PTR _start_snowdrop_number$[ebp]
  0010c	8b 45 ec	 mov	 eax, DWORD PTR _end_snowdrop_number$[ebp]
  0010f	2b 45 f0	 sub	 eax, DWORD PTR _start_snowdrop_number$[ebp]
  00112	f3 0f 2a c8	 cvtsi2ss xmm1, eax
  00116	f3 0f 59 4d d0	 mulss	 xmm1, DWORD PTR _weather_t$[ebp]
  0011b	f3 0f 58 c1	 addss	 xmm0, xmm1
  0011f	f3 0f 2c c8	 cvttss2si ecx, xmm0
  00123	89 4d e8	 mov	 DWORD PTR _total_snowdrop_number$[ebp], ecx
$LN17@update_3d_:

; 339  : 	}
; 340  : 
; 341  : 	//
; 342  : 	// Special snow flag stuff
; 343  : 	//
; 344  : 
; 345  : 	if ( special_snow_flag )
; 346  : 	{
; 347  : /*
; 348  : 		if ( visual_3d_vp )
; 349  : 		{
; 350  : 
; 351  : 			int
; 352  : 				x,
; 353  : 				z;
; 354  : 
; 355  : 			int
; 356  : 				near_snow;
; 357  : 
; 358  : 			float
; 359  : 				old_rain_total;
; 360  : 
; 361  : 			near_snow = FALSE;
; 362  : 
; 363  : 			for ( z = -1; z <= 1; z++ )
; 364  : 			{
; 365  : 	
; 366  : 				for ( x = -1; x <= 1; x++ )
; 367  : 				{
; 368  : 
; 369  : 					float
; 370  : 						x_pos,
; 371  : 						z_pos;
; 372  : 
; 373  : 					x_pos = visual_3d_vp->x + x * TERRAIN_3D_SECTOR_SIDE_LENGTH;
; 374  : 					z_pos = visual_3d_vp->z + z * TERRAIN_3D_SECTOR_SIDE_LENGTH;
; 375  : 
; 376  : 					x_pos = bound ( x_pos, terrain_3d_min_map_x, terrain_3d_max_map_x );
; 377  : 					z_pos = bound ( z_pos, terrain_3d_min_map_z, terrain_3d_max_map_z );
; 378  : 
; 379  : 					get_terrain_3d_types_in_sector ( x_pos, z_pos );
; 380  : 
; 381  : 					if ( terrain_types_in_sector[TERRAIN_TYPE_ALTERED_LAND3] )
; 382  : 					{
; 383  : 
; 384  : 						near_snow = TRUE;
; 385  : 					}
; 386  : 				}
; 387  : 			}
; 388  : 
; 389  : 			if ( near_snow )
; 390  : 			{
; 391  : 	
; 392  : 				old_rain_total = total_raindrop_number;
; 393  : 	
; 394  : 				total_raindrop_number = old_rain_total * 0.0;
; 395  : 				total_snowdrop_number = old_rain_total * 1.0;
; 396  : 			}
; 397  : 		}
; 398  : 		*/
; 399  : 	}
; 400  : 
; 401  : 	//
; 402  : 	//
; 403  : 	//
; 404  : 
; 405  : 	rain_3d_delta_time = time - time_rain_last_updated;

  00126	f3 0f 10 45 0c	 movss	 xmm0, DWORD PTR _time$[ebp]
  0012b	f3 0f 5c 05 00
	00 00 00	 subss	 xmm0, DWORD PTR ?time_rain_last_updated@@3MA
  00133	f3 0f 11 05 00
	00 00 00	 movss	 DWORD PTR ?rain_3d_delta_time@@3MA, xmm0

; 406  : 
; 407  : 	time_rain_last_updated = time;

  0013b	f3 0f 10 45 0c	 movss	 xmm0, DWORD PTR _time$[ebp]
  00140	f3 0f 11 05 00
	00 00 00	 movss	 DWORD PTR ?time_rain_last_updated@@3MA, xmm0

; 408  : 
; 409  : 	//
; 410  : 	// Calculate the distance moved by each raindrop.
; 411  : 	//
; 412  : 
; 413  : 	distance_moved.x = rain_3d_wind_direction.x * rain_3d_wind_speed * rain_3d_delta_time;

  00148	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_wind_direction@@3UVEC3D@@A
  00150	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?rain_3d_wind_speed@@3MA
  00158	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?rain_3d_delta_time@@3MA
  00160	f3 0f 11 45 c4	 movss	 DWORD PTR _distance_moved$[ebp], xmm0

; 414  : 	distance_moved.y = rain_3d_wind_direction.y * rain_3d_wind_speed * rain_3d_delta_time;

  00165	f3 0f 10 05 04
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_wind_direction@@3UVEC3D@@A+4
  0016d	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?rain_3d_wind_speed@@3MA
  00175	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?rain_3d_delta_time@@3MA
  0017d	f3 0f 11 45 c8	 movss	 DWORD PTR _distance_moved$[ebp+4], xmm0

; 415  : 	distance_moved.z = rain_3d_wind_direction.z * rain_3d_wind_speed * rain_3d_delta_time;

  00182	f3 0f 10 05 08
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_wind_direction@@3UVEC3D@@A+8
  0018a	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?rain_3d_wind_speed@@3MA
  00192	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?rain_3d_delta_time@@3MA
  0019a	f3 0f 11 45 cc	 movss	 DWORD PTR _distance_moved$[ebp+8], xmm0

; 416  : 
; 417  : 	rain_displacement.x = distance_moved.x;

  0019f	f3 0f 10 45 c4	 movss	 xmm0, DWORD PTR _distance_moved$[ebp]
  001a4	f3 0f 11 45 b8	 movss	 DWORD PTR _rain_displacement$[ebp], xmm0

; 418  : 	rain_displacement.y = distance_moved.y + ( rain_3d_speed * rain_3d_delta_time );

  001a9	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_speed@@3MA
  001b1	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?rain_3d_delta_time@@3MA
  001b9	f3 0f 58 45 c8	 addss	 xmm0, DWORD PTR _distance_moved$[ebp+4]
  001be	f3 0f 11 45 bc	 movss	 DWORD PTR _rain_displacement$[ebp+4], xmm0

; 419  : 	rain_displacement.z = distance_moved.z;

  001c3	f3 0f 10 45 cc	 movss	 xmm0, DWORD PTR _distance_moved$[ebp+8]
  001c8	f3 0f 11 45 c0	 movss	 DWORD PTR _rain_displacement$[ebp+8], xmm0

; 420  : 
; 421  : 	//
; 422  : 	// Calculate the distance moved by each snowdrop.
; 423  : 	//
; 424  : 
; 425  : 	snow_drift_displacement.x = distance_moved.x;

  001cd	f3 0f 10 45 c4	 movss	 xmm0, DWORD PTR _distance_moved$[ebp]
  001d2	f3 0f 11 45 ac	 movss	 DWORD PTR _snow_drift_displacement$[ebp], xmm0

; 426  : 	snow_drift_displacement.y = distance_moved.y;

  001d7	f3 0f 10 45 c8	 movss	 xmm0, DWORD PTR _distance_moved$[ebp+4]
  001dc	f3 0f 11 45 b0	 movss	 DWORD PTR _snow_drift_displacement$[ebp+4], xmm0

; 427  : 	snow_drift_displacement.z = distance_moved.z;

  001e1	f3 0f 10 45 cc	 movss	 xmm0, DWORD PTR _distance_moved$[ebp+8]
  001e6	f3 0f 11 45 b4	 movss	 DWORD PTR _snow_drift_displacement$[ebp+8], xmm0

; 428  : 
; 429  : 	snow_fall_displacement = ( rain_3d_speed / 4 ) * rain_3d_delta_time;

  001eb	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_speed@@3MA
  001f3	f3 0f 5e 05 00
	00 00 00	 divss	 xmm0, DWORD PTR __real@40800000
  001fb	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?rain_3d_delta_time@@3MA
  00203	f3 0f 11 45 d4	 movss	 DWORD PTR _snow_fall_displacement$[ebp], xmm0

; 430  : 
; 431  : 	snow_displacement_magnitude = get_3d_vector_magnitude ( &snow_drift_displacement );

  00208	8d 45 ac	 lea	 eax, DWORD PTR _snow_drift_displacement$[ebp]
  0020b	50		 push	 eax
  0020c	e8 00 00 00 00	 call	 ?get_3d_vector_magnitude@@YGMPBUVEC3D@@@Z ; get_3d_vector_magnitude
  00211	d9 5d d8	 fstp	 DWORD PTR _snow_displacement_magnitude$[ebp]

; 432  : 
; 433  : 	//
; 434  : 	// Calculate the 'streak' effect - this is now NOT framerate related
; 435  : 	//
; 436  : 
; 437  : 	rain_streak_displacement = rain_displacement;

  00214	8b 45 b8	 mov	 eax, DWORD PTR _rain_displacement$[ebp]
  00217	89 45 a0	 mov	 DWORD PTR _rain_streak_displacement$[ebp], eax
  0021a	8b 4d bc	 mov	 ecx, DWORD PTR _rain_displacement$[ebp+4]
  0021d	89 4d a4	 mov	 DWORD PTR _rain_streak_displacement$[ebp+4], ecx
  00220	8b 55 c0	 mov	 edx, DWORD PTR _rain_displacement$[ebp+8]
  00223	89 55 a8	 mov	 DWORD PTR _rain_streak_displacement$[ebp+8], edx

; 438  : 
; 439  : 	displacement_magnitude = get_3d_vector_magnitude ( &rain_streak_displacement );

  00226	8d 45 a0	 lea	 eax, DWORD PTR _rain_streak_displacement$[ebp]
  00229	50		 push	 eax
  0022a	e8 00 00 00 00	 call	 ?get_3d_vector_magnitude@@YGMPBUVEC3D@@@Z ; get_3d_vector_magnitude
  0022f	d9 5d dc	 fstp	 DWORD PTR _displacement_magnitude$[ebp]

; 440  : 
; 441  : 	if ( displacement_magnitude != 0 )

  00232	f3 0f 10 45 dc	 movss	 xmm0, DWORD PTR _displacement_magnitude$[ebp]
  00237	0f 2e 05 00 00
	00 00		 ucomiss xmm0, DWORD PTR __real@00000000
  0023e	9f		 lahf
  0023f	f6 c4 44	 test	 ah, 68			; 00000044H
  00242	7b 4c		 jnp	 SHORT $LN19@update_3d_

; 442  : 	{
; 443  : 
; 444  : 		displacement_magnitude = 1.5 / displacement_magnitude;

  00244	f3 0f 5a 45 dc	 cvtss2sd xmm0, DWORD PTR _displacement_magnitude$[ebp]
  00249	f2 0f 10 0d 00
	00 00 00	 movsd	 xmm1, QWORD PTR __real@3ff8000000000000
  00251	f2 0f 5e c8	 divsd	 xmm1, xmm0
  00255	f2 0f 5a c1	 cvtsd2ss xmm0, xmm1
  00259	f3 0f 11 45 dc	 movss	 DWORD PTR _displacement_magnitude$[ebp], xmm0

; 445  : 
; 446  : 		rain_streak_displacement.x *= displacement_magnitude;

  0025e	f3 0f 10 45 a0	 movss	 xmm0, DWORD PTR _rain_streak_displacement$[ebp]
  00263	f3 0f 59 45 dc	 mulss	 xmm0, DWORD PTR _displacement_magnitude$[ebp]
  00268	f3 0f 11 45 a0	 movss	 DWORD PTR _rain_streak_displacement$[ebp], xmm0

; 447  : 		rain_streak_displacement.y *= displacement_magnitude;

  0026d	f3 0f 10 45 a4	 movss	 xmm0, DWORD PTR _rain_streak_displacement$[ebp+4]
  00272	f3 0f 59 45 dc	 mulss	 xmm0, DWORD PTR _displacement_magnitude$[ebp]
  00277	f3 0f 11 45 a4	 movss	 DWORD PTR _rain_streak_displacement$[ebp+4], xmm0

; 448  : 		rain_streak_displacement.z *= displacement_magnitude;

  0027c	f3 0f 10 45 a8	 movss	 xmm0, DWORD PTR _rain_streak_displacement$[ebp+8]
  00281	f3 0f 59 45 dc	 mulss	 xmm0, DWORD PTR _displacement_magnitude$[ebp]
  00286	f3 0f 11 45 a8	 movss	 DWORD PTR _rain_streak_displacement$[ebp+8], xmm0

; 449  : 	}
; 450  : 	else

  0028b	e9 e8 00 00 00	 jmp	 $LN21@update_3d_
$LN19@update_3d_:

; 451  : 	{
; 452  : 
; 453  : 		//
; 454  : 		// Put artificial streaking in there ( game paused )
; 455  : 		//
; 456  : 
; 457  : 		rain_streak_displacement.x = rain_3d_wind_direction.x * rain_3d_wind_speed * 0.05;

  00290	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_wind_direction@@3UVEC3D@@A
  00298	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?rain_3d_wind_speed@@3MA
  002a0	f3 0f 5a c0	 cvtss2sd xmm0, xmm0
  002a4	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3fa999999999999a
  002ac	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  002b0	f3 0f 11 45 a0	 movss	 DWORD PTR _rain_streak_displacement$[ebp], xmm0

; 458  : 		rain_streak_displacement.y = rain_3d_wind_direction.y * rain_3d_wind_speed * 0.05 + ( rain_3d_speed * 0.05 );

  002b5	f3 0f 10 05 04
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_wind_direction@@3UVEC3D@@A+4
  002bd	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?rain_3d_wind_speed@@3MA
  002c5	f3 0f 5a c0	 cvtss2sd xmm0, xmm0
  002c9	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3fa999999999999a
  002d1	f3 0f 5a 0d 00
	00 00 00	 cvtss2sd xmm1, DWORD PTR ?rain_3d_speed@@3MA
  002d9	f2 0f 59 0d 00
	00 00 00	 mulsd	 xmm1, QWORD PTR __real@3fa999999999999a
  002e1	f2 0f 58 c1	 addsd	 xmm0, xmm1
  002e5	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  002e9	f3 0f 11 45 a4	 movss	 DWORD PTR _rain_streak_displacement$[ebp+4], xmm0

; 459  : 		rain_streak_displacement.z = rain_3d_wind_direction.z * rain_3d_wind_speed * 0.05;

  002ee	f3 0f 10 05 08
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_wind_direction@@3UVEC3D@@A+8
  002f6	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?rain_3d_wind_speed@@3MA
  002fe	f3 0f 5a c0	 cvtss2sd xmm0, xmm0
  00302	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3fa999999999999a
  0030a	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  0030e	f3 0f 11 45 a8	 movss	 DWORD PTR _rain_streak_displacement$[ebp+8], xmm0

; 460  : 	
; 461  : 		displacement_magnitude = get_3d_vector_magnitude ( &rain_streak_displacement );

  00313	8d 45 a0	 lea	 eax, DWORD PTR _rain_streak_displacement$[ebp]
  00316	50		 push	 eax
  00317	e8 00 00 00 00	 call	 ?get_3d_vector_magnitude@@YGMPBUVEC3D@@@Z ; get_3d_vector_magnitude
  0031c	d9 5d dc	 fstp	 DWORD PTR _displacement_magnitude$[ebp]

; 462  : 	
; 463  : 		if ( displacement_magnitude != 0 )

  0031f	f3 0f 10 45 dc	 movss	 xmm0, DWORD PTR _displacement_magnitude$[ebp]
  00324	0f 2e 05 00 00
	00 00		 ucomiss xmm0, DWORD PTR __real@00000000
  0032b	9f		 lahf
  0032c	f6 c4 44	 test	 ah, 68			; 00000044H
  0032f	7b 47		 jnp	 SHORT $LN21@update_3d_

; 464  : 		{
; 465  : 	
; 466  : 			displacement_magnitude = 1.5 / displacement_magnitude;

  00331	f3 0f 5a 45 dc	 cvtss2sd xmm0, DWORD PTR _displacement_magnitude$[ebp]
  00336	f2 0f 10 0d 00
	00 00 00	 movsd	 xmm1, QWORD PTR __real@3ff8000000000000
  0033e	f2 0f 5e c8	 divsd	 xmm1, xmm0
  00342	f2 0f 5a c1	 cvtsd2ss xmm0, xmm1
  00346	f3 0f 11 45 dc	 movss	 DWORD PTR _displacement_magnitude$[ebp], xmm0

; 467  : 	
; 468  : 			rain_streak_displacement.x *= displacement_magnitude;

  0034b	f3 0f 10 45 a0	 movss	 xmm0, DWORD PTR _rain_streak_displacement$[ebp]
  00350	f3 0f 59 45 dc	 mulss	 xmm0, DWORD PTR _displacement_magnitude$[ebp]
  00355	f3 0f 11 45 a0	 movss	 DWORD PTR _rain_streak_displacement$[ebp], xmm0

; 469  : 			rain_streak_displacement.y *= displacement_magnitude;

  0035a	f3 0f 10 45 a4	 movss	 xmm0, DWORD PTR _rain_streak_displacement$[ebp+4]
  0035f	f3 0f 59 45 dc	 mulss	 xmm0, DWORD PTR _displacement_magnitude$[ebp]
  00364	f3 0f 11 45 a4	 movss	 DWORD PTR _rain_streak_displacement$[ebp+4], xmm0

; 470  : 			rain_streak_displacement.z *= displacement_magnitude;

  00369	f3 0f 10 45 a8	 movss	 xmm0, DWORD PTR _rain_streak_displacement$[ebp+8]
  0036e	f3 0f 59 45 dc	 mulss	 xmm0, DWORD PTR _displacement_magnitude$[ebp]
  00373	f3 0f 11 45 a8	 movss	 DWORD PTR _rain_streak_displacement$[ebp+8], xmm0
$LN21@update_3d_:

; 471  : 		}
; 472  : 	}
; 473  : 
; 474  : 	//
; 475  : 	// Remove any raindrops that have strayed out of the area of effect
; 476  : 	//
; 477  : 
; 478  : 	creation_vector.x = rain_3d_wind_direction.x * rain_3d_wind_speed * 0.5;

  00378	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_wind_direction@@3UVEC3D@@A
  00380	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?rain_3d_wind_speed@@3MA
  00388	f3 0f 5a c0	 cvtss2sd xmm0, xmm0
  0038c	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3fe0000000000000
  00394	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00398	f3 0f 11 45 94	 movss	 DWORD PTR _creation_vector$[ebp], xmm0

; 479  : 	creation_vector.y = rain_3d_wind_direction.y * rain_3d_wind_speed * 0.5 + ( rain_3d_speed * 0.5 );

  0039d	f3 0f 10 05 04
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_wind_direction@@3UVEC3D@@A+4
  003a5	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?rain_3d_wind_speed@@3MA
  003ad	f3 0f 5a c0	 cvtss2sd xmm0, xmm0
  003b1	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3fe0000000000000
  003b9	f3 0f 5a 0d 00
	00 00 00	 cvtss2sd xmm1, DWORD PTR ?rain_3d_speed@@3MA
  003c1	f2 0f 59 0d 00
	00 00 00	 mulsd	 xmm1, QWORD PTR __real@3fe0000000000000
  003c9	f2 0f 58 c1	 addsd	 xmm0, xmm1
  003cd	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  003d1	f3 0f 11 45 98	 movss	 DWORD PTR _creation_vector$[ebp+4], xmm0

; 480  : 	creation_vector.z = rain_3d_wind_direction.z * rain_3d_wind_speed * 0.5;

  003d6	f3 0f 10 05 08
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_wind_direction@@3UVEC3D@@A+8
  003de	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?rain_3d_wind_speed@@3MA
  003e6	f3 0f 5a c0	 cvtss2sd xmm0, xmm0
  003ea	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3fe0000000000000
  003f2	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  003f6	f3 0f 11 45 9c	 movss	 DWORD PTR _creation_vector$[ebp+8], xmm0

; 481  : 
; 482  : 	normalise_any_3d_vector ( &creation_vector );

  003fb	8d 45 94	 lea	 eax, DWORD PTR _creation_vector$[ebp]
  003fe	50		 push	 eax
  003ff	e8 00 00 00 00	 call	 ?normalise_any_3d_vector@@YGMPAUVEC3D@@@Z ; normalise_any_3d_vector
  00404	dd d8		 fstp	 ST(0)

; 483  : 
; 484  : 	for ( count = 0; count < TOTAL_3D_RAINDROPS; count++ )

  00406	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  0040d	eb 09		 jmp	 SHORT $LN4@update_3d_
$LN2@update_3d_:
  0040f	8b 45 e0	 mov	 eax, DWORD PTR _count$[ebp]
  00412	83 c0 01	 add	 eax, 1
  00415	89 45 e0	 mov	 DWORD PTR _count$[ebp], eax
$LN4@update_3d_:
  00418	81 7d e0 00 08
	00 00		 cmp	 DWORD PTR _count$[ebp], 2048 ; 00000800H
  0041f	0f 8d 73 0b 00
	00		 jge	 $LN3@update_3d_

; 485  : 	{
; 486  : 
; 487  : 		switch ( rain_3d_drops[count].type )

  00425	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  00429	8b 88 18 00 00
	00		 mov	 ecx, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+24]
  0042f	89 8d 08 ff ff
	ff		 mov	 DWORD PTR tv232[ebp], ecx
  00435	83 bd 08 ff ff
	ff 01		 cmp	 DWORD PTR tv232[ebp], 1
  0043c	74 12		 je	 SHORT $LN22@update_3d_
  0043e	83 bd 08 ff ff
	ff 02		 cmp	 DWORD PTR tv232[ebp], 2
  00445	0f 84 23 01 00
	00		 je	 $LN25@update_3d_
  0044b	e9 88 03 00 00	 jmp	 $LN5@update_3d_
$LN22@update_3d_:

; 488  : 		{
; 489  : 
; 490  : 			case RAINDROP_RAIN:
; 491  : 			{
; 492  : 
; 493  : 				vec3d
; 494  : 					rel;
; 495  : 
; 496  : 				//
; 497  : 				// Update the rain position
; 498  : 				//
; 499  : 			
; 500  : 				rain_3d_drops[count].current_position.x -= rain_displacement.x;

  00450	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  00454	f3 0f 10 80 00
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax]
  0045c	f3 0f 5c 45 b8	 subss	 xmm0, DWORD PTR _rain_displacement$[ebp]
  00461	6b 4d e0 1c	 imul	 ecx, DWORD PTR _count$[ebp], 28
  00465	f3 0f 11 81 00
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[ecx], xmm0

; 501  : 				rain_3d_drops[count].current_position.y -= rain_displacement.y;

  0046d	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  00471	f3 0f 10 80 04
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+4]
  00479	f3 0f 5c 45 bc	 subss	 xmm0, DWORD PTR _rain_displacement$[ebp+4]
  0047e	6b 4d e0 1c	 imul	 ecx, DWORD PTR _count$[ebp], 28
  00482	f3 0f 11 81 04
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[ecx+4], xmm0

; 502  : 				rain_3d_drops[count].current_position.z -= rain_displacement.z;

  0048a	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  0048e	f3 0f 10 80 08
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+8]
  00496	f3 0f 5c 45 c0	 subss	 xmm0, DWORD PTR _rain_displacement$[ebp+8]
  0049b	6b 4d e0 1c	 imul	 ecx, DWORD PTR _count$[ebp], 28
  0049f	f3 0f 11 81 08
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[ecx+8], xmm0

; 503  : 
; 504  : 				rel.x = rain_3d_drops[count].current_position.x - visual_3d_vp->x;

  004a7	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  004ab	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  004b1	f3 0f 10 80 00
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax]
  004b9	f3 0f 5c 01	 subss	 xmm0, DWORD PTR [ecx]
  004bd	f3 0f 11 45 88	 movss	 DWORD PTR _rel$12[ebp], xmm0

; 505  : 				rel.y = rain_3d_drops[count].current_position.y - visual_3d_vp->y;

  004c2	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  004c6	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  004cc	f3 0f 10 80 04
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+4]
  004d4	f3 0f 5c 41 04	 subss	 xmm0, DWORD PTR [ecx+4]
  004d9	f3 0f 11 45 8c	 movss	 DWORD PTR _rel$12[ebp+4], xmm0

; 506  : 				rel.z = rain_3d_drops[count].current_position.z - visual_3d_vp->z;

  004de	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  004e2	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  004e8	f3 0f 10 80 08
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+8]
  004f0	f3 0f 5c 41 08	 subss	 xmm0, DWORD PTR [ecx+8]
  004f5	f3 0f 11 45 90	 movss	 DWORD PTR _rel$12[ebp+8], xmm0

; 507  : 	
; 508  : 				if (
; 509  : 						( rel.x > RAINDROPS_AREA_WIDTH ) || ( rel.x < ( -RAINDROPS_AREA_WIDTH ) ) ||
; 510  : 						( rel.y > RAINDROPS_AREA_HEIGHT ) || ( rel.y < ( -RAINDROPS_AREA_HEIGHT ) ) ||
; 511  : 						( rel.z > RAINDROPS_AREA_DEPTH ) || ( rel.z < ( -RAINDROPS_AREA_DEPTH ) )

  004fa	f3 0f 10 45 88	 movss	 xmm0, DWORD PTR _rel$12[ebp]
  004ff	0f 2f 05 00 00
	00 00		 comiss	 xmm0, DWORD PTR __real@43200000
  00506	77 46		 ja	 SHORT $LN24@update_3d_
  00508	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@c3200000
  00510	0f 2f 45 88	 comiss	 xmm0, DWORD PTR _rel$12[ebp]
  00514	77 38		 ja	 SHORT $LN24@update_3d_
  00516	f3 0f 10 45 8c	 movss	 xmm0, DWORD PTR _rel$12[ebp+4]
  0051b	0f 2f 05 00 00
	00 00		 comiss	 xmm0, DWORD PTR __real@42a00000
  00522	77 2a		 ja	 SHORT $LN24@update_3d_
  00524	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@c2a00000
  0052c	0f 2f 45 8c	 comiss	 xmm0, DWORD PTR _rel$12[ebp+4]
  00530	77 1c		 ja	 SHORT $LN24@update_3d_
  00532	f3 0f 10 45 90	 movss	 xmm0, DWORD PTR _rel$12[ebp+8]
  00537	0f 2f 05 00 00
	00 00		 comiss	 xmm0, DWORD PTR __real@44000000
  0053e	77 0e		 ja	 SHORT $LN24@update_3d_
  00540	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@c4000000
  00548	0f 2f 45 90	 comiss	 xmm0, DWORD PTR _rel$12[ebp+8]
  0054c	76 1b		 jbe	 SHORT $LN23@update_3d_
$LN24@update_3d_:

; 512  : 					)
; 513  : 				{
; 514  : 	
; 515  : 	
; 516  : 					rain_3d_raindrops_valid--;

  0054e	a1 00 00 00 00	 mov	 eax, DWORD PTR ?rain_3d_raindrops_valid@@3HA
  00553	83 e8 01	 sub	 eax, 1
  00556	a3 00 00 00 00	 mov	 DWORD PTR ?rain_3d_raindrops_valid@@3HA, eax

; 517  : 	
; 518  : 					rain_3d_drops[count].type = RAINDROP_INVALID;

  0055b	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  0055f	c7 80 18 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+24], 0
$LN23@update_3d_:

; 519  : 				}
; 520  : 
; 521  : 				break;

  00569	e9 6a 02 00 00	 jmp	 $LN5@update_3d_
$LN25@update_3d_:

; 522  : 			}
; 523  : 
; 524  : 			case RAINDROP_SNOW:
; 525  : 			{
; 526  : 
; 527  : 				vec3d
; 528  : 					snow_noise,
; 529  : 					rel;
; 530  : 
; 531  : 				float
; 532  : 					relative_speed;
; 533  : 
; 534  : 				//
; 535  : 				// Update the rain position
; 536  : 				//
; 537  : 
; 538  : 				snow_noise.x = sfrand1 () * rain_3d_delta_time;	//0.1	;//snow_displacement_magnitude;

  0056e	69 05 00 00 00
	00 6d 4e c6 41	 imul	 eax, DWORD PTR ?random_number_seed@@3HA, 1103515245 ; random_number_seed
  00578	05 39 30 00 00	 add	 eax, 12345		; 00003039H
  0057d	a3 00 00 00 00	 mov	 DWORD PTR ?random_number_seed@@3HA, eax ; random_number_seed
  00582	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?random_number_seed@@3HA ; random_number_seed
  00588	c1 f9 10	 sar	 ecx, 16			; 00000010H
  0058b	81 e1 ff 7f 00
	00		 and	 ecx, 32767		; 00007fffH
  00591	81 e9 00 40 00
	00		 sub	 ecx, 16384		; 00004000H
  00597	f2 0f 2a c1	 cvtsi2sd xmm0, ecx
  0059b	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3f10000000000000
  005a3	f3 0f 5a 0d 00
	00 00 00	 cvtss2sd xmm1, DWORD PTR ?rain_3d_delta_time@@3MA
  005ab	f2 0f 59 c1	 mulsd	 xmm0, xmm1
  005af	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  005b3	f3 0f 11 85 7c
	ff ff ff	 movss	 DWORD PTR _snow_noise$11[ebp], xmm0

; 539  : 				snow_noise.y = sfrand1 () * rain_3d_delta_time;	//0.1	;//snow_displacement_magnitude;

  005bb	69 05 00 00 00
	00 6d 4e c6 41	 imul	 eax, DWORD PTR ?random_number_seed@@3HA, 1103515245 ; random_number_seed
  005c5	05 39 30 00 00	 add	 eax, 12345		; 00003039H
  005ca	a3 00 00 00 00	 mov	 DWORD PTR ?random_number_seed@@3HA, eax ; random_number_seed
  005cf	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?random_number_seed@@3HA ; random_number_seed
  005d5	c1 f9 10	 sar	 ecx, 16			; 00000010H
  005d8	81 e1 ff 7f 00
	00		 and	 ecx, 32767		; 00007fffH
  005de	81 e9 00 40 00
	00		 sub	 ecx, 16384		; 00004000H
  005e4	f2 0f 2a c1	 cvtsi2sd xmm0, ecx
  005e8	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3f10000000000000
  005f0	f3 0f 5a 0d 00
	00 00 00	 cvtss2sd xmm1, DWORD PTR ?rain_3d_delta_time@@3MA
  005f8	f2 0f 59 c1	 mulsd	 xmm0, xmm1
  005fc	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00600	f3 0f 11 45 80	 movss	 DWORD PTR _snow_noise$11[ebp+4], xmm0

; 540  : 				snow_noise.z = sfrand1 () * rain_3d_delta_time;	//0.1	;//snow_displacement_magnitude;

  00605	69 05 00 00 00
	00 6d 4e c6 41	 imul	 eax, DWORD PTR ?random_number_seed@@3HA, 1103515245 ; random_number_seed
  0060f	05 39 30 00 00	 add	 eax, 12345		; 00003039H
  00614	a3 00 00 00 00	 mov	 DWORD PTR ?random_number_seed@@3HA, eax ; random_number_seed
  00619	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?random_number_seed@@3HA ; random_number_seed
  0061f	c1 f9 10	 sar	 ecx, 16			; 00000010H
  00622	81 e1 ff 7f 00
	00		 and	 ecx, 32767		; 00007fffH
  00628	81 e9 00 40 00
	00		 sub	 ecx, 16384		; 00004000H
  0062e	f2 0f 2a c1	 cvtsi2sd xmm0, ecx
  00632	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3f10000000000000
  0063a	f3 0f 5a 0d 00
	00 00 00	 cvtss2sd xmm1, DWORD PTR ?rain_3d_delta_time@@3MA
  00642	f2 0f 59 c1	 mulsd	 xmm0, xmm1
  00646	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  0064a	f3 0f 11 45 84	 movss	 DWORD PTR _snow_noise$11[ebp+8], xmm0

; 541  : 
; 542  : 				relative_speed = rain_3d_drops[count].relative_speed;

  0064f	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  00653	f3 0f 10 80 0c
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+12]
  0065b	f3 0f 11 85 6c
	ff ff ff	 movss	 DWORD PTR _relative_speed$9[ebp], xmm0

; 543  : 			
; 544  : 				rain_3d_drops[count].current_position.x -= ( snow_drift_displacement.x + snow_noise.x );

  00663	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  00667	f3 0f 10 45 ac	 movss	 xmm0, DWORD PTR _snow_drift_displacement$[ebp]
  0066c	f3 0f 58 85 7c
	ff ff ff	 addss	 xmm0, DWORD PTR _snow_noise$11[ebp]
  00674	f3 0f 10 88 00
	00 00 00	 movss	 xmm1, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax]
  0067c	f3 0f 5c c8	 subss	 xmm1, xmm0
  00680	6b 4d e0 1c	 imul	 ecx, DWORD PTR _count$[ebp], 28
  00684	f3 0f 11 89 00
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[ecx], xmm1

; 545  : 				rain_3d_drops[count].current_position.y -= ( snow_drift_displacement.y );

  0068c	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  00690	f3 0f 10 80 04
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+4]
  00698	f3 0f 5c 45 b0	 subss	 xmm0, DWORD PTR _snow_drift_displacement$[ebp+4]
  0069d	6b 4d e0 1c	 imul	 ecx, DWORD PTR _count$[ebp], 28
  006a1	f3 0f 11 81 04
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[ecx+4], xmm0

; 546  : 				rain_3d_drops[count].current_position.z -= ( snow_drift_displacement.z + snow_noise.x );

  006a9	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  006ad	f3 0f 10 45 b4	 movss	 xmm0, DWORD PTR _snow_drift_displacement$[ebp+8]
  006b2	f3 0f 58 85 7c
	ff ff ff	 addss	 xmm0, DWORD PTR _snow_noise$11[ebp]
  006ba	f3 0f 10 88 08
	00 00 00	 movss	 xmm1, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+8]
  006c2	f3 0f 5c c8	 subss	 xmm1, xmm0
  006c6	6b 4d e0 1c	 imul	 ecx, DWORD PTR _count$[ebp], 28
  006ca	f3 0f 11 89 08
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[ecx+8], xmm1

; 547  : 
; 548  : 				rain_3d_drops[count].current_position.y -= ( snow_fall_displacement * relative_speed );

  006d2	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  006d6	f3 0f 10 45 d4	 movss	 xmm0, DWORD PTR _snow_fall_displacement$[ebp]
  006db	f3 0f 59 85 6c
	ff ff ff	 mulss	 xmm0, DWORD PTR _relative_speed$9[ebp]
  006e3	f3 0f 10 88 04
	00 00 00	 movss	 xmm1, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+4]
  006eb	f3 0f 5c c8	 subss	 xmm1, xmm0
  006ef	6b 4d e0 1c	 imul	 ecx, DWORD PTR _count$[ebp], 28
  006f3	f3 0f 11 89 04
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[ecx+4], xmm1

; 549  : 
; 550  : 				rel.x = rain_3d_drops[count].current_position.x - visual_3d_vp->x;

  006fb	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  006ff	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  00705	f3 0f 10 80 00
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax]
  0070d	f3 0f 5c 01	 subss	 xmm0, DWORD PTR [ecx]
  00711	f3 0f 11 85 70
	ff ff ff	 movss	 DWORD PTR _rel$10[ebp], xmm0

; 551  : 				rel.y = rain_3d_drops[count].current_position.y - visual_3d_vp->y;

  00719	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  0071d	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  00723	f3 0f 10 80 04
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+4]
  0072b	f3 0f 5c 41 04	 subss	 xmm0, DWORD PTR [ecx+4]
  00730	f3 0f 11 85 74
	ff ff ff	 movss	 DWORD PTR _rel$10[ebp+4], xmm0

; 552  : 				rel.z = rain_3d_drops[count].current_position.z - visual_3d_vp->z;

  00738	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  0073c	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  00742	f3 0f 10 80 08
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+8]
  0074a	f3 0f 5c 41 08	 subss	 xmm0, DWORD PTR [ecx+8]
  0074f	f3 0f 11 85 78
	ff ff ff	 movss	 DWORD PTR _rel$10[ebp+8], xmm0

; 553  : 	
; 554  : 				if (
; 555  : 						( rel.x > SNOWDROPS_AREA_WIDTH ) || ( rel.x < ( -SNOWDROPS_AREA_WIDTH ) ) ||
; 556  : 						( rel.y > SNOWDROPS_AREA_HEIGHT ) || ( rel.y < ( -SNOWDROPS_AREA_HEIGHT ) ) ||
; 557  : 						( rel.z > SNOWDROPS_AREA_DEPTH ) || ( rel.z < ( -SNOWDROPS_AREA_DEPTH ) )

  00757	f3 0f 10 85 70
	ff ff ff	 movss	 xmm0, DWORD PTR _rel$10[ebp]
  0075f	0f 2f 05 00 00
	00 00		 comiss	 xmm0, DWORD PTR __real@43200000
  00766	77 55		 ja	 SHORT $LN27@update_3d_
  00768	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@c3200000
  00770	0f 2f 85 70 ff
	ff ff		 comiss	 xmm0, DWORD PTR _rel$10[ebp]
  00777	77 44		 ja	 SHORT $LN27@update_3d_
  00779	f3 0f 10 85 74
	ff ff ff	 movss	 xmm0, DWORD PTR _rel$10[ebp+4]
  00781	0f 2f 05 00 00
	00 00		 comiss	 xmm0, DWORD PTR __real@42a00000
  00788	77 33		 ja	 SHORT $LN27@update_3d_
  0078a	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@c2a00000
  00792	0f 2f 85 74 ff
	ff ff		 comiss	 xmm0, DWORD PTR _rel$10[ebp+4]
  00799	77 22		 ja	 SHORT $LN27@update_3d_
  0079b	f3 0f 10 85 78
	ff ff ff	 movss	 xmm0, DWORD PTR _rel$10[ebp+8]
  007a3	0f 2f 05 00 00
	00 00		 comiss	 xmm0, DWORD PTR __real@44000000
  007aa	77 11		 ja	 SHORT $LN27@update_3d_
  007ac	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@c4000000
  007b4	0f 2f 85 78 ff
	ff ff		 comiss	 xmm0, DWORD PTR _rel$10[ebp+8]
  007bb	76 1b		 jbe	 SHORT $LN26@update_3d_
$LN27@update_3d_:

; 558  : 					)
; 559  : 				{
; 560  : 	
; 561  : 					rain_3d_snowdrops_valid--;

  007bd	a1 00 00 00 00	 mov	 eax, DWORD PTR ?rain_3d_snowdrops_valid@@3HA
  007c2	83 e8 01	 sub	 eax, 1
  007c5	a3 00 00 00 00	 mov	 DWORD PTR ?rain_3d_snowdrops_valid@@3HA, eax

; 562  : 
; 563  : 					rain_3d_drops[count].type = RAINDROP_INVALID;

  007ca	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  007ce	c7 80 18 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+24], 0
$LN26@update_3d_:
$LN5@update_3d_:

; 564  : 				}
; 565  : 
; 566  : 				break;
; 567  : 			}
; 568  : 		}
; 569  : 
; 570  : 		if ( ( rain_3d_drops[count].type == RAINDROP_INVALID ) && ( creation_allowed ) )

  007d8	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  007dc	83 b8 18 00 00
	00 00		 cmp	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+24], 0
  007e3	0f 85 aa 07 00
	00		 jne	 $LN31@update_3d_
  007e9	83 7d e4 00	 cmp	 DWORD PTR _creation_allowed$[ebp], 0
  007ed	0f 84 a0 07 00
	00		 je	 $LN31@update_3d_

; 571  : 		{
; 572  : 
; 573  : 			if ( rain_3d_raindrops_valid < total_raindrop_number )

  007f3	a1 00 00 00 00	 mov	 eax, DWORD PTR ?rain_3d_raindrops_valid@@3HA
  007f8	3b 45 f4	 cmp	 eax, DWORD PTR _total_raindrop_number$[ebp]
  007fb	0f 8d 9d 03 00
	00		 jge	 $LN29@update_3d_

; 574  : 			{
; 575  : 	
; 576  : 				float
; 577  : 					x,
; 578  : 					y,
; 579  : 					z,
; 580  : 					creation_distance;
; 581  : 	
; 582  : 				//
; 583  : 				// Generate a new rain drop randomly
; 584  : 				//
; 585  : 	
; 586  : 				z = ( ( frand1 () * 0.8 ) + 0.2 ) * ( RAINDROPS_AREA_DEPTH / 5 );

  00801	69 05 00 00 00
	00 6d 4e c6 41	 imul	 eax, DWORD PTR ?random_number_seed@@3HA, 1103515245 ; random_number_seed
  0080b	05 39 30 00 00	 add	 eax, 12345		; 00003039H
  00810	a3 00 00 00 00	 mov	 DWORD PTR ?random_number_seed@@3HA, eax ; random_number_seed
  00815	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?random_number_seed@@3HA ; random_number_seed
  0081b	c1 f9 10	 sar	 ecx, 16			; 00000010H
  0081e	81 e1 ff 7f 00
	00		 and	 ecx, 32767		; 00007fffH
  00824	f2 0f 2a c1	 cvtsi2sd xmm0, ecx
  00828	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3f00002000400080
  00830	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3fe999999999999a
  00838	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR __real@3fc999999999999a
  00840	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@4059800000000000
  00848	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  0084c	f3 0f 11 85 60
	ff ff ff	 movss	 DWORD PTR _z$6[ebp], xmm0

; 587  : 				x = sfrand1 () * ( RAINDROPS_AREA_WIDTH / 5 );

  00854	69 05 00 00 00
	00 6d 4e c6 41	 imul	 eax, DWORD PTR ?random_number_seed@@3HA, 1103515245 ; random_number_seed
  0085e	05 39 30 00 00	 add	 eax, 12345		; 00003039H
  00863	a3 00 00 00 00	 mov	 DWORD PTR ?random_number_seed@@3HA, eax ; random_number_seed
  00868	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?random_number_seed@@3HA ; random_number_seed
  0086e	c1 f9 10	 sar	 ecx, 16			; 00000010H
  00871	81 e1 ff 7f 00
	00		 and	 ecx, 32767		; 00007fffH
  00877	81 e9 00 40 00
	00		 sub	 ecx, 16384		; 00004000H
  0087d	f2 0f 2a c1	 cvtsi2sd xmm0, ecx
  00881	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3f10000000000000
  00889	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@4040000000000000
  00891	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00895	f3 0f 11 85 68
	ff ff ff	 movss	 DWORD PTR _x$8[ebp], xmm0

; 588  : 				y = sfrand1 () * ( RAINDROPS_AREA_HEIGHT / 5 );

  0089d	69 05 00 00 00
	00 6d 4e c6 41	 imul	 eax, DWORD PTR ?random_number_seed@@3HA, 1103515245 ; random_number_seed
  008a7	05 39 30 00 00	 add	 eax, 12345		; 00003039H
  008ac	a3 00 00 00 00	 mov	 DWORD PTR ?random_number_seed@@3HA, eax ; random_number_seed
  008b1	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?random_number_seed@@3HA ; random_number_seed
  008b7	c1 f9 10	 sar	 ecx, 16			; 00000010H
  008ba	81 e1 ff 7f 00
	00		 and	 ecx, 32767		; 00007fffH
  008c0	81 e9 00 40 00
	00		 sub	 ecx, 16384		; 00004000H
  008c6	f2 0f 2a c1	 cvtsi2sd xmm0, ecx
  008ca	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3f10000000000000
  008d2	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@4030000000000000
  008da	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  008de	f3 0f 11 85 64
	ff ff ff	 movss	 DWORD PTR _y$7[ebp], xmm0

; 589  : 
; 590  : 				x *= z / 50;

  008e6	f3 0f 10 85 60
	ff ff ff	 movss	 xmm0, DWORD PTR _z$6[ebp]
  008ee	f3 0f 5e 05 00
	00 00 00	 divss	 xmm0, DWORD PTR __real@42480000
  008f6	f3 0f 59 85 68
	ff ff ff	 mulss	 xmm0, DWORD PTR _x$8[ebp]
  008fe	f3 0f 11 85 68
	ff ff ff	 movss	 DWORD PTR _x$8[ebp], xmm0

; 591  : 				y *= z / 50;

  00906	f3 0f 10 85 60
	ff ff ff	 movss	 xmm0, DWORD PTR _z$6[ebp]
  0090e	f3 0f 5e 05 00
	00 00 00	 divss	 xmm0, DWORD PTR __real@42480000
  00916	f3 0f 59 85 64
	ff ff ff	 mulss	 xmm0, DWORD PTR _y$7[ebp]
  0091e	f3 0f 11 85 64
	ff ff ff	 movss	 DWORD PTR _y$7[ebp], xmm0

; 592  : 	
; 593  : 				//
; 594  : 				// Now project along the motion vector
; 595  : 				//
; 596  : 	
; 597  : 				creation_distance = frand1 () * 8;

  00926	69 05 00 00 00
	00 6d 4e c6 41	 imul	 eax, DWORD PTR ?random_number_seed@@3HA, 1103515245 ; random_number_seed
  00930	05 39 30 00 00	 add	 eax, 12345		; 00003039H
  00935	a3 00 00 00 00	 mov	 DWORD PTR ?random_number_seed@@3HA, eax ; random_number_seed
  0093a	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?random_number_seed@@3HA ; random_number_seed
  00940	c1 f9 10	 sar	 ecx, 16			; 00000010H
  00943	81 e1 ff 7f 00
	00		 and	 ecx, 32767		; 00007fffH
  00949	f2 0f 2a c1	 cvtsi2sd xmm0, ecx
  0094d	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3f00002000400080
  00955	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@4020000000000000
  0095d	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00961	f3 0f 11 85 5c
	ff ff ff	 movss	 DWORD PTR _creation_distance$5[ebp], xmm0

; 598  : 				x += creation_vector.x * creation_distance;

  00969	f3 0f 10 45 94	 movss	 xmm0, DWORD PTR _creation_vector$[ebp]
  0096e	f3 0f 59 85 5c
	ff ff ff	 mulss	 xmm0, DWORD PTR _creation_distance$5[ebp]
  00976	f3 0f 58 85 68
	ff ff ff	 addss	 xmm0, DWORD PTR _x$8[ebp]
  0097e	f3 0f 11 85 68
	ff ff ff	 movss	 DWORD PTR _x$8[ebp], xmm0

; 599  : 				y += creation_vector.y * creation_distance;

  00986	f3 0f 10 45 98	 movss	 xmm0, DWORD PTR _creation_vector$[ebp+4]
  0098b	f3 0f 59 85 5c
	ff ff ff	 mulss	 xmm0, DWORD PTR _creation_distance$5[ebp]
  00993	f3 0f 58 85 64
	ff ff ff	 addss	 xmm0, DWORD PTR _y$7[ebp]
  0099b	f3 0f 11 85 64
	ff ff ff	 movss	 DWORD PTR _y$7[ebp], xmm0

; 600  : 				z += creation_vector.z * creation_distance;

  009a3	f3 0f 10 45 9c	 movss	 xmm0, DWORD PTR _creation_vector$[ebp+8]
  009a8	f3 0f 59 85 5c
	ff ff ff	 mulss	 xmm0, DWORD PTR _creation_distance$5[ebp]
  009b0	f3 0f 58 85 60
	ff ff ff	 addss	 xmm0, DWORD PTR _z$6[ebp]
  009b8	f3 0f 11 85 60
	ff ff ff	 movss	 DWORD PTR _z$6[ebp], xmm0

; 601  : 	
; 602  : 				//
; 603  : 				// Rotate this back into the view coordinate system
; 604  : 				//
; 605  : 	
; 606  : 				rain_3d_drops[count].current_position.x = x * view_attitude[0][0] + y * view_attitude[1][0] + z * view_attitude[2][0];

  009c0	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  009c5	6b c8 00	 imul	 ecx, eax, 0
  009c8	03 4d 10	 add	 ecx, DWORD PTR _view_attitude$[ebp]
  009cb	ba 04 00 00 00	 mov	 edx, 4
  009d0	6b c2 00	 imul	 eax, edx, 0
  009d3	f3 0f 10 85 68
	ff ff ff	 movss	 xmm0, DWORD PTR _x$8[ebp]
  009db	f3 0f 59 04 01	 mulss	 xmm0, DWORD PTR [ecx+eax]
  009e0	b9 0c 00 00 00	 mov	 ecx, 12			; 0000000cH
  009e5	c1 e1 00	 shl	 ecx, 0
  009e8	03 4d 10	 add	 ecx, DWORD PTR _view_attitude$[ebp]
  009eb	ba 04 00 00 00	 mov	 edx, 4
  009f0	6b c2 00	 imul	 eax, edx, 0
  009f3	f3 0f 10 8d 64
	ff ff ff	 movss	 xmm1, DWORD PTR _y$7[ebp]
  009fb	f3 0f 59 0c 01	 mulss	 xmm1, DWORD PTR [ecx+eax]
  00a00	f3 0f 58 c1	 addss	 xmm0, xmm1
  00a04	b9 0c 00 00 00	 mov	 ecx, 12			; 0000000cH
  00a09	d1 e1		 shl	 ecx, 1
  00a0b	03 4d 10	 add	 ecx, DWORD PTR _view_attitude$[ebp]
  00a0e	ba 04 00 00 00	 mov	 edx, 4
  00a13	6b c2 00	 imul	 eax, edx, 0
  00a16	f3 0f 10 8d 60
	ff ff ff	 movss	 xmm1, DWORD PTR _z$6[ebp]
  00a1e	f3 0f 59 0c 01	 mulss	 xmm1, DWORD PTR [ecx+eax]
  00a23	f3 0f 58 c1	 addss	 xmm0, xmm1
  00a27	6b 4d e0 1c	 imul	 ecx, DWORD PTR _count$[ebp], 28
  00a2b	f3 0f 11 81 00
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[ecx], xmm0

; 607  : 				rain_3d_drops[count].current_position.y = x * view_attitude[0][1] + y * view_attitude[1][1] + z * view_attitude[2][1];

  00a33	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00a38	6b c8 00	 imul	 ecx, eax, 0
  00a3b	03 4d 10	 add	 ecx, DWORD PTR _view_attitude$[ebp]
  00a3e	ba 04 00 00 00	 mov	 edx, 4
  00a43	c1 e2 00	 shl	 edx, 0
  00a46	f3 0f 10 85 68
	ff ff ff	 movss	 xmm0, DWORD PTR _x$8[ebp]
  00a4e	f3 0f 59 04 11	 mulss	 xmm0, DWORD PTR [ecx+edx]
  00a53	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00a58	c1 e0 00	 shl	 eax, 0
  00a5b	03 45 10	 add	 eax, DWORD PTR _view_attitude$[ebp]
  00a5e	b9 04 00 00 00	 mov	 ecx, 4
  00a63	c1 e1 00	 shl	 ecx, 0
  00a66	f3 0f 10 8d 64
	ff ff ff	 movss	 xmm1, DWORD PTR _y$7[ebp]
  00a6e	f3 0f 59 0c 08	 mulss	 xmm1, DWORD PTR [eax+ecx]
  00a73	f3 0f 58 c1	 addss	 xmm0, xmm1
  00a77	ba 0c 00 00 00	 mov	 edx, 12			; 0000000cH
  00a7c	d1 e2		 shl	 edx, 1
  00a7e	03 55 10	 add	 edx, DWORD PTR _view_attitude$[ebp]
  00a81	b8 04 00 00 00	 mov	 eax, 4
  00a86	c1 e0 00	 shl	 eax, 0
  00a89	f3 0f 10 8d 60
	ff ff ff	 movss	 xmm1, DWORD PTR _z$6[ebp]
  00a91	f3 0f 59 0c 02	 mulss	 xmm1, DWORD PTR [edx+eax]
  00a96	f3 0f 58 c1	 addss	 xmm0, xmm1
  00a9a	6b 4d e0 1c	 imul	 ecx, DWORD PTR _count$[ebp], 28
  00a9e	f3 0f 11 81 04
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[ecx+4], xmm0

; 608  : 				rain_3d_drops[count].current_position.z = x * view_attitude[0][2] + y * view_attitude[1][2] + z * view_attitude[2][2];

  00aa6	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00aab	6b c8 00	 imul	 ecx, eax, 0
  00aae	03 4d 10	 add	 ecx, DWORD PTR _view_attitude$[ebp]
  00ab1	ba 04 00 00 00	 mov	 edx, 4
  00ab6	d1 e2		 shl	 edx, 1
  00ab8	f3 0f 10 85 68
	ff ff ff	 movss	 xmm0, DWORD PTR _x$8[ebp]
  00ac0	f3 0f 59 04 11	 mulss	 xmm0, DWORD PTR [ecx+edx]
  00ac5	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00aca	c1 e0 00	 shl	 eax, 0
  00acd	03 45 10	 add	 eax, DWORD PTR _view_attitude$[ebp]
  00ad0	b9 04 00 00 00	 mov	 ecx, 4
  00ad5	d1 e1		 shl	 ecx, 1
  00ad7	f3 0f 10 8d 64
	ff ff ff	 movss	 xmm1, DWORD PTR _y$7[ebp]
  00adf	f3 0f 59 0c 08	 mulss	 xmm1, DWORD PTR [eax+ecx]
  00ae4	f3 0f 58 c1	 addss	 xmm0, xmm1
  00ae8	ba 0c 00 00 00	 mov	 edx, 12			; 0000000cH
  00aed	d1 e2		 shl	 edx, 1
  00aef	03 55 10	 add	 edx, DWORD PTR _view_attitude$[ebp]
  00af2	b8 04 00 00 00	 mov	 eax, 4
  00af7	d1 e0		 shl	 eax, 1
  00af9	f3 0f 10 8d 60
	ff ff ff	 movss	 xmm1, DWORD PTR _z$6[ebp]
  00b01	f3 0f 59 0c 02	 mulss	 xmm1, DWORD PTR [edx+eax]
  00b06	f3 0f 58 c1	 addss	 xmm0, xmm1
  00b0a	6b 4d e0 1c	 imul	 ecx, DWORD PTR _count$[ebp], 28
  00b0e	f3 0f 11 81 08
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[ecx+8], xmm0

; 609  : 
; 610  : 				rain_3d_drops[count].current_position.x += visual_3d_vp->x;

  00b16	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  00b1a	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  00b20	f3 0f 10 80 00
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax]
  00b28	f3 0f 58 01	 addss	 xmm0, DWORD PTR [ecx]
  00b2c	6b 55 e0 1c	 imul	 edx, DWORD PTR _count$[ebp], 28
  00b30	f3 0f 11 82 00
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[edx], xmm0

; 611  : 				rain_3d_drops[count].current_position.y += visual_3d_vp->y;

  00b38	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  00b3c	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  00b42	f3 0f 10 80 04
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+4]
  00b4a	f3 0f 58 41 04	 addss	 xmm0, DWORD PTR [ecx+4]
  00b4f	6b 55 e0 1c	 imul	 edx, DWORD PTR _count$[ebp], 28
  00b53	f3 0f 11 82 04
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[edx+4], xmm0

; 612  : 				rain_3d_drops[count].current_position.z += visual_3d_vp->z;

  00b5b	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  00b5f	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  00b65	f3 0f 10 80 08
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+8]
  00b6d	f3 0f 58 41 08	 addss	 xmm0, DWORD PTR [ecx+8]
  00b72	6b 55 e0 1c	 imul	 edx, DWORD PTR _count$[ebp], 28
  00b76	f3 0f 11 82 08
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[edx+8], xmm0

; 613  : 
; 614  : 				rain_3d_drops[count].type = RAINDROP_RAIN;

  00b7e	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  00b82	c7 80 18 00 00
	00 01 00 00 00	 mov	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+24], 1

; 615  : 	
; 616  : 				rain_3d_raindrops_valid++;

  00b8c	a1 00 00 00 00	 mov	 eax, DWORD PTR ?rain_3d_raindrops_valid@@3HA
  00b91	83 c0 01	 add	 eax, 1
  00b94	a3 00 00 00 00	 mov	 DWORD PTR ?rain_3d_raindrops_valid@@3HA, eax
  00b99	e9 f5 03 00 00	 jmp	 $LN31@update_3d_
$LN29@update_3d_:

; 617  : 			}
; 618  : 			else if ( rain_3d_snowdrops_valid < total_snowdrop_number )

  00b9e	a1 00 00 00 00	 mov	 eax, DWORD PTR ?rain_3d_snowdrops_valid@@3HA
  00ba3	3b 45 e8	 cmp	 eax, DWORD PTR _total_snowdrop_number$[ebp]
  00ba6	0f 8d e7 03 00
	00		 jge	 $LN31@update_3d_

; 619  : 			{
; 620  : 	
; 621  : 				float
; 622  : 					x,
; 623  : 					y,
; 624  : 					z,
; 625  : 					creation_distance;
; 626  : 
; 627  : 				//
; 628  : 				// Generate a new snowdrop
; 629  : 				//
; 630  : 
; 631  : 				z = ( ( frand1 () * 0.8 ) + 0.2 ) * ( SNOWDROPS_AREA_DEPTH / 5 );

  00bac	69 05 00 00 00
	00 6d 4e c6 41	 imul	 eax, DWORD PTR ?random_number_seed@@3HA, 1103515245 ; random_number_seed
  00bb6	05 39 30 00 00	 add	 eax, 12345		; 00003039H
  00bbb	a3 00 00 00 00	 mov	 DWORD PTR ?random_number_seed@@3HA, eax ; random_number_seed
  00bc0	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?random_number_seed@@3HA ; random_number_seed
  00bc6	c1 f9 10	 sar	 ecx, 16			; 00000010H
  00bc9	81 e1 ff 7f 00
	00		 and	 ecx, 32767		; 00007fffH
  00bcf	f2 0f 2a c1	 cvtsi2sd xmm0, ecx
  00bd3	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3f00002000400080
  00bdb	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3fe999999999999a
  00be3	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR __real@3fc999999999999a
  00beb	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@4059800000000000
  00bf3	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00bf7	f3 0f 11 85 50
	ff ff ff	 movss	 DWORD PTR _z$2[ebp], xmm0

; 632  : 				x = sfrand1 () * ( SNOWDROPS_AREA_WIDTH / 5 );

  00bff	69 05 00 00 00
	00 6d 4e c6 41	 imul	 eax, DWORD PTR ?random_number_seed@@3HA, 1103515245 ; random_number_seed
  00c09	05 39 30 00 00	 add	 eax, 12345		; 00003039H
  00c0e	a3 00 00 00 00	 mov	 DWORD PTR ?random_number_seed@@3HA, eax ; random_number_seed
  00c13	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?random_number_seed@@3HA ; random_number_seed
  00c19	c1 f9 10	 sar	 ecx, 16			; 00000010H
  00c1c	81 e1 ff 7f 00
	00		 and	 ecx, 32767		; 00007fffH
  00c22	81 e9 00 40 00
	00		 sub	 ecx, 16384		; 00004000H
  00c28	f2 0f 2a c1	 cvtsi2sd xmm0, ecx
  00c2c	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3f10000000000000
  00c34	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@4040000000000000
  00c3c	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00c40	f3 0f 11 85 58
	ff ff ff	 movss	 DWORD PTR _x$4[ebp], xmm0

; 633  : 				y = sfrand1 () * ( SNOWDROPS_AREA_HEIGHT / 5 );

  00c48	69 05 00 00 00
	00 6d 4e c6 41	 imul	 eax, DWORD PTR ?random_number_seed@@3HA, 1103515245 ; random_number_seed
  00c52	05 39 30 00 00	 add	 eax, 12345		; 00003039H
  00c57	a3 00 00 00 00	 mov	 DWORD PTR ?random_number_seed@@3HA, eax ; random_number_seed
  00c5c	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?random_number_seed@@3HA ; random_number_seed
  00c62	c1 f9 10	 sar	 ecx, 16			; 00000010H
  00c65	81 e1 ff 7f 00
	00		 and	 ecx, 32767		; 00007fffH
  00c6b	81 e9 00 40 00
	00		 sub	 ecx, 16384		; 00004000H
  00c71	f2 0f 2a c1	 cvtsi2sd xmm0, ecx
  00c75	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3f10000000000000
  00c7d	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@4030000000000000
  00c85	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00c89	f3 0f 11 85 54
	ff ff ff	 movss	 DWORD PTR _y$3[ebp], xmm0

; 634  : 	
; 635  : 				x *= z / 50;

  00c91	f3 0f 10 85 50
	ff ff ff	 movss	 xmm0, DWORD PTR _z$2[ebp]
  00c99	f3 0f 5e 05 00
	00 00 00	 divss	 xmm0, DWORD PTR __real@42480000
  00ca1	f3 0f 59 85 58
	ff ff ff	 mulss	 xmm0, DWORD PTR _x$4[ebp]
  00ca9	f3 0f 11 85 58
	ff ff ff	 movss	 DWORD PTR _x$4[ebp], xmm0

; 636  : 				y *= z / 50;

  00cb1	f3 0f 10 85 50
	ff ff ff	 movss	 xmm0, DWORD PTR _z$2[ebp]
  00cb9	f3 0f 5e 05 00
	00 00 00	 divss	 xmm0, DWORD PTR __real@42480000
  00cc1	f3 0f 59 85 54
	ff ff ff	 mulss	 xmm0, DWORD PTR _y$3[ebp]
  00cc9	f3 0f 11 85 54
	ff ff ff	 movss	 DWORD PTR _y$3[ebp], xmm0

; 637  : 	
; 638  : 				//
; 639  : 				// Now project along the motion vector
; 640  : 				//
; 641  : 	
; 642  : 				creation_distance = frand1 () * 8;

  00cd1	69 05 00 00 00
	00 6d 4e c6 41	 imul	 eax, DWORD PTR ?random_number_seed@@3HA, 1103515245 ; random_number_seed
  00cdb	05 39 30 00 00	 add	 eax, 12345		; 00003039H
  00ce0	a3 00 00 00 00	 mov	 DWORD PTR ?random_number_seed@@3HA, eax ; random_number_seed
  00ce5	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?random_number_seed@@3HA ; random_number_seed
  00ceb	c1 f9 10	 sar	 ecx, 16			; 00000010H
  00cee	81 e1 ff 7f 00
	00		 and	 ecx, 32767		; 00007fffH
  00cf4	f2 0f 2a c1	 cvtsi2sd xmm0, ecx
  00cf8	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3f00002000400080
  00d00	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@4020000000000000
  00d08	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00d0c	f3 0f 11 85 4c
	ff ff ff	 movss	 DWORD PTR _creation_distance$1[ebp], xmm0

; 643  : 				x += creation_vector.x * creation_distance;

  00d14	f3 0f 10 45 94	 movss	 xmm0, DWORD PTR _creation_vector$[ebp]
  00d19	f3 0f 59 85 4c
	ff ff ff	 mulss	 xmm0, DWORD PTR _creation_distance$1[ebp]
  00d21	f3 0f 58 85 58
	ff ff ff	 addss	 xmm0, DWORD PTR _x$4[ebp]
  00d29	f3 0f 11 85 58
	ff ff ff	 movss	 DWORD PTR _x$4[ebp], xmm0

; 644  : 				y += creation_vector.y * creation_distance;

  00d31	f3 0f 10 45 98	 movss	 xmm0, DWORD PTR _creation_vector$[ebp+4]
  00d36	f3 0f 59 85 4c
	ff ff ff	 mulss	 xmm0, DWORD PTR _creation_distance$1[ebp]
  00d3e	f3 0f 58 85 54
	ff ff ff	 addss	 xmm0, DWORD PTR _y$3[ebp]
  00d46	f3 0f 11 85 54
	ff ff ff	 movss	 DWORD PTR _y$3[ebp], xmm0

; 645  : 				z += creation_vector.z * creation_distance;

  00d4e	f3 0f 10 45 9c	 movss	 xmm0, DWORD PTR _creation_vector$[ebp+8]
  00d53	f3 0f 59 85 4c
	ff ff ff	 mulss	 xmm0, DWORD PTR _creation_distance$1[ebp]
  00d5b	f3 0f 58 85 50
	ff ff ff	 addss	 xmm0, DWORD PTR _z$2[ebp]
  00d63	f3 0f 11 85 50
	ff ff ff	 movss	 DWORD PTR _z$2[ebp], xmm0

; 646  : 	
; 647  : 				//
; 648  : 				// Rotate this back into the view coordinate system
; 649  : 				//
; 650  : 	
; 651  : 				rain_3d_drops[count].current_position.x = x * view_attitude[0][0] + y * view_attitude[1][0] + z * view_attitude[2][0];

  00d6b	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00d70	6b c8 00	 imul	 ecx, eax, 0
  00d73	03 4d 10	 add	 ecx, DWORD PTR _view_attitude$[ebp]
  00d76	ba 04 00 00 00	 mov	 edx, 4
  00d7b	6b c2 00	 imul	 eax, edx, 0
  00d7e	f3 0f 10 85 58
	ff ff ff	 movss	 xmm0, DWORD PTR _x$4[ebp]
  00d86	f3 0f 59 04 01	 mulss	 xmm0, DWORD PTR [ecx+eax]
  00d8b	b9 0c 00 00 00	 mov	 ecx, 12			; 0000000cH
  00d90	c1 e1 00	 shl	 ecx, 0
  00d93	03 4d 10	 add	 ecx, DWORD PTR _view_attitude$[ebp]
  00d96	ba 04 00 00 00	 mov	 edx, 4
  00d9b	6b c2 00	 imul	 eax, edx, 0
  00d9e	f3 0f 10 8d 54
	ff ff ff	 movss	 xmm1, DWORD PTR _y$3[ebp]
  00da6	f3 0f 59 0c 01	 mulss	 xmm1, DWORD PTR [ecx+eax]
  00dab	f3 0f 58 c1	 addss	 xmm0, xmm1
  00daf	b9 0c 00 00 00	 mov	 ecx, 12			; 0000000cH
  00db4	d1 e1		 shl	 ecx, 1
  00db6	03 4d 10	 add	 ecx, DWORD PTR _view_attitude$[ebp]
  00db9	ba 04 00 00 00	 mov	 edx, 4
  00dbe	6b c2 00	 imul	 eax, edx, 0
  00dc1	f3 0f 10 8d 50
	ff ff ff	 movss	 xmm1, DWORD PTR _z$2[ebp]
  00dc9	f3 0f 59 0c 01	 mulss	 xmm1, DWORD PTR [ecx+eax]
  00dce	f3 0f 58 c1	 addss	 xmm0, xmm1
  00dd2	6b 4d e0 1c	 imul	 ecx, DWORD PTR _count$[ebp], 28
  00dd6	f3 0f 11 81 00
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[ecx], xmm0

; 652  : 				rain_3d_drops[count].current_position.y = x * view_attitude[0][1] + y * view_attitude[1][1] + z * view_attitude[2][1];

  00dde	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00de3	6b c8 00	 imul	 ecx, eax, 0
  00de6	03 4d 10	 add	 ecx, DWORD PTR _view_attitude$[ebp]
  00de9	ba 04 00 00 00	 mov	 edx, 4
  00dee	c1 e2 00	 shl	 edx, 0
  00df1	f3 0f 10 85 58
	ff ff ff	 movss	 xmm0, DWORD PTR _x$4[ebp]
  00df9	f3 0f 59 04 11	 mulss	 xmm0, DWORD PTR [ecx+edx]
  00dfe	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00e03	c1 e0 00	 shl	 eax, 0
  00e06	03 45 10	 add	 eax, DWORD PTR _view_attitude$[ebp]
  00e09	b9 04 00 00 00	 mov	 ecx, 4
  00e0e	c1 e1 00	 shl	 ecx, 0
  00e11	f3 0f 10 8d 54
	ff ff ff	 movss	 xmm1, DWORD PTR _y$3[ebp]
  00e19	f3 0f 59 0c 08	 mulss	 xmm1, DWORD PTR [eax+ecx]
  00e1e	f3 0f 58 c1	 addss	 xmm0, xmm1
  00e22	ba 0c 00 00 00	 mov	 edx, 12			; 0000000cH
  00e27	d1 e2		 shl	 edx, 1
  00e29	03 55 10	 add	 edx, DWORD PTR _view_attitude$[ebp]
  00e2c	b8 04 00 00 00	 mov	 eax, 4
  00e31	c1 e0 00	 shl	 eax, 0
  00e34	f3 0f 10 8d 50
	ff ff ff	 movss	 xmm1, DWORD PTR _z$2[ebp]
  00e3c	f3 0f 59 0c 02	 mulss	 xmm1, DWORD PTR [edx+eax]
  00e41	f3 0f 58 c1	 addss	 xmm0, xmm1
  00e45	6b 4d e0 1c	 imul	 ecx, DWORD PTR _count$[ebp], 28
  00e49	f3 0f 11 81 04
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[ecx+4], xmm0

; 653  : 				rain_3d_drops[count].current_position.z = x * view_attitude[0][2] + y * view_attitude[1][2] + z * view_attitude[2][2];

  00e51	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00e56	6b c8 00	 imul	 ecx, eax, 0
  00e59	03 4d 10	 add	 ecx, DWORD PTR _view_attitude$[ebp]
  00e5c	ba 04 00 00 00	 mov	 edx, 4
  00e61	d1 e2		 shl	 edx, 1
  00e63	f3 0f 10 85 58
	ff ff ff	 movss	 xmm0, DWORD PTR _x$4[ebp]
  00e6b	f3 0f 59 04 11	 mulss	 xmm0, DWORD PTR [ecx+edx]
  00e70	b8 0c 00 00 00	 mov	 eax, 12			; 0000000cH
  00e75	c1 e0 00	 shl	 eax, 0
  00e78	03 45 10	 add	 eax, DWORD PTR _view_attitude$[ebp]
  00e7b	b9 04 00 00 00	 mov	 ecx, 4
  00e80	d1 e1		 shl	 ecx, 1
  00e82	f3 0f 10 8d 54
	ff ff ff	 movss	 xmm1, DWORD PTR _y$3[ebp]
  00e8a	f3 0f 59 0c 08	 mulss	 xmm1, DWORD PTR [eax+ecx]
  00e8f	f3 0f 58 c1	 addss	 xmm0, xmm1
  00e93	ba 0c 00 00 00	 mov	 edx, 12			; 0000000cH
  00e98	d1 e2		 shl	 edx, 1
  00e9a	03 55 10	 add	 edx, DWORD PTR _view_attitude$[ebp]
  00e9d	b8 04 00 00 00	 mov	 eax, 4
  00ea2	d1 e0		 shl	 eax, 1
  00ea4	f3 0f 10 8d 50
	ff ff ff	 movss	 xmm1, DWORD PTR _z$2[ebp]
  00eac	f3 0f 59 0c 02	 mulss	 xmm1, DWORD PTR [edx+eax]
  00eb1	f3 0f 58 c1	 addss	 xmm0, xmm1
  00eb5	6b 4d e0 1c	 imul	 ecx, DWORD PTR _count$[ebp], 28
  00eb9	f3 0f 11 81 08
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[ecx+8], xmm0

; 654  : 	
; 655  : 				rain_3d_drops[count].current_position.x += visual_3d_vp->x;

  00ec1	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  00ec5	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  00ecb	f3 0f 10 80 00
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax]
  00ed3	f3 0f 58 01	 addss	 xmm0, DWORD PTR [ecx]
  00ed7	6b 55 e0 1c	 imul	 edx, DWORD PTR _count$[ebp], 28
  00edb	f3 0f 11 82 00
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[edx], xmm0

; 656  : 				rain_3d_drops[count].current_position.y += visual_3d_vp->y;

  00ee3	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  00ee7	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  00eed	f3 0f 10 80 04
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+4]
  00ef5	f3 0f 58 41 04	 addss	 xmm0, DWORD PTR [ecx+4]
  00efa	6b 55 e0 1c	 imul	 edx, DWORD PTR _count$[ebp], 28
  00efe	f3 0f 11 82 04
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[edx+4], xmm0

; 657  : 				rain_3d_drops[count].current_position.z += visual_3d_vp->z;

  00f06	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  00f0a	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?visual_3d_vp@@3PAUVIEWPOINT@@A ; visual_3d_vp
  00f10	f3 0f 10 80 08
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+8]
  00f18	f3 0f 58 41 08	 addss	 xmm0, DWORD PTR [ecx+8]
  00f1d	6b 55 e0 1c	 imul	 edx, DWORD PTR _count$[ebp], 28
  00f21	f3 0f 11 82 08
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[edx+8], xmm0

; 658  : 
; 659  : 				rain_3d_drops[count].relative_speed = ( frand1() * 0.5 ) + 0.5;

  00f29	69 05 00 00 00
	00 6d 4e c6 41	 imul	 eax, DWORD PTR ?random_number_seed@@3HA, 1103515245 ; random_number_seed
  00f33	05 39 30 00 00	 add	 eax, 12345		; 00003039H
  00f38	a3 00 00 00 00	 mov	 DWORD PTR ?random_number_seed@@3HA, eax ; random_number_seed
  00f3d	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?random_number_seed@@3HA ; random_number_seed
  00f43	c1 f9 10	 sar	 ecx, 16			; 00000010H
  00f46	81 e1 ff 7f 00
	00		 and	 ecx, 32767		; 00007fffH
  00f4c	f2 0f 2a c1	 cvtsi2sd xmm0, ecx
  00f50	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3f00002000400080
  00f58	f2 0f 59 05 00
	00 00 00	 mulsd	 xmm0, QWORD PTR __real@3fe0000000000000
  00f60	f2 0f 58 05 00
	00 00 00	 addsd	 xmm0, QWORD PTR __real@3fe0000000000000
  00f68	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00f6c	6b 55 e0 1c	 imul	 edx, DWORD PTR _count$[ebp], 28
  00f70	f3 0f 11 82 0c
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[edx+12], xmm0

; 660  : 	
; 661  : 				rain_3d_drops[count].type = RAINDROP_SNOW;

  00f78	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  00f7c	c7 80 18 00 00
	00 02 00 00 00	 mov	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+24], 2

; 662  : 	
; 663  : 				rain_3d_snowdrops_valid++;

  00f86	a1 00 00 00 00	 mov	 eax, DWORD PTR ?rain_3d_snowdrops_valid@@3HA
  00f8b	83 c0 01	 add	 eax, 1
  00f8e	a3 00 00 00 00	 mov	 DWORD PTR ?rain_3d_snowdrops_valid@@3HA, eax
$LN31@update_3d_:

; 664  : 			}
; 665  : 		}
; 666  : 	}

  00f93	e9 77 f4 ff ff	 jmp	 $LN2@update_3d_
$LN3@update_3d_:

; 667  : 
; 668  : 	//
; 669  : 	// Now calculate the predicted positions for rendering
; 670  : 	//
; 671  : 
; 672  : 	for ( count = 0; count < TOTAL_3D_RAINDROPS; count++ )

  00f98	c7 45 e0 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  00f9f	eb 09		 jmp	 SHORT $LN9@update_3d_
$LN7@update_3d_:
  00fa1	8b 45 e0	 mov	 eax, DWORD PTR _count$[ebp]
  00fa4	83 c0 01	 add	 eax, 1
  00fa7	89 45 e0	 mov	 DWORD PTR _count$[ebp], eax
$LN9@update_3d_:
  00faa	81 7d e0 00 08
	00 00		 cmp	 DWORD PTR _count$[ebp], 2048 ; 00000800H
  00fb1	7d 66		 jge	 SHORT $LN8@update_3d_

; 673  : 	{
; 674  : 
; 675  : 		if ( rain_3d_drops[count].type == RAINDROP_RAIN )

  00fb3	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  00fb7	83 b8 18 00 00
	00 01		 cmp	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+24], 1
  00fbe	75 57		 jne	 SHORT $LN32@update_3d_

; 676  : 		{
; 677  : 	
; 678  : 			rain_3d_drops[count].predicted_position.x = rain_3d_drops[count].current_position.x - rain_streak_displacement.x;

  00fc0	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  00fc4	f3 0f 10 80 00
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax]
  00fcc	f3 0f 5c 45 a0	 subss	 xmm0, DWORD PTR _rain_streak_displacement$[ebp]
  00fd1	6b 4d e0 1c	 imul	 ecx, DWORD PTR _count$[ebp], 28
  00fd5	f3 0f 11 81 0c
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[ecx+12], xmm0

; 679  : 			rain_3d_drops[count].predicted_position.y = rain_3d_drops[count].current_position.y - rain_streak_displacement.y;

  00fdd	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  00fe1	f3 0f 10 80 04
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+4]
  00fe9	f3 0f 5c 45 a4	 subss	 xmm0, DWORD PTR _rain_streak_displacement$[ebp+4]
  00fee	6b 4d e0 1c	 imul	 ecx, DWORD PTR _count$[ebp], 28
  00ff2	f3 0f 11 81 10
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[ecx+16], xmm0

; 680  : 			rain_3d_drops[count].predicted_position.z = rain_3d_drops[count].current_position.z - rain_streak_displacement.z;

  00ffa	6b 45 e0 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  00ffe	f3 0f 10 80 08
	00 00 00	 movss	 xmm0, DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+8]
  01006	f3 0f 5c 45 a8	 subss	 xmm0, DWORD PTR _rain_streak_displacement$[ebp+8]
  0100b	6b 4d e0 1c	 imul	 ecx, DWORD PTR _count$[ebp], 28
  0100f	f3 0f 11 81 14
	00 00 00	 movss	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[ecx+20], xmm0
$LN32@update_3d_:

; 681  : 		}
; 682  : 	}

  01017	eb 88		 jmp	 SHORT $LN7@update_3d_
$LN8@update_3d_:

; 683  : }

  01019	5f		 pop	 edi
  0101a	5e		 pop	 esi
  0101b	5b		 pop	 ebx
  0101c	8b e5		 mov	 esp, ebp
  0101e	5d		 pop	 ebp
  0101f	c2 0c 00	 ret	 12			; 0000000cH
?update_3d_rain@@YGXPAUENV_3D@@MQAY02M@Z ENDP		; update_3d_rain
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3drain.c
;	COMDAT ?set_3d_rain_wind@@YGXPAUVEC3D@@M@Z
_TEXT	SEGMENT
_direction$ = 8						; size = 4
_speed$ = 12						; size = 4
?set_3d_rain_wind@@YGXPAUVEC3D@@M@Z PROC		; set_3d_rain_wind, COMDAT

; 244  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 245  : 
; 246  : 	//
; 247  : 	// direction *must* be a unit vector - or expect the rain to move faster/slower than it should
; 248  : 	//
; 249  : 
; 250  : 	rain_3d_wind_direction = *direction;

  00009	8b 45 08	 mov	 eax, DWORD PTR _direction$[ebp]
  0000c	8b 08		 mov	 ecx, DWORD PTR [eax]
  0000e	89 0d 00 00 00
	00		 mov	 DWORD PTR ?rain_3d_wind_direction@@3UVEC3D@@A, ecx
  00014	8b 50 04	 mov	 edx, DWORD PTR [eax+4]
  00017	89 15 04 00 00
	00		 mov	 DWORD PTR ?rain_3d_wind_direction@@3UVEC3D@@A+4, edx
  0001d	8b 40 08	 mov	 eax, DWORD PTR [eax+8]
  00020	a3 08 00 00 00	 mov	 DWORD PTR ?rain_3d_wind_direction@@3UVEC3D@@A+8, eax

; 251  : 
; 252  : 	rain_3d_wind_speed = speed;

  00025	f3 0f 10 45 0c	 movss	 xmm0, DWORD PTR _speed$[ebp]
  0002a	f3 0f 11 05 00
	00 00 00	 movss	 DWORD PTR ?rain_3d_wind_speed@@3MA, xmm0

; 253  : }

  00032	5f		 pop	 edi
  00033	5e		 pop	 esi
  00034	5b		 pop	 ebx
  00035	8b e5		 mov	 esp, ebp
  00037	5d		 pop	 ebp
  00038	c2 08 00	 ret	 8
?set_3d_rain_wind@@YGXPAUVEC3D@@M@Z ENDP		; set_3d_rain_wind
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3drain.c
;	COMDAT ?invalidate_3d_rain@@YGXXZ
_TEXT	SEGMENT
_count$ = -4						; size = 4
?invalidate_3d_rain@@YGXXZ PROC				; invalidate_3d_rain, COMDAT

; 690  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 691  : 
; 692  : 	int
; 693  : 		count;
; 694  : 
; 695  : 	//
; 696  : 	// Go through tagging all the snow/raindrops as not in use
; 697  : 	//
; 698  : 
; 699  : 	for ( count = 0; count < TOTAL_3D_RAINDROPS; count++ )

  00009	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  00010	eb 09		 jmp	 SHORT $LN4@invalidate
$LN2@invalidate:
  00012	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  00015	83 c0 01	 add	 eax, 1
  00018	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@invalidate:
  0001b	81 7d fc 00 08
	00 00		 cmp	 DWORD PTR _count$[ebp], 2048 ; 00000800H
  00022	7d 10		 jge	 SHORT $LN3@invalidate

; 700  : 	{
; 701  : 
; 702  : 		rain_3d_drops[count].type = RAINDROP_INVALID;

  00024	6b 45 fc 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  00028	c7 80 18 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+24], 0

; 703  : 	}

  00032	eb de		 jmp	 SHORT $LN2@invalidate
$LN3@invalidate:

; 704  : 
; 705  : 	rain_3d_raindrops_valid = 0;

  00034	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?rain_3d_raindrops_valid@@3HA, 0

; 706  : 
; 707  : 	rain_3d_snowdrops_valid = 0;

  0003e	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?rain_3d_snowdrops_valid@@3HA, 0

; 708  : }

  00048	5f		 pop	 edi
  00049	5e		 pop	 esi
  0004a	5b		 pop	 ebx
  0004b	8b e5		 mov	 esp, ebp
  0004d	5d		 pop	 ebp
  0004e	c3		 ret	 0
?invalidate_3d_rain@@YGXXZ ENDP				; invalidate_3d_rain
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3drain.c
;	COMDAT ?set_3d_rain_special_snow_flag@@YGXH@Z
_TEXT	SEGMENT
_flag$ = 8						; size = 4
?set_3d_rain_special_snow_flag@@YGXH@Z PROC		; set_3d_rain_special_snow_flag, COMDAT

; 234  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 235  : 
; 236  : 	special_snow_flag = flag;

  00009	8b 45 08	 mov	 eax, DWORD PTR _flag$[ebp]
  0000c	a3 00 00 00 00	 mov	 DWORD PTR ?special_snow_flag@@3HA, eax

; 237  : }

  00011	5f		 pop	 edi
  00012	5e		 pop	 esi
  00013	5b		 pop	 ebx
  00014	8b e5		 mov	 esp, ebp
  00016	5d		 pop	 ebp
  00017	c2 04 00	 ret	 4
?set_3d_rain_special_snow_flag@@YGXH@Z ENDP		; set_3d_rain_special_snow_flag
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3drain.c
;	COMDAT ?set_3d_rain_speed@@YGXM@Z
_TEXT	SEGMENT
_speed$ = 8						; size = 4
?set_3d_rain_speed@@YGXM@Z PROC				; set_3d_rain_speed, COMDAT

; 224  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 225  : 
; 226  : 	rain_3d_speed = speed;

  00009	f3 0f 10 45 08	 movss	 xmm0, DWORD PTR _speed$[ebp]
  0000e	f3 0f 11 05 00
	00 00 00	 movss	 DWORD PTR ?rain_3d_speed@@3MA, xmm0

; 227  : }

  00016	5f		 pop	 edi
  00017	5e		 pop	 esi
  00018	5b		 pop	 ebx
  00019	8b e5		 mov	 esp, ebp
  0001b	5d		 pop	 ebp
  0001c	c2 04 00	 ret	 4
?set_3d_rain_speed@@YGXM@Z ENDP				; set_3d_rain_speed
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3drain.c
;	COMDAT ?set_3d_snow_texture@@YGXH@Z
_TEXT	SEGMENT
_snow_texture_index$ = 8				; size = 4
?set_3d_snow_texture@@YGXH@Z PROC			; set_3d_snow_texture, COMDAT

; 214  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 215  : 
; 216  : 	snow_3d_texture = system_textures[snow_texture_index];

  00009	8b 45 08	 mov	 eax, DWORD PTR _snow_texture_index$[ebp]
  0000c	8b 0c 85 00 00
	00 00		 mov	 ecx, DWORD PTR ?system_textures@@3PAPAUSCREEN@@A[eax*4]
  00013	89 0d 00 00 00
	00		 mov	 DWORD PTR ?snow_3d_texture@@3PAUSCREEN@@A, ecx

; 217  : }

  00019	5f		 pop	 edi
  0001a	5e		 pop	 esi
  0001b	5b		 pop	 ebx
  0001c	8b e5		 mov	 esp, ebp
  0001e	5d		 pop	 ebp
  0001f	c2 04 00	 ret	 4
?set_3d_snow_texture@@YGXH@Z ENDP			; set_3d_snow_texture
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\3drain.c
;	COMDAT ?initialise_3d_rain@@YGXMPAUVEC3D@@@Z
_TEXT	SEGMENT
_count$ = -4						; size = 4
_start_time$ = 8					; size = 4
_start_position$ = 12					; size = 4
?initialise_3d_rain@@YGXMPAUVEC3D@@@Z PROC		; initialise_3d_rain, COMDAT

; 170  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 171  : 
; 172  : 	int
; 173  : 		count;
; 174  : 
; 175  : 	time_rain_last_updated = start_time;

  00009	f3 0f 10 45 08	 movss	 xmm0, DWORD PTR _start_time$[ebp]
  0000e	f3 0f 11 05 00
	00 00 00	 movss	 DWORD PTR ?time_rain_last_updated@@3MA, xmm0

; 176  : 
; 177  : 	snow_particle_radius = 0.3;

  00016	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@3e99999a
  0001e	f3 0f 11 05 00
	00 00 00	 movss	 DWORD PTR ?snow_particle_radius@@3MA, xmm0

; 178  : 
; 179  : 	//
; 180  : 	// Set the number of raindrops allowed per weathermode.
; 181  : 	//
; 182  : 
; 183  : 	number_of_weather_particles_allowed[WEATHERMODE_DRY].number_of_raindrops = 0;

  00026	b8 08 00 00 00	 mov	 eax, 8
  0002b	c1 e0 00	 shl	 eax, 0
  0002e	c7 80 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?number_of_weather_particles_allowed@@3PAURAINDROP_SETTINGS@@A[eax], 0

; 184  : 	number_of_weather_particles_allowed[WEATHERMODE_DRY].number_of_snowdrops = 0;

  00038	b8 08 00 00 00	 mov	 eax, 8
  0003d	c1 e0 00	 shl	 eax, 0
  00040	c7 80 04 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?number_of_weather_particles_allowed@@3PAURAINDROP_SETTINGS@@A[eax+4], 0

; 185  : 
; 186  : 	number_of_weather_particles_allowed[WEATHERMODE_LIGHT_RAIN].number_of_raindrops = TOTAL_3D_RAINDROPS/2;

  0004a	b8 08 00 00 00	 mov	 eax, 8
  0004f	d1 e0		 shl	 eax, 1
  00051	c7 80 00 00 00
	00 00 04 00 00	 mov	 DWORD PTR ?number_of_weather_particles_allowed@@3PAURAINDROP_SETTINGS@@A[eax], 1024 ; 00000400H

; 187  : 	number_of_weather_particles_allowed[WEATHERMODE_LIGHT_RAIN].number_of_snowdrops = 0;

  0005b	b8 08 00 00 00	 mov	 eax, 8
  00060	d1 e0		 shl	 eax, 1
  00062	c7 80 04 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?number_of_weather_particles_allowed@@3PAURAINDROP_SETTINGS@@A[eax+4], 0

; 188  : 
; 189  : 	number_of_weather_particles_allowed[WEATHERMODE_HEAVY_RAIN].number_of_raindrops = TOTAL_3D_RAINDROPS;

  0006c	b8 08 00 00 00	 mov	 eax, 8
  00071	6b c8 03	 imul	 ecx, eax, 3
  00074	c7 81 00 00 00
	00 00 08 00 00	 mov	 DWORD PTR ?number_of_weather_particles_allowed@@3PAURAINDROP_SETTINGS@@A[ecx], 2048 ; 00000800H

; 190  : 	number_of_weather_particles_allowed[WEATHERMODE_HEAVY_RAIN].number_of_snowdrops = 0;

  0007e	b8 08 00 00 00	 mov	 eax, 8
  00083	6b c8 03	 imul	 ecx, eax, 3
  00086	c7 81 04 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?number_of_weather_particles_allowed@@3PAURAINDROP_SETTINGS@@A[ecx+4], 0

; 191  : 
; 192  : 	number_of_weather_particles_allowed[WEATHERMODE_SNOW].number_of_raindrops = 0;

  00090	b8 08 00 00 00	 mov	 eax, 8
  00095	c1 e0 02	 shl	 eax, 2
  00098	c7 80 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?number_of_weather_particles_allowed@@3PAURAINDROP_SETTINGS@@A[eax], 0

; 193  : 	number_of_weather_particles_allowed[WEATHERMODE_SNOW].number_of_snowdrops = TOTAL_3D_RAINDROPS/2;

  000a2	b8 08 00 00 00	 mov	 eax, 8
  000a7	c1 e0 02	 shl	 eax, 2
  000aa	c7 80 04 00 00
	00 00 04 00 00	 mov	 DWORD PTR ?number_of_weather_particles_allowed@@3PAURAINDROP_SETTINGS@@A[eax+4], 1024 ; 00000400H

; 194  : 
; 195  : 	//
; 196  : 	// Initialise all the raindrops to be invalid.
; 197  : 	//
; 198  : 
; 199  : 	rain_3d_raindrops_valid = 0;

  000b4	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?rain_3d_raindrops_valid@@3HA, 0

; 200  : 	rain_3d_snowdrops_valid = 0;

  000be	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?rain_3d_snowdrops_valid@@3HA, 0

; 201  : 
; 202  : 	for ( count = 0; count < TOTAL_3D_RAINDROPS; count++ )

  000c8	c7 45 fc 00 00
	00 00		 mov	 DWORD PTR _count$[ebp], 0
  000cf	eb 09		 jmp	 SHORT $LN4@initialise
$LN2@initialise:
  000d1	8b 45 fc	 mov	 eax, DWORD PTR _count$[ebp]
  000d4	83 c0 01	 add	 eax, 1
  000d7	89 45 fc	 mov	 DWORD PTR _count$[ebp], eax
$LN4@initialise:
  000da	81 7d fc 00 08
	00 00		 cmp	 DWORD PTR _count$[ebp], 2048 ; 00000800H
  000e1	7d 10		 jge	 SHORT $LN3@initialise

; 203  : 	{
; 204  : 
; 205  : 		rain_3d_drops[count].type = RAINDROP_INVALID;

  000e3	6b 45 fc 1c	 imul	 eax, DWORD PTR _count$[ebp], 28
  000e7	c7 80 18 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?rain_3d_drops@@3PAURAINDROP_INFORMATION@@A[eax+24], 0

; 206  : 	}

  000f1	eb de		 jmp	 SHORT $LN2@initialise
$LN3@initialise:

; 207  : }

  000f3	5f		 pop	 edi
  000f4	5e		 pop	 esi
  000f5	5b		 pop	 ebx
  000f6	8b e5		 mov	 esp, ebp
  000f8	5d		 pop	 ebp
  000f9	c2 08 00	 ret	 8
?initialise_3d_rain@@YGXMPAUVEC3D@@@Z ENDP		; initialise_3d_rain
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\graphics\viewport.h
;	COMDAT ?generate_lookup_outcode@@YGHHHHH@Z
_TEXT	SEGMENT
_xmin$ = 8						; size = 4
_ymin$ = 12						; size = 4
_xmax$ = 16						; size = 4
_ymax$ = 20						; size = 4
?generate_lookup_outcode@@YGHHHHH@Z PROC		; generate_lookup_outcode, COMDAT

; 199  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 200  : 
; 201  : 	__asm mov eax, xmin;

  00009	8b 45 08	 mov	 eax, DWORD PTR _xmin$[ebp]
  0000c	8b 5d 0c	 mov	 ebx, DWORD PTR _ymin$[ebp]
  0000f	8b 4d 10	 mov	 ecx, DWORD PTR _xmax$[ebp]
  00012	8b 55 14	 mov	 edx, DWORD PTR _ymax$[ebp]
  00015	c1 e8 1f	 shr	 eax, 31			; 0000001fH
  00018	81 e3 00 00 00
	80		 and	 ebx, -2147483648	; 80000000H
  0001e	c1 e9 1d	 shr	 ecx, 29			; 0000001dH
  00021	81 e2 00 00 00
	80		 and	 edx, -2147483648	; 80000000H
  00027	c1 eb 1e	 shr	 ebx, 30			; 0000001eH
  0002a	83 e0 01	 and	 eax, 1
  0002d	c1 ea 1c	 shr	 edx, 28			; 0000001cH
  00030	83 e1 04	 and	 ecx, 4
  00033	0b c3		 or	 eax, ebx
  00035	0b ca		 or	 ecx, edx
  00037	0b c1		 or	 eax, ecx
  00039	5f		 pop	 edi
  0003a	5e		 pop	 esi
  0003b	5b		 pop	 ebx
  0003c	8b e5		 mov	 esp, ebp
  0003e	5d		 pop	 ebp
  0003f	c2 10 00	 ret	 16			; 00000010H
?generate_lookup_outcode@@YGHHHHH@Z ENDP		; generate_lookup_outcode
_TEXT	ENDS
END
