; Listing generated by Microsoft (R) Optimizing Compiler Version 19.16.27045.0 

	TITLE	C:\Users\nhv90\Projects\eech\aphavoc\source\app3d\3d_snd.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRTD
INCLUDELIB OLDNAMES

PUBLIC	?play_application_main_scene_sound@@YGXXZ	; play_application_main_scene_sound
PUBLIC	?play_application_ui_sound@@YGXXZ		; play_application_ui_sound
PUBLIC	?__LINE__Var@?0??play_application_ui_sound@@YGXXZ@4JA ; `play_application_ui_sound'::`1'::__LINE__Var
PUBLIC	??_C@_0DL@MACLKFPM@c?3?2users?2nhv90?2projects?2eech?2ap@ ; `string'
EXTRN	?process_assert@@YGXPBD0H@Z:PROC		; process_assert
EXTRN	?scan_local_entity_sounds@@YGXPAUVIEWPOINT@@@Z:PROC ; scan_local_entity_sounds
EXTRN	?get_external_view_entity@@YGPAUENTITY@@XZ:PROC	; get_external_view_entity
EXTRN	?null_entity_pointer_message@@3PBDB:DWORD	; null_entity_pointer_message
EXTRN	?fn_get_local_entity_attitude_matrix@@3PAP6GXPAUENTITY@@QAY02M@ZA:BYTE ; fn_get_local_entity_attitude_matrix
EXTRN	?overload_invalid_vec3d_type_message@@3PBDB:DWORD ; overload_invalid_vec3d_type_message
EXTRN	?fn_get_local_entity_vec3d@@3PAY0BI@P6GXPAUENTITY@@W4VEC3D_TYPES@@PAUVEC3D@@@ZA:BYTE ; fn_get_local_entity_vec3d
EXTRN	?gunship_entity@@3PAUENTITY@@A:DWORD		; gunship_entity
EXTRN	?camera_entity@@3PAUENTITY@@A:DWORD		; camera_entity
EXTRN	?main_vp@@3UVIEWPOINT@@A:BYTE			; main_vp
EXTRN	?in_cockpit@@3HA:DWORD				; in_cockpit
;	COMDAT ??_C@_0DL@MACLKFPM@c?3?2users?2nhv90?2projects?2eech?2ap@
CONST	SEGMENT
??_C@_0DL@MACLKFPM@c?3?2users?2nhv90?2projects?2eech?2ap@ DB 'c:\users\nh'
	DB	'v90\projects\eech\aphavoc\source\app3d\3d_snd.c', 00H ; `string'
CONST	ENDS
;	COMDAT ?__LINE__Var@?0??play_application_ui_sound@@YGXXZ@4JA
_DATA	SEGMENT
?__LINE__Var@?0??play_application_ui_sound@@YGXXZ@4JA DD 054H ; `play_application_ui_sound'::`1'::__LINE__Var
_DATA	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\aphavoc\source\app3d\3d_snd.c
;	COMDAT ?play_application_ui_sound@@YGXXZ
_TEXT	SEGMENT
tv83 = -120						; size = 4
tv95 = -116						; size = 4
tv75 = -116						; size = 4
_vp$1 = -48						; size = 48
?play_application_ui_sound@@YGXXZ PROC			; play_application_ui_sound, COMDAT

; 84   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 78	 sub	 esp, 120		; 00000078H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 85   : 	//
; 86   : 	// if you're not in the cockpit of a valid gunship, and have an external view entity, play sounds from the camera viewpoint
; 87   : 	//
; 88   : 	
; 89   : 	if (!((in_cockpit) && (get_gunship_entity ())))

  00009	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?in_cockpit@@3HA, 0 ; in_cockpit
  00010	74 0d		 je	 SHORT $LN3@play_appli
  00012	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?gunship_entity@@3PAUENTITY@@A, 0 ; gunship_entity
  00019	0f 85 f8 00 00
	00		 jne	 $LN2@play_appli
$LN3@play_appli:

; 90   : 	{
; 91   : 		if ((get_external_view_entity ()) && (get_camera_entity ()))

  0001f	e8 00 00 00 00	 call	 ?get_external_view_entity@@YGPAUENTITY@@XZ ; get_external_view_entity
  00024	85 c0		 test	 eax, eax
  00026	0f 84 eb 00 00
	00		 je	 $LN2@play_appli
  0002c	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?camera_entity@@3PAUENTITY@@A, 0 ; camera_entity
  00033	0f 84 de 00 00
	00		 je	 $LN2@play_appli

; 92   : 		{
; 93   : 			viewpoint
; 94   : 				vp;
; 95   : 
; 96   : 		   get_local_entity_vec3d (get_camera_entity (), VEC3D_TYPE_POSITION, &vp.position);

  00039	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?camera_entity@@3PAUENTITY@@A, 0 ; camera_entity
  00040	74 0c		 je	 SHORT $LN6@play_appli
  00042	a1 00 00 00 00	 mov	 eax, DWORD PTR ?camera_entity@@3PAUENTITY@@A ; camera_entity
  00047	8b 08		 mov	 ecx, DWORD PTR [eax]
  00049	89 4d 8c	 mov	 DWORD PTR tv75[ebp], ecx
  0004c	eb 21		 jmp	 SHORT $LN7@play_appli
$LN6@play_appli:
  0004e	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?__LINE__Var@?0??play_application_ui_sound@@YGXXZ@4JA
  00054	83 c2 0c	 add	 edx, 12			; 0000000cH
  00057	52		 push	 edx
  00058	68 00 00 00 00	 push	 OFFSET ??_C@_0DL@MACLKFPM@c?3?2users?2nhv90?2projects?2eech?2ap@
  0005d	a1 00 00 00 00	 mov	 eax, DWORD PTR ?null_entity_pointer_message@@3PBDB ; null_entity_pointer_message
  00062	50		 push	 eax
  00063	e8 00 00 00 00	 call	 ?process_assert@@YGXPBD0H@Z ; process_assert
  00068	c7 45 8c 00 00
	00 00		 mov	 DWORD PTR tv75[ebp], 0
$LN7@play_appli:
  0006f	b9 01 00 00 00	 mov	 ecx, 1
  00074	85 c9		 test	 ecx, ecx
  00076	74 09		 je	 SHORT $LN8@play_appli
  00078	c7 45 88 08 00
	00 00		 mov	 DWORD PTR tv83[ebp], 8
  0007f	eb 21		 jmp	 SHORT $LN9@play_appli
$LN8@play_appli:
  00081	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?__LINE__Var@?0??play_application_ui_sound@@YGXXZ@4JA
  00087	83 c2 0c	 add	 edx, 12			; 0000000cH
  0008a	52		 push	 edx
  0008b	68 00 00 00 00	 push	 OFFSET ??_C@_0DL@MACLKFPM@c?3?2users?2nhv90?2projects?2eech?2ap@
  00090	a1 00 00 00 00	 mov	 eax, DWORD PTR ?overload_invalid_vec3d_type_message@@3PBDB ; overload_invalid_vec3d_type_message
  00095	50		 push	 eax
  00096	e8 00 00 00 00	 call	 ?process_assert@@YGXPBD0H@Z ; process_assert
  0009b	c7 45 88 00 00
	00 00		 mov	 DWORD PTR tv83[ebp], 0
$LN9@play_appli:
  000a2	8d 4d d0	 lea	 ecx, DWORD PTR _vp$1[ebp]
  000a5	51		 push	 ecx
  000a6	6a 08		 push	 8
  000a8	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?camera_entity@@3PAUENTITY@@A ; camera_entity
  000ae	52		 push	 edx
  000af	6b 45 8c 60	 imul	 eax, DWORD PTR tv75[ebp], 96
  000b3	8b 4d 88	 mov	 ecx, DWORD PTR tv83[ebp]
  000b6	8b 94 88 00 00
	00 00		 mov	 edx, DWORD PTR ?fn_get_local_entity_vec3d@@3PAY0BI@P6GXPAUENTITY@@W4VEC3D_TYPES@@PAUVEC3D@@@ZA[eax+ecx*4]
  000bd	ff d2		 call	 edx

; 97   : 
; 98   : 		   get_local_entity_attitude_matrix (get_camera_entity (), vp.attitude);

  000bf	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?camera_entity@@3PAUENTITY@@A, 0 ; camera_entity
  000c6	74 0c		 je	 SHORT $LN10@play_appli
  000c8	a1 00 00 00 00	 mov	 eax, DWORD PTR ?camera_entity@@3PAUENTITY@@A ; camera_entity
  000cd	8b 08		 mov	 ecx, DWORD PTR [eax]
  000cf	89 4d 8c	 mov	 DWORD PTR tv95[ebp], ecx
  000d2	eb 21		 jmp	 SHORT $LN11@play_appli
$LN10@play_appli:
  000d4	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?__LINE__Var@?0??play_application_ui_sound@@YGXXZ@4JA
  000da	83 c2 0e	 add	 edx, 14			; 0000000eH
  000dd	52		 push	 edx
  000de	68 00 00 00 00	 push	 OFFSET ??_C@_0DL@MACLKFPM@c?3?2users?2nhv90?2projects?2eech?2ap@
  000e3	a1 00 00 00 00	 mov	 eax, DWORD PTR ?null_entity_pointer_message@@3PBDB ; null_entity_pointer_message
  000e8	50		 push	 eax
  000e9	e8 00 00 00 00	 call	 ?process_assert@@YGXPBD0H@Z ; process_assert
  000ee	c7 45 8c 00 00
	00 00		 mov	 DWORD PTR tv95[ebp], 0
$LN11@play_appli:
  000f5	8d 4d dc	 lea	 ecx, DWORD PTR _vp$1[ebp+12]
  000f8	51		 push	 ecx
  000f9	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?camera_entity@@3PAUENTITY@@A ; camera_entity
  000ff	52		 push	 edx
  00100	8b 45 8c	 mov	 eax, DWORD PTR tv95[ebp]
  00103	8b 0c 85 00 00
	00 00		 mov	 ecx, DWORD PTR ?fn_get_local_entity_attitude_matrix@@3PAP6GXPAUENTITY@@QAY02M@ZA[eax*4]
  0010a	ff d1		 call	 ecx

; 99   : 
; 100  : 			scan_local_entity_sounds (&vp);

  0010c	8d 45 d0	 lea	 eax, DWORD PTR _vp$1[ebp]
  0010f	50		 push	 eax
  00110	e8 00 00 00 00	 call	 ?scan_local_entity_sounds@@YGXPAUVIEWPOINT@@@Z ; scan_local_entity_sounds

; 101  : 
; 102  : 			return;

  00115	eb 0a		 jmp	 SHORT $LN1@play_appli
$LN2@play_appli:

; 103  : 		}
; 104  : 	}
; 105  : 
; 106  : 	//
; 107  : 	// otherwise just use the main viewpoint
; 108  : 	//
; 109  : 
; 110  : 	scan_local_entity_sounds (&main_vp);

  00117	68 00 00 00 00	 push	 OFFSET ?main_vp@@3UVIEWPOINT@@A ; main_vp
  0011c	e8 00 00 00 00	 call	 ?scan_local_entity_sounds@@YGXPAUVIEWPOINT@@@Z ; scan_local_entity_sounds
$LN1@play_appli:

; 111  : }

  00121	5f		 pop	 edi
  00122	5e		 pop	 esi
  00123	5b		 pop	 ebx
  00124	8b e5		 mov	 esp, ebp
  00126	5d		 pop	 ebp
  00127	c3		 ret	 0
?play_application_ui_sound@@YGXXZ ENDP			; play_application_ui_sound
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\aphavoc\source\app3d\3d_snd.c
;	COMDAT ?play_application_main_scene_sound@@YGXXZ
_TEXT	SEGMENT
?play_application_main_scene_sound@@YGXXZ PROC		; play_application_main_scene_sound, COMDAT

; 74   : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 75   : 
; 76   : 	scan_local_entity_sounds (&main_vp);

  00009	68 00 00 00 00	 push	 OFFSET ?main_vp@@3UVIEWPOINT@@A ; main_vp
  0000e	e8 00 00 00 00	 call	 ?scan_local_entity_sounds@@YGXPAUVIEWPOINT@@@Z ; scan_local_entity_sounds

; 77   : }

  00013	5f		 pop	 edi
  00014	5e		 pop	 esi
  00015	5b		 pop	 ebx
  00016	8b e5		 mov	 esp, ebp
  00018	5d		 pop	 ebp
  00019	c3		 ret	 0
?play_application_main_scene_sound@@YGXXZ ENDP		; play_application_main_scene_sound
_TEXT	ENDS
END
