; Listing generated by Microsoft (R) Optimizing Compiler Version 19.16.27045.0 

	TITLE	C:\Users\nhv90\Projects\eech\modules\3d\terrain\terrsel.c
	.686P
	.XMM
	include listing.inc
	.model	flat

INCLUDELIB MSVCRTD
INCLUDELIB OLDNAMES

PUBLIC	?terrain_3d_simple_elevation_grid@@3PAMA	; terrain_3d_simple_elevation_grid
PUBLIC	?terrain_3d_simple_elevation_memory_mapped@@3HA	; terrain_3d_simple_elevation_memory_mapped
PUBLIC	?terrain_3d_simple_elevation_width@@3HA		; terrain_3d_simple_elevation_width
PUBLIC	?terrain_3d_simple_elevation_height@@3HA	; terrain_3d_simple_elevation_height
PUBLIC	?terrain_3d_simple_elevation_x_grid_size@@3MA	; terrain_3d_simple_elevation_x_grid_size
PUBLIC	?terrain_3d_simple_elevation_z_grid_size@@3MA	; terrain_3d_simple_elevation_z_grid_size
PUBLIC	?terrain_3d_simple_elevation_x_grid_size_reciprocal@@3MA ; terrain_3d_simple_elevation_x_grid_size_reciprocal
PUBLIC	?terrain_3d_simple_elevation_z_grid_size_reciprocal@@3MA ; terrain_3d_simple_elevation_z_grid_size_reciprocal
PUBLIC	?terrain_3d_simple_elevation_memory_map@@3PAEA	; terrain_3d_simple_elevation_memory_map
_BSS	SEGMENT
?terrain_3d_simple_elevation_grid@@3PAMA DD 01H DUP (?)	; terrain_3d_simple_elevation_grid
?terrain_3d_simple_elevation_memory_mapped@@3HA DD 01H DUP (?) ; terrain_3d_simple_elevation_memory_mapped
?terrain_3d_simple_elevation_width@@3HA DD 01H DUP (?)	; terrain_3d_simple_elevation_width
?terrain_3d_simple_elevation_height@@3HA DD 01H DUP (?)	; terrain_3d_simple_elevation_height
?terrain_3d_simple_elevation_x_grid_size@@3MA DD 01H DUP (?) ; terrain_3d_simple_elevation_x_grid_size
?terrain_3d_simple_elevation_z_grid_size@@3MA DD 01H DUP (?) ; terrain_3d_simple_elevation_z_grid_size
?terrain_3d_simple_elevation_x_grid_size_reciprocal@@3MA DD 01H DUP (?) ; terrain_3d_simple_elevation_x_grid_size_reciprocal
?terrain_3d_simple_elevation_z_grid_size_reciprocal@@3MA DD 01H DUP (?) ; terrain_3d_simple_elevation_z_grid_size_reciprocal
?terrain_3d_simple_elevation_memory_map@@3PAEA DD 01H DUP (?) ; terrain_3d_simple_elevation_memory_map
_BSS	ENDS
PUBLIC	?initialise_terrain_simple_elevation@@YGXXZ	; initialise_terrain_simple_elevation
PUBLIC	?get_3d_terrain_fast_elevation@@YGMMM@Z		; get_3d_terrain_fast_elevation
PUBLIC	?load_terrain_simple_elevation@@YGHPBD@Z	; load_terrain_simple_elevation
PUBLIC	?unload_terrain_simple_elevation_grid@@YGXXZ	; unload_terrain_simple_elevation_grid
PUBLIC	?generate_terrain_simple_elevation@@YGXM@Z	; generate_terrain_simple_elevation
PUBLIC	?save_terrain_simple_elevation@@YGXPBD@Z	; save_terrain_simple_elevation
PUBLIC	?display_terrain_simple_elevation_statistics@@YGXXZ ; display_terrain_simple_elevation_statistics
PUBLIC	??_C@_02GMLFBBN@wb@				; `string'
PUBLIC	??_C@_0CE@NOCLKO@num_simple_elevation_tests?5?5?5?5?5@ ; `string'
PUBLIC	__real@00000000
PUBLIC	__real@3f800000
PUBLIC	__real@3ff0000000000000
PUBLIC	__real@40000000
PUBLIC	__real@bf800000
PUBLIC	__real@bff0000000000000
PUBLIC	__real@c59c4000
EXTRN	__imp__fclose:PROC
EXTRN	__imp__fwrite:PROC
EXTRN	?convert_float_to_int@@YGXMPAH@Z:PROC		; convert_float_to_int
EXTRN	?debug_log@@YAXPBDZZ:PROC			; debug_log
EXTRN	?safe_malloc_memory@@YGPAXI@Z:PROC		; safe_malloc_memory
EXTRN	?safe_free@@YGXPAX@Z:PROC			; safe_free
EXTRN	?mopen@@YGPAXPBD@Z:PROC				; mopen
EXTRN	?safe_mclose@@YGHPAX@Z:PROC			; safe_mclose
EXTRN	?safe_fopen@@YGPAU_iobuf@@PBD0@Z:PROC		; safe_fopen
EXTRN	?get_3d_terrain_point_data@@YGMMMPAUTERRAIN_3D_POINT_DATA@@@Z:PROC ; get_3d_terrain_point_data
EXTRN	?get_3d_terrain_point_data_type@@YGHPAUTERRAIN_3D_POINT_DATA@@@Z:PROC ; get_3d_terrain_point_data_type
EXTRN	?check_coastal_river_intersection@@YGMMMMM@Z:PROC ; check_coastal_river_intersection
EXTRN	?terrain_3d_sector_x_max@@3HA:DWORD		; terrain_3d_sector_x_max
EXTRN	?terrain_3d_sector_z_max@@3HA:DWORD		; terrain_3d_sector_z_max
EXTRN	?terrain_3d_max_map_x@@3MA:DWORD		; terrain_3d_max_map_x
EXTRN	?terrain_3d_max_map_z@@3MA:DWORD		; terrain_3d_max_map_z
EXTRN	__fltused:DWORD
_BSS	SEGMENT
?num_simple_elevation_tests@@3HA DD 01H DUP (?)		; num_simple_elevation_tests
_BSS	ENDS
;	COMDAT __real@c59c4000
CONST	SEGMENT
__real@c59c4000 DD 0c59c4000r			; -5000
CONST	ENDS
;	COMDAT __real@bff0000000000000
CONST	SEGMENT
__real@bff0000000000000 DQ 0bff0000000000000r	; -1
CONST	ENDS
;	COMDAT __real@bf800000
CONST	SEGMENT
__real@bf800000 DD 0bf800000r			; -1
CONST	ENDS
;	COMDAT __real@40000000
CONST	SEGMENT
__real@40000000 DD 040000000r			; 2
CONST	ENDS
;	COMDAT __real@3ff0000000000000
CONST	SEGMENT
__real@3ff0000000000000 DQ 03ff0000000000000r	; 1
CONST	ENDS
;	COMDAT __real@3f800000
CONST	SEGMENT
__real@3f800000 DD 03f800000r			; 1
CONST	ENDS
;	COMDAT __real@00000000
CONST	SEGMENT
__real@00000000 DD 000000000r			; 0
CONST	ENDS
;	COMDAT ??_C@_0CE@NOCLKO@num_simple_elevation_tests?5?5?5?5?5@
CONST	SEGMENT
??_C@_0CE@NOCLKO@num_simple_elevation_tests?5?5?5?5?5@ DB 'num_simple_ele'
	DB	'vation_tests     = %d', 00H			; `string'
CONST	ENDS
;	COMDAT ??_C@_02GMLFBBN@wb@
CONST	SEGMENT
??_C@_02GMLFBBN@wb@ DB 'wb', 00H			; `string'
CONST	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrsel.c
;	COMDAT ?display_terrain_simple_elevation_statistics@@YGXXZ
_TEXT	SEGMENT
?display_terrain_simple_elevation_statistics@@YGXXZ PROC ; display_terrain_simple_elevation_statistics, COMDAT

; 619  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 620  : 	
; 621  : 	debug_log ( "num_simple_elevation_tests     = %d", num_simple_elevation_tests );

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?num_simple_elevation_tests@@3HA
  0000e	50		 push	 eax
  0000f	68 00 00 00 00	 push	 OFFSET ??_C@_0CE@NOCLKO@num_simple_elevation_tests?5?5?5?5?5@
  00014	e8 00 00 00 00	 call	 ?debug_log@@YAXPBDZZ	; debug_log
  00019	83 c4 08	 add	 esp, 8

; 622  : }

  0001c	5f		 pop	 edi
  0001d	5e		 pop	 esi
  0001e	5b		 pop	 ebx
  0001f	8b e5		 mov	 esp, ebp
  00021	5d		 pop	 ebp
  00022	c3		 ret	 0
?display_terrain_simple_elevation_statistics@@YGXXZ ENDP ; display_terrain_simple_elevation_statistics
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrsel.c
;	COMDAT ?save_terrain_simple_elevation@@YGXPBD@Z
_TEXT	SEGMENT
_fp$ = -4						; size = 4
_filename$ = 8						; size = 4
?save_terrain_simple_elevation@@YGXPBD@Z PROC		; save_terrain_simple_elevation, COMDAT

; 594  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 595  : 	
; 596  : 	FILE
; 597  : 		*fp;
; 598  : 	
; 599  : 	fp = safe_fopen ( filename, "wb" );

  00009	68 00 00 00 00	 push	 OFFSET ??_C@_02GMLFBBN@wb@
  0000e	8b 45 08	 mov	 eax, DWORD PTR _filename$[ebp]
  00011	50		 push	 eax
  00012	e8 00 00 00 00	 call	 ?safe_fopen@@YGPAU_iobuf@@PBD0@Z ; safe_fopen
  00017	89 45 fc	 mov	 DWORD PTR _fp$[ebp], eax

; 600  : 	
; 601  : 	fwrite ( &terrain_3d_simple_elevation_width, sizeof ( int ), 1, fp );

  0001a	8b 45 fc	 mov	 eax, DWORD PTR _fp$[ebp]
  0001d	50		 push	 eax
  0001e	6a 01		 push	 1
  00020	6a 04		 push	 4
  00022	68 00 00 00 00	 push	 OFFSET ?terrain_3d_simple_elevation_width@@3HA ; terrain_3d_simple_elevation_width
  00027	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__fwrite
  0002d	83 c4 10	 add	 esp, 16			; 00000010H

; 602  : 	
; 603  : 	fwrite ( &terrain_3d_simple_elevation_height, sizeof ( int ), 1, fp );

  00030	8b 45 fc	 mov	 eax, DWORD PTR _fp$[ebp]
  00033	50		 push	 eax
  00034	6a 01		 push	 1
  00036	6a 04		 push	 4
  00038	68 00 00 00 00	 push	 OFFSET ?terrain_3d_simple_elevation_height@@3HA ; terrain_3d_simple_elevation_height
  0003d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__fwrite
  00043	83 c4 10	 add	 esp, 16			; 00000010H

; 604  : 	
; 605  : 	fwrite ( &terrain_3d_simple_elevation_x_grid_size, sizeof ( float ), 1, fp );

  00046	8b 45 fc	 mov	 eax, DWORD PTR _fp$[ebp]
  00049	50		 push	 eax
  0004a	6a 01		 push	 1
  0004c	6a 04		 push	 4
  0004e	68 00 00 00 00	 push	 OFFSET ?terrain_3d_simple_elevation_x_grid_size@@3MA ; terrain_3d_simple_elevation_x_grid_size
  00053	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__fwrite
  00059	83 c4 10	 add	 esp, 16			; 00000010H

; 606  : 
; 607  : 	fwrite ( &terrain_3d_simple_elevation_z_grid_size, sizeof ( float ), 1, fp );

  0005c	8b 45 fc	 mov	 eax, DWORD PTR _fp$[ebp]
  0005f	50		 push	 eax
  00060	6a 01		 push	 1
  00062	6a 04		 push	 4
  00064	68 00 00 00 00	 push	 OFFSET ?terrain_3d_simple_elevation_z_grid_size@@3MA ; terrain_3d_simple_elevation_z_grid_size
  00069	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__fwrite
  0006f	83 c4 10	 add	 esp, 16			; 00000010H

; 608  : 	
; 609  : 	fwrite ( terrain_3d_simple_elevation_grid, sizeof ( float ), terrain_3d_simple_elevation_width * terrain_3d_simple_elevation_height, fp );

  00072	8b 45 fc	 mov	 eax, DWORD PTR _fp$[ebp]
  00075	50		 push	 eax
  00076	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_simple_elevation_width@@3HA ; terrain_3d_simple_elevation_width
  0007c	0f af 0d 00 00
	00 00		 imul	 ecx, DWORD PTR ?terrain_3d_simple_elevation_height@@3HA ; terrain_3d_simple_elevation_height
  00083	51		 push	 ecx
  00084	6a 04		 push	 4
  00086	8b 15 00 00 00
	00		 mov	 edx, DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA ; terrain_3d_simple_elevation_grid
  0008c	52		 push	 edx
  0008d	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__fwrite
  00093	83 c4 10	 add	 esp, 16			; 00000010H

; 610  : 	
; 611  : 	fclose ( fp );

  00096	8b 45 fc	 mov	 eax, DWORD PTR _fp$[ebp]
  00099	50		 push	 eax
  0009a	ff 15 00 00 00
	00		 call	 DWORD PTR __imp__fclose
  000a0	83 c4 04	 add	 esp, 4

; 612  : }

  000a3	5f		 pop	 edi
  000a4	5e		 pop	 esi
  000a5	5b		 pop	 ebx
  000a6	8b e5		 mov	 esp, ebp
  000a8	5d		 pop	 ebp
  000a9	c2 04 00	 ret	 4
?save_terrain_simple_elevation@@YGXPBD@Z ENDP		; save_terrain_simple_elevation
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrsel.c
;	COMDAT ?generate_terrain_simple_elevation@@YGXM@Z
_TEXT	SEGMENT
tv147 = -156						; size = 4
tv143 = -156						; size = 4
tv155 = -152						; size = 4
tv148 = -152						; size = 4
tv144 = -152						; size = 4
_z1$1 = -84						; size = 4
_x1$2 = -80						; size = 4
_t$3 = -76						; size = 4
_checked$4 = -72					; size = 4
_height2$5 = -68					; size = 4
_height1$6 = -64					; size = 4
_type$7 = -60						; size = 4
_height$8 = -56						; size = 4
_z$9 = -52						; size = 4
_x$10 = -48						; size = 4
_elevations$11 = -44					; size = 4
_sea_height$ = -40					; size = 4
_z_elevation_grid_size$ = -36				; size = 4
_x_elevation_grid_size$ = -32				; size = 4
_z_rounded$ = -28					; size = 4
_x_rounded$ = -24					; size = 4
_power$ = -20						; size = 4
_z_grid$ = -16						; size = 4
_x_grid$ = -12						; size = 4
_z_size$ = -8						; size = 4
_x_size$ = -4						; size = 4
_elevation_grid_size$ = 8				; size = 4
?generate_terrain_simple_elevation@@YGXM@Z PROC		; generate_terrain_simple_elevation, COMDAT

; 258  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	81 ec 9c 00 00
	00		 sub	 esp, 156		; 0000009cH
  00009	53		 push	 ebx
  0000a	56		 push	 esi
  0000b	57		 push	 edi

; 259  : 	
; 260  : 	int
; 261  : 		x_size,
; 262  : 		z_size,
; 263  : 		x_grid,
; 264  : 		z_grid;
; 265  : 
; 266  : 	int
; 267  : 		power,
; 268  : 		x_rounded,
; 269  : 		z_rounded;
; 270  : 
; 271  : 	float
; 272  : 		x_elevation_grid_size,
; 273  : 		z_elevation_grid_size,
; 274  : 		sea_height;
; 275  : 	
; 276  : 	unload_terrain_simple_elevation_grid ();

  0000c	e8 00 00 00 00	 call	 ?unload_terrain_simple_elevation_grid@@YGXXZ ; unload_terrain_simple_elevation_grid

; 277  : 	
; 278  : 	//
; 279  : 	// Figure out the dimensions of the array.
; 280  : 	//
; 281  : 	
; 282  : 	x_size = ( ( terrain_3d_sector_x_max * TERRAIN_3D_SECTOR_SIDE_LENGTH ) / elevation_grid_size );

  00011	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_x_max@@3HA ; terrain_3d_sector_x_max
  00016	c1 e0 0b	 shl	 eax, 11			; 0000000bH
  00019	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  0001d	f3 0f 5e 45 08	 divss	 xmm0, DWORD PTR _elevation_grid_size$[ebp]
  00022	f3 0f 2c c8	 cvttss2si ecx, xmm0
  00026	89 4d fc	 mov	 DWORD PTR _x_size$[ebp], ecx

; 283  : 	
; 284  : 	z_size = ( ( terrain_3d_sector_z_max * TERRAIN_3D_SECTOR_SIDE_LENGTH ) / elevation_grid_size );

  00029	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_z_max@@3HA ; terrain_3d_sector_z_max
  0002e	c1 e0 0b	 shl	 eax, 11			; 0000000bH
  00031	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  00035	f3 0f 5e 45 08	 divss	 xmm0, DWORD PTR _elevation_grid_size$[ebp]
  0003a	f3 0f 2c c8	 cvttss2si ecx, xmm0
  0003e	89 4d f8	 mov	 DWORD PTR _z_size$[ebp], ecx

; 285  : 
; 286  : 	//
; 287  : 	// Round them to the nearest power of 2
; 288  : 	//
; 289  : 
; 290  : 	x_rounded = z_rounded = FALSE;

  00041	c7 45 e4 00 00
	00 00		 mov	 DWORD PTR _z_rounded$[ebp], 0
  00048	8b 45 e4	 mov	 eax, DWORD PTR _z_rounded$[ebp]
  0004b	89 45 e8	 mov	 DWORD PTR _x_rounded$[ebp], eax

; 291  : 
; 292  : 	for ( power = 2; power < 32768; power *= 2 )

  0004e	c7 45 ec 02 00
	00 00		 mov	 DWORD PTR _power$[ebp], 2
  00055	eb 08		 jmp	 SHORT $LN4@generate_t
$LN2@generate_t:
  00057	8b 45 ec	 mov	 eax, DWORD PTR _power$[ebp]
  0005a	d1 e0		 shl	 eax, 1
  0005c	89 45 ec	 mov	 DWORD PTR _power$[ebp], eax
$LN4@generate_t:
  0005f	81 7d ec 00 80
	00 00		 cmp	 DWORD PTR _power$[ebp], 32768 ; 00008000H
  00066	7d 48		 jge	 SHORT $LN3@generate_t

; 293  : 	{
; 294  : 
; 295  : 		if ( !x_rounded )

  00068	83 7d e8 00	 cmp	 DWORD PTR _x_rounded$[ebp], 0
  0006c	75 1d		 jne	 SHORT $LN26@generate_t

; 296  : 		{
; 297  : 
; 298  : 			if ( ( x_size == power ) || ( x_size < power ) )

  0006e	8b 45 fc	 mov	 eax, DWORD PTR _x_size$[ebp]
  00071	3b 45 ec	 cmp	 eax, DWORD PTR _power$[ebp]
  00074	74 08		 je	 SHORT $LN27@generate_t
  00076	8b 45 fc	 mov	 eax, DWORD PTR _x_size$[ebp]
  00079	3b 45 ec	 cmp	 eax, DWORD PTR _power$[ebp]
  0007c	7d 0d		 jge	 SHORT $LN26@generate_t
$LN27@generate_t:

; 299  : 			{
; 300  : 
; 301  : 				x_size = power;

  0007e	8b 45 ec	 mov	 eax, DWORD PTR _power$[ebp]
  00081	89 45 fc	 mov	 DWORD PTR _x_size$[ebp], eax

; 302  : 
; 303  : 				x_rounded = TRUE;

  00084	c7 45 e8 01 00
	00 00		 mov	 DWORD PTR _x_rounded$[ebp], 1
$LN26@generate_t:

; 304  : 			}
; 305  : 		}
; 306  : 
; 307  : 		if ( !z_rounded )

  0008b	83 7d e4 00	 cmp	 DWORD PTR _z_rounded$[ebp], 0
  0008f	75 1d		 jne	 SHORT $LN29@generate_t

; 308  : 		{
; 309  : 
; 310  : 			if ( ( z_size == power ) || ( z_size < power ) )

  00091	8b 45 f8	 mov	 eax, DWORD PTR _z_size$[ebp]
  00094	3b 45 ec	 cmp	 eax, DWORD PTR _power$[ebp]
  00097	74 08		 je	 SHORT $LN30@generate_t
  00099	8b 45 f8	 mov	 eax, DWORD PTR _z_size$[ebp]
  0009c	3b 45 ec	 cmp	 eax, DWORD PTR _power$[ebp]
  0009f	7d 0d		 jge	 SHORT $LN29@generate_t
$LN30@generate_t:

; 311  : 			{
; 312  : 
; 313  : 				z_size = power;

  000a1	8b 45 ec	 mov	 eax, DWORD PTR _power$[ebp]
  000a4	89 45 f8	 mov	 DWORD PTR _z_size$[ebp], eax

; 314  : 
; 315  : 				z_rounded = TRUE;

  000a7	c7 45 e4 01 00
	00 00		 mov	 DWORD PTR _z_rounded$[ebp], 1
$LN29@generate_t:

; 316  : 			}
; 317  : 		}
; 318  : 	}

  000ae	eb a7		 jmp	 SHORT $LN2@generate_t
$LN3@generate_t:

; 319  : 
; 320  : 	x_elevation_grid_size = ( terrain_3d_sector_x_max * TERRAIN_3D_SECTOR_SIDE_LENGTH ) / x_size;

  000b0	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_x_max@@3HA ; terrain_3d_sector_x_max
  000b5	c1 e0 0b	 shl	 eax, 11			; 0000000bH
  000b8	99		 cdq
  000b9	f7 7d fc	 idiv	 DWORD PTR _x_size$[ebp]
  000bc	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  000c0	f3 0f 11 45 e0	 movss	 DWORD PTR _x_elevation_grid_size$[ebp], xmm0

; 321  : 
; 322  : 	z_elevation_grid_size = ( terrain_3d_sector_z_max * TERRAIN_3D_SECTOR_SIDE_LENGTH ) / z_size;

  000c5	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_sector_z_max@@3HA ; terrain_3d_sector_z_max
  000ca	c1 e0 0b	 shl	 eax, 11			; 0000000bH
  000cd	99		 cdq
  000ce	f7 7d f8	 idiv	 DWORD PTR _z_size$[ebp]
  000d1	f3 0f 2a c0	 cvtsi2ss xmm0, eax
  000d5	f3 0f 11 45 dc	 movss	 DWORD PTR _z_elevation_grid_size$[ebp], xmm0

; 323  : 
; 324  : 	x_size++;

  000da	8b 45 fc	 mov	 eax, DWORD PTR _x_size$[ebp]
  000dd	83 c0 01	 add	 eax, 1
  000e0	89 45 fc	 mov	 DWORD PTR _x_size$[ebp], eax

; 325  : 
; 326  : 	z_size++;

  000e3	8b 45 f8	 mov	 eax, DWORD PTR _z_size$[ebp]
  000e6	83 c0 01	 add	 eax, 1
  000e9	89 45 f8	 mov	 DWORD PTR _z_size$[ebp], eax

; 327  : 	
; 328  : 	terrain_3d_simple_elevation_grid = ( float * ) safe_malloc ( x_size * z_size * sizeof ( float ) );

  000ec	8b 45 fc	 mov	 eax, DWORD PTR _x_size$[ebp]
  000ef	0f af 45 f8	 imul	 eax, DWORD PTR _z_size$[ebp]
  000f3	c1 e0 02	 shl	 eax, 2
  000f6	50		 push	 eax
  000f7	e8 00 00 00 00	 call	 ?safe_malloc_memory@@YGPAXI@Z ; safe_malloc_memory
  000fc	a3 00 00 00 00	 mov	 DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA, eax ; terrain_3d_simple_elevation_grid

; 329  : 	
; 330  : 	terrain_3d_simple_elevation_width = x_size;

  00101	8b 45 fc	 mov	 eax, DWORD PTR _x_size$[ebp]
  00104	a3 00 00 00 00	 mov	 DWORD PTR ?terrain_3d_simple_elevation_width@@3HA, eax ; terrain_3d_simple_elevation_width

; 331  : 	
; 332  : 	terrain_3d_simple_elevation_height = z_size;

  00109	8b 45 f8	 mov	 eax, DWORD PTR _z_size$[ebp]
  0010c	a3 00 00 00 00	 mov	 DWORD PTR ?terrain_3d_simple_elevation_height@@3HA, eax ; terrain_3d_simple_elevation_height

; 333  : 	
; 334  : 	terrain_3d_simple_elevation_x_grid_size = x_elevation_grid_size;

  00111	f3 0f 10 45 e0	 movss	 xmm0, DWORD PTR _x_elevation_grid_size$[ebp]
  00116	f3 0f 11 05 00
	00 00 00	 movss	 DWORD PTR ?terrain_3d_simple_elevation_x_grid_size@@3MA, xmm0

; 335  : 
; 336  : 	terrain_3d_simple_elevation_z_grid_size = z_elevation_grid_size;

  0011e	f3 0f 10 45 dc	 movss	 xmm0, DWORD PTR _z_elevation_grid_size$[ebp]
  00123	f3 0f 11 05 00
	00 00 00	 movss	 DWORD PTR ?terrain_3d_simple_elevation_z_grid_size@@3MA, xmm0

; 337  : 	
; 338  : 	terrain_3d_simple_elevation_x_grid_size_reciprocal = 1.0 / terrain_3d_simple_elevation_x_grid_size;

  0012b	f3 0f 5a 05 00
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?terrain_3d_simple_elevation_x_grid_size@@3MA
  00133	f2 0f 10 0d 00
	00 00 00	 movsd	 xmm1, QWORD PTR __real@3ff0000000000000
  0013b	f2 0f 5e c8	 divsd	 xmm1, xmm0
  0013f	f2 0f 5a c1	 cvtsd2ss xmm0, xmm1
  00143	f3 0f 11 05 00
	00 00 00	 movss	 DWORD PTR ?terrain_3d_simple_elevation_x_grid_size_reciprocal@@3MA, xmm0

; 339  : 
; 340  : 	terrain_3d_simple_elevation_z_grid_size_reciprocal = 1.0 / terrain_3d_simple_elevation_z_grid_size;

  0014b	f3 0f 5a 05 00
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?terrain_3d_simple_elevation_z_grid_size@@3MA
  00153	f2 0f 10 0d 00
	00 00 00	 movsd	 xmm1, QWORD PTR __real@3ff0000000000000
  0015b	f2 0f 5e c8	 divsd	 xmm1, xmm0
  0015f	f2 0f 5a c1	 cvtsd2ss xmm0, xmm1
  00163	f3 0f 11 05 00
	00 00 00	 movss	 DWORD PTR ?terrain_3d_simple_elevation_z_grid_size_reciprocal@@3MA, xmm0

; 341  : 	
; 342  : 	for ( z_grid = 0; z_grid < z_size; z_grid++ )

  0016b	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _z_grid$[ebp], 0
  00172	eb 09		 jmp	 SHORT $LN7@generate_t
$LN5@generate_t:
  00174	8b 45 f0	 mov	 eax, DWORD PTR _z_grid$[ebp]
  00177	83 c0 01	 add	 eax, 1
  0017a	89 45 f0	 mov	 DWORD PTR _z_grid$[ebp], eax
$LN7@generate_t:
  0017d	8b 45 f0	 mov	 eax, DWORD PTR _z_grid$[ebp]
  00180	3b 45 f8	 cmp	 eax, DWORD PTR _z_size$[ebp]
  00183	0f 8d a0 01 00
	00		 jge	 $LN6@generate_t

; 343  : 	{
; 344  : 		
; 345  : 		float
; 346  : 			*elevations;
; 347  : 		
; 348  : 		elevations = terrain_3d_simple_elevation_grid + ( z_grid * x_size );

  00189	8b 45 f0	 mov	 eax, DWORD PTR _z_grid$[ebp]
  0018c	0f af 45 fc	 imul	 eax, DWORD PTR _x_size$[ebp]
  00190	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA ; terrain_3d_simple_elevation_grid
  00196	8d 14 81	 lea	 edx, DWORD PTR [ecx+eax*4]
  00199	89 55 d4	 mov	 DWORD PTR _elevations$11[ebp], edx

; 349  : 		
; 350  : 		for ( x_grid = 0; x_grid < x_size; x_grid++ )

  0019c	c7 45 f4 00 00
	00 00		 mov	 DWORD PTR _x_grid$[ebp], 0
  001a3	eb 09		 jmp	 SHORT $LN10@generate_t
$LN8@generate_t:
  001a5	8b 45 f4	 mov	 eax, DWORD PTR _x_grid$[ebp]
  001a8	83 c0 01	 add	 eax, 1
  001ab	89 45 f4	 mov	 DWORD PTR _x_grid$[ebp], eax
$LN10@generate_t:
  001ae	8b 45 f4	 mov	 eax, DWORD PTR _x_grid$[ebp]
  001b1	3b 45 fc	 cmp	 eax, DWORD PTR _x_size$[ebp]
  001b4	0f 8d 6a 01 00
	00		 jge	 $LN9@generate_t

; 351  : 		{
; 352  : 			
; 353  : 			float
; 354  : 				x,
; 355  : 				z,
; 356  : 				height;
; 357  : 
; 358  : 			terrain_types
; 359  : 				type;
; 360  : 			
; 361  : 			x = x_grid * x_elevation_grid_size;

  001ba	f3 0f 2a 45 f4	 cvtsi2ss xmm0, DWORD PTR _x_grid$[ebp]
  001bf	f3 0f 59 45 e0	 mulss	 xmm0, DWORD PTR _x_elevation_grid_size$[ebp]
  001c4	f3 0f 11 45 d0	 movss	 DWORD PTR _x$10[ebp], xmm0

; 362  : 			z = z_grid * z_elevation_grid_size;

  001c9	f3 0f 2a 45 f0	 cvtsi2ss xmm0, DWORD PTR _z_grid$[ebp]
  001ce	f3 0f 59 45 dc	 mulss	 xmm0, DWORD PTR _z_elevation_grid_size$[ebp]
  001d3	f3 0f 11 45 cc	 movss	 DWORD PTR _z$9[ebp], xmm0

; 363  : 
; 364  : 			x = bound ( x, 0, terrain_3d_max_map_x );

  001d8	0f 57 c0	 xorps	 xmm0, xmm0
  001db	0f 2f 45 d0	 comiss	 xmm0, DWORD PTR _x$10[ebp]
  001df	76 0d		 jbe	 SHORT $LN58@generate_t
  001e1	0f 57 c0	 xorps	 xmm0, xmm0
  001e4	f3 0f 11 85 68
	ff ff ff	 movss	 DWORD PTR tv144[ebp], xmm0
  001ec	eb 3d		 jmp	 SHORT $LN59@generate_t
$LN58@generate_t:
  001ee	f3 0f 10 45 d0	 movss	 xmm0, DWORD PTR _x$10[ebp]
  001f3	0f 2f 05 00 00
	00 00		 comiss	 xmm0, DWORD PTR ?terrain_3d_max_map_x@@3MA
  001fa	76 12		 jbe	 SHORT $LN56@generate_t
  001fc	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR ?terrain_3d_max_map_x@@3MA
  00204	f3 0f 11 85 64
	ff ff ff	 movss	 DWORD PTR tv143[ebp], xmm0
  0020c	eb 0d		 jmp	 SHORT $LN57@generate_t
$LN56@generate_t:
  0020e	f3 0f 10 45 d0	 movss	 xmm0, DWORD PTR _x$10[ebp]
  00213	f3 0f 11 85 64
	ff ff ff	 movss	 DWORD PTR tv143[ebp], xmm0
$LN57@generate_t:
  0021b	f3 0f 10 85 64
	ff ff ff	 movss	 xmm0, DWORD PTR tv143[ebp]
  00223	f3 0f 11 85 68
	ff ff ff	 movss	 DWORD PTR tv144[ebp], xmm0
$LN59@generate_t:
  0022b	f3 0f 10 85 68
	ff ff ff	 movss	 xmm0, DWORD PTR tv144[ebp]
  00233	f3 0f 11 45 d0	 movss	 DWORD PTR _x$10[ebp], xmm0

; 365  : 			z = bound ( z, 0, terrain_3d_max_map_z );

  00238	0f 57 c0	 xorps	 xmm0, xmm0
  0023b	0f 2f 45 cc	 comiss	 xmm0, DWORD PTR _z$9[ebp]
  0023f	76 0d		 jbe	 SHORT $LN62@generate_t
  00241	0f 57 c0	 xorps	 xmm0, xmm0
  00244	f3 0f 11 85 68
	ff ff ff	 movss	 DWORD PTR tv148[ebp], xmm0
  0024c	eb 3d		 jmp	 SHORT $LN63@generate_t
$LN62@generate_t:
  0024e	f3 0f 10 45 cc	 movss	 xmm0, DWORD PTR _z$9[ebp]
  00253	0f 2f 05 00 00
	00 00		 comiss	 xmm0, DWORD PTR ?terrain_3d_max_map_z@@3MA
  0025a	76 12		 jbe	 SHORT $LN60@generate_t
  0025c	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR ?terrain_3d_max_map_z@@3MA
  00264	f3 0f 11 85 64
	ff ff ff	 movss	 DWORD PTR tv147[ebp], xmm0
  0026c	eb 0d		 jmp	 SHORT $LN61@generate_t
$LN60@generate_t:
  0026e	f3 0f 10 45 cc	 movss	 xmm0, DWORD PTR _z$9[ebp]
  00273	f3 0f 11 85 64
	ff ff ff	 movss	 DWORD PTR tv147[ebp], xmm0
$LN61@generate_t:
  0027b	f3 0f 10 85 64
	ff ff ff	 movss	 xmm0, DWORD PTR tv147[ebp]
  00283	f3 0f 11 85 68
	ff ff ff	 movss	 DWORD PTR tv148[ebp], xmm0
$LN63@generate_t:
  0028b	f3 0f 10 85 68
	ff ff ff	 movss	 xmm0, DWORD PTR tv148[ebp]
  00293	f3 0f 11 45 cc	 movss	 DWORD PTR _z$9[ebp], xmm0

; 366  : 
; 367  : 			height = get_3d_terrain_elevation ( x, z );

  00298	6a 00		 push	 0
  0029a	51		 push	 ecx
  0029b	f3 0f 10 45 cc	 movss	 xmm0, DWORD PTR _z$9[ebp]
  002a0	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  002a5	51		 push	 ecx
  002a6	f3 0f 10 45 d0	 movss	 xmm0, DWORD PTR _x$10[ebp]
  002ab	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  002b0	e8 00 00 00 00	 call	 ?get_3d_terrain_point_data@@YGMMMPAUTERRAIN_3D_POINT_DATA@@@Z ; get_3d_terrain_point_data
  002b5	d9 5d c8	 fstp	 DWORD PTR _height$8[ebp]

; 368  : 
; 369  : 			//
; 370  : 			// Find if sea or not
; 371  : 			//
; 372  : 
; 373  : 			type = get_3d_terrain_point_data_type ( NULL );

  002b8	6a 00		 push	 0
  002ba	e8 00 00 00 00	 call	 ?get_3d_terrain_point_data_type@@YGHPAUTERRAIN_3D_POINT_DATA@@@Z ; get_3d_terrain_point_data_type
  002bf	89 45 c4	 mov	 DWORD PTR _type$7[ebp], eax

; 374  : 
; 375  : 			switch ( type )

  002c2	8b 45 c4	 mov	 eax, DWORD PTR _type$7[ebp]
  002c5	89 85 68 ff ff
	ff		 mov	 DWORD PTR tv155[ebp], eax
  002cb	83 bd 68 ff ff
	ff 07		 cmp	 DWORD PTR tv155[ebp], 7
  002d2	74 02		 je	 SHORT $LN31@generate_t
  002d4	eb 0f		 jmp	 SHORT $LN32@generate_t
$LN31@generate_t:

; 376  : 			{
; 377  : 
; 378  : 				case TERRAIN_TYPE_SEA:
; 379  : 				{
; 380  : 
; 381  : 					height = -5000;

  002d6	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@c59c4000
  002de	f3 0f 11 45 c8	 movss	 DWORD PTR _height$8[ebp], xmm0

; 382  : 
; 383  : 					break;

  002e3	eb 12		 jmp	 SHORT $LN11@generate_t
$LN32@generate_t:

; 384  : 				}
; 385  : 
; 386  : 				default:
; 387  : 				{
; 388  : 
; 389  : 					height += 2;

  002e5	f3 0f 10 45 c8	 movss	 xmm0, DWORD PTR _height$8[ebp]
  002ea	f3 0f 58 05 00
	00 00 00	 addss	 xmm0, DWORD PTR __real@40000000
  002f2	f3 0f 11 45 c8	 movss	 DWORD PTR _height$8[ebp], xmm0
$LN11@generate_t:

; 390  : 				}
; 391  : 			}
; 392  : 
; 393  : 			if ( type == TERRAIN_TYPE_SEA )

  002f7	83 7d c4 07	 cmp	 DWORD PTR _type$7[ebp], 7
  002fb	75 0d		 jne	 SHORT $LN33@generate_t

; 394  : //			if ( ( type == TERRAIN_TYPE_SEA ) || ( type == TERRAIN_TYPE_BEACH ) )
; 395  : 			{
; 396  : 
; 397  : 				height = -5000;

  002fd	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@c59c4000
  00305	f3 0f 11 45 c8	 movss	 DWORD PTR _height$8[ebp], xmm0
$LN33@generate_t:

; 398  : 			}
; 399  : 			
; 400  : 			*elevations++ = height;

  0030a	8b 45 d4	 mov	 eax, DWORD PTR _elevations$11[ebp]
  0030d	f3 0f 10 45 c8	 movss	 xmm0, DWORD PTR _height$8[ebp]
  00312	f3 0f 11 00	 movss	 DWORD PTR [eax], xmm0
  00316	8b 4d d4	 mov	 ecx, DWORD PTR _elevations$11[ebp]
  00319	83 c1 04	 add	 ecx, 4
  0031c	89 4d d4	 mov	 DWORD PTR _elevations$11[ebp], ecx

; 401  : 		}

  0031f	e9 81 fe ff ff	 jmp	 $LN8@generate_t
$LN9@generate_t:

; 402  : 	}

  00324	e9 4b fe ff ff	 jmp	 $LN5@generate_t
$LN6@generate_t:

; 403  : 
; 404  : 	//
; 405  : 	// Now go through detecting the coast line
; 406  : 	//
; 407  : 
; 408  : 	sea_height = -1;

  00329	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@bf800000
  00331	f3 0f 11 45 d8	 movss	 DWORD PTR _sea_height$[ebp], xmm0

; 409  : 
; 410  : 	for ( z_grid = 0; z_grid < z_size; z_grid++ )

  00336	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _z_grid$[ebp], 0
  0033d	eb 09		 jmp	 SHORT $LN15@generate_t
$LN13@generate_t:
  0033f	8b 45 f0	 mov	 eax, DWORD PTR _z_grid$[ebp]
  00342	83 c0 01	 add	 eax, 1
  00345	89 45 f0	 mov	 DWORD PTR _z_grid$[ebp], eax
$LN15@generate_t:
  00348	8b 45 f0	 mov	 eax, DWORD PTR _z_grid$[ebp]
  0034b	3b 45 f8	 cmp	 eax, DWORD PTR _z_size$[ebp]
  0034e	0f 8d 8f 05 00
	00		 jge	 $LN14@generate_t

; 411  : 	{
; 412  : 		
; 413  : 		for ( x_grid = 0; x_grid < x_size; x_grid++ )

  00354	c7 45 f4 00 00
	00 00		 mov	 DWORD PTR _x_grid$[ebp], 0
  0035b	eb 09		 jmp	 SHORT $LN18@generate_t
$LN16@generate_t:
  0035d	8b 45 f4	 mov	 eax, DWORD PTR _x_grid$[ebp]
  00360	83 c0 01	 add	 eax, 1
  00363	89 45 f4	 mov	 DWORD PTR _x_grid$[ebp], eax
$LN18@generate_t:
  00366	8b 45 f4	 mov	 eax, DWORD PTR _x_grid$[ebp]
  00369	3b 45 fc	 cmp	 eax, DWORD PTR _x_size$[ebp]
  0036c	0f 8d 6c 05 00
	00		 jge	 $LN17@generate_t

; 414  : 		{
; 415  : 
; 416  : 			float
; 417  : 				height1,
; 418  : 				height2;
; 419  : 
; 420  : 			height1 = terrain_3d_simple_elevation_grid[((z_grid*x_size)+x_grid)];

  00372	8b 45 f0	 mov	 eax, DWORD PTR _z_grid$[ebp]
  00375	0f af 45 fc	 imul	 eax, DWORD PTR _x_size$[ebp]
  00379	03 45 f4	 add	 eax, DWORD PTR _x_grid$[ebp]
  0037c	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA ; terrain_3d_simple_elevation_grid
  00382	f3 0f 10 04 81	 movss	 xmm0, DWORD PTR [ecx+eax*4]
  00387	f3 0f 11 45 c0	 movss	 DWORD PTR _height1$6[ebp], xmm0

; 421  : 
; 422  : 			if ( height1 == -5000 )

  0038c	f3 0f 10 45 c0	 movss	 xmm0, DWORD PTR _height1$6[ebp]
  00391	0f 2e 05 00 00
	00 00		 ucomiss xmm0, DWORD PTR __real@c59c4000
  00398	9f		 lahf
  00399	f6 c4 44	 test	 ah, 68			; 00000044H
  0039c	0f 8a 37 05 00
	00		 jp	 $LN53@generate_t

; 423  : 			{
; 424  : 
; 425  : 				int
; 426  : 					checked;
; 427  : 
; 428  : 				float
; 429  : 					t,
; 430  : 					x1,
; 431  : 					z1;
; 432  : 
; 433  : 				checked = FALSE;

  003a2	c7 45 b8 00 00
	00 00		 mov	 DWORD PTR _checked$4[ebp], 0

; 434  : 
; 435  : 				x1 = x_grid * x_elevation_grid_size;

  003a9	f3 0f 2a 45 f4	 cvtsi2ss xmm0, DWORD PTR _x_grid$[ebp]
  003ae	f3 0f 59 45 e0	 mulss	 xmm0, DWORD PTR _x_elevation_grid_size$[ebp]
  003b3	f3 0f 11 45 b0	 movss	 DWORD PTR _x1$2[ebp], xmm0

; 436  : 
; 437  : 				z1 = z_grid * z_elevation_grid_size;

  003b8	f3 0f 2a 45 f0	 cvtsi2ss xmm0, DWORD PTR _z_grid$[ebp]
  003bd	f3 0f 59 45 dc	 mulss	 xmm0, DWORD PTR _z_elevation_grid_size$[ebp]
  003c2	f3 0f 11 45 ac	 movss	 DWORD PTR _z1$1[ebp], xmm0

; 438  : 
; 439  : 				if ( ( !checked ) && ( z_grid < ( z_size - 1 ) ) && ( x_grid < ( x_size - 1 ) ) )

  003c7	83 7d b8 00	 cmp	 DWORD PTR _checked$4[ebp], 0
  003cb	0f 85 db 00 00
	00		 jne	 $LN37@generate_t
  003d1	8b 45 f8	 mov	 eax, DWORD PTR _z_size$[ebp]
  003d4	83 e8 01	 sub	 eax, 1
  003d7	39 45 f0	 cmp	 DWORD PTR _z_grid$[ebp], eax
  003da	0f 8d cc 00 00
	00		 jge	 $LN37@generate_t
  003e0	8b 45 fc	 mov	 eax, DWORD PTR _x_size$[ebp]
  003e3	83 e8 01	 sub	 eax, 1
  003e6	39 45 f4	 cmp	 DWORD PTR _x_grid$[ebp], eax
  003e9	0f 8d bd 00 00
	00		 jge	 $LN37@generate_t

; 440  : 				{
; 441  : 
; 442  : 					height2 = terrain_3d_simple_elevation_grid[(((z_grid+1)*x_size)+x_grid+1)];

  003ef	8b 45 f0	 mov	 eax, DWORD PTR _z_grid$[ebp]
  003f2	83 c0 01	 add	 eax, 1
  003f5	0f af 45 fc	 imul	 eax, DWORD PTR _x_size$[ebp]
  003f9	03 45 f4	 add	 eax, DWORD PTR _x_grid$[ebp]
  003fc	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA ; terrain_3d_simple_elevation_grid
  00402	f3 0f 10 44 81
	04		 movss	 xmm0, DWORD PTR [ecx+eax*4+4]
  00408	f3 0f 11 45 bc	 movss	 DWORD PTR _height2$5[ebp], xmm0

; 443  : 
; 444  : 					if ( height2 > 0 )

  0040d	f3 0f 10 45 bc	 movss	 xmm0, DWORD PTR _height2$5[ebp]
  00412	0f 2f 05 00 00
	00 00		 comiss	 xmm0, DWORD PTR __real@00000000
  00419	0f 86 8d 00 00
	00		 jbe	 $LN37@generate_t

; 445  : 					{
; 446  : 		
; 447  : 						t = check_coastal_river_intersection ( x1, z1, x1 + x_elevation_grid_size, z1 + z_elevation_grid_size );

  0041f	f3 0f 10 45 ac	 movss	 xmm0, DWORD PTR _z1$1[ebp]
  00424	f3 0f 58 45 dc	 addss	 xmm0, DWORD PTR _z_elevation_grid_size$[ebp]
  00429	51		 push	 ecx
  0042a	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0042f	f3 0f 10 45 b0	 movss	 xmm0, DWORD PTR _x1$2[ebp]
  00434	f3 0f 58 45 e0	 addss	 xmm0, DWORD PTR _x_elevation_grid_size$[ebp]
  00439	51		 push	 ecx
  0043a	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0043f	51		 push	 ecx
  00440	f3 0f 10 45 ac	 movss	 xmm0, DWORD PTR _z1$1[ebp]
  00445	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0044a	51		 push	 ecx
  0044b	f3 0f 10 45 b0	 movss	 xmm0, DWORD PTR _x1$2[ebp]
  00450	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00455	e8 00 00 00 00	 call	 ?check_coastal_river_intersection@@YGMMMMM@Z ; check_coastal_river_intersection
  0045a	d9 5d b4	 fstp	 DWORD PTR _t$3[ebp]

; 448  : 
; 449  : 						if ( t != -1.0 )

  0045d	f3 0f 5a 45 b4	 cvtss2sd xmm0, DWORD PTR _t$3[ebp]
  00462	66 0f 2e 05 00
	00 00 00	 ucomisd xmm0, QWORD PTR __real@bff0000000000000
  0046a	9f		 lahf
  0046b	f6 c4 44	 test	 ah, 68			; 00000044H
  0046e	7b 3c		 jnp	 SHORT $LN37@generate_t

; 450  : 						{
; 451  : 
; 452  : 							height1 = ( sea_height - ( t * height2 ) ) / ( 1.0 - t );

  00470	f3 0f 10 45 b4	 movss	 xmm0, DWORD PTR _t$3[ebp]
  00475	f3 0f 59 45 bc	 mulss	 xmm0, DWORD PTR _height2$5[ebp]
  0047a	f3 0f 10 4d d8	 movss	 xmm1, DWORD PTR _sea_height$[ebp]
  0047f	f3 0f 5c c8	 subss	 xmm1, xmm0
  00483	f3 0f 5a c1	 cvtss2sd xmm0, xmm1
  00487	f3 0f 5a 4d b4	 cvtss2sd xmm1, DWORD PTR _t$3[ebp]
  0048c	f2 0f 10 15 00
	00 00 00	 movsd	 xmm2, QWORD PTR __real@3ff0000000000000
  00494	f2 0f 5c d1	 subsd	 xmm2, xmm1
  00498	f2 0f 5e c2	 divsd	 xmm0, xmm2
  0049c	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  004a0	f3 0f 11 45 c0	 movss	 DWORD PTR _height1$6[ebp], xmm0

; 453  : 
; 454  : 							checked = TRUE;

  004a5	c7 45 b8 01 00
	00 00		 mov	 DWORD PTR _checked$4[ebp], 1
$LN37@generate_t:

; 455  : 						}
; 456  : 					}
; 457  : 				}
; 458  : 
; 459  : 				if ( ( !checked ) && ( z_grid > 0 ) && ( x_grid > 0 ) )

  004ac	83 7d b8 00	 cmp	 DWORD PTR _checked$4[ebp], 0
  004b0	0f 85 d1 00 00
	00		 jne	 $LN40@generate_t
  004b6	83 7d f0 00	 cmp	 DWORD PTR _z_grid$[ebp], 0
  004ba	0f 8e c7 00 00
	00		 jle	 $LN40@generate_t
  004c0	83 7d f4 00	 cmp	 DWORD PTR _x_grid$[ebp], 0
  004c4	0f 8e bd 00 00
	00		 jle	 $LN40@generate_t

; 460  : 				{
; 461  : 
; 462  : 					height2 = terrain_3d_simple_elevation_grid[(((z_grid-1)*x_size)+x_grid-1)];

  004ca	8b 45 f0	 mov	 eax, DWORD PTR _z_grid$[ebp]
  004cd	83 e8 01	 sub	 eax, 1
  004d0	0f af 45 fc	 imul	 eax, DWORD PTR _x_size$[ebp]
  004d4	03 45 f4	 add	 eax, DWORD PTR _x_grid$[ebp]
  004d7	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA ; terrain_3d_simple_elevation_grid
  004dd	f3 0f 10 44 81
	fc		 movss	 xmm0, DWORD PTR [ecx+eax*4-4]
  004e3	f3 0f 11 45 bc	 movss	 DWORD PTR _height2$5[ebp], xmm0

; 463  : 
; 464  : 					if ( height2 > 0 )

  004e8	f3 0f 10 45 bc	 movss	 xmm0, DWORD PTR _height2$5[ebp]
  004ed	0f 2f 05 00 00
	00 00		 comiss	 xmm0, DWORD PTR __real@00000000
  004f4	0f 86 8d 00 00
	00		 jbe	 $LN40@generate_t

; 465  : 					{
; 466  : 		
; 467  : 						t = check_coastal_river_intersection ( x1, z1, x1 - x_elevation_grid_size, z1 - z_elevation_grid_size );

  004fa	f3 0f 10 45 ac	 movss	 xmm0, DWORD PTR _z1$1[ebp]
  004ff	f3 0f 5c 45 dc	 subss	 xmm0, DWORD PTR _z_elevation_grid_size$[ebp]
  00504	51		 push	 ecx
  00505	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0050a	f3 0f 10 45 b0	 movss	 xmm0, DWORD PTR _x1$2[ebp]
  0050f	f3 0f 5c 45 e0	 subss	 xmm0, DWORD PTR _x_elevation_grid_size$[ebp]
  00514	51		 push	 ecx
  00515	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0051a	51		 push	 ecx
  0051b	f3 0f 10 45 ac	 movss	 xmm0, DWORD PTR _z1$1[ebp]
  00520	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00525	51		 push	 ecx
  00526	f3 0f 10 45 b0	 movss	 xmm0, DWORD PTR _x1$2[ebp]
  0052b	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00530	e8 00 00 00 00	 call	 ?check_coastal_river_intersection@@YGMMMMM@Z ; check_coastal_river_intersection
  00535	d9 5d b4	 fstp	 DWORD PTR _t$3[ebp]

; 468  : 
; 469  : 						if ( t != -1.0 )

  00538	f3 0f 5a 45 b4	 cvtss2sd xmm0, DWORD PTR _t$3[ebp]
  0053d	66 0f 2e 05 00
	00 00 00	 ucomisd xmm0, QWORD PTR __real@bff0000000000000
  00545	9f		 lahf
  00546	f6 c4 44	 test	 ah, 68			; 00000044H
  00549	7b 3c		 jnp	 SHORT $LN40@generate_t

; 470  : 						{
; 471  : 	
; 472  : 							height1 = ( sea_height - ( t * height2 ) ) / ( 1.0 - t );

  0054b	f3 0f 10 45 b4	 movss	 xmm0, DWORD PTR _t$3[ebp]
  00550	f3 0f 59 45 bc	 mulss	 xmm0, DWORD PTR _height2$5[ebp]
  00555	f3 0f 10 4d d8	 movss	 xmm1, DWORD PTR _sea_height$[ebp]
  0055a	f3 0f 5c c8	 subss	 xmm1, xmm0
  0055e	f3 0f 5a c1	 cvtss2sd xmm0, xmm1
  00562	f3 0f 5a 4d b4	 cvtss2sd xmm1, DWORD PTR _t$3[ebp]
  00567	f2 0f 10 15 00
	00 00 00	 movsd	 xmm2, QWORD PTR __real@3ff0000000000000
  0056f	f2 0f 5c d1	 subsd	 xmm2, xmm1
  00573	f2 0f 5e c2	 divsd	 xmm0, xmm2
  00577	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  0057b	f3 0f 11 45 c0	 movss	 DWORD PTR _height1$6[ebp], xmm0

; 473  : 
; 474  : 							checked = TRUE;

  00580	c7 45 b8 01 00
	00 00		 mov	 DWORD PTR _checked$4[ebp], 1
$LN40@generate_t:

; 475  : 						}
; 476  : 					}
; 477  : 				}
; 478  : 
; 479  : 				if ( ( !checked ) && ( z_grid > 0 ) )

  00587	83 7d b8 00	 cmp	 DWORD PTR _checked$4[ebp], 0
  0058b	0f 85 c1 00 00
	00		 jne	 $LN43@generate_t
  00591	83 7d f0 00	 cmp	 DWORD PTR _z_grid$[ebp], 0
  00595	0f 8e b7 00 00
	00		 jle	 $LN43@generate_t

; 480  : 				{
; 481  : 
; 482  : 					height2 = terrain_3d_simple_elevation_grid[(((z_grid-1)*x_size)+x_grid)];

  0059b	8b 45 f0	 mov	 eax, DWORD PTR _z_grid$[ebp]
  0059e	83 e8 01	 sub	 eax, 1
  005a1	0f af 45 fc	 imul	 eax, DWORD PTR _x_size$[ebp]
  005a5	03 45 f4	 add	 eax, DWORD PTR _x_grid$[ebp]
  005a8	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA ; terrain_3d_simple_elevation_grid
  005ae	f3 0f 10 04 81	 movss	 xmm0, DWORD PTR [ecx+eax*4]
  005b3	f3 0f 11 45 bc	 movss	 DWORD PTR _height2$5[ebp], xmm0

; 483  : 
; 484  : 					if ( height2 > 0 )

  005b8	f3 0f 10 45 bc	 movss	 xmm0, DWORD PTR _height2$5[ebp]
  005bd	0f 2f 05 00 00
	00 00		 comiss	 xmm0, DWORD PTR __real@00000000
  005c4	0f 86 88 00 00
	00		 jbe	 $LN43@generate_t

; 485  : 					{
; 486  : 	
; 487  : 						t = check_coastal_river_intersection ( x1, z1, x1, z1 - z_elevation_grid_size );

  005ca	f3 0f 10 45 ac	 movss	 xmm0, DWORD PTR _z1$1[ebp]
  005cf	f3 0f 5c 45 dc	 subss	 xmm0, DWORD PTR _z_elevation_grid_size$[ebp]
  005d4	51		 push	 ecx
  005d5	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  005da	51		 push	 ecx
  005db	f3 0f 10 45 b0	 movss	 xmm0, DWORD PTR _x1$2[ebp]
  005e0	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  005e5	51		 push	 ecx
  005e6	f3 0f 10 45 ac	 movss	 xmm0, DWORD PTR _z1$1[ebp]
  005eb	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  005f0	51		 push	 ecx
  005f1	f3 0f 10 45 b0	 movss	 xmm0, DWORD PTR _x1$2[ebp]
  005f6	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  005fb	e8 00 00 00 00	 call	 ?check_coastal_river_intersection@@YGMMMMM@Z ; check_coastal_river_intersection
  00600	d9 5d b4	 fstp	 DWORD PTR _t$3[ebp]

; 488  : 
; 489  : 						if ( t != -1.0 )

  00603	f3 0f 5a 45 b4	 cvtss2sd xmm0, DWORD PTR _t$3[ebp]
  00608	66 0f 2e 05 00
	00 00 00	 ucomisd xmm0, QWORD PTR __real@bff0000000000000
  00610	9f		 lahf
  00611	f6 c4 44	 test	 ah, 68			; 00000044H
  00614	7b 3c		 jnp	 SHORT $LN43@generate_t

; 490  : 						{
; 491  : 
; 492  : 							height1 = ( sea_height - ( t * height2 ) ) / ( 1.0 - t );

  00616	f3 0f 10 45 b4	 movss	 xmm0, DWORD PTR _t$3[ebp]
  0061b	f3 0f 59 45 bc	 mulss	 xmm0, DWORD PTR _height2$5[ebp]
  00620	f3 0f 10 4d d8	 movss	 xmm1, DWORD PTR _sea_height$[ebp]
  00625	f3 0f 5c c8	 subss	 xmm1, xmm0
  00629	f3 0f 5a c1	 cvtss2sd xmm0, xmm1
  0062d	f3 0f 5a 4d b4	 cvtss2sd xmm1, DWORD PTR _t$3[ebp]
  00632	f2 0f 10 15 00
	00 00 00	 movsd	 xmm2, QWORD PTR __real@3ff0000000000000
  0063a	f2 0f 5c d1	 subsd	 xmm2, xmm1
  0063e	f2 0f 5e c2	 divsd	 xmm0, xmm2
  00642	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  00646	f3 0f 11 45 c0	 movss	 DWORD PTR _height1$6[ebp], xmm0

; 493  : 
; 494  : 							checked = TRUE;

  0064b	c7 45 b8 01 00
	00 00		 mov	 DWORD PTR _checked$4[ebp], 1
$LN43@generate_t:

; 495  : 						}
; 496  : 					}
; 497  : 				}
; 498  : 
; 499  : 				if ( ( !checked ) && ( x_grid > 0 ) )

  00652	83 7d b8 00	 cmp	 DWORD PTR _checked$4[ebp], 0
  00656	0f 85 bf 00 00
	00		 jne	 $LN46@generate_t
  0065c	83 7d f4 00	 cmp	 DWORD PTR _x_grid$[ebp], 0
  00660	0f 8e b5 00 00
	00		 jle	 $LN46@generate_t

; 500  : 				{
; 501  : 
; 502  : 					height2 = terrain_3d_simple_elevation_grid[((z_grid*x_size)+x_grid-1)];

  00666	8b 45 f0	 mov	 eax, DWORD PTR _z_grid$[ebp]
  00669	0f af 45 fc	 imul	 eax, DWORD PTR _x_size$[ebp]
  0066d	03 45 f4	 add	 eax, DWORD PTR _x_grid$[ebp]
  00670	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA ; terrain_3d_simple_elevation_grid
  00676	f3 0f 10 44 81
	fc		 movss	 xmm0, DWORD PTR [ecx+eax*4-4]
  0067c	f3 0f 11 45 bc	 movss	 DWORD PTR _height2$5[ebp], xmm0

; 503  : 
; 504  : 					if ( height2 > 0 )

  00681	f3 0f 10 45 bc	 movss	 xmm0, DWORD PTR _height2$5[ebp]
  00686	0f 2f 05 00 00
	00 00		 comiss	 xmm0, DWORD PTR __real@00000000
  0068d	0f 86 88 00 00
	00		 jbe	 $LN46@generate_t

; 505  : 					{
; 506  : 		
; 507  : 						t = check_coastal_river_intersection ( x1, z1, x1 - x_elevation_grid_size, z1 );

  00693	51		 push	 ecx
  00694	f3 0f 10 45 ac	 movss	 xmm0, DWORD PTR _z1$1[ebp]
  00699	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0069e	f3 0f 10 45 b0	 movss	 xmm0, DWORD PTR _x1$2[ebp]
  006a3	f3 0f 5c 45 e0	 subss	 xmm0, DWORD PTR _x_elevation_grid_size$[ebp]
  006a8	51		 push	 ecx
  006a9	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  006ae	51		 push	 ecx
  006af	f3 0f 10 45 ac	 movss	 xmm0, DWORD PTR _z1$1[ebp]
  006b4	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  006b9	51		 push	 ecx
  006ba	f3 0f 10 45 b0	 movss	 xmm0, DWORD PTR _x1$2[ebp]
  006bf	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  006c4	e8 00 00 00 00	 call	 ?check_coastal_river_intersection@@YGMMMMM@Z ; check_coastal_river_intersection
  006c9	d9 5d b4	 fstp	 DWORD PTR _t$3[ebp]

; 508  : 
; 509  : 						if ( t != -1.0 )

  006cc	f3 0f 5a 45 b4	 cvtss2sd xmm0, DWORD PTR _t$3[ebp]
  006d1	66 0f 2e 05 00
	00 00 00	 ucomisd xmm0, QWORD PTR __real@bff0000000000000
  006d9	9f		 lahf
  006da	f6 c4 44	 test	 ah, 68			; 00000044H
  006dd	7b 3c		 jnp	 SHORT $LN46@generate_t

; 510  : 						{
; 511  : 	
; 512  : 							height1 = ( sea_height - ( t * height2 ) ) / ( 1.0 - t );

  006df	f3 0f 10 45 b4	 movss	 xmm0, DWORD PTR _t$3[ebp]
  006e4	f3 0f 59 45 bc	 mulss	 xmm0, DWORD PTR _height2$5[ebp]
  006e9	f3 0f 10 4d d8	 movss	 xmm1, DWORD PTR _sea_height$[ebp]
  006ee	f3 0f 5c c8	 subss	 xmm1, xmm0
  006f2	f3 0f 5a c1	 cvtss2sd xmm0, xmm1
  006f6	f3 0f 5a 4d b4	 cvtss2sd xmm1, DWORD PTR _t$3[ebp]
  006fb	f2 0f 10 15 00
	00 00 00	 movsd	 xmm2, QWORD PTR __real@3ff0000000000000
  00703	f2 0f 5c d1	 subsd	 xmm2, xmm1
  00707	f2 0f 5e c2	 divsd	 xmm0, xmm2
  0070b	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  0070f	f3 0f 11 45 c0	 movss	 DWORD PTR _height1$6[ebp], xmm0

; 513  : 
; 514  : 							checked = TRUE;

  00714	c7 45 b8 01 00
	00 00		 mov	 DWORD PTR _checked$4[ebp], 1
$LN46@generate_t:

; 515  : 						}
; 516  : 					}
; 517  : 				}
; 518  : 
; 519  : 				if ( ( !checked ) && ( x_grid < ( x_size - 1 ) ) )

  0071b	83 7d b8 00	 cmp	 DWORD PTR _checked$4[ebp], 0
  0071f	0f 85 c4 00 00
	00		 jne	 $LN49@generate_t
  00725	8b 45 fc	 mov	 eax, DWORD PTR _x_size$[ebp]
  00728	83 e8 01	 sub	 eax, 1
  0072b	39 45 f4	 cmp	 DWORD PTR _x_grid$[ebp], eax
  0072e	0f 8d b5 00 00
	00		 jge	 $LN49@generate_t

; 520  : 				{
; 521  : 
; 522  : 					height2 = terrain_3d_simple_elevation_grid[((z_grid*x_size)+x_grid+1)];

  00734	8b 45 f0	 mov	 eax, DWORD PTR _z_grid$[ebp]
  00737	0f af 45 fc	 imul	 eax, DWORD PTR _x_size$[ebp]
  0073b	03 45 f4	 add	 eax, DWORD PTR _x_grid$[ebp]
  0073e	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA ; terrain_3d_simple_elevation_grid
  00744	f3 0f 10 44 81
	04		 movss	 xmm0, DWORD PTR [ecx+eax*4+4]
  0074a	f3 0f 11 45 bc	 movss	 DWORD PTR _height2$5[ebp], xmm0

; 523  : 
; 524  : 					if ( height2 > 0 )

  0074f	f3 0f 10 45 bc	 movss	 xmm0, DWORD PTR _height2$5[ebp]
  00754	0f 2f 05 00 00
	00 00		 comiss	 xmm0, DWORD PTR __real@00000000
  0075b	0f 86 88 00 00
	00		 jbe	 $LN49@generate_t

; 525  : 					{
; 526  : 		
; 527  : 						t = check_coastal_river_intersection ( x1, z1, x1 + x_elevation_grid_size, z1 );

  00761	51		 push	 ecx
  00762	f3 0f 10 45 ac	 movss	 xmm0, DWORD PTR _z1$1[ebp]
  00767	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0076c	f3 0f 10 45 b0	 movss	 xmm0, DWORD PTR _x1$2[ebp]
  00771	f3 0f 58 45 e0	 addss	 xmm0, DWORD PTR _x_elevation_grid_size$[ebp]
  00776	51		 push	 ecx
  00777	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0077c	51		 push	 ecx
  0077d	f3 0f 10 45 ac	 movss	 xmm0, DWORD PTR _z1$1[ebp]
  00782	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00787	51		 push	 ecx
  00788	f3 0f 10 45 b0	 movss	 xmm0, DWORD PTR _x1$2[ebp]
  0078d	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00792	e8 00 00 00 00	 call	 ?check_coastal_river_intersection@@YGMMMMM@Z ; check_coastal_river_intersection
  00797	d9 5d b4	 fstp	 DWORD PTR _t$3[ebp]

; 528  : 
; 529  : 						if ( t != -1.0 )

  0079a	f3 0f 5a 45 b4	 cvtss2sd xmm0, DWORD PTR _t$3[ebp]
  0079f	66 0f 2e 05 00
	00 00 00	 ucomisd xmm0, QWORD PTR __real@bff0000000000000
  007a7	9f		 lahf
  007a8	f6 c4 44	 test	 ah, 68			; 00000044H
  007ab	7b 3c		 jnp	 SHORT $LN49@generate_t

; 530  : 						{
; 531  : 	
; 532  : 							height1 = ( sea_height - ( t * height2 ) ) / ( 1.0 - t );

  007ad	f3 0f 10 45 b4	 movss	 xmm0, DWORD PTR _t$3[ebp]
  007b2	f3 0f 59 45 bc	 mulss	 xmm0, DWORD PTR _height2$5[ebp]
  007b7	f3 0f 10 4d d8	 movss	 xmm1, DWORD PTR _sea_height$[ebp]
  007bc	f3 0f 5c c8	 subss	 xmm1, xmm0
  007c0	f3 0f 5a c1	 cvtss2sd xmm0, xmm1
  007c4	f3 0f 5a 4d b4	 cvtss2sd xmm1, DWORD PTR _t$3[ebp]
  007c9	f2 0f 10 15 00
	00 00 00	 movsd	 xmm2, QWORD PTR __real@3ff0000000000000
  007d1	f2 0f 5c d1	 subsd	 xmm2, xmm1
  007d5	f2 0f 5e c2	 divsd	 xmm0, xmm2
  007d9	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  007dd	f3 0f 11 45 c0	 movss	 DWORD PTR _height1$6[ebp], xmm0

; 533  : 
; 534  : 							checked = TRUE;

  007e2	c7 45 b8 01 00
	00 00		 mov	 DWORD PTR _checked$4[ebp], 1
$LN49@generate_t:

; 535  : 						}
; 536  : 					}
; 537  : 				}
; 538  : 
; 539  : 				if ( ( !checked ) && ( z_grid < ( z_size - 1 ) ) )

  007e9	83 7d b8 00	 cmp	 DWORD PTR _checked$4[ebp], 0
  007ed	0f 85 c6 00 00
	00		 jne	 $LN52@generate_t
  007f3	8b 45 f8	 mov	 eax, DWORD PTR _z_size$[ebp]
  007f6	83 e8 01	 sub	 eax, 1
  007f9	39 45 f0	 cmp	 DWORD PTR _z_grid$[ebp], eax
  007fc	0f 8d b7 00 00
	00		 jge	 $LN52@generate_t

; 540  : 				{
; 541  : 
; 542  : 					height2 = terrain_3d_simple_elevation_grid[(((z_grid+1)*x_size)+x_grid)];

  00802	8b 45 f0	 mov	 eax, DWORD PTR _z_grid$[ebp]
  00805	83 c0 01	 add	 eax, 1
  00808	0f af 45 fc	 imul	 eax, DWORD PTR _x_size$[ebp]
  0080c	03 45 f4	 add	 eax, DWORD PTR _x_grid$[ebp]
  0080f	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA ; terrain_3d_simple_elevation_grid
  00815	f3 0f 10 04 81	 movss	 xmm0, DWORD PTR [ecx+eax*4]
  0081a	f3 0f 11 45 bc	 movss	 DWORD PTR _height2$5[ebp], xmm0

; 543  : 
; 544  : 					if ( height2 > 0 )

  0081f	f3 0f 10 45 bc	 movss	 xmm0, DWORD PTR _height2$5[ebp]
  00824	0f 2f 05 00 00
	00 00		 comiss	 xmm0, DWORD PTR __real@00000000
  0082b	0f 86 88 00 00
	00		 jbe	 $LN52@generate_t

; 545  : 					{
; 546  : 		
; 547  : 						t = check_coastal_river_intersection ( x1, z1, x1, z1 + z_elevation_grid_size );

  00831	f3 0f 10 45 ac	 movss	 xmm0, DWORD PTR _z1$1[ebp]
  00836	f3 0f 58 45 dc	 addss	 xmm0, DWORD PTR _z_elevation_grid_size$[ebp]
  0083b	51		 push	 ecx
  0083c	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00841	51		 push	 ecx
  00842	f3 0f 10 45 b0	 movss	 xmm0, DWORD PTR _x1$2[ebp]
  00847	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0084c	51		 push	 ecx
  0084d	f3 0f 10 45 ac	 movss	 xmm0, DWORD PTR _z1$1[ebp]
  00852	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00857	51		 push	 ecx
  00858	f3 0f 10 45 b0	 movss	 xmm0, DWORD PTR _x1$2[ebp]
  0085d	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00862	e8 00 00 00 00	 call	 ?check_coastal_river_intersection@@YGMMMMM@Z ; check_coastal_river_intersection
  00867	d9 5d b4	 fstp	 DWORD PTR _t$3[ebp]

; 548  : 
; 549  : 						if ( t != -1.0 )

  0086a	f3 0f 5a 45 b4	 cvtss2sd xmm0, DWORD PTR _t$3[ebp]
  0086f	66 0f 2e 05 00
	00 00 00	 ucomisd xmm0, QWORD PTR __real@bff0000000000000
  00877	9f		 lahf
  00878	f6 c4 44	 test	 ah, 68			; 00000044H
  0087b	7b 3c		 jnp	 SHORT $LN52@generate_t

; 550  : 						{
; 551  : 	
; 552  : 							height1 = ( sea_height - ( t * height2 ) ) / ( 1.0 - t );

  0087d	f3 0f 10 45 b4	 movss	 xmm0, DWORD PTR _t$3[ebp]
  00882	f3 0f 59 45 bc	 mulss	 xmm0, DWORD PTR _height2$5[ebp]
  00887	f3 0f 10 4d d8	 movss	 xmm1, DWORD PTR _sea_height$[ebp]
  0088c	f3 0f 5c c8	 subss	 xmm1, xmm0
  00890	f3 0f 5a c1	 cvtss2sd xmm0, xmm1
  00894	f3 0f 5a 4d b4	 cvtss2sd xmm1, DWORD PTR _t$3[ebp]
  00899	f2 0f 10 15 00
	00 00 00	 movsd	 xmm2, QWORD PTR __real@3ff0000000000000
  008a1	f2 0f 5c d1	 subsd	 xmm2, xmm1
  008a5	f2 0f 5e c2	 divsd	 xmm0, xmm2
  008a9	f2 0f 5a c0	 cvtsd2ss xmm0, xmm0
  008ad	f3 0f 11 45 c0	 movss	 DWORD PTR _height1$6[ebp], xmm0

; 553  : 
; 554  : 							checked = TRUE;

  008b2	c7 45 b8 01 00
	00 00		 mov	 DWORD PTR _checked$4[ebp], 1
$LN52@generate_t:

; 555  : 						}
; 556  : 					}
; 557  : 				}
; 558  : 
; 559  : 				if ( checked )

  008b9	83 7d b8 00	 cmp	 DWORD PTR _checked$4[ebp], 0
  008bd	74 1a		 je	 SHORT $LN53@generate_t

; 560  : 				{
; 561  : 
; 562  : 					terrain_3d_simple_elevation_grid[((z_grid*x_size)+x_grid)] = height1;

  008bf	8b 45 f0	 mov	 eax, DWORD PTR _z_grid$[ebp]
  008c2	0f af 45 fc	 imul	 eax, DWORD PTR _x_size$[ebp]
  008c6	03 45 f4	 add	 eax, DWORD PTR _x_grid$[ebp]
  008c9	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA ; terrain_3d_simple_elevation_grid
  008cf	f3 0f 10 45 c0	 movss	 xmm0, DWORD PTR _height1$6[ebp]
  008d4	f3 0f 11 04 81	 movss	 DWORD PTR [ecx+eax*4], xmm0
$LN53@generate_t:

; 563  : 				}
; 564  : 			}
; 565  : 		}

  008d9	e9 7f fa ff ff	 jmp	 $LN16@generate_t
$LN17@generate_t:

; 566  : 	}

  008de	e9 5c fa ff ff	 jmp	 $LN13@generate_t
$LN14@generate_t:

; 567  : 
; 568  : 	//
; 569  : 	// Now bring the sea points into line
; 570  : 	///
; 571  : 
; 572  : 	for ( z_grid = 0; z_grid < z_size; z_grid++ )

  008e3	c7 45 f0 00 00
	00 00		 mov	 DWORD PTR _z_grid$[ebp], 0
  008ea	eb 09		 jmp	 SHORT $LN21@generate_t
$LN19@generate_t:
  008ec	8b 45 f0	 mov	 eax, DWORD PTR _z_grid$[ebp]
  008ef	83 c0 01	 add	 eax, 1
  008f2	89 45 f0	 mov	 DWORD PTR _z_grid$[ebp], eax
$LN21@generate_t:
  008f5	8b 45 f0	 mov	 eax, DWORD PTR _z_grid$[ebp]
  008f8	3b 45 f8	 cmp	 eax, DWORD PTR _z_size$[ebp]
  008fb	7d 62		 jge	 SHORT $LN20@generate_t

; 573  : 	{
; 574  : 		
; 575  : 		for ( x_grid = 0; x_grid < x_size; x_grid++ )

  008fd	c7 45 f4 00 00
	00 00		 mov	 DWORD PTR _x_grid$[ebp], 0
  00904	eb 09		 jmp	 SHORT $LN24@generate_t
$LN22@generate_t:
  00906	8b 45 f4	 mov	 eax, DWORD PTR _x_grid$[ebp]
  00909	83 c0 01	 add	 eax, 1
  0090c	89 45 f4	 mov	 DWORD PTR _x_grid$[ebp], eax
$LN24@generate_t:
  0090f	8b 45 f4	 mov	 eax, DWORD PTR _x_grid$[ebp]
  00912	3b 45 fc	 cmp	 eax, DWORD PTR _x_size$[ebp]
  00915	7d 46		 jge	 SHORT $LN23@generate_t

; 576  : 		{
; 577  : 
; 578  : 			if ( terrain_3d_simple_elevation_grid[((z_grid*x_size)+x_grid)] == -5000 )

  00917	8b 45 f0	 mov	 eax, DWORD PTR _z_grid$[ebp]
  0091a	0f af 45 fc	 imul	 eax, DWORD PTR _x_size$[ebp]
  0091e	03 45 f4	 add	 eax, DWORD PTR _x_grid$[ebp]
  00921	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA ; terrain_3d_simple_elevation_grid
  00927	f3 0f 10 04 81	 movss	 xmm0, DWORD PTR [ecx+eax*4]
  0092c	0f 2e 05 00 00
	00 00		 ucomiss xmm0, DWORD PTR __real@c59c4000
  00933	9f		 lahf
  00934	f6 c4 44	 test	 ah, 68			; 00000044H
  00937	7a 22		 jp	 SHORT $LN54@generate_t

; 579  : 			{
; 580  : 
; 581  : 				terrain_3d_simple_elevation_grid[((z_grid*x_size)+x_grid)] = sea_height -1;

  00939	f3 0f 10 45 d8	 movss	 xmm0, DWORD PTR _sea_height$[ebp]
  0093e	f3 0f 5c 05 00
	00 00 00	 subss	 xmm0, DWORD PTR __real@3f800000
  00946	8b 45 f0	 mov	 eax, DWORD PTR _z_grid$[ebp]
  00949	0f af 45 fc	 imul	 eax, DWORD PTR _x_size$[ebp]
  0094d	03 45 f4	 add	 eax, DWORD PTR _x_grid$[ebp]
  00950	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA ; terrain_3d_simple_elevation_grid
  00956	f3 0f 11 04 81	 movss	 DWORD PTR [ecx+eax*4], xmm0
$LN54@generate_t:

; 582  : 			}
; 583  : 		}

  0095b	eb a9		 jmp	 SHORT $LN22@generate_t
$LN23@generate_t:

; 584  : 	}

  0095d	eb 8d		 jmp	 SHORT $LN19@generate_t
$LN20@generate_t:

; 585  : 	
; 586  : 	terrain_3d_simple_elevation_memory_mapped = FALSE;

  0095f	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?terrain_3d_simple_elevation_memory_mapped@@3HA, 0 ; terrain_3d_simple_elevation_memory_mapped

; 587  : }

  00969	5f		 pop	 edi
  0096a	5e		 pop	 esi
  0096b	5b		 pop	 ebx
  0096c	8b e5		 mov	 esp, ebp
  0096e	5d		 pop	 ebp
  0096f	c2 04 00	 ret	 4
?generate_terrain_simple_elevation@@YGXM@Z ENDP		; generate_terrain_simple_elevation
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrsel.c
;	COMDAT ?unload_terrain_simple_elevation_grid@@YGXXZ
_TEXT	SEGMENT
?unload_terrain_simple_elevation_grid@@YGXXZ PROC	; unload_terrain_simple_elevation_grid, COMDAT

; 225  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 226  : 	
; 227  : 	if ( terrain_3d_simple_elevation_grid )

  00009	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA, 0 ; terrain_3d_simple_elevation_grid
  00010	74 3f		 je	 SHORT $LN1@unload_ter

; 228  : 	{
; 229  : 		
; 230  : 		//
; 231  : 		// Free up the elevation map already loaded
; 232  : 		//
; 233  : 		
; 234  : 		if ( terrain_3d_simple_elevation_memory_mapped )

  00012	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?terrain_3d_simple_elevation_memory_mapped@@3HA, 0 ; terrain_3d_simple_elevation_memory_mapped
  00019	74 0d		 je	 SHORT $LN3@unload_ter

; 235  : 		{
; 236  : 			
; 237  : 			safe_mclose ( terrain_3d_simple_elevation_memory_map );

  0001b	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_simple_elevation_memory_map@@3PAEA ; terrain_3d_simple_elevation_memory_map
  00020	50		 push	 eax
  00021	e8 00 00 00 00	 call	 ?safe_mclose@@YGHPAX@Z	; safe_mclose

; 238  : 		}
; 239  : 		else

  00026	eb 0b		 jmp	 SHORT $LN4@unload_ter
$LN3@unload_ter:

; 240  : 		{
; 241  : 			
; 242  : 			safe_free ( terrain_3d_simple_elevation_grid );

  00028	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA ; terrain_3d_simple_elevation_grid
  0002d	50		 push	 eax
  0002e	e8 00 00 00 00	 call	 ?safe_free@@YGXPAX@Z	; safe_free
$LN4@unload_ter:

; 243  : 		}
; 244  : 		
; 245  : 		terrain_3d_simple_elevation_memory_map = NULL;

  00033	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?terrain_3d_simple_elevation_memory_map@@3PAEA, 0 ; terrain_3d_simple_elevation_memory_map

; 246  : 		
; 247  : 		terrain_3d_simple_elevation_grid = NULL;

  0003d	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA, 0 ; terrain_3d_simple_elevation_grid

; 248  : 		
; 249  : 		terrain_3d_simple_elevation_memory_mapped = FALSE;

  00047	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?terrain_3d_simple_elevation_memory_mapped@@3HA, 0 ; terrain_3d_simple_elevation_memory_mapped
$LN1@unload_ter:

; 250  : 	}
; 251  : }

  00051	5f		 pop	 edi
  00052	5e		 pop	 esi
  00053	5b		 pop	 ebx
  00054	8b e5		 mov	 esp, ebp
  00056	5d		 pop	 ebp
  00057	c3		 ret	 0
?unload_terrain_simple_elevation_grid@@YGXXZ ENDP	; unload_terrain_simple_elevation_grid
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrsel.c
;	COMDAT ?load_terrain_simple_elevation@@YGHPBD@Z
_TEXT	SEGMENT
_ptr$ = -4						; size = 4
_filename$ = 8						; size = 4
?load_terrain_simple_elevation@@YGHPBD@Z PROC		; load_terrain_simple_elevation, COMDAT

; 180  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 44	 sub	 esp, 68			; 00000044H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 181  : 	
; 182  : 	unsigned char
; 183  : 		*ptr;
; 184  : 	
; 185  : 	unload_terrain_simple_elevation_grid ();

  00009	e8 00 00 00 00	 call	 ?unload_terrain_simple_elevation_grid@@YGXXZ ; unload_terrain_simple_elevation_grid

; 186  : 	
; 187  : 	//
; 188  : 	// Memory map the file ( we won't be altering the data! )
; 189  : 	//
; 190  : 	
; 191  : 	terrain_3d_simple_elevation_memory_map = ( unsigned char * ) mopen ( filename );

  0000e	8b 45 08	 mov	 eax, DWORD PTR _filename$[ebp]
  00011	50		 push	 eax
  00012	e8 00 00 00 00	 call	 ?mopen@@YGPAXPBD@Z	; mopen
  00017	a3 00 00 00 00	 mov	 DWORD PTR ?terrain_3d_simple_elevation_memory_map@@3PAEA, eax ; terrain_3d_simple_elevation_memory_map

; 192  : 	
; 193  : 	if ( !terrain_3d_simple_elevation_memory_map )

  0001c	83 3d 00 00 00
	00 00		 cmp	 DWORD PTR ?terrain_3d_simple_elevation_memory_map@@3PAEA, 0 ; terrain_3d_simple_elevation_memory_map
  00023	75 07		 jne	 SHORT $LN2@load_terra

; 194  : 	{
; 195  : 		
; 196  : 		return ( FALSE );

  00025	33 c0		 xor	 eax, eax
  00027	e9 bb 00 00 00	 jmp	 $LN1@load_terra
$LN2@load_terra:

; 197  : 	}
; 198  : 	
; 199  : 	ptr = terrain_3d_simple_elevation_memory_map;

  0002c	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_simple_elevation_memory_map@@3PAEA ; terrain_3d_simple_elevation_memory_map
  00031	89 45 fc	 mov	 DWORD PTR _ptr$[ebp], eax

; 200  : 	
; 201  : 	terrain_3d_simple_elevation_width = get_list_item ( ptr, int );

  00034	8b 45 fc	 mov	 eax, DWORD PTR _ptr$[ebp]
  00037	83 c0 04	 add	 eax, 4
  0003a	89 45 fc	 mov	 DWORD PTR _ptr$[ebp], eax
  0003d	8b 4d fc	 mov	 ecx, DWORD PTR _ptr$[ebp]
  00040	8b 51 fc	 mov	 edx, DWORD PTR [ecx-4]
  00043	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_simple_elevation_width@@3HA, edx ; terrain_3d_simple_elevation_width

; 202  : 	
; 203  : 	terrain_3d_simple_elevation_height = get_list_item ( ptr, int );

  00049	8b 45 fc	 mov	 eax, DWORD PTR _ptr$[ebp]
  0004c	83 c0 04	 add	 eax, 4
  0004f	89 45 fc	 mov	 DWORD PTR _ptr$[ebp], eax
  00052	8b 4d fc	 mov	 ecx, DWORD PTR _ptr$[ebp]
  00055	8b 51 fc	 mov	 edx, DWORD PTR [ecx-4]
  00058	89 15 00 00 00
	00		 mov	 DWORD PTR ?terrain_3d_simple_elevation_height@@3HA, edx ; terrain_3d_simple_elevation_height

; 204  : 	
; 205  : 	terrain_3d_simple_elevation_x_grid_size = get_list_item ( ptr, float );

  0005e	8b 45 fc	 mov	 eax, DWORD PTR _ptr$[ebp]
  00061	83 c0 04	 add	 eax, 4
  00064	89 45 fc	 mov	 DWORD PTR _ptr$[ebp], eax
  00067	8b 4d fc	 mov	 ecx, DWORD PTR _ptr$[ebp]
  0006a	f3 0f 10 41 fc	 movss	 xmm0, DWORD PTR [ecx-4]
  0006f	f3 0f 11 05 00
	00 00 00	 movss	 DWORD PTR ?terrain_3d_simple_elevation_x_grid_size@@3MA, xmm0

; 206  : 	
; 207  : 	terrain_3d_simple_elevation_z_grid_size = get_list_item ( ptr, float );

  00077	8b 45 fc	 mov	 eax, DWORD PTR _ptr$[ebp]
  0007a	83 c0 04	 add	 eax, 4
  0007d	89 45 fc	 mov	 DWORD PTR _ptr$[ebp], eax
  00080	8b 4d fc	 mov	 ecx, DWORD PTR _ptr$[ebp]
  00083	f3 0f 10 41 fc	 movss	 xmm0, DWORD PTR [ecx-4]
  00088	f3 0f 11 05 00
	00 00 00	 movss	 DWORD PTR ?terrain_3d_simple_elevation_z_grid_size@@3MA, xmm0

; 208  : 	
; 209  : 	terrain_3d_simple_elevation_grid = ( float * ) ptr;

  00090	8b 45 fc	 mov	 eax, DWORD PTR _ptr$[ebp]
  00093	a3 00 00 00 00	 mov	 DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA, eax ; terrain_3d_simple_elevation_grid

; 210  : 	
; 211  : 	terrain_3d_simple_elevation_x_grid_size_reciprocal = 1.0 / terrain_3d_simple_elevation_x_grid_size;

  00098	f3 0f 5a 05 00
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?terrain_3d_simple_elevation_x_grid_size@@3MA
  000a0	f2 0f 10 0d 00
	00 00 00	 movsd	 xmm1, QWORD PTR __real@3ff0000000000000
  000a8	f2 0f 5e c8	 divsd	 xmm1, xmm0
  000ac	f2 0f 5a c1	 cvtsd2ss xmm0, xmm1
  000b0	f3 0f 11 05 00
	00 00 00	 movss	 DWORD PTR ?terrain_3d_simple_elevation_x_grid_size_reciprocal@@3MA, xmm0

; 212  : 
; 213  : 	terrain_3d_simple_elevation_z_grid_size_reciprocal = 1.0 / terrain_3d_simple_elevation_z_grid_size;

  000b8	f3 0f 5a 05 00
	00 00 00	 cvtss2sd xmm0, DWORD PTR ?terrain_3d_simple_elevation_z_grid_size@@3MA
  000c0	f2 0f 10 0d 00
	00 00 00	 movsd	 xmm1, QWORD PTR __real@3ff0000000000000
  000c8	f2 0f 5e c8	 divsd	 xmm1, xmm0
  000cc	f2 0f 5a c1	 cvtsd2ss xmm0, xmm1
  000d0	f3 0f 11 05 00
	00 00 00	 movss	 DWORD PTR ?terrain_3d_simple_elevation_z_grid_size_reciprocal@@3MA, xmm0

; 214  : 	
; 215  : 	terrain_3d_simple_elevation_memory_mapped = TRUE;

  000d8	c7 05 00 00 00
	00 01 00 00 00	 mov	 DWORD PTR ?terrain_3d_simple_elevation_memory_mapped@@3HA, 1 ; terrain_3d_simple_elevation_memory_mapped

; 216  : 	
; 217  : 	return ( TRUE );

  000e2	b8 01 00 00 00	 mov	 eax, 1
$LN1@load_terra:

; 218  : }

  000e7	5f		 pop	 edi
  000e8	5e		 pop	 esi
  000e9	5b		 pop	 ebx
  000ea	8b e5		 mov	 esp, ebp
  000ec	5d		 pop	 ebp
  000ed	c2 04 00	 ret	 4
?load_terrain_simple_elevation@@YGHPBD@Z ENDP		; load_terrain_simple_elevation
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrsel.c
;	COMDAT ?get_3d_terrain_fast_elevation@@YGMMM@Z
_TEXT	SEGMENT
tv137 = -124						; size = 4
tv131 = -124						; size = 4
tv93 = -124						; size = 4
tv87 = -124						; size = 4
tv138 = -120						; size = 4
tv132 = -120						; size = 4
tv94 = -120						; size = 4
tv88 = -120						; size = 4
_height$ = -52						; size = 4
_height_zx2$ = -48					; size = 4
_height_zx1$ = -44					; size = 4
_height_x2z2$ = -40					; size = 4
_height_x1z2$ = -36					; size = 4
_height_x2z1$ = -32					; size = 4
_height_x1z1$ = -28					; size = 4
_z_offset$ = -24					; size = 4
_x_offset$ = -20					; size = 4
_grid_z2$ = -16						; size = 4
_grid_z1$ = -12						; size = 4
_grid_x2$ = -8						; size = 4
_grid_x1$ = -4						; size = 4
_x$ = 8							; size = 4
_z$ = 12						; size = 4
?get_3d_terrain_fast_elevation@@YGMMM@Z PROC		; get_3d_terrain_fast_elevation, COMDAT

; 124  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 7c	 sub	 esp, 124		; 0000007cH
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 125  : 	
; 126  : 	int
; 127  : 		grid_x1,
; 128  : 		grid_x2,
; 129  : 		grid_z1,
; 130  : 		grid_z2;
; 131  : 	
; 132  : 	float
; 133  : 		x_offset,
; 134  : 		z_offset,
; 135  : 		height_x1z1,
; 136  : 		height_x2z1,
; 137  : 		height_x1z2,
; 138  : 		height_x2z2,
; 139  : 		height_zx1,
; 140  : 		height_zx2,
; 141  : 		height;
; 142  : 		
; 143  : 	num_simple_elevation_tests++;

  00009	a1 00 00 00 00	 mov	 eax, DWORD PTR ?num_simple_elevation_tests@@3HA
  0000e	83 c0 01	 add	 eax, 1
  00011	a3 00 00 00 00	 mov	 DWORD PTR ?num_simple_elevation_tests@@3HA, eax

; 144  : 	
; 145  : 	convert_float_to_int ( ( x * terrain_3d_simple_elevation_x_grid_size_reciprocal ), &grid_x1 );

  00016	8d 45 fc	 lea	 eax, DWORD PTR _grid_x1$[ebp]
  00019	50		 push	 eax
  0001a	f3 0f 10 45 08	 movss	 xmm0, DWORD PTR _x$[ebp]
  0001f	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_simple_elevation_x_grid_size_reciprocal@@3MA
  00027	51		 push	 ecx
  00028	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  0002d	e8 00 00 00 00	 call	 ?convert_float_to_int@@YGXMPAH@Z ; convert_float_to_int

; 146  : 	convert_float_to_int ( ( z * terrain_3d_simple_elevation_z_grid_size_reciprocal ), &grid_z1 );

  00032	8d 45 f4	 lea	 eax, DWORD PTR _grid_z1$[ebp]
  00035	50		 push	 eax
  00036	f3 0f 10 45 0c	 movss	 xmm0, DWORD PTR _z$[ebp]
  0003b	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_simple_elevation_z_grid_size_reciprocal@@3MA
  00043	51		 push	 ecx
  00044	f3 0f 11 04 24	 movss	 DWORD PTR [esp], xmm0
  00049	e8 00 00 00 00	 call	 ?convert_float_to_int@@YGXMPAH@Z ; convert_float_to_int

; 147  : 	
; 148  : 	x_offset = x - ( grid_x1 * terrain_3d_simple_elevation_x_grid_size );

  0004e	f3 0f 2a 45 fc	 cvtsi2ss xmm0, DWORD PTR _grid_x1$[ebp]
  00053	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_simple_elevation_x_grid_size@@3MA
  0005b	f3 0f 10 4d 08	 movss	 xmm1, DWORD PTR _x$[ebp]
  00060	f3 0f 5c c8	 subss	 xmm1, xmm0
  00064	f3 0f 11 4d ec	 movss	 DWORD PTR _x_offset$[ebp], xmm1

; 149  : 	z_offset = z - ( grid_z1 * terrain_3d_simple_elevation_z_grid_size );

  00069	f3 0f 2a 45 f4	 cvtsi2ss xmm0, DWORD PTR _grid_z1$[ebp]
  0006e	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_simple_elevation_z_grid_size@@3MA
  00076	f3 0f 10 4d 0c	 movss	 xmm1, DWORD PTR _z$[ebp]
  0007b	f3 0f 5c c8	 subss	 xmm1, xmm0
  0007f	f3 0f 11 4d e8	 movss	 DWORD PTR _z_offset$[ebp], xmm1

; 150  : 	
; 151  : 	x_offset *= terrain_3d_simple_elevation_x_grid_size_reciprocal;

  00084	f3 0f 10 45 ec	 movss	 xmm0, DWORD PTR _x_offset$[ebp]
  00089	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_simple_elevation_x_grid_size_reciprocal@@3MA
  00091	f3 0f 11 45 ec	 movss	 DWORD PTR _x_offset$[ebp], xmm0

; 152  : 	z_offset *= terrain_3d_simple_elevation_z_grid_size_reciprocal;

  00096	f3 0f 10 45 e8	 movss	 xmm0, DWORD PTR _z_offset$[ebp]
  0009b	f3 0f 59 05 00
	00 00 00	 mulss	 xmm0, DWORD PTR ?terrain_3d_simple_elevation_z_grid_size_reciprocal@@3MA
  000a3	f3 0f 11 45 e8	 movss	 DWORD PTR _z_offset$[ebp], xmm0

; 153  : 	
; 154  : 	grid_x2 = grid_x1 + 1;

  000a8	8b 45 fc	 mov	 eax, DWORD PTR _grid_x1$[ebp]
  000ab	83 c0 01	 add	 eax, 1
  000ae	89 45 f8	 mov	 DWORD PTR _grid_x2$[ebp], eax

; 155  : 	grid_z2 = grid_z1 + 1;

  000b1	8b 45 f4	 mov	 eax, DWORD PTR _grid_z1$[ebp]
  000b4	83 c0 01	 add	 eax, 1
  000b7	89 45 f0	 mov	 DWORD PTR _grid_z2$[ebp], eax

; 156  : 	
; 157  : 	grid_x1 = bound ( grid_x1, 0, ( terrain_3d_simple_elevation_width - 1 ) );

  000ba	83 7d fc 00	 cmp	 DWORD PTR _grid_x1$[ebp], 0
  000be	7d 09		 jge	 SHORT $LN5@get_3d_ter
  000c0	c7 45 88 00 00
	00 00		 mov	 DWORD PTR tv88[ebp], 0
  000c7	eb 27		 jmp	 SHORT $LN6@get_3d_ter
$LN5@get_3d_ter:
  000c9	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_simple_elevation_width@@3HA ; terrain_3d_simple_elevation_width
  000ce	83 e8 01	 sub	 eax, 1
  000d1	39 45 fc	 cmp	 DWORD PTR _grid_x1$[ebp], eax
  000d4	7e 0e		 jle	 SHORT $LN3@get_3d_ter
  000d6	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_simple_elevation_width@@3HA ; terrain_3d_simple_elevation_width
  000dc	83 e9 01	 sub	 ecx, 1
  000df	89 4d 84	 mov	 DWORD PTR tv87[ebp], ecx
  000e2	eb 06		 jmp	 SHORT $LN4@get_3d_ter
$LN3@get_3d_ter:
  000e4	8b 55 fc	 mov	 edx, DWORD PTR _grid_x1$[ebp]
  000e7	89 55 84	 mov	 DWORD PTR tv87[ebp], edx
$LN4@get_3d_ter:
  000ea	8b 45 84	 mov	 eax, DWORD PTR tv87[ebp]
  000ed	89 45 88	 mov	 DWORD PTR tv88[ebp], eax
$LN6@get_3d_ter:
  000f0	8b 4d 88	 mov	 ecx, DWORD PTR tv88[ebp]
  000f3	89 4d fc	 mov	 DWORD PTR _grid_x1$[ebp], ecx

; 158  : 	grid_x2 = bound ( grid_x2, 0, ( terrain_3d_simple_elevation_width - 1 ) );

  000f6	83 7d f8 00	 cmp	 DWORD PTR _grid_x2$[ebp], 0
  000fa	7d 09		 jge	 SHORT $LN9@get_3d_ter
  000fc	c7 45 88 00 00
	00 00		 mov	 DWORD PTR tv94[ebp], 0
  00103	eb 27		 jmp	 SHORT $LN10@get_3d_ter
$LN9@get_3d_ter:
  00105	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_simple_elevation_width@@3HA ; terrain_3d_simple_elevation_width
  0010a	83 e8 01	 sub	 eax, 1
  0010d	39 45 f8	 cmp	 DWORD PTR _grid_x2$[ebp], eax
  00110	7e 0e		 jle	 SHORT $LN7@get_3d_ter
  00112	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_simple_elevation_width@@3HA ; terrain_3d_simple_elevation_width
  00118	83 e9 01	 sub	 ecx, 1
  0011b	89 4d 84	 mov	 DWORD PTR tv93[ebp], ecx
  0011e	eb 06		 jmp	 SHORT $LN8@get_3d_ter
$LN7@get_3d_ter:
  00120	8b 55 f8	 mov	 edx, DWORD PTR _grid_x2$[ebp]
  00123	89 55 84	 mov	 DWORD PTR tv93[ebp], edx
$LN8@get_3d_ter:
  00126	8b 45 84	 mov	 eax, DWORD PTR tv93[ebp]
  00129	89 45 88	 mov	 DWORD PTR tv94[ebp], eax
$LN10@get_3d_ter:
  0012c	8b 4d 88	 mov	 ecx, DWORD PTR tv94[ebp]
  0012f	89 4d f8	 mov	 DWORD PTR _grid_x2$[ebp], ecx

; 159  : 	grid_z1 = bound ( grid_z1, 0, ( terrain_3d_simple_elevation_height - 1 ) );

  00132	83 7d f4 00	 cmp	 DWORD PTR _grid_z1$[ebp], 0
  00136	7d 09		 jge	 SHORT $LN13@get_3d_ter
  00138	c7 45 88 00 00
	00 00		 mov	 DWORD PTR tv132[ebp], 0
  0013f	eb 27		 jmp	 SHORT $LN14@get_3d_ter
$LN13@get_3d_ter:
  00141	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_simple_elevation_height@@3HA ; terrain_3d_simple_elevation_height
  00146	83 e8 01	 sub	 eax, 1
  00149	39 45 f4	 cmp	 DWORD PTR _grid_z1$[ebp], eax
  0014c	7e 0e		 jle	 SHORT $LN11@get_3d_ter
  0014e	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_simple_elevation_height@@3HA ; terrain_3d_simple_elevation_height
  00154	83 e9 01	 sub	 ecx, 1
  00157	89 4d 84	 mov	 DWORD PTR tv131[ebp], ecx
  0015a	eb 06		 jmp	 SHORT $LN12@get_3d_ter
$LN11@get_3d_ter:
  0015c	8b 55 f4	 mov	 edx, DWORD PTR _grid_z1$[ebp]
  0015f	89 55 84	 mov	 DWORD PTR tv131[ebp], edx
$LN12@get_3d_ter:
  00162	8b 45 84	 mov	 eax, DWORD PTR tv131[ebp]
  00165	89 45 88	 mov	 DWORD PTR tv132[ebp], eax
$LN14@get_3d_ter:
  00168	8b 4d 88	 mov	 ecx, DWORD PTR tv132[ebp]
  0016b	89 4d f4	 mov	 DWORD PTR _grid_z1$[ebp], ecx

; 160  : 	grid_z2 = bound ( grid_z2, 0, ( terrain_3d_simple_elevation_height - 1 ) );

  0016e	83 7d f0 00	 cmp	 DWORD PTR _grid_z2$[ebp], 0
  00172	7d 09		 jge	 SHORT $LN17@get_3d_ter
  00174	c7 45 88 00 00
	00 00		 mov	 DWORD PTR tv138[ebp], 0
  0017b	eb 27		 jmp	 SHORT $LN18@get_3d_ter
$LN17@get_3d_ter:
  0017d	a1 00 00 00 00	 mov	 eax, DWORD PTR ?terrain_3d_simple_elevation_height@@3HA ; terrain_3d_simple_elevation_height
  00182	83 e8 01	 sub	 eax, 1
  00185	39 45 f0	 cmp	 DWORD PTR _grid_z2$[ebp], eax
  00188	7e 0e		 jle	 SHORT $LN15@get_3d_ter
  0018a	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_simple_elevation_height@@3HA ; terrain_3d_simple_elevation_height
  00190	83 e9 01	 sub	 ecx, 1
  00193	89 4d 84	 mov	 DWORD PTR tv137[ebp], ecx
  00196	eb 06		 jmp	 SHORT $LN16@get_3d_ter
$LN15@get_3d_ter:
  00198	8b 55 f0	 mov	 edx, DWORD PTR _grid_z2$[ebp]
  0019b	89 55 84	 mov	 DWORD PTR tv137[ebp], edx
$LN16@get_3d_ter:
  0019e	8b 45 84	 mov	 eax, DWORD PTR tv137[ebp]
  001a1	89 45 88	 mov	 DWORD PTR tv138[ebp], eax
$LN18@get_3d_ter:
  001a4	8b 4d 88	 mov	 ecx, DWORD PTR tv138[ebp]
  001a7	89 4d f0	 mov	 DWORD PTR _grid_z2$[ebp], ecx

; 161  : 	
; 162  : 	height_x1z1 = terrain_3d_simple_elevation_grid[ ( grid_z1 * terrain_3d_simple_elevation_width + grid_x1 ) ];

  001aa	8b 45 f4	 mov	 eax, DWORD PTR _grid_z1$[ebp]
  001ad	0f af 05 00 00
	00 00		 imul	 eax, DWORD PTR ?terrain_3d_simple_elevation_width@@3HA ; terrain_3d_simple_elevation_width
  001b4	03 45 fc	 add	 eax, DWORD PTR _grid_x1$[ebp]
  001b7	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA ; terrain_3d_simple_elevation_grid
  001bd	f3 0f 10 04 81	 movss	 xmm0, DWORD PTR [ecx+eax*4]
  001c2	f3 0f 11 45 e4	 movss	 DWORD PTR _height_x1z1$[ebp], xmm0

; 163  : 	height_x2z1 = terrain_3d_simple_elevation_grid[ ( grid_z1 * terrain_3d_simple_elevation_width + grid_x2 ) ];

  001c7	8b 45 f4	 mov	 eax, DWORD PTR _grid_z1$[ebp]
  001ca	0f af 05 00 00
	00 00		 imul	 eax, DWORD PTR ?terrain_3d_simple_elevation_width@@3HA ; terrain_3d_simple_elevation_width
  001d1	03 45 f8	 add	 eax, DWORD PTR _grid_x2$[ebp]
  001d4	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA ; terrain_3d_simple_elevation_grid
  001da	f3 0f 10 04 81	 movss	 xmm0, DWORD PTR [ecx+eax*4]
  001df	f3 0f 11 45 e0	 movss	 DWORD PTR _height_x2z1$[ebp], xmm0

; 164  : 	height_x1z2 = terrain_3d_simple_elevation_grid[ ( grid_z2 * terrain_3d_simple_elevation_width + grid_x1 ) ];

  001e4	8b 45 f0	 mov	 eax, DWORD PTR _grid_z2$[ebp]
  001e7	0f af 05 00 00
	00 00		 imul	 eax, DWORD PTR ?terrain_3d_simple_elevation_width@@3HA ; terrain_3d_simple_elevation_width
  001ee	03 45 fc	 add	 eax, DWORD PTR _grid_x1$[ebp]
  001f1	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA ; terrain_3d_simple_elevation_grid
  001f7	f3 0f 10 04 81	 movss	 xmm0, DWORD PTR [ecx+eax*4]
  001fc	f3 0f 11 45 dc	 movss	 DWORD PTR _height_x1z2$[ebp], xmm0

; 165  : 	height_x2z2 = terrain_3d_simple_elevation_grid[ ( grid_z2 * terrain_3d_simple_elevation_width + grid_x2 ) ];

  00201	8b 45 f0	 mov	 eax, DWORD PTR _grid_z2$[ebp]
  00204	0f af 05 00 00
	00 00		 imul	 eax, DWORD PTR ?terrain_3d_simple_elevation_width@@3HA ; terrain_3d_simple_elevation_width
  0020b	03 45 f8	 add	 eax, DWORD PTR _grid_x2$[ebp]
  0020e	8b 0d 00 00 00
	00		 mov	 ecx, DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA ; terrain_3d_simple_elevation_grid
  00214	f3 0f 10 04 81	 movss	 xmm0, DWORD PTR [ecx+eax*4]
  00219	f3 0f 11 45 d8	 movss	 DWORD PTR _height_x2z2$[ebp], xmm0

; 166  : 	
; 167  : 	height_zx1 = ( ( height_x1z1 * ( 1 - z_offset ) ) + ( height_x1z2 * z_offset ) );

  0021e	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@3f800000
  00226	f3 0f 5c 45 e8	 subss	 xmm0, DWORD PTR _z_offset$[ebp]
  0022b	f3 0f 59 45 e4	 mulss	 xmm0, DWORD PTR _height_x1z1$[ebp]
  00230	f3 0f 10 4d dc	 movss	 xmm1, DWORD PTR _height_x1z2$[ebp]
  00235	f3 0f 59 4d e8	 mulss	 xmm1, DWORD PTR _z_offset$[ebp]
  0023a	f3 0f 58 c1	 addss	 xmm0, xmm1
  0023e	f3 0f 11 45 d4	 movss	 DWORD PTR _height_zx1$[ebp], xmm0

; 168  : 	height_zx2 = ( ( height_x2z1 * ( 1 - z_offset ) ) + ( height_x2z2 * z_offset ) );

  00243	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@3f800000
  0024b	f3 0f 5c 45 e8	 subss	 xmm0, DWORD PTR _z_offset$[ebp]
  00250	f3 0f 59 45 e0	 mulss	 xmm0, DWORD PTR _height_x2z1$[ebp]
  00255	f3 0f 10 4d d8	 movss	 xmm1, DWORD PTR _height_x2z2$[ebp]
  0025a	f3 0f 59 4d e8	 mulss	 xmm1, DWORD PTR _z_offset$[ebp]
  0025f	f3 0f 58 c1	 addss	 xmm0, xmm1
  00263	f3 0f 11 45 d0	 movss	 DWORD PTR _height_zx2$[ebp], xmm0

; 169  : 	
; 170  : 	height = ( ( height_zx1 * ( 1 - x_offset ) ) + ( height_zx2 * x_offset ) );

  00268	f3 0f 10 05 00
	00 00 00	 movss	 xmm0, DWORD PTR __real@3f800000
  00270	f3 0f 5c 45 ec	 subss	 xmm0, DWORD PTR _x_offset$[ebp]
  00275	f3 0f 59 45 d4	 mulss	 xmm0, DWORD PTR _height_zx1$[ebp]
  0027a	f3 0f 10 4d d0	 movss	 xmm1, DWORD PTR _height_zx2$[ebp]
  0027f	f3 0f 59 4d ec	 mulss	 xmm1, DWORD PTR _x_offset$[ebp]
  00284	f3 0f 58 c1	 addss	 xmm0, xmm1
  00288	f3 0f 11 45 cc	 movss	 DWORD PTR _height$[ebp], xmm0

; 171  : 	
; 172  : 	return ( height );

  0028d	d9 45 cc	 fld	 DWORD PTR _height$[ebp]

; 173  : }

  00290	5f		 pop	 edi
  00291	5e		 pop	 esi
  00292	5b		 pop	 ebx
  00293	8b e5		 mov	 esp, ebp
  00295	5d		 pop	 ebp
  00296	c2 08 00	 ret	 8
?get_3d_terrain_fast_elevation@@YGMMM@Z ENDP		; get_3d_terrain_fast_elevation
_TEXT	ENDS
; Function compile flags: /Odtp /ZI
; File c:\users\nhv90\projects\eech\modules\3d\terrain\terrsel.c
;	COMDAT ?initialise_terrain_simple_elevation@@YGXXZ
_TEXT	SEGMENT
?initialise_terrain_simple_elevation@@YGXXZ PROC	; initialise_terrain_simple_elevation, COMDAT

; 110  : {

  00000	55		 push	 ebp
  00001	8b ec		 mov	 ebp, esp
  00003	83 ec 40	 sub	 esp, 64			; 00000040H
  00006	53		 push	 ebx
  00007	56		 push	 esi
  00008	57		 push	 edi

; 111  : 	
; 112  : 	terrain_3d_simple_elevation_memory_map = NULL;

  00009	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?terrain_3d_simple_elevation_memory_map@@3PAEA, 0 ; terrain_3d_simple_elevation_memory_map

; 113  : 	
; 114  : 	terrain_3d_simple_elevation_grid = NULL;

  00013	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?terrain_3d_simple_elevation_grid@@3PAMA, 0 ; terrain_3d_simple_elevation_grid

; 115  : 	
; 116  : 	terrain_3d_simple_elevation_memory_mapped = FALSE;

  0001d	c7 05 00 00 00
	00 00 00 00 00	 mov	 DWORD PTR ?terrain_3d_simple_elevation_memory_mapped@@3HA, 0 ; terrain_3d_simple_elevation_memory_mapped

; 117  : }

  00027	5f		 pop	 edi
  00028	5e		 pop	 esi
  00029	5b		 pop	 ebx
  0002a	8b e5		 mov	 esp, ebp
  0002c	5d		 pop	 ebp
  0002d	c3		 ret	 0
?initialise_terrain_simple_elevation@@YGXXZ ENDP	; initialise_terrain_simple_elevation
_TEXT	ENDS
END
